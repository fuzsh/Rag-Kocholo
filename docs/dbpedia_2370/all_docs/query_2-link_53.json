{
    "id": "dbpedia_2370_2",
    "rank": 53,
    "data": {
        "url": "https://www.mediawiki.org/wiki/Manual_talk:Configuring_file_uploads",
        "read_more_link": "",
        "language": "en",
        "title": "Manual talk:Configuring file uploads",
        "top_image": "https://www.mediawiki.org/static/favicon/mediawiki.ico",
        "meta_img": "https://www.mediawiki.org/static/favicon/mediawiki.ico",
        "images": [
            "https://www.mediawiki.org/static/images/icons/mediawikiwiki.svg",
            "https://www.mediawiki.org/static/images/mobile/copyright/mediawikiwiki-wordmark.svg",
            "https://upload.wikimedia.org/wikipedia/mediawiki/thumb/2/25/Where_php.ini_is_found.png/400px-Where_php.ini_is_found.png",
            "https://upload.wikimedia.org/wikipedia/commons/thumb/b/bc/Post_max_size_and_upload_max_filesize.jpg/100px-Post_max_size_and_upload_max_filesize.jpg",
            "https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/OOjs_UI_icon_info.svg/20px-OOjs_UI_icon_info.svg.png",
            "https://login.wikimedia.org/wiki/Special:CentralAutoLogin/start?type=1x1",
            "https://www.mediawiki.org/static/images/footer/wikimedia-button.svg",
            "https://www.mediawiki.org/static/images/footer/poweredby_mediawiki.svg"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "",
        "meta_lang": "en",
        "meta_favicon": "/static/apple-touch/mediawiki.png",
        "meta_site_name": "MediaWiki",
        "canonical_link": "https://www.mediawiki.org/wiki/Manual_talk:Configuring_file_uploads",
        "text": "I enabled uploading pdf but on that page I get this message. What does it mean? pdf file has problem or a php extension or wikimedia itself?\n\nFile has insufficient data for an image. GPL Ghostscript 8.71: Unrecoverable error, exit code 1 convert: no decode delegate for this image format `/tmp/magick-9uL6qG5N' @ error/constitute.c/ReadImage/544. convert: no images defined `/tmp/transform_8e246748821a.jpg' @ error/convert.c/ConvertImageCommand/301\n\nI'm using Bluehost, with Mediawiki 1.20.5, PHP 5.4.13, MySQL 5.5.30. Images directory in /w is set to 777\n\nLocal Settings: $wgEnableUploads = true; $wgUseImageMagick = true; $wgImageMagickConvertCommand = \"/usr/bin/convert\";\n\nAND\n\nphp.ini file_uploads = On\n\nThe upload process on the wiki itself seems to work fine-- the upload screen shows the thumbnail of the image about the imported. Once the upload is done however, no image displays-- just empty thumbnail boxes. When I click on the image link itself, it takes me to a 404 screen with the URL /w/images/'number or letter'/'number or letter'/'my filename'. No folder or file is created in /images, however.\n\nI've also tried configuring php.ini to move the uploaded file, using: move_uploaded_file($_FILES['userfile']['tmp_name'], \"{IP}/images\") although I'm not sure if I did that right or not, or if that is even the problem to begin with\n\nAny ideas?\n\nSame Problem here after I upgraded from MW 1.19 to MW 1.23. Still searching for the real cause. --213.196.168.246\n\nI looked in apache logs. The following error \"sh: /cp: not found\" appears each time I try a new upload. (I use MW 1.23.)\n\nI may know the problem because i think i have the same problem. it could be that the server you're working on does not work with $wgImageMagickConvertCommand = \"/usr/bin/convert\"; MW 1.29 14:15, 9 October 2017 (UTC)\n\nIn the wiki, I added the openoffice file extentions in order not to privilege Microsoft extentions, and so that the readers easily may copy them.\n\nI am unable to upload ods and other open office files. I have included them in the $wgFileExtensions. Its not in the black lists. I have also set the mime types in the mime.types file.\n\nPlease advice\n\nThe Upload option is not displayed in my toolbox. My LocalSettings.php upload configuration is this:\n\n$wgEnableUploads = true; $wgGroupPermissions['autoconfirmed']['upload'] = true; $wgGroupPermissions['autoconfirmed']['reupload'] = true; $wgGroupPermissions['user']['upload'] = true; $wgFileExtensions = array('png', 'gif', 'jpg', 'jpeg', 'doc', 'xls', 'mpp', 'pdf', 'ppt', 'tiff', 'bmp', 'docx', 'xlsx', 'pptx', 'ps', 'psd', 'swf', 'fla', 'mp3', 'mp4', 'm4v', 'mov', 'avi');\n\nThe Server Settings seem to be right, but if not that wouldn't prevent MediaWiki to show the Link wouldn't it?\n\n09:27, 17 December 2010 (UTC)\n\nSolved the problem there was another \"$wgEnableUploads = false\" in the File.\n\n91.37.53.90\n\nI have the same problem, same LocalSettings.php configuration, but no upload option in my sidebar. Thanks! --213.203.135.77\n\nI want to provide a convenient way to upload,But in the program utf-8 mediawiki cannot upload file name for the gbk code.Please try for this file name.\n\n新建文本文档.pdf\n\nMediaWiki version: 1.16.0\n\nOS:Windows 7\n\nIE:Intelnet Explorer 8/Opera 10 — Preceding unsigned comment added by Changdaojun (talk • contribs)\n\nIs the server running Windows? Max Semenik\n\nThe server is running in Windows。I can upload the file with chinese name to server as follows,\n\n标志.jpg\n\nbut the file is renamed to corrupted characters in the server directory as follows,\n\n鏍囧織.jpg\n\nAnd then, the url in the file page is error as follows,\n\nThe requested URL /ismwiki/images/1/15/æ ‡å¿—.jpg was not found on this server.\n\nMediaWiki version: 1.16.1\n\nMysql:5.5.8\n\nPHP:5.3.3\n\nOS:Windows Server 2003\n\nMediaWiki version: 1.16.0beta2\n\nPHP version: 5.2.6-1+lenny4 (apache2handler)\n\nMySQL version: 5.0.51a-24+lenny2+spu1\n\nURL: http://www.theyesmenfixtheworld.com/guide (un: guest pw: todayonly!)\n\nI cannot upload PDFs to my wiki. I am logged in as a sysop. I can upload images just fine. The research I have done leads be to believe these changes in LocalSettings should do the trick, but they don't... The public directory is now 777. I don't an error message.\n\n$wgEnableUploads = true; $wgAllowExternalImages = true; $wgAllowCopyUploads = true; $wgAllowImageMoving = true; # $wgUseImageMagick = true; # $wgImageMagickConvertCommand = \"/usr/bin/convert\"; # allow more file types: $wgFileExtensions[] = 'pdf'; # trying to get pdfs to work $wgVerifyMimeType = false; $wgStrictFileExtensions = false; $wgCheckFileExtensions = false; ## $wgMimeDetectorCommand = \"file -bi\"; ini_set( 'memory_limit', '64M' ); /** This is a flag to determine whether or not to check file extensions on upload. */ $wgUploadSizeWarning = true;\n\nAny advice? --Two7s clash\n\n$wgEnableUploads as the very last line. Setting it to true before setting $wgAllowExternalImages and $wgVerifyMimeType can cause errors. See '\".[FILE EXTENSION]\" is not a recommended image file format.' below. --Brian F. 19:46, 10 August 2010 (UTC)\n\nAfter uploading images I'm not able to see them because the subfolders don't have the permission 755. Can I change that automatically or do I have to change them after every upload? It would also be ok if all images would be stored in the images/ folder instead in the images/firstletter/firstletternumber. I hope someone can help me.\n\nHow come when editing MediaWiki's $wgEnableUploads between true and false becomes noticeable immediately (unable to upload vs. upload enabled) but editing PHP $file_uploads (if already 'on') is not impacting/denying my upload experience at all?\n\nYou have to restart Apache for your PHP config changes to take effect\n\nWho is the \"end user\"; someone accessing the wiki using a web browser, or a local user on the machine running the wiki?\n\nIn this case, \"end user\" refers to the user accessing the wiki using a web browser.\n\nAre file uploads only for images, or for any type of file?\n\nYou can configure MediaWiki to accept additional file types using the $wgFileExtensions configuration setting.\n\nShouldn't the chmod for the upload directory be 744? That gives rwxr--r--. 755 gives r-x, which I thought was what we were trying to avoid...\n\nExecute privilege on directories is required to access files inside them. (Yes, this is confusing. Blame AT&T.) --Brion VIBBER\n\nThere are pages on this site that say 744,755,777. Could someone explain wich to use when? -- anon\n\nThe important thing is that the webserver has write access. Thus if the upload directory is owned by the webserver user ( e.g. www-data ) 755 would suffice. If the webserver is not owner, but is in the group owning the directory, 775 would be better. 777 is the extreme case where all users on the system have full access. In most cases this would not be advisable. -- anon\n\nThanks for that. Actually the bit about setting the owner to www-data just helped me. As an additional note on this, I think I'm also seeing (on a standard ubuntu apache set-up) that setting the directory to 777 will trip some other security checks thus preventing access. But could be my imagination.\n\nSo combining these things, I needed to set 755, but also set the owner of the file and the group of the file to 'www-data'. I also needed to do these things recursively because I was restoring from a backed up directory tree:\n\nchmod -R 755 images\n\nchown -R www-data images\n\nchgrp -R www-data images\n\nThe page currently doesn't mention what the owner should be set to. It's important no? Of course 'www-data' wont always be the correct username. Worked for me on ubuntu.\n\n-- Harry Wood\n\nFor me this worked:\n\nchown -R username:psaserv /var/www/vhosts/mywiki.com/httpdocs/wiki/images/\n\nchmod -R 775 /var/www/vhosts/mywiki.com/httpdocs/wiki/images/\n\n--Subfader (talk)\n\nDoes anyone have any idea how to allow files to be uploaded and named with lowercase letter, for some reason all uploaded file default to a capital letter for the first letter of the file name? 24.3.123.174\n\nwuh. just under a year response time. Anywho: A technical limitation of Mediawiki is that all pagenames have to start with an uppercase letter. this is most likely the cause for all files beeing renamed.195.230.62.186\n\nI did as mentioned.\n\nIt's a little frustrating, but it seems like mediawiki does not bother that I changed settings in localsettings.php.\n\nI added zip as an extension, than I turned off the extension check, then I turned of mime check etc.\n\nStill I can only upload images and no zip files.\n\nwhat to do?\n\nI had to set $wgVerifyMimeType=false; in my LocalSettings.php which means my mime types are probably screwed up. Its an symptomatic fix to a bigger problem, i suspect.\n\nPerhaps have a look at Manual:Mime type detection -- Duesentrieb ⇌\n\nI have set file extensions to allow wmv and avi, set $wgStrictFileExtensions=false; and $wgVerifyMimeType=false in LocalSettings.php, but get the message \" \".avi\" is not a recommended image file format. \" (same for .wmv) when I try to upload avi (and wmv) files. Files sizes are under the cap in php.ini. I have not problems uploading static image files (eg .jpg, .png).\n\nWith $wgStrictFileExtensions=false, you will still get that warning, but should be able to override it (\"upload anyway\" or some such). $wgVerifyMimeType=false has nothing to do with this, it just tells MediaWiki not to check if the file actually is an avi file (failing that test would result in a different error message though). -- Duesentrieb ⇌\n\nThanks for the speedy response. Unfortunately no override option appeared on the screen. I just got \"Upload warning\" header above the \"not a recommended image file format\" message. This also happened when I check \"Ignore any warnings\" on the upload screen. However, I then rearranged the order of in LocalSetting.php so that $wgStrictFileExtensions=false appeared before $wgEnableUploads=true and $wgFileExtensions = .... I can now upload video files without any difficulties.\n\nTurning of $wgStrictFileExtensions seems a little dangerous. I fixed a similar problem I was having with xls files by adding the following line to mime.types:\n\napplication/msword xls\n\nDepending upon the mime detection engine on your server, certain types are misidentified. The true solution is to fix the engine, but this is a pretty safe alternative. - dan\n\nMUst be server pixies then. -- Duesentrieb ⇌\n\nHow do you change the maximum allowed size of a file for uploading?\n\nThis is what I have in my php.ini:\n\nYou may also have to change post_max_size in the same file. Apache itself might also have a limit set. And keep in mind that you have to restart Apache for any changes to the PHP configuration to take effect...\n\nOn my system I'm apparently using PHP FPM, so the file to edit is /etc/php/7.2/fpm/php.ini (editing /etc/php/7.2/apache2/php.ini had no effect). After doing that you need to restart the PHP FPM process.\n\nIs there a way to set it so that only SysOp can upload files?\n\nTry meta:Uploading_files#Is_it_possible_to_let_only_some_users_upload_Images.3F --Flominator\n\nIs there a way to allow users to upload files without logging in?\n\nThat'd be a great help for corporate environments where only a limited number of people can access the wiki (server) anyway...\n\nEdit SpecialUpload.php file in the includes folder\n\nComment out the following two lines:\n\n$wgOut->errorPage( 'uploadnologin', 'uploadnologintext' ); return;\n\nNow users will not have to login to reach the upload form.\n\nSimpler method, modify LocalSettings.php:\n\n$wgEnableUploads = true; $wgGroupPermissions['*']['upload'] = true;\n\nIm trying to change my extensions list, but it is not in LocalSettings? Where is it?\n\nThe default is set in includes/DefaultSettings.php. But you shouldn't change it here. Just copy the line into your LocalSettings.php and alter it the way you like here. The intention for this procedure is just that the DefaultSettings is responsible for everything that is NOT explicity set by yourself. Also if you like to make an update someday you won't destroy your current settings, cause the LocalSettings.php won't be touched through an update.\n\nIn the manual page, it says under \"Check directory security\" that \"The upload directory needs to be configured so that it is not possible for an end user to upload and execute other scripts, which could then exploit access to your web directory and damage your wiki or web site.\"\n\nUnfortunately, the PHP function that makes subdirectories is:\n\nfunction wfMkdirParents( $fullDir, $mode = 0777 ) { ... }\n\nand many places that call this use the fault mode 0777 which is world-writable. For example, everywhere in Image.php it uses one argument calling this method, such as:\n\n./includes/Image.php:1078: wfMkdirParents( $thumbDir );\n\nThe consequence of this is that every directory recursively under images is world-writable. The files themselves seem to be fine (mode 644), however, any user who can login to the system on which the MediaWiki instance is running can copy or destroy files at will.\n\nCan we get wfMkdirParents (and everywhere that 0777 is passed to that method) to use a mode of 0755 instead? --Caswick\n\nCase 1 - When i want to upload images, i follow the following steps\n\ngo to page edit\n\nwrite a suitable name\n\nmake it into an image link by clicking the 6th button from the left on the edit menu\n\nsave page\n\nview page, the link is shown in red.\n\nclick it and upload the image\n\nSimple.\n\nBut with file types other than images,it give an error as to \"not a jpeg format\", there is no such option. I have to link the thing by copy/pasting the exact names everytime. There must some other way around! Please help me on this !! --Ankit.madan\n\nFatal error: Call to undefined function curl_init() in /path/to/wiki/includes/SpecialUpload.php on line 165\n\nAny idea what could cause this? I've googled it, but it seems only the chinese have experiences this problem. Using MW 1.11 - followed the directions on the configuration page. Regular uploads work fine.\n\nI solved this by typing on Ubuntu: 'sudo apt-get install php5-curl' followed by 'sudo /etc/init.d/apache2 restart'\n\nIf you are using suphp you might want to check the suphp configuration file ( /etc/suphp.conf )\n\nand ensure the Umask value is set to something sane (so when the folders get created they get the proper permissions)\n\nUmask to set, specify in octal notation\n\numask=0022\n\nYou can also set the umask locally at the LocalSettings.php:\n\numask(0022);\n\nIs it possible to upload multiple files at one time (like for a photo gallery) rather than uploading each file individually? Or if I FTP them to my server without using MediaWiki's upload page, can I still use the <gallery> tags to display them somehow?\n\nThere's Extension:MultiUpload, havn't tried it though. If you upload files directly to the server using FTP or SCP or whatever, you have to import them into MediaWiki to make them work wiki-style: That is done using maintenance/importImages.php but it requires shell access. I believe some of the bots that exist for mediawiki also support file upload, but I havn't looked into that. There's also the commonist upload tool, which was designed for wikimedia commons, but can be adopted to other sites as well.\n\nHTH -- Duesentrieb ⇌\n\nThanks so much for the info! I do have shell access, and I think FTP and import would probably the fastest for lots of images. I may use MultiUpload as well - it would be nice if I had just a few files.\n\nJust saw that I do not want drag'n'drop mutple upload via interface. Too much abuse. Will also try MultiUpload. Thanks --Subfader\n\nThe absolute best extension for this is Extension:SpecialUploadLocal which currently works for all version but 1.16. Adamtheclown\n\nI'm webmaster of http://venciclopedia.com, a Spanish language wiki. We recently moved from one hosting server to another and it took us weeks to finish the migration because of problems with the names of some images. The main problem was that our former hosting (yahoo) didn't allow the creation of files or folders with certain characters, but wiki did it anyway and we didn't care until we moved away. Our former wiki could read the folders and images in them, but we could not see them or ftp them out of yahoo because of invalid characters in the names.\n\nThis was most likely solved by our move to a new hosting and upgrade to the latest wiki, but after so many problems I simply don't want to risk it. My question: There's way to forbid users from uploading files with names containing symbols (as in #, @, etc) and accented words (as in \"ó\")?\n\nRight now we are running with a modification I did to Specialupload.php in line 426, where I changed this:\n\n$filtered = preg_replace ( \"/[^\".Title::legalChars().\"]|:/\", '-', $filtered );\n\nTo this:\n\n$filtered = preg_replace ( \"/[^a-z0-9\\\\040\\\\.]|:/i\", 'x', $filtered );\n\nWith this change users cannot upload files with symbols or accented words, but they still can upload the \"ugly\" and nondescriptive file names created by my patch. Meaning, words with a bunch of X's where the symbols or accented words used to be.\n\nSo, is there a way to just reload the page and say, Please change your filename, such and such characters are invalid?\n\nIs there a way to transform accented words like \"ó\" into plain \"o\"s?\n\nIn Especial:Allmessages I found a message titled illegalfilename that warns against using invalid characters, so I guess there's some sort of option without having to change Specialupload.php directly.\n\nThanks in advance, here's my upload page in case you need to test it. http://venciclopedia.com/index.php?title=Especial:Upload\n\n--Mark 09:55, 25 April 2008 (UTC)\n\nreload the page and say, Please change your filename -> yes, you can write a piece of code using the hook UploadVerification (you can adapt UploadBlacklist extension for this purpose) --Yannouk (talk)\n\nIs it possible to upload files to FTP server?\n\nYes, then use /maintenance/importImages.php Read above section.\n\nHey, I recently installed the newest Mediawiki and any files (I only tried images though) I upload always come up as Image:[USERNAME]--[IMAGENAME].[extension]. Is there any way to make it just go to the file name? Thanks. --Ratmaster\n\nI'm getting this too on a small wiki I'm an administrator on. There doesn't seem to be any obvious setting in includes/specials/SpecialUpload.php, does anyone have any clues they could offer me on where to look? Bryan Derksen\n\nAfter digging a bit further on this site I found the answer here: Project:Support_desk/Archives/Images/002#(RESOLVED) Preloaded Image Names?. Apparently the \"KeepYourHandsToYourself\" extension is responsible. Commenting out the line\n\n'extensions/KeepYourHandsToYourself.php' -- $wgHooks['UploadForm:BeforeProcessing'][] = 'prependUsernameToFilename';\n\nseems to be one way to fix it. Bryan Derksen\n\nHi,\n\nI'm using mediawiki1.7 with postgres. When uploading a file, the pg_query() can't write in img_size in the image table and I get an error message -\n\nERROR: value \"202205\" is out of range for type smallint\n\nand some other details...\n\n...out of range for type smallint in /usr/share/mediawiki1.7/includes/DatabasePostgres.php\n\nI have modified $wgMaxUploadSize and $wgFileExtensions in LocalSettings.php\n\n$wgFileExtensions = array( 'png', 'gif', 'jpg', 'jpeg', 'ppt', 'pdf', 'doc', 'psd', 'mp3','xls', 'zip','swf', 'doc', 'odt', 'odc', 'odp', 'odg', 'mpp'); $wgUploadSizeWarning = 1000 * 1024; $wgMaxUploadSize = 1024 * 1024 * 100;\n\nThis did not help. I think, the problem is in the definition of the image table. Is there a way to enable upload of larger files, up to 2M?\n\nThank you in advance,\n\nTwisp\n\nHello,\n\nI was able to solve this problem by going into the database using phpPgAdmin and modifying the 'image' table by changing the Column/Field img_size type from 'smallint' to 'integer' and now I am able to upload files which exceed the 32K limit which was imposed by using a 'smallint' type for that field.\n\nI hope you can resolve this issue on your end...\n\nmuman613 20:07, 1 March 2012 (UTC)\n\nHow does one change the text on this page?\n\nI need to add some extra copyright warning text.\n\n--Stuart Halliday\n\nAh. Discovered how to do this: Go to the 'MediaWiki:Uploadtext' page of your Wiki and edit it. --Stuart Halliday\n\nRight up in Prerequisites, it mentions that a file called php.ini needs to be changed to allow uploads. Problem is, I searched though on my FTP thing, and I don't seem to HAVE a file called php.ini. I did change the bit for LocalSettings.php, and that much allows me to upload images... but to try looking at the page for it, or a page that it's supposed to appear on at all, all that comes up is a 500 Internal Server Error that includes, \"Additionally, a 404 Not Found error was encountered while trying to use an ErrorDocument to handle the request.\"\n\nSo... I have no idea what to do.\n\nphp.ini is a system configuration file; you probably don't have access to it. Your host may or may not be willing to change settings in php.ini for you, and may or may not have a way for you to use your own custom php.ini file.\n\nIn any event, you are able to upload files, but the resulting image pages give internal server errors? Enable error reporting and post what you find. —Emufarmers(T|C)\n\nIs it possible to change the directory of images to a differnt FTP Server? At the moment all images are placed on server1 with all the other folders. Is it possible to extract just the image folder to a different FTP server? The rest of the wiki folders will stay on server1. How do I address the server2 with the uploaddirectory and the uploadpath?\n\nI would also like this feature. My hosting providers offers a separate service for just file hosting without scripting. It's much cheaper, get lots of space, and great transfer allocations. Then, it would be images.mydomain.tld. But, it only has FTP access for uploads, and HTTP access for downloads. 192.55.55.39\n\nOn trying to upload a pic directly from an URL I get an error message\n\nWarning: file_exists():open_basedir restriction in effect. File(/temp/xcvsderd)is not within the allowed path(s): (/var/www/web/html:/var/www/web/phptmp:/var/www/web/files:/var/www/web/atd: ...............in /var/www/web/wiki/includes/specials/SpecialUpload.php on line 150\n\nI'm runnig MediaWiki 1.14.0 mysql 5.0.51 php 5.2.9\n\nWhat am I doing wrong ? How to \"config\" this feature ? Thanks\n\nRed ant\n\nHey, I'm upgrading from 1.11 to 1.15.1. I have a lot of customized extensions, so I set up 1.15.1 in a separate area of my server to test it out first. However, in 1.15.1 I can't enable file uploads. It says \"Uploads disabled. File uploads are disabled in PHP. Please check the file_uploads setting.\" But my php settings are unchanged, file_uploads is on and it is working fine in the already installed 1.11 wiki (same server but different folder, same database but different table prefixes). Do anyone know what could cause this? I have set $wgEnableUploads=true, and I have set the upload folder to be writable by the server (even set it to 777 just to check). I'd be grateful for any help! --Anderssl\n\nI've added this topic to the main article. I spent a few hours trying to get my uploads working and it wasn't until I saw the Upload File option under Special Pages that it finally told me I had to register and logon. This would be expected for Wikipedia but for own wikis starting up people (like me) won't necessary register and logon to set it up. 118.209.221.29\n\nI had the following problem with mediawiki installed on Windows with wamp server and it took me pretty long to solve it:\n\nIf the temp directory is in a different volume that the image directory, then the error \"could not rename x to y\" error arises. That's because PHP (at least version 5.3) does not like renaming files among volumes. In my case I had wamp installed on C: (so the temp directory was the default one c:/wamp/tmp) and wamps webroot directory installed on D: (so the image directory was something like D:/wamp/www/mediawiki/images).\n\nI know this is no strictly a mediawiki issue, but it would have saved me lots of time if a note about this was included in the article.\n\n--Mmutilva\n\nneither of the commands on the main page worked for me in putty.exe or find php.ini, so searching the internet i found this:\n\nFor an example of where the php.ini file is: see Where is php.ini located?. Igottheconch\n\nI have a problem, I don't think I have the file at all :/ No idea why, but what to do now?\n\nI have the same issue. I'm running MW 1.23 and don't see these folders or the file mentioned. Maldarthe1st 13 February, 2015\n\nI had this problem too. I'm afraid this help article is so bad it's worse than useless for the novice. After much effort and googling, I found a way to locate php.ini, only to find that it isn't in a mediawiki folder at all-- it's apparently a sort of system file that applies to everything you do on your server. In my case, it was /etc/php72/php.ini, which is on a read-only directory on the server of the company that hosts my website. I wonder if most users are able to change that directory-- maybe you can't unless you have your own linux installation under your completely control, so users like me who have university or company or commercial servers can't change it. Some discussion of that would be helpful. Don't assume that all mediawiki users know php and linux-- not even the bare basics.\n\nEditeur24 (talk)\n\nSee Manual:php.ini. There's a link to that page in a lot of instances of php.ini of the manual... To prevent confusion, I've removed instructions from the section \"locating the php.ini\" and pointed to that page instead --Ciencia Al Poder (talk)\n\nHello, I've started uploading photos and it worked great except for some photos. I have the following warning \" Could not create directory \"public/archive/e/ef\" \". This is strange as php.ini allows upload, $wgEnableUploads is set to true, and especially it worked OK before and after these 2 photos. I run MW1.16 with php5, image directory is fully writable as well as subfolders \"archive\", \"e\" and \"thumb\". but where is this \"public\" folder? Any clue? thx! — Preceding unsigned comment added by 89.246.214.0 (talk • contribs) 10:42, 1 March 2011\n\nSo, I found and I'll let you know! basically, the subfolder \"e\" had no special right and no new subfolder could be written. I simply gave it full authorisation...\n\nSorry and envoy MW!!! — Preceding unsigned comment added by 89.246.214.0 (talk • contribs) 11:20, 1 March 2011\n\nTrying to solve this, any idea?\n\nsame as the post just above you, folder 9/9b does not have the correct user rights. Go into your files and change the folder attributes to 777. Igottheconch\n\nMaybe the owner of the directories is different from the user that the apache process is using (see section Chmod).\n\n--91.213.61.23\n\nRecently I have upgraded media wiki from 1.16 to 1.17. Since the upgrade my upload page is displaying the message \"Maximum file size: 7 KB (a file on your computer)\" and throws me the warning \"This file is bigger than the server is configured to allow.\" when I try to upload a file of modest size.\n\nin the php.ini Localsettings.php file I have the upload limit defined as follows\n\n## Set upload limit $wgMaxUploadSize = \"50M\";\n\nand in php.ini, I have these settings (pertaining to file upload)\n\nupload_max_filesize = 50M post_max_size = 50M\n\nWhat's missing in my configuration? Any idea? --124.195.194.2\n\nYea, take a look in your includes/DefaultSettings.php file. Copy the upload size code over to you local settings and edit the '100' to be the size you're looking for. There is also an example in there for uploads from different sources.. url or other. --Pher122s (talk)\n\nWhat is the problem on uploading files in linux godaddy. When I had my mediawiki on windows, I've uploaded files, but now on linux I can't site\n\nHello everyone. Is there anyway to configure a mw wiki to allow users to upload more than one image at a time? Say I have a folder with 20 various icons I want to upload for a template (let's just say smiley faces), is there anyway to upload them all in one shot instead of one file at a time? Is there an extension out there that will allow this? Thanks for any ideas or suggestions dealing with this. -- ShoeMaker ( Contributions • Message )\n\nExtension:MultiUpload is what you're looking for, although it's unmaintained.Jasper Deng (talk)\n\nToday I recognized that images in my wiki do not load. So I checked the logs /var/log/apache2/error.log :\n\n[Tue Aug 14 21:24:47 2012] [alert] [client 86.56.32.27] /var/www/wiki/images/.htaccess: RewriteEngine not allowed here, referer: https://example.com/wiki/index.php/Datei:2012-08-13_11h25_37.png\n\nThis is the content of the .htaccess file under /var/www/wiki/images:\n\n# Protect against bug 28235 <IfModule rewrite_module> RewriteEngine On RewriteCond %{QUERY_STRING} \\.[^\\\\/:*?\\x22<>|%]+(#|\\?|$) [nocase] RewriteRule . - [forbidden] </IfModule>\n\nI just renamed this file so everythings starts working again, but I would like to reveal the cause of this error. I Think the error originates from my apache's \"sites-available\", maybe someone could give me a hint. Do I need to set the \"AllowOverwrite\" option in the images segment?\n\ncat /etc/apache2/sites-available/default-ssl\n\n<IfModule mod_ssl.c> <VirtualHost _default_:443> ServerAdmin webmaster@localhost DocumentRoot /var/www <Directory /> Options FollowSymLinks AllowOverride AuthConfig </Directory> <Directory /var/www/> Options Indexes FollowSymLinks MultiViews AllowOverride AuthConfig Order allow,deny allow from all </Directory> <Directory /var/www/wiki/images> Options -Indexes </Directory> ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/ <Directory \"/usr/lib/cgi-bin\"> AllowOverride None Options +ExecCGI -MultiViews +SymLinksIfOwnerMatch Order allow,deny Allow from all </Directory> ErrorLog /var/log/apache2/error.log # Possible values include: debug, info, notice, warn, error, crit, # alert, emerg. LogLevel warn CustomLog /var/log/apache2/ssl_access.log combined Alias /doc/ \"/usr/share/doc/\" <Directory \"/usr/share/doc/\"> Options Indexes MultiViews FollowSymLinks AllowOverride None Order deny,allow Deny from all Allow from 127.0.0.0/255.0.0.0 ::1/128 </Directory> # SSL Engine Switch: # Enable/Disable SSL for this virtual host. SSLEngine on SSLCertificateFile /etc/apache2/ssl/cert/server.cer SSLCertificateKeyFile /etc/apache2/ssl/cert/server.key <FilesMatch \"\\.(cgi|shtml|phtml|php)$\"> SSLOptions +StdEnvVars </FilesMatch> <Directory /usr/lib/cgi-bin> SSLOptions +StdEnvVars </Directory> BrowserMatch \"MSIE [2-6]\" \\ nokeepalive ssl-unclean-shutdown \\ downgrade-1.0 force-response-1.0 # MSIE 7 and newer should be able to use keepalive BrowserMatch \"MSIE [17-9]\" ssl-unclean-shutdown </VirtualHost> </IfModule>\n\nRoemer2201 (talk)\n\nI'm using MW 1.18.0+PHP 5.2.17 on IIS. I've been using it for several months now with no problems. Suddenly for no apparent reason, I cannot upload files anymore. I get error 500 for regular upload file, and cannot open file error for import. What could be the reason? I checked php.ini and LocalSettings.php. They did not change and both allow uploading. Thank you Osishkin (talk)\n\nWhen uploading files I'm getting \"File extension \".jpg\" does not match the detected MIME type of the file ().\" and when $wgVerifyMimeType = false; is set I get \"An error was encountered when opening the file for ZIP checks.\" The first error showing in the log is\n\nPHP Warning: is_file(): open_basedir restriction in effect. File(C:\\Windows\\Temp\\phpC132.tmp) is not within the allowed path(s): (C:\\inetpub\\domain.com\\live) in C:\\inetpub\\domain.com\\live\\includes\\filerepo\\backe nd\\FSFile.php on line 42\n\nI've tried adding C:\\Windows\\Temp to the open_basedir line in php.ini, but it doesn't seem to change anything. I've also tried everything I can find to change the temp folder to something else with upload_tmp_dir and others, but they also seem to not have any effect. I have IUSR and IIS_IUSRS set to full for testing on both temp directory and images directory with no luck. I'm at a complete loss as to whats going on. Any help would be greatly appreciated!\n\nI would like to know, is it possible for administrators - and ONLY administrators - to upload EXE files? What can I add to LocalSettings.php that makes it so?\n\nIt seems that mediawiki capitalizes all files, and all I could find to prevent that is to disable this feature for article titless. Is there a way to keep filenames as they are, but capitalize articles? We want to store certain files that require exact filenames.\n\nBump.\n\nSome of the commands I've just used to enable file upload:\n\ngrep bash /var/log/audit/audit.log | audit2allow -M mypol\n\nsetsebool -P httpd_setrlimit 1\n\ngrep mysqld /var/log/audit/audit.log | audit2allow -M mypol\n\nsemodule -i mypol.pp\n\nsemanage fcontext -a -t httpd_sys_rw_content_t 'images'\n\nrestorecon -v 'images'\n\nsetsebool -P httpd_unified 1\n\nYou can use SELinux Troubleshooter (on System menu) to fix detected problems\n\nI have just inherited a MediaWiki and a fair number of images are in the regular images directory, but some are duplicated in skins/common/images. I'd like to clear those out, but I'm concerned that I don't know how they got there in the first place. Any ideas?\n\nMy Wiki is invitation only, so I trust the editors enough to allow ZIP uploading. I followed the guide here to add the extension in and remove it from the blacklist and everything works great.\n\nHowever, several users want to upload UNIX/LINUX archives using BZip2. I've added \"bz2\" to the $wgFileExtensions array and MediaWiki allows for them to be selected, but when I hit \"Upload\" I get back:\n\nFile extension \".bz2\" does not match the detected MIME type of the file (application/x-bzip2).\n\nI'm pretty confident that the BZip2 file has the correct headers and isn't corrupt in anyway, as I have compressed it myself using two separate programs. I've looked at $wgMimeTypeBlacklist, but it doesn't prevent bzip2 by default. Anyone have any luck with this? --TheAlmightyGuru (talk)\n\nA reader named Duncan was able to put me in the right direction for this problem. The problem lies in the ./includes/mime.types file. My existing line read:\n\napplication/x-bzip gz bz2\n\nWhich considers BZip2 files as regular BZip files. I fixed it by changing the line to read:\n\napplication/x-bzip2 bz2\n\nNow, BZip2 files are identified as a mime type of BZip2. GZ files are already covered in a line further down in the file, so it's safe to remove it. I also added the following line to my ./includes/mime.info:\n\napplication/x-bzip2 [ARCHIVE]\n\nSo the Wiki would be able to accept BZip2 files.\n\nThis may not be the most correct way of doing it, but it did allow my users to upload bz2 files properly. If anyone has a better way, please post here.\n\nI'm having a trouble with a new, clean install of Mediawiki 1.23.9 (advanced one-click method in hostgator's QuickInstall). Images can be successfully uploaded, but they are not usable in wiki pages: attempting to click and view the just-uploaded image yields an Internal Server Error (500).\n\nOn a wiki page where the image is embedded, the image simply doesn't display- instead I just see the image title. How can I fix this and make uploads usable on wiki pages?\n\nPossibly helpful info: - Turning off short URLs does not fix this problem- it just clarifies that the internal error is a 505. - ImageMagick, file upload.. etc are all set to true. - Via SFTP, I can download the image (and thumbnails). The files aren't corrupt. (Mediawiki even reads the image metadata correctly- it just doesn't display the image!) - The permissions on the \"images\" directory (and subfolders) are drwxr-xr-x, the default setting.\n\nThe file size is 600 KB, well below the upload limit. A smaller image gives the same problem.\n\nI tried EVERYTHING, I'm desperate. Please help for me and any future person that gets the same problem!\n\nHave you solved it?--Jipre (talk)\n\nHey there, I've scoured the internet on this topic. I may have even came across the answer, but if I did - I couldn't understand it.\n\nI've enabled file uploads for a few files (specifically .oft - a Microsoft Outlook 2013 template). I've successfully uploaded them. When I open it in Firefox, it opens great. When I open it in Internet Explorer, I get something like this:\n\nÐÏ�à¡±�á>�þÿ ������þÿÿÿ�ÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿÿRoot Entry��ÿÿÿÿÿÿÿÿ� Á²ô¹UÏ� À*__properties_version1.00�ÿÿÿÿÿÿÿÿÿÿÿÿLÐ�__nameid_version1.0(��ÿÿÿÿÿÿÿÿ�ðK²ô¹UÏ� Á²ô¹UÏ�__substg1.0_0E04001E*��ÿÿÿÿ�ÿÿÿÿþÿÿÿ�ýÿÿÿÿÿÿÿÿÿÿÿ���7E �����@������������ !\"#$%&\n\nImagine that, except about 1,000 lines worth. What am I doing wrong? Thanks!\n\nYou're doing nothing wrong. IE just can't handle .oft files. --186.79.68.0\n\nMediawiki seems to associate a bogus MIME type with these files: MIME-Typ: chemical/x-mdl-rgfile. At my site, we're only able to open them via Firefox if right-clicking and saving the file (else 0kB). In IE11, additionally you need to change the .htm extension to .oft, then IE11 can delegate them to Outlook. MichaelKesper (talk)\n\nI already have hundreds of files and images set in my site directory structure, i.e., Media/Photos, Media/Documents. I can set the default upload directory to \"Media\" but is there a way to use the subfolders I already have? I've found and installed the UploadLocal extension to \"upload\" all of these files that are already on the server into MediaWiki, but I'd really like to retain the directory structure I already have because of previous usage and links to these files. I really don't want to start from scratch on THAT and try to catch all of those -- and I don't want all of these files in one directory. These files are used by several different programs and website areas -- I need to retain these directory structure paths.\n\nIs there a file upload configuration that will allow me to specify the use of these subdirectories? Or is there an extension that would allow me to select a subfolder when uploading a file? I was able to change upload directories to test the UploadLocal extension, and it will put them where I want them, but I can't access them through MediaWiki after that, of course, with the upload path of only \"Media\". Thanks.\n\nI'm using a localhost wiki, but every time I upload an image, I get this error: An error was encountered when opening the file for ZIP checks.\n\nHow do I fix it? I am running MediaWiki 1.25.2, PHP 5.6.11 (cgi-fcgi), MySQL 5.6.25-log, and IIS 7 on a Windows 7 Home Premium.\n\n--68.45.51.161\n\nHi,\n\nWe have a corporate wiki and been having some issues with uploaded files with multiple versions.\n\nGeneral use case is this: Someone uploads a certain file1.docx to the wiki, creating a link to it using [[Media:file1.docx]] on a certain article/page. So far, so good. You can click the resulting link to download the file (call this the original, version 1).\n\nAs time goes by, another user decides to update file1 so he goes to /File:file1.docx and clicks \"upload a new version of this file\". He uploads a new version (call it version 2) of the file and everything seems to be ok, as both versions appear on the file's version history.\n\nNow, if you try to download the file again (either from the article linking to the file, or from the file description page itself) you'd expect to get the second version of the file, however, we keep getting the original one (version 1) instead.\n\nIt seems to be some sort of cache issue, but I am not familiar with the MediaWiki code to look any deeper.\n\nHere's our setup:\n\nLinux server on shared hosting (dreamhost)\n\nMediaWiki 1.26.2\n\nPHP 5.6.29 (cgi-fcgi)\n\nMySQL 5.6.25-log\n\nInstalled Extensions: CategoryTree; Cite; DynamicPageList3; EmbedVideo; NumberFormat; ParserFunctions; SimpleMathJax; Google Analytics Integration\n\nAny help, comments, ideas will be greatly appreciated.\n\nThanks in advance\n\n--Rbirmann (talk)\n\nUPDATE: This error seems to be happening only on files with non-ascii titles. Still investigating.\n\n--Rbirmann (talk)\n\nUPDATE: I tried to replicate this error on my user page here on this wiki, but failed. The uploaded file (FILE_NON-ASCII_TITLE_Ã Ó é ü TEST FILE.pdf) worked perfectly. Tried the exact same thing on our wiki with both .pdf and .docx files and it also worked, so I am guessing it is not related to the non-ASCII characters (still inconclusive, however). Bottom-line is we have this error in some files on our wiki, but can´t really seem to replicate it deliberately :(\n\n--Rbirmann (talk)\n\nIf you open the file using private browsing, if you get the old version then it's being cached on the server, otherwise it's being cached on your browser. In the second case, the server may be sending too far expires: HTTP headers causing browser to cache the URL a very long time. --Ciencia Al Poder (talk)\n\nTried to reuse reference <ref name=\"kavoir\" /> in section Manual:Configuring_file_uploads#Set_maximum_size_for_file_uploads but there's some weird interaction between the ‎<translate> tags I don't understand. Can someone fix that? Thanks. NE Ent (talk)\n\nIs there another way of uploading a file to the wiki when the server doesn't work with the convert command? User: Valamesh\n\nConvert is used for thumbnailing. I think you can disable convert entirely (set $wgUseImageMagick to false) and uploads should work. However, no thumbnailing would be done. --Ciencia Al Poder (talk)\n\nI have increased the upload limit to 500mb. When i upload smaler files > 6mb everything works fine, but when i upload larger files (30mb, 100mb etc..) the site stops working and chrome shows \"ERR_SPDY_PROTOCOL_ERROR\". Sadly the wiki itself or php don't show any errors. My wiki runs on IIS 10, wiki version 1.29.1 and i have done the \"Image Authorization\".\n\nEdit: i have found the error, i had to increase the maximum allowed upload file in the iis itself.\n\nThe statement, MediaWiki also has a $wgMaxUploadSize option, but that is currently not enforced for normal uploads (when uploading a local file). The only way of restricting the upload size is through the use of modifying the php configuration., does not appear to be a true statement. I have observed on MW 1.27 leaving this unset and uploads greater than the default 100MB value fail. I took the value up to match the php.ini settings which were set higher than 300MB and the upload worked. Can we update this statement if it is no longer valid. Or update it if it is valid for older versions of MW? Thanks Hutchy68 (talk)\n\nReading further down the page, there is even a reference to update $wgMaxUploadSize to upload up to 2GB files along with the server setttings. So these two pieces of information are at odds with each other.\n\nI've enabled file uploads on my MediaWiki 1.33 and Nginx 1.17 environment, but I always got an error message saying that mwstore://local-backend/local-public/x/y/filename was blocked. I tried a lot of things, such as change /image folder ownership and permissions, LocalSettings.php variables etc. Nothing worked. So, I just defined /images folder owner as apache (is it a problem from MediaWiki code?) and now I can upload files!\n\nDuring sideloading, the curl timeout is default and larger files will not load.\n\nSetting $wgCopyUploadTimeout to 300 will increase this to 300 seconds.\n\nThis really should be added on the main page for completeness.\n\nNot reporting a problem, but a solution I found.\n\nI'm running MediaWiki on a Raspberry Pi and wanted to place the images folder on an external hard disk in order to save space on the small micro SD card. I found the documentation very poor and confusing and no helpful advice on SO or anywhere else, however I managed to solve this problem and would like to share my solution. I'd welcome any feedback on whether my solution is good or not.\n\nLet's assume that the external disk is mounted at /mnt/externaldisk .\n\nHere's what I did:\n\nCreate a folder called mediawiki-images on the external disk.\n\nchown www-data:www-data /mnt/externaldisk/mediawiki-images\n\nchmod 755 /mnt/externaldisk/mediawiki-images\n\nAdd the line $wgUploadDirectory = \"/mnt/externaldisk/mediawiki-images\" to my LocalSettings.php.\n\nAdd the following to the Apache VHost configuration in /etc/apache2/sites-available/mediawiki.conf:\n\nAlias /images /mnt/externaldisk/mediawiki-images <Directory \"/mnt/externaldisk/mediawiki-images\"> Require all granted </Directory>\n\nRestarted the web server\n\nSo far, I have successfully uploaded, viewed and deleted multiple files.\n\nIf this is a reasonable approach, I'd love to see it documented somewhere.\n\nThank you for your time. 2001:9E8:E5CD:6E00:3915:497A:62:AB08"
    }
}