{
    "id": "dbpedia_2370_2",
    "rank": 67,
    "data": {
        "url": "https://archi-lab.net/printing-pdfs-from-revit-why-is-it-so-hard/",
        "read_more_link": "",
        "language": "en",
        "title": "printing PDFs from Revit…why is it so hard?",
        "top_image": "https://i1.wp.com/archi-lab.net/wp-content/uploads/2017/03/maxresdefault.jpg?fit=1200%2C675&ssl=1",
        "meta_img": "https://i1.wp.com/archi-lab.net/wp-content/uploads/2017/03/maxresdefault.jpg?fit=1200%2C675&ssl=1",
        "images": [
            "https://archi-lab.net/wp-content/uploads/2016/02/wordpress-logo.jpg",
            "https://i1.wp.com/archi-lab.net/wp-content/uploads/2017/03/maxresdefault.jpg?fit=1280%2C720&ssl=1",
            "https://i1.wp.com/archi-lab.net/wp-content/uploads/2017/03/Capture-2.png?resize=537%2C480",
            "https://i0.wp.com/archi-lab.net/wp-content/plugins/patron-button-and-widgets-by-codebard/images/become_a_patron_button.png?w=920&ssl=1",
            "https://secure.gravatar.com/avatar/459d2e811a3bfff10609feca5f306987?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/41c90718285503b545aa760b27ee4c53?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/21ba3b0990a9fd041e071c6d6b1c00a1?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/6828a6f65648a5ef5202ad46bdcc0552?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/41c90718285503b545aa760b27ee4c53?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/73aa15635fb1ad5dedb1d867d3541341?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/41c90718285503b545aa760b27ee4c53?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/b93184496f718df869b268dee248808e?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/41c90718285503b545aa760b27ee4c53?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/927cf64348c69e06bc3c0608040264e8?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/22e41c13866d8e5cf4cb157c16a84d34?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/41c90718285503b545aa760b27ee4c53?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/1cb68f57120920f2a337074cd62c1baa?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/41c90718285503b545aa760b27ee4c53?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/357975b638c950f1ba1b60caae746cc4?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/41c90718285503b545aa760b27ee4c53?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/828038aba4e5bdb58f8182519c5e5c2d?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/33929b13952810c1698caf91ef447b0a?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/41c90718285503b545aa760b27ee4c53?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/0649febaa662b8aa786f00672d72aadf?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/13fe87837a66a4d4e93975228c73fe5c?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/6fd47b1148c962ad4c663a4b4bc379b8?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/033ea7d42b282f52d687390466346cf3?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/41c90718285503b545aa760b27ee4c53?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/cdd0af90ced0215b1922c906c7a4c92a?s=35&d=mm&r=g",
            "https://secure.gravatar.com/avatar/41c90718285503b545aa760b27ee4c53?s=35&d=mm&r=g",
            "https://i1.wp.com/archi-lab.net/wp-content/uploads/2015/04/CAN1202_N40_letter.jpg?w=178&h=267&ssl=1",
            "https://i2.wp.com/archi-lab.net/wp-content/uploads/2015/04/featuredImage.jpg?w=734&h=267&ssl=1",
            "https://i1.wp.com/archi-lab.net/wp-content/uploads/2015/04/CAN1202_N27_letter.jpg?w=508&h=263&ssl=1",
            "https://i0.wp.com/archi-lab.net/wp-content/uploads/2015/04/CAN1202_N42_letter.jpg?w=508&h=339&ssl=1",
            "https://i2.wp.com/archi-lab.net/wp-content/uploads/2016/11/GrimshawDWUR_Ewing-0843.jpg?w=404&h=606&ssl=1",
            "https://i0.wp.com/archi-lab.net/wp-content/uploads/2016/11/GrimshawDWUR_Ewing-2905-1.jpg?w=611&h=408&ssl=1",
            "https://i1.wp.com/archi-lab.net/wp-content/uploads/2016/11/main_GrimshawDWUR_Ewing-1137-2.jpg?w=301&h=202&ssl=1",
            "https://i0.wp.com/archi-lab.net/wp-content/uploads/2016/11/GrimshawDWUR_Ewing-0186-3.jpg?w=301&h=202&ssl=1",
            "https://i2.wp.com/archi-lab.net/wp-content/uploads/2016/11/GrimshawDWUR_Ewing-0752-2.jpg?w=262&h=175&ssl=1",
            "https://i0.wp.com/archi-lab.net/wp-content/uploads/2016/11/GrimshawDWUR_Ewing-0722-1.jpg?w=117&h=175&ssl=1",
            "https://i2.wp.com/archi-lab.net/wp-content/uploads/2016/11/GrimshawDWUR_Ewing-2612.jpg?w=263&h=175&ssl=1",
            "https://i0.wp.com/archi-lab.net/wp-content/uploads/2016/11/main_GrimshawDWUR_Ewing-3124.jpg?w=262&h=175&ssl=1",
            "https://archi-lab.net/wp-content/plugins/patron-button-and-widgets-by-codebard/images/become_a_patron_button.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "Konrad K Sobon"
        ],
        "publish_date": "2017-03-30T01:27:58+00:00",
        "summary": "",
        "meta_description": "Disclaimer:  If you don’t have to, please don’t reinvent the wheel. I am a proponent of just going out and buying the tools you need to do your job, rather than re-making them yourself.…",
        "meta_lang": "en",
        "meta_favicon": "/wp-content/uploads/fbrfg/favicon.ico",
        "meta_site_name": "archi-lab",
        "canonical_link": "https://archi-lab.net/printing-pdfs-from-revit-why-is-it-so-hard/",
        "text": "Disclaimer:\n\nIf you don’t have to, please don’t reinvent the wheel. I am a proponent of just going out and buying the tools you need to do your job, rather than re-making them yourself. It’s a bit inefficient to solve the same problem that others have already solved. With that said, the best tool on the market for running PDF prints is RTV Tools. Get that if you can spend a few bucks. The rest of us poor souls, read on!\n\nI put Revit’s name in the title, but to be honest the responsibility for this lies somewhere in-between Autodesk and Adobe. First, let’s make it clear, that for a piece of software that main’s job is to create documentation drawings of buildings (99% of the time distributed in PDF format), not to have its own PDF creator, or at least licensed and implemented one of the handful available ones…I just have no words for this Autodesk. This condition, that we have been dealing with since Revit’s inception some 15+ years ago, is just not acceptable. Sure, it’s hunky-dory to let users specify their own Printer, but for god’s sake, Autodesk, please also give them an embedded one that comes with the software. That would also allow you to cater to needs of those of us, that want a little more out of the software than a typical end user. I am speaking of the development community that wants to build automation tools on top of your software, and having access to embedded PDF creator, with ability to specify things like JPG Compression, Security protocols or simply FILE NAME. Yes! File name, and location that will not be overridden by the 3rd party PDF creator like Adobe’s Distiller. Now that we are on the subject of Adobe and its free PDF Reader, I just have no words for how shitty that thing is. Yes, it’s free, but it’s also severely crippled, and ON PURPOSE! What the hell were you thinking Adobe, always launching Acro Tray process in the background, and leaving it open even, when printing is done. WTF? Yes, the paid version of your software has more support, but still…that’s just sad. Anyways, let’s talk about some solutions here:\n\nYou probably know that if you set Printing Preferences for Adobe PDF printer, like this…\n\n…you should be able to send a printing job of multiple sheets, and you would not be prompted to specify location for each one individually. That’s great if you are content with the pre-defined print location. What happens when you are building a plug-in and you want your users to be able to specify custom file names and file locations? In that case there is so far been one option:\n\nOverride the PrinterJobControl registry input! What?! Yes, in order to specify a file name, one must dabble with Registry. Thanks Autodesk! That’s swell! Here’s how and why:\n\nAdobe PDF, normally prompts user for a new file location. However, there is a way to override that, if one overrides the PrinterJobControl subkey, with a Key/Value pair specifically telling Adobe that for the next printing job submitted from Revit.exe process, you want it to print to a specific filename and location. Here’s a small utility that will do that for you:\n\nAs you can see this will only work for Adobe PDF printer. I also have a global variable named CURRENT_REVIT_VERSION stored in my Settings file. This should be either 2016 or 2017 depending on what version of Revit I am compiling my plug-in for. Basically, you would need to call this method before every single sheet is submitted to Revit’s Print Manager for printing. That way, you always override the next print job’s name, and location and Adobe won’t prompt for filename.\n\nNow, it might ask to replace an existing file if you didn’t uncheck that setting in the Printing Preferences dialog box. To avoid seeing that prompt, just use the regular File.Exists() method and File.Delete() to clean up before printing. Something like this will do:\n\nNow, I also often do a post processing routine. Take for example, Zipping up all of your files to be sent to consultant or even combining them into a single PDF, if you are that adventurous. Since printing a PDF can take quite some time, even minutes, which in computer world is freaking decades, you will need a small utility to wait for the last file to print before starting your post processing. Here’s one I copy-pasted from Stack Overflow (copying and pasting from SO is an art.):\n\nI call it like this:\n\nThe “lastCreatedFileName” variable is as you can guess the name of the last sheet that I have submitted to Print Manager. I am only really checking the last file submitted, since all others would be done, before I can submit my last one. My wait routine, has 1000 loops each halting the execution for 300 ms for a total of 3min. If printing of your last sheet takes more than 3min, it will most likely be skipped in the post-processing routine. Just an FYI.\n\nI hope this helps. Cheers!"
    }
}