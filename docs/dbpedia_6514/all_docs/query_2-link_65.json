{
    "id": "dbpedia_6514_2",
    "rank": 65,
    "data": {
        "url": "https://www.biorxiv.org/content/10.1101/2022.02.05.479210v1.full",
        "read_more_link": "",
        "language": "en",
        "title": "Genomic neighbor typing for bacterial outbreak surveillance",
        "top_image": "https://www.biorxiv.org/sites/default/files/images/biorxiv_logo_homepage7-5-small.png",
        "meta_img": "https://www.biorxiv.org/sites/default/files/images/biorxiv_logo_homepage7-5-small.png",
        "images": [
            "https://www.biorxiv.org/sites/default/files/biorxiv_article.jpg",
            "https://www.biorxiv.org/sites/all/modules/contrib/panels_ajax_tab/images/loading.gif",
            "https://www.biorxiv.org/content/biorxiv/early/2022/02/06/2022.02.05.479210/F1.medium.gif",
            "https://www.biorxiv.org/content/biorxiv/early/2022/02/06/2022.02.05.479210/F1.medium.gif",
            "https://www.biorxiv.org/content/biorxiv/early/2022/02/06/2022.02.05.479210/F2.medium.gif",
            "https://www.biorxiv.org/content/biorxiv/early/2022/02/06/2022.02.05.479210/F2.medium.gif",
            "https://www.biorxiv.org/content/biorxiv/early/2022/02/06/2022.02.05.479210/F6.medium.gif",
            "https://www.biorxiv.org/content/biorxiv/early/2022/02/06/2022.02.05.479210/F6.medium.gif",
            "https://www.biorxiv.org/content/biorxiv/early/2022/02/06/2022.02.05.479210/F3.medium.gif",
            "https://www.biorxiv.org/content/biorxiv/early/2022/02/06/2022.02.05.479210/F3.medium.gif",
            "https://www.biorxiv.org/content/biorxiv/early/2022/02/06/2022.02.05.479210/F4.medium.gif",
            "https://www.biorxiv.org/content/biorxiv/early/2022/02/06/2022.02.05.479210/F4.medium.gif",
            "https://www.biorxiv.org/content/biorxiv/early/2022/02/06/2022.02.05.479210/F5.medium.gif",
            "https://www.biorxiv.org/content/biorxiv/early/2022/02/06/2022.02.05.479210/F5.medium.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-15.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-15.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-16.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-16.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-17.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-17.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-18.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-18.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-19.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-19.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-20.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-20.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-21.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-21.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-22.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-22.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-23.gif",
            "https://www.biorxiv.org/sites/default/files/highwire/biorxiv/early/2022/02/06/2022.02.05.479210/embed/graphic-23.gif",
            "https://www.biorxiv.org/sites/all/modules/highwire/highwire/images/twitter.png",
            "https://www.biorxiv.org/sites/all/modules/highwire/highwire/images/fb-blue.png",
            "https://www.biorxiv.org/sites/all/modules/highwire/highwire/images/linkedin-32px.png",
            "https://www.biorxiv.org/sites/all/modules/highwire/highwire/images/mendeley.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "Eike Steinig",
            "Miranda Pitt",
            "Izzard Aglua",
            "Annika Suttie",
            "Andrew Greenhill",
            "Christopher Heather",
            "Cadhla Firth",
            "Simon Smith",
            "William Pomat",
            "Paul Horwood"
        ],
        "publish_date": "2022-02-05T00:00:00",
        "summary": "",
        "meta_description": "bioRxiv - the preprint server for biology, operated by Cold Spring Harbor Laboratory, a research and educational institution",
        "meta_lang": "en",
        "meta_favicon": "https://www.biorxiv.org/sites/default/files/images/favicon.ico",
        "meta_site_name": "bioRxiv",
        "canonical_link": "https://www.biorxiv.org/content/10.1101/2022.02.05.479210v1",
        "text": "Results\n\nSpecies cross-validation simulation\n\nWhole genome sequences for six species with varying levels of representation in the European Nucleotide Archive (ENA) were collected for reference sketch construction (Table 1) (25). After filtering of assemblies for contamination, completeness and strain heterogeneity, we constructed default (k = 16, s = 1000) and high resolution (k = 16, s = 10000) reference sketches for evaluation (Table 1). Sketch databases contained between 4,832 (Pseudomonas aeruginosa) and 47,616 genomes (S. pneumoniae). Low resolution sketch files were considerably smaller and consumed less memory than their high resolution equivalents (Table 1). We used multi-locus sequence types (MLST) as a proxy for genotype predictions, as MLST data were readily available for all species (25) and representative of the ability to match genomes in the correct genomic neighborhood (lineage) of the reference database. We conducted a cross-validation simulation, for which we sampled 10 genomes (without replacement) from the reference collection of each species across 20 replicates (n = 200) and used reference sketches which did (DB+) or did not (DB-) contain the sampled genomes (Fig. 2, Table 1). Since our primary aim was to call genotypes from as few reads as possible, we evaluated performance (mean proportion correctly classified) at a threshold of 1000 reads (Methods). We assessed two other methods at this threshold for comparison with Sketchy: a k-mer based MLST allele typer for long reads (Krocus) and whole genome assembly with Flye, with added polish by Medaka.\n\nPerformance was dependent on species, with three out of six species (N. gonorrhoeae, N. meningiditis and S. pneumoniae) showing inferior lineage predictions in the cross-validation assessment, including extremely low performance by N. gonorrhoeae (Table 1, Fig. 2). In contrast, K. pneumoniae, S. aureus and P. aeruginosa recovered MLST reasonably well, ranging from 79.5% - 100% (DB+) and 74.5% - 93.0% accuracy (Table 1, Fig. 2). For these species, predictions improved when sampled genomes were contained in the reference sketch (green, DB+) but this trend was not as pronounced for under-performing species (Fig. 1). In all species, predictions improved, often considerably, using higher resolution sketches (s = 10000), including accurate predictions using sketches which did not contain the sampled genomes for P. aeruginosa (93% ± 6.57) and K. pneumoniae (86% ± 12.3) (Table 1).\n\nIn species where sketches were able to sufficiently recover lineage, performance stabilised around 200 - 500 reads suggesting that fewer reads than the threshold may be sufficient for genotyping (Fig. S1A). Reference sketch size, memory consumption and prediction times scaled approximately linearly with the number of genomes in the reference sketch and sketch size (Table 1). Predictions at an additional threshold of 10000 reads using the low-resolution sketches (s = 1000) showed minor improvements in performance across species (Fig. S1B), indicating that most of the observed error was due to the resolution of the sketching approach, and only some due to the low read threshold chosen for typing. Finally we compared Sketchy to allele based k-mer matching with Krocus and lineage typing from assemblies generated with Flye, optionally polished with Medaka. Krocus was unable to infer MLST from 1000 reads in all cases (Fig1. S1C). Using assembled genomes, allele typing led to incorrect multi-locus sequence types in all cases, except in a single P. aeruginosa assembly with Flye (Fig. S1C).\n\nGenotype surveillance of community-associated outbreaks\n\nWe next evaluated Sketchy genotyping on two S. aureus outbreaks from remote communities in Papua New Guinea and Far North Queensland (n = 160), which had been sequenced at low-coverage using a dual-library protocol with interspersed nuclease washes (24 strains per MinION flow cell, on a total of 8 flow cells) (4) (Fig. 3, Methods). While most isolates belonged to the Australian ST93-MRSA-IV clone (26, 27) (n = 120), multiple other sequence types were recovered (ST1, ST5, ST15, ST25, ST30, ST45, ST81, ST121, ST243, ST762, n = 35), including several novel sequence types (n = 5) of which some derived from the ST93 outbreak lineage (n = 3). In addition, a version of the S. aureus reference sketch was created using a collection of genomes for which we had pre-viously computed antimicrobial resistance calls with Mykrobe (n = 34,583), as well as SCCmec type and presence of the Panton-Valentine leukocidin locus (PVL). As the outbreak isolates were the first S. aureus genomes recovered from Papua New Guinea, these data comprised an independent validation dataset for performance evaluation of the S. aureus reference sketch, in the absence of local or regional genome collections.\n\nSketchy predictions on 1000 reads of the outbreak data from FNQ and PNG were compared with Illumina reference genotypes and standard performance metrics were computed across the dataset (Figure 3, Table 2). Generally, lineage-wide distributed features (MLST, PVL, penicillin resistance, some antibiotic susceptibilities) achieved high accuracy and precision (Table 2). Importantly, most sequence types were correctly identified (144/160) providing an accurate survey of lineage diversity in FNQ and PNG. Analysis of sequence typing errors revealed consistent false calls between ST81 reference and ST1 prediction pairs (n = 3), ST243 and ST30/ST3452 (n = 5), ST5 and ST225/ST228 (n = 2) and one ST762 genome predicted as ST1 (n = 1) (Table S1). In all cases except one, the reference sequence type was contained in the reference sketch and predicted sequence types belonged to the same clonal complex (CC) with a difference of one or two alleles (Table S1). Finally, of the novel sequence types detected in this dataset (n = 5), three single allele variants of ST93 were predicted ST93, one single allele variant of ST88 was predicted ST88 and one unknown ST variant with four alleles difference was predicted ST1 (Table 2).\n\nWe also used the streaming algorithm (sum of shared hashes) with the same configurations for comparison (Table S2). Overall, there were slight regressions in all predictions, which were expected due to computing shared hashes per read, losing some of the information contained in the completed read sets (1000 reads). When we used the high-resolution species sketch (s = 10000) in non-streaming mode for these outbreak data, improvements in lineage predictions were observed, including resolution of the ST243/ST30 and ST5/ST255/ST228 misclassification, and some of the associated resistance and PVL classifications (Table S3). No improvements were made in SCCmec related features, with regressions in methicillin resistance and SCCmec type classification accuracy across the dataset, indicating that these were driven by systematic error in classification of clade-specific features of the dominant outbreak lineage ST93.\n\nWe next ran a library of strains from the osteomyelitis outbreak in situ at the Papua New Guinea Institute of Medical Research in Goroka (Eastern Highlands). We multiplexed 12 strains onto a MinION flow cell, but ultimately obtained few reads per barcode (276 - 1896, Table 3) due to malfunctioning laboratory equipment resulting in failed barcode attachment (15072/23774 reads unclassified, Fig. 4A). Nevertheless, we were able to use the remaining reads per barcode to type with Sketchy, which correctly predicted lineage (ST93) with the exception of two isolates (ST22 and ST121 from 276 and 533 reads respectively) and some lineage-distributed genotypes (PVL, some antibiotic resistance categories) suggesting deficits in SCCmec related predictions for ST93-MRSA-IV (Table 4). Incorrect predictions were however mitigated when the high-resolution (s = 10000) S. aureus reference sketch was used, which correctly predicted all sequence types from as few as 276 reads, but failed to predict several important secondary resistances (clindamycin, tetracycline, erythromycin) in one isolate (PNG-69) and failed to predict methicillin resistant genotypes in two others (Table S4).\n\nIn the next experiment we used a panel of 12 outbreak isolates to multiplex on a Flongle adapter flow cell (Fig. 4B). A large proportion of reads (11944/23611) was unclassified, which was likely due to including reads with average qualities over Q5 to account for the low throughput of the Flongle flow cell (Table 3). Similar prediction patterns as in the experiment in Goroka were observed, with few reads available for prediction across barcodes (713-1162, Table 3). Despite the low read counts, classification using the default resolution reference sketch (k =16, s = 1000, 1000 reads) successfully typed most isolates as the outbreak sequence type ST93-MRSA-IV, albeit with the previously observed limitations in SCCmec-related features (Table 5), including improvements across Flongle predictions with the higher resolution S. aureus reference sketch (Table S5). Finally, we tested a faster, successive library sequencing protocol for MinION flow cells, using 48 strains in 4 barcoded libraries, which were sequenced for 2 hours followed by a nuclease wash in between libraries (Methods). We had aimed to sequence another 4 libraries on the same flow cell (n = 96) as the 96 barcode sequencing kits had not been released yet. However, during reloading too many bubbles were introduced to the flow cell channel and the experiment terminated at 48 strains with a remaining 900-1000 active pores after a final diagnostic check (data not shown). Nevertheless, predictions of the 48 strain protocol using the default S. aureus sketch show that this approach is viable, with 2/48 lineage misclassifications (PNG-4, PNG-68) which were novel allele variants of ST81 and ST93 (and misclassified as ST93) (Table S1, Table 6, Table S6).\n\nSublineage genotyping comparison with RASE\n\nFinally, we compared Sketchy at sublineage resolution to RASE predictions for the outbreak sequence type (ST93). We built reference databases based on lineage genomes (n = 360, k =16) including a rooted maximum-likelihood phylogeny from previous single nucleotide polymorphism calls (26) (Fig. 5A). Because of the small size of this reference databases, we constructed additional sketches with higher resolution (up to s = 1000000) to compare for sublineage genotyping with Sketchy (Methods). RASE predictions were largely congruent with reference genotypes, with most categories exceeding 90% accuracy and precision, and only sporadic false positive and false negative predictions for clindamycin, mupirocin, methicillin and erythromycin (Table 7). There appeared to be a systematic error in tetracycline predictions, where 28/118 isolates were predicted resistant (R), but were in fact susceptible (S). Only a single isolate assembly in the reference database was typed as resistant (R). We ruled out contaminated genomes in the reference sketch as a source for these aberrant predictions, due to using conservative filters including contamination and strain heterogeneity (Methods). In addition, we ruled out errors introduced by ancestral state reconstruction, which was disabled for this analysis in RASE. Ultimately, most false tetracycline resistance predictions were flagged with low confidence from the preference score used in RASE, but did not resolve when using all reads for inference (Table S5).\n\nSketchy performed slightly worse than RASE using a low resolution sketch (s = 1000) (Table 8) with sporadic false positives and false negatives in clindamycin, ciprofloxacin, tetracycline, mupirocin and erythromycin predictions. However, these were largely eliminated using the high-resolution sketch (s = 1000000) raising accuracy and precision for most antibiotic resistance predictions to > 96% (Table 9). RASE timestamps indicate that predictions of ST93 genotypes around the selected read threshold (1000 reads) were able to be conducted in approximately 1 - 11 minutes per barcode (data not shown). According to our expectations, systematic errors were found in the methicillin predictions of Sketchy, with an excess of isolates that were typed susceptible (MSSA) rather than resistant (MRSA). Sketchy was therefore not capable of sufficiently resolving clade-specific traits for sublineage genotyping. We illustrated the difference in resolution of the underlying core method (MinHash vs. SNPs) and its ability to resolve clade-specific traits in the ST93 reference sketch using population graphs, where nodes are genomes and edges their mutual k-nearest-neighbors at an optimized k value (genomic neighborhoods) (Fig. S1D). We constructed the graph for pairwise s - shared hashes distance (s = 1000) using Sketchy as well as from pairwise SNP distances based on previously generated variants for the ST93 lineage (26) (from which the ML topology in the RASE approach was built) (Fig 5B). Shared hash distances were insufficient to resolve MSSA and MRSA communities compared to networks constructed from pairwise SNP distances. This fundamental difference in resolution of the two approaches underlines the limitations of Sketchy, although the ultra high-resolution sketch (s = 1000000) mitigated some of the non clade-specific errors (e.g. clindamycin and erythromycin resistance) observed using lower-resolution sketches (Table 9).\n\nDiscussion\n\nIn this study, we explored the use of heuristic genomic neighbor typing (16) for lineage and genotype inference in bacterial outbreak scenarios. We reasoned that a ‘hypothesisagnostic’ reference database would be preferred over a smaller ‘hypothesis-driven’ reference database, because the latter cannot capture the known diversity of a species, and may not be useful in situations where prior sequence data on lineage and genotype diversity does not exist. We further reasoned that it would be possible to conduct multiplex sequencing and use genomic neighbor typing to rapidly scan an isolate collection from limited sequence data. For these applications we developed Sketchy, a genomic neighbor typing implementation using shared min-wise hashes against species-wide database sketches with associated lineage and genotype data, which we derived from public sources (25).\n\nWe first used a cross-validation procedure to assess performance of Sketchy at the selected 1000 reads threshold in recovering lineages (MLST) as a proxy for further sublineage genotyping (Fig. 2, Table 1) using default resolution (s = 1000) and higher resolution (s = 10000) reference sketches. Results indicate two major trends: first, genomic neighbor typing of lineages was sufficiently accurate in some species (S. aureus, K. pneumoniae, P. aeruginosa) but failed to recover lineages in others (N. gonorrhoeae, N. meningitidis, S. pneumoniae). We were unable to control for sequence type diversity of the reference sketches, and it may be possible that cross-validation sampling of reference sketches with many singular sequence types or little sequence type diversity biased the results in favour of sketches with fewer diversity. However, we note that the species which did not perform well on this task are those with high levels of homologous recombination. This was discussed by Břinda et al. (16) who suggested that genomic neighbor typing may be limited by homologous recombination due to scattering of the phylogenetic signal and spread of chro-mosomally encoded resistance genes. We note that Sketchy under-performed for MLST typing of two species, N. gonorrhoeae and S. pneumoniae, both of which were used in the original genomic neighbor typing approach. However, direct comparisons are difficult, as the underlying reference data was vastly smaller, and the focus was on sublineage antimicrobial resistance phenotyping using MIC values from the reference collection.\n\nSecond, we observed that performance notably increased using a larger sketch size, suggesting that the default sketch size may be insufficient to capture the full diversity of hashes shared between analyte and the reference databases. This suggests that the default sketch size (s = 1000) may not be a good default if accuracy is preferred. However, because memory consumption increased approximately linearly with the number of included genomes and sketch size, higher resolution sketches may not be suitable for smaller computing platforms, especially with large reference databases (e.g. for S. aureus and S. pneumoniae). Nevertheless, memory consumption did not exceed 6 GB, making large, species-wide reference sketches at higher resolution usable on laptops and other standard computing hardware. In addition, we note that memory consumption of Sketchy for the smallest reference sketch (P. aeruginosa, 4832 genomes, 56 MB) is significantly smaller than the ProPhyle (28) indices created for S. pneumoniae (616 genomes, 321 MB) and N. gonorrhoeae (1102 genomes, 242 MB), and for higher resolution sketches approximately twice as much (554 MB) (29). Overall, sketch sizes are extremely small, particularly when compressed for transfer or storage (Table 1). Sketchy is therefore capable of creating highly efficient species-wide databases, which can capture the known diversity of a species, while maintaining resource efficiency, albeit with some limitations in performance for smaller sketches which may be necessary for portable sequencing setups in remote locations.\n\nWe then assessed Sketchy’s performance on an outbreak dataset of S. aureus community infections in Papua New Guinea and Far North Queensland (4, 17, 18), for which we had previously generated matching Illumina reference data (n = 160). In this context, the outbreaks constituted an independent validation dataset, as no S. aureus genomes from these regions had ever been sequenced before (including the very first S. aureus genomes from Papua New Guinea). While the majority of isolates in this study belonged to the outbreak sequence type (ST93, n = 120) several other sequence types were identified in the dataset (n = 40). By including all known strains at the time in the reference database, their lineages were included during database construction by default and successfully typed in most cases (Table 4). Remaining misclassifications were mitigated in higher resolution sketches (Table S3) with the exception of clade-specific SCCmec related genotypes (see below). In addition, we sequenced one full panel of outbreak isolates at the Papua New Guinea Institute of Medical Research in Goroka, Eastern Highlands Province. No sequencing infrastructure is accessible, so that a portable setup with the MinION was the only option to survey the outbreak on site. As an illustration of the challenges of sequencing in remote places, a heatblock malfunctioned during library preparation, which was likely the reason for sub-optimal barcode attachment resulting in extremely low throughput for a MinION flow cell (Table 3). Nevertheless, we were able to obtain 83% (default resolution) and 100% accuracy (higher resolution, Table S4) in typing lineages, providing a useful picture of the outbreak sequence type, antibiotic resistance genotypes (with exception of SCCmec related features) and presence of the PVL toxin. Similar results were obtained on a multiplex run on cheap Flongle adapters (Table 5, Table S5).\n\nWe employed an efficient multiplex sequencing protocol on the MinION for surveying the two outbreaks, sequencing 2 x 12 barcodes on the same flow cell, driving down the cost of each isolate with full assembly, genotyping and phylodynamic analysis to around $40-50 per isolate, as previously described (4). In this analysis, we used a subset of the total reads per barcode (1000) for genomic neighbor typing evaluation which corresponds to approximately 2-3x coverage of the S. aureus genome, having shown previously that assembly based genotyping is possible at approximately 5x coverage per genome (4). In addition, we expanded on the dual-library sequencing protocol and attempted to sequence 48 strains on a MinION flow cell in 2 hour intervals, with sufficient data obtained for genomic neighbor typing further reducing cost to approximately $30 (Australian) per barcode (Table 6, Table S6). Given the efficiency of our approach, it should be possible to use 96-barcode kits to sequence as many isolates on a single MinION flow cell and obtain accurate genotypes. Taking into consideration the limitations in species applications and resource management for higher resolution sketches, genomic neighbor typing with Sketchy is therefore suitable to survey bacterial outbreaks rapidly, at low-cost, and with sufficiently accurate results to infer important epidemiological characteristics. In this case, the predominant outbreak sequence type was the Australian ST93 lineage, which had emerged in the Northern Territory and spread to the East Coast of Australia (26). Even without confirmation from phylogenetic analysis (27), the predominance of the ST93 sequence type in Far North Queensland and Papua New Guinea outbreaks strongly suggests transmission from Australia.\n\nFinally, we observed systematic misclassifications of cladespecific SCCmec related features (methicillin resistance, SCCmec subtype) that could not be resolved with higher resolution sketches (Tables 2–6, Tables 8–9). We hypothesized that this could be due to the approximate MinHash approach, which does not have the same resolution on sublineage geno- or phenotypes as the phylogenetically guided classification approach using ProPhyle in RASE. We demonstrated this limitation on a lineage-specific (ST93) reference sketch in comparison with the same reference database implemented in RASE (Tables 7–9), for which we used a phylogenetic tree of the lineage that distinguished between MSSA and MRSA clades (Fig. 5A). While most misclassifications with Sketchycould be resolved with increasing sketch size (Table 9) and indeed outperformed RASE, classifications of SCCmec features continued to fail even at very high sketch sizes (s = 1000000). While RASE performed better on sublineage genotyping, we noted a systematic error in tetracycline predictions, which was unexpected since only a single isolate in the reference dataset was resistant; we were unable to explain these errors but note that the preference score employed by RASE marked uncertainty in the majority of tetracycline predictions, even when run on all reads for each isolate, ultimately not resolving the tetracycline prediction errors (Table S5).\n\nOverall, phylogenetically informed genomic neighbor typing has a definitive advantage over Sketchy for inference of clade-specific traits, which his particularly relevant for clinical diagnostics (e.g. antimicrobial susceptibility predictions). However, we were unable to construct RASE databases for the species-wide reference collections, as the required phylogenetic trees are infeasible, or at least highly impractical, to infer from tens of thousands of whole genome sequences. At the species level, the ease with which reference sketches can be constructed for Sketchy and their minimal resource requirements given the number of genomes included, puts Sketchy at an advantage for outbreak surveillance applications. Because we derive genotypes from other genotype classifications (based on assemblies or reads) it should be noted that classification with Sketchy can only achieve classification performance of the underlying genotyping methods (e.g. Mykrobe). However, genomic neighbor genotyping with Sketchy could also enable automating the construction of reference databases, so that public archives can be surveyed periodically and new genome integrated continuously. At this stage, due to limitations in sublineage genotype predictions for antibiotic susceptibility predictions, we do not recommend using Sketchy for clinical applications, but rather as a tool to rapidly survey bacterial outbreaks or isolate collections at scale. Sketchy may also be useful in scenarios where genotype inference of limited sequence data is required.\n\nIn comparison to other genotype classification tools, Sketchy is situated between species-level taxonomic classifiers and phylogenetically informed genomic neighbor typing. Predictions are useful for traits distributed at the lineage level, for example penicillin resistance or PVL toxins in S. aureus, with limitations in application to some species with high rates of homologous recombination, such as Neisseria gonorrhoeae or Neisseria meningitidis. Future work on genomic neighbor typing may consider scaling up multiplexing (e.g. 96-barcode panels), curation and minimisation of reference databases, implementation of alternative query methods, or combining different approaches to genomic neighbor typing to enable continuous species- to sublineage-level predictions. Adaptive sequencing may be useful to balance throughput per barcode in order to make multiplex sequencing protocols more robust and cost-effective (30). Ultimately, we demonstrated that genomic neighbor typing with species-wide reference sketches is a viable approach for genotype surveillance of bacterial community outbreaks, particularly under challenging circumstances and in remote locations, including northern Australia and Papua New Guinea.\n\nMaterials and Methods\n\nOutbreak sampling and reference sequencing\n\nIsolates were collected from outbreaks in two remote populations in northern Australia and Papua New Guinea as described by Steinig et al. (4) and Aglua et al. (17). Isolates associated with paediatric osteomyelitis cases (mean age of 8 years) were collected from 2012 to 2017 (n = 42) from Kundiawa, Simbu Province (27), and from 2012 to 2018 (n = 35) from patients in the neighboring Eastern Highlands province town of Goroka. We supplemented the data with MSSA isolates associated with severe hospital-associated infections and blood cultures in Madang (Madang Province) (n = 8) and Goroka (n = 12). Isolates from communities in Far North Queensland, including metropolitan Cairns, the Cape York Peninsula and the Torres Strait Islands (n = 91) were a contemporary sample from 2019. Isolates were recovered on LB agar from clinical specimens using routine microbiological techniques at Queensland Health and the Papua New Guinea Institute of Medical Research (PNGIMR). Isolates were transported on swabs from monocultures to the Australian Institute of Tropical Health and Medicine (AITHM Townsville) where they were cultured in 10 ml LB broth at 37°C overnight and stored at −80°C in 20% (v/v) glycosol and LB. Samples were regrown on LB agar prior to sequencing, and a single colony was placed into inhouse lysis buffer and sequenced at the Doherty Applied Microbial Genomics laboratory (DAMG), using 100 bp paired-end libraries on Illumina HiSeq.\n\nMinION outbreak library preparation and sequencing\n\n2 ml of LB broth was spun down at 5,000 x g for 10 minutes and after removing the supernatant, 50 ul of 0.5 mg / ml lysostaphin were added to the tube and vortexed. Cell lysis was conducted at 37°C for 2 hours with gentle shaking followed by a proteinase K digestion for 30 mins. at 56°C. DNA was extracted using a simple column protocol from the DNeasy Blood & Tissue kit (QIAGEN) following the manufacturer’s instructions. DNA was eluted in 70 ul of nuclease-free water, quantified on Qubit, and DNA was stored at 4°C until library preparation. Library preparation was done using approx. 420 ng of DNA and the rapid barcoding kit with 12 barcodes (ONT, SQK-RBK004) as per manufacturer’s instructions, with the exception of conducting bead cleanup steps. DNA was quantitated using Qubit 4.0 (Thermo Fisher Scientific), purity determined with a NanoDrop 2000 Spectrophotometer (Thermo Fisher Scientific). Basecalling was done using the PyTorch Bonito v0.3.6 R9.4.1 DNA model, run on a local NVIDIA GTX1080-Ti or a remote cluster of NVIDIA P100 GPUs. Sequence runs were conducted with 2 x 12 barcoded (SQK-RBK004) isolates per flow cell in two consecutive 18-24 hour runs. Libraries were nuclease flushed using the wash kit between consecutive runs (Oxford Nanopore Technologies, EXP-WSH-003). This is sufficiently effective to remove read carry-over, as demonstrated previously with hybrid assemblies of sequentially sequenced Enterobacteriaceae (31). Sequencing runs were managed on two MinIONs and monitored in MinKNOW > v20.3.1. Read sum mary reports for nanopore reads were generated with nanoq v0.8.2 (32).\n\nMinION and Flongle multiplexing experiments\n\nTo demonstrate that genotyping is possible on site in Papua New Guinea, we sequenced 12 S. aureus outbreak strains at the Papua New Guinea Institute of Medical Research (PNGIMR) in Goroka. We replicated the QIAGEN extraction and rapid library sequencing protocol described above, unknowingly using a malfunctioning heatblock in the library preparation step (SQK-RBK004), which resulted in suboptimal barcode attachments. We also prepared a multiplex run for a Flongle experiment at the Peter Doherty Institute for Infection and Immunity. Staphylococcus aureus glycerol stocks were inoculated in Tryptic soy broth (TSB) and grown overnight at 37°C, 180 rpm. DNA was extracted from 8 ml of overnight culture via pelleting cells at 12,000 rpm for 2 minutes. Cells were resuspended in PrepMan™ Ultra Sample Preparation Reagent (ThermoFisher Scientific) and Lysing Matrix Y beads (MP Biomedicals). Isolates were incubated at 95°C for 15 minutes and cells further lysed via a TissueLyser LT (Qiagen) at 6.5 m/s for 60 seconds similar to previously described (33). Extracts were centrifuged at 13,000 rpm for 10 minutes. Supernatant was removed and mixed with 3M sodium acetate (pH 5.5), ice-cold 100% ethanol (0.3:0.03:0.67 ratio) and DNA was precipitated for 3 hours at −20°C. DNA was pelleted at 13,000 rpm for 15 mins (4°C), washed with 70% ethanol and resuspendeded in ultrapure water. High-molecular-weight (HMW) DNA was isolated via the MagAttract HMW DNA Kit (Qiagen) as per manufacturer’s instructions. Briefly, this included a protein digest with proteinase K for 30 minutes at 56°C (900 rpm) and an RNAse A (0.4mg) treatment for 10 minutes at room temperature. HMW DNA was further purified using Agencourt Ampure XP (Beckman Coulter Australia) beads (1:1 ratio). Libraries were prepared using the ONT Rapid Barcoding (SQK-RBK004) kit with an input of 200ng of HMW DNA for each isolate. The library was sequenced on an ONT Flongle FLO-FLG001 flow cell for 24 hours. All runs in this sections were called with Guppy v4.6 R9.4.1 DNA high accuracy models (HAC). Finally, we repeated library construction as described for the outbreak sequencing above to test a faster sequencing protocol, in which four libraries were sequenced on the same MinION flow-cell with intermediate nuclease flushes and a runtime of 2 hours per library.\n\nReference databases construction and genotyping\n\nFor reference sketch construction, we used a collection of assemblies containing bacterial genomes from the entire European Nucleotide Archive (ENA) in 2018 (n = 660,333) (25). Metadata from precomputed assembly genotypes was used to subset assemblies with complete lineage designation for inclusion (MLST). CheckM metrics were used to filter assemblies by completeness (< 99%), contamination (> 0.1%) and evidence for strain heterogeneity (> 0.1%) retaining a total of 543,695 assemblies across 71 species with at least 100 genomes. For reference sketch construction in the simulations, we included five common species of interest with at least 1000 genomes: Streptococcus pneumoniae (n = 47,616), Staphylococcus aureus (n = 42,461), Neisseria meningitidis (n = 16,198), Klebsiella pneumoniae (n = 10,072) and Neisseria gonorrhoeae (n = 8,413). We had previously downloaded a collection of S. aureus sequence runs from the NCBI Short Read Archive and ENA (n = 38,985) providing matching raw sequence read data for a subset of the assemblies in the ENA collection. Antimicrobial resistance phenotypes for 12 antibiotics (ciprofloxacin, clindamycin, erythromycin, fusidic acid, gentamicin, methicillin, mupirocin, penicillin, rifampicin, tetracycline, trimethoprim and vancomycin) were inferred from these reads with Mykrobe v0.6.1 and the default S. aureus typing panel (34). In addition, we used SCCion v0.2.1 (https://github.com/esteinig/sccion) to type SCCmec subtypes using Mash matches against the SCCmecFinder database (35).\n\nSketchy implementation and streaming algorithm\n\nSketchy implements k-mer extraction and hashing based on the needletail (https://github.com/onecodex/needletail) and finch (https://github.com/onecodex/finch-rs) libraries, which allowed us to replicate Mash sketching and shared hashes computation in Rust. Mash (23) pioneered an unbiased approximation of the Jaccard index between two k-mer sets A and B:\n\nMash (and Finch) merge-sort two bottom sketches S(A) and S(B) to estimate the Jaccard index, where the merge is terminated after s unique hashes, and the estimate of the Jaccard index is computed for x shared hashes found after processing s′ hashes:\n\nSketchy implements two simple reference sketch matching functions based on the parameters of the reference sketch (k-mer size, sketch size and hash seed) that compute the min-wise shared hashes (x) with each genome in the reference sketch. In the first instance, we use Finch to compute the number of shared hashes (x) for all reads until the specified read limit (i) (--limit parameter). In addition, we provide a streaming implementation (the sum of shared hashes) in which the shared hashes (x) are computed for each read (j) and added to the sum of shared hashes (h) until the read limit (i) is reached:\n\nImplementation of genomic neighbor typing is achieved by ranking the shared hashes (or the sum of shared hashes after each read) and selecting the associated genotype of the highest ranking genome in the reference database as inferred genotype. When predicting genomic neighbors from closely related genomes of the same lineage (e.g. in an outbreak scenario) a consensus call for each genotype features across the highest ranking genomes can be made using the --consensus flag and --top parameter in the Sketchy command line client.\n\nSketchy command line client\n\nSketchy v0.6.0 is written in Rust and implements a command line client with several functions. First, a multi-genome reference sketch can be constructed from sequence files at a given sketch (s) and k-mer size (k):\n\nInformation about the sketch (k-mer size, sketch-size, hash seed, number of genomes, identity and order of genomes) can be produced from the sketch file:\n\nAssociated genotype or phenotype files can then be constructed and checked against the reference sketch to ensure both contain the same genomes in the same order:\n\nFor any given (multiple) sketch file the shared hashes with each genome in the reference sketch can then be computed, if parameters between the reference and query sketches are consistent:\n\nFinally, genomic neighbor typing predictions based on the reference sketch and a sequence file can be computed for a given number of reads (--limit), which will output a given number of the highest ranking matches (--top) in the reference sketch and their associated genotypes or phenotypes for inference. Streaming and consensus modes can be activated with their respective flags (--stream and --consensus):\n\nLineage calling simulations and comparisons\n\nDatabases varied in the representation of the total diversity within each species, due to variations in the number of genomes available and diversity of sequence types contained in each database. We conducted a cross-validation analysis by randomly sampling 10 genomes from each database across multiple replicate samples (n = 20). For each replicate, we constructed the reference sketch without the sampled genomes to evaluate the impact of predicting sequence types not contained in the database. We used badread v0.2.0 to simulate decent quality, low-coverage (5x) nanopore reads (similar to using R9.4 flow cells and RAD004 libraries) with parameters:\n\nWe then selected a series of read cut-offs for predictions (10, 50, 100, 200, 300, 500 and 1000 reads). Ultimately, we selected to report results at the 1000 read threshold for several reasons: first, the threshold marks around 1-3x coverage of the S. aureus genome (depending on read length), after which it becomes feasible to do assembly based genotyping with high recall from nanopore data alone, as demonstrated previously for these outbreak data (20); second, our primary aim was to infer genotypes from as few reads as possible and initial simulations indicated stabilisation of predictions below 1000 reads (Fig. S1); third, reporting by time (as in RASE) is highly volatile due to differences in throughput between libraries (e.g. multiplex vs. single isolates), sequencing devices (e.g. MinION vs. PromethION) as well as pore availability and occupancy per flow cell. Our target for these simulations was lineage calling, as the prediction of intra-lineage genotypes (including antibiotic resistance) depends on first matching into the correct genomic neighborhood of the species (i.e. finding the correct sequence type). MLST (lineage) predictions were made from the match with the highest shared hashes in the replicate database (--top 1). Replicate samples were run against the hold-out sketches (DB-) and against the full sketch (DB+) computing the average sequence types correctly predicted over all samples (including standard deviation, Table 1).\n\nFor comparison at the 1000 read threshold we used Krocus v1.0.1 (k = 16), which attempts to find k-mers matching to species-specific MLST alleles and is conceptually similar to Sketchy in that it implements a ‘hypothesis-agnostic’ approach to genotyping lineages (based on available MLST alleles from PubMLST) (36). We also compared results with assemblies of the simulated genomes using Flye v2.9 (37) followed by MLST typing with mlst v2.19.0 (https://github.com/tseemann/mlst). At this stage, we did not compare Sketchy to RASE, because RASE requires phylogenetic guide trees for ProPhyle (28), which are not feasible or practical to infer for species-wide whole genome collections, such as the ones constructed here. Direct inference of MLST from assemblies and k-mer allele typing were therefore conceptually more suitable for comparison with Sketchy. Mean maximum memory consumption and time for prediction were measured on a single representative isolate picked at random for 10 iterations (including standard deviation, Table 1).\n\nGenotyping of community-associated outbreaks\n\nFor validation of predictions in an outbreak surveillance scenario we used a set of 160 nanopore-sequenced isolates from FNQ (n = 70) and PNG (n = 90) sequenced using the dual-library protocol and for which we had matching Illumina data. Using Illumina genotypes as reference, for each binary genotype feature (e.g. R or S, PNL+ or PVL-) we computed accuracy, precision, sensitivity, and specificity using sklearn functions, with weighed scores for multi-label features (SCCmec-type, MLST). While the dataset constituted a real test dataset with previously unknown strains from a country for which genome sequences did not exist for S. aureus, it should be noted that there was substantial bias in composition towards the ST93-MRSA-IV outbreak lineage (n = 120/160). Sketchy was run using consensus genotypes over the 5 highest ranking prediction of the default reference sketch for S. aureus (k = 16, s = 1000, 1000 reads classification limit) which marginally improved within outbreak genotyping of ST93 isolates. Output predictions were evaluated against the Illumina reference genotypes for each feature (Tables 2 – 5). For comparison of streaming analysis (sum of shared hashes) we used the outbreak dataset and the highest ranking prediction (1000 reads classification limit) (Table S3). For demonstration of applying Sketchy in challenging sequencing scenarios related to this outbreak, we conducted three experiments: a multiplex flow cell of 12 outbreak isolates sequenced in Goroka (during which a heatblock failed resulting in suboptimal barcode attachment), a library on an early Flongle adapter flow cell with highly reduced throughput, and sequencing 4 panels of 12 barcoded isolates in succession (2 hours each, with nuclease washes between runs, see above). We applied the same consensus genotype prediction and metrics for these three experiments as in the dual barcoding library (Fig. 4, Tables 3–5).\n\nGenomic neighbor typing of sublineage genotypes\n\nFor comparison of sublineage antimicrobial resistance typing with RASE, we collected a reference set of ST93-MSSA and -MRSA strains based on previous work with this lineage (n = 360) (26). Genotype data consisted of the antimicrobial resistance genotypes derived from the full reference sketch for S. aureus used in the outbreak surveillance section. For implementation in RASE, we constructed a phylogenetic tree based on core SNPs from our previous phylogenomic analysis of the lineage (26). IQTREE v2.1.2 was used to reconstruct a maximum-likelihood phylogeny using the General Time Reversible model with rate heterogeneity, Lewis ascertainment bias correction (GTR+G+ASC) and placing the root on an early diverging MSSA isolate, consistent with previous phylogenetic reconstructions (SAMEA1557252). Trees were visualized with Interactive Tree of Life (38). The RASE reference database was constructed without additional ancestral state reconstruction as all resistance genotypes were known.\n\nST93 has two distinct clades, an ancestral MSSA clade with isolates from the Northern Territory, and a divergent MRSA clade, which expanded on the Australian East Coast, and spread to FNQ and PNG. This allowed us to assess genotyping ability of cladespecific methicillin resistance, which we have shown was compromised in the outbreak surveillance assessment using the approximate genomic neighbor typing approach in Sketchy. We expected RASE to have superior performance due to using a lineage phylogeny as guide for its genomic neighbor typing implementation with ProPhyle 0.3.3.1 (28). To visualize the differences in resolution between our MinHash approach and tree-guided (SNP based) genomic neighbor typing (Fig. S4), we used NetView (39) to reconstruct genome population networks based on pairwise-distances from underlying SNPs and pairwise shared hash distance (s - h) computed with Sketchy. A value of k = 20 was selected for visualization of the network topologies in Fig. 5, as described previously (40) indicating stable configurations in both networks across selected community clustering algorithms (Fig. S1, C-D).\n\nFor comparison with Sketchy, we used a RASE (commit 27113cb) database constructed at k = 16, and the Sketchy outbreak reference sketch at k = 16 and s = 1000, as well as a high resolution sketch at s = 1000000. RASE requires sequence times per read, which were not available in the output of Bonito v0.3.6. We therefore used reads base called with the Guppy v4.6 R9.4.1 DNA HAC model for this comparison. RASE outputs predictions by minute timestamps (including the number of reads) from which we selected the prediction closest to the 1000 read threshold (Table 7) used throughout this manuscript; we also ran the full read set to check for persistence of tetracycline prediction errors (Table S7). RASE read thresholds for each isolate were used for the read limit parameter (--limit) in the Sketchy predictions (Tables 8,9)."
    }
}