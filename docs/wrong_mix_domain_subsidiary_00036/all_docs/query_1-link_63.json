{
    "id": "wrong_mix_domain_subsidiary_00036_1",
    "rank": 63,
    "data": {
        "url": "https://calendarservermigration.blogspot.com/2007/09/",
        "read_more_link": "",
        "language": "en",
        "title": "Sumatra's Calendar Server Blog",
        "top_image": "https://calendarservermigration.blogspot.com/favicon.ico",
        "meta_img": "https://calendarservermigration.blogspot.com/favicon.ico",
        "images": [
            "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEiUE1KwZ-cLC2SEqdNT8aXUhqEuSyPpoyFjxxhrc_KroOwK9c8N0qMuqg7kB6ySSmG6Vdj-yhcoCSb5I9_OMOKPfT9xIlAEV9fD5f8MLPhZTsHQh9SyvBVM1etQQia8YW5pV3NeIQ/s400/zinsert.jpg",
            "https://resources.blogblog.com/img/icon18_email.gif",
            "https://resources.blogblog.com/img/icon18_edit_allbkg.gif",
            "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEg63fNNdgr-oXncIH85m3gxucwj7CFgmBtPwvWiMxFH8XVvV-ebRqh_uevqPRpcMlcBCLHGGikoTlcQB6lV04kFMkSG5z2uSR7wYQOa9suyASOKkIlrAGw776NxyPTU8LjvikDXOg/s400/revised+OraCal+reader.jpg",
            "https://resources.blogblog.com/img/icon18_email.gif",
            "https://resources.blogblog.com/img/icon18_edit_allbkg.gif",
            "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEjWS7fk-ynCqNLZ84cbya38Q2sjXBmzqFGrQGw6D8_vtrPAvbk5upw1Fza9VMxykVhJ-4zfvwIiMp_4JjvTzozUg1GYjyAB-QStAfE5tFoiohNP4gH5eMRBibYQPDJD0v61AP9spw/s400/users-go.jpg",
            "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEizUv6yi-8Qntbc-Drn3YUZX-Gbw3T0l-Ki6zxE4aMfUsahTFfmH6cwU-EDtt3kmGASTyyqZUQ4JL4xcwjuz3xBKhyIfNxk3ntAFOQRBprHv8kiaTC90iDTdo_upr9bc6QwjZWjWw/s400/users-new.jpg",
            "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgha-Su4URwLjiqF9AWx0h6ojHZZGDEM6mZ5p2GNFpHburGg-ZSh_8NCVrKwP1BwL_oQ-zd0W5C2XT3M5dfRAqX12_RVdL5YDPdwFKY48fpsZsqMHr7n9rk6coZ_Q5-45MW5kjo3Q/s400/users-query.jpg",
            "https://resources.blogblog.com/img/icon18_email.gif",
            "https://resources.blogblog.com/img/icon18_edit_allbkg.gif",
            "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhnkLKN-RrXoUxC7rSAE-T0BEpuPCpKAS6_Tf5bF91jG2bLBhXIBlT22WulyZosQnCqrEqlbiGyU_WYEYgqCKT_WZL5ElcR_TpSmjv7khwVKvRPW_nPsVdUgrEVR7K6aqoKLYiLyQ/s400/oracal.jpg",
            "https://resources.blogblog.com/img/icon18_email.gif",
            "https://resources.blogblog.com/img/icon18_edit_allbkg.gif",
            "https://resources.blogblog.com/img/icon18_email.gif",
            "https://resources.blogblog.com/img/icon18_edit_allbkg.gif",
            "https://resources.blogblog.com/img/icon18_email.gif",
            "https://resources.blogblog.com/img/icon18_edit_allbkg.gif",
            "https://resources.blogblog.com/img/icon18_email.gif",
            "https://resources.blogblog.com/img/icon18_edit_allbkg.gif",
            "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhjB5MGiEUKJtVaNcqxOsw7s2oeh9UDO8RujGaYwJq1hV0QnHg14AZ4GcvK_l4QVFxYDc1xsF65YWoa7wijw4-74ympU1q2lSFymdgwIXDbf2cwO0ErGK7oyAFXNINupBKLroOfhw/s400/ocs-signin.jpg",
            "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj77jFpqU89o-O0epwBDSb0KAp0xbIhkgOtB9iNvWbTp5JEtMngv_7_-wUz6udGCCchk2dWCDQfwlJilwHI4vjX2_WffJNZTQpEcZVNkaDyY2ju_Ljo21PSCQQ1x2qNuZFIF-_l9Q/s400/ocs-select.jpg",
            "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEj1LXz7s6CuR2PQPXcVr8C8Bkq4pIOlDr67BbowQIhKPqwWWwtX_Ma2LObx4e5x7rrx3h085uZfvwN86OJw0feX2nOabspgnD72OD75XowQTIilfRcCCGi9-vwCFv87rp5vb5RzPQ/s400/dupeUser.jpg",
            "https://resources.blogblog.com/img/icon18_email.gif",
            "https://resources.blogblog.com/img/icon18_edit_allbkg.gif",
            "https://resources.blogblog.com/img/icon18_email.gif",
            "https://resources.blogblog.com/img/icon18_edit_allbkg.gif",
            "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEi_IjXcbJQY_R8qgC3HYqDhONwEGr2QtoadGeIicDqmHas19wNQGN8_W6TdeJ7n9WIZsnGifpiHU4XlHHrLPr8AWhy5NCqQpAgqWeHKiAGoGlMea6_d-oiEzAZwtzU4R-Ym8n7xYA/s400/john-OCS.jpg",
            "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEhGtx3onEPDjr4uecP_qsTCN3oQQRQjXcDFSVgL3WdTFSHiSanGiQMbNIBW_Q0Ew8oGwGi9XDaWUz9Yt4nHj-dtbRF-_0veQdoas7bgCUcDoKS_EZMkKsh51jEAAenPN4tXBF_-Mg/s400/zim-john.jpg",
            "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEijkaCgz2xHHCNczMIxCHbUJyykBK_sQ15llKVd_l890zp9qIg3MgxoQj68wFyc5_8Nt3mpoRFBo50XnRJT0zTllEWtkD-CgiF4AOksExbuowFb513KG2zOHouDtzCirz0tLO2tnA/s400/oracal-shot.jpg",
            "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgr6e-olC8NcHsfI4kdhbe9_GWzxXTsXRzMA5GytShGrN1F3VEytRFOg0xnkLsWrdmy14jyEFq8eqXZyRXQMO1AqYaJ5U6lgBa5Q6QS_nuLGe4x1NlvhjEQV6E2V1a6aHZ6ECct6Q/s400/ol-john.jpg",
            "https://resources.blogblog.com/img/icon18_email.gif",
            "https://resources.blogblog.com/img/icon18_edit_allbkg.gif"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "Calendar and scheduling server technical information, emphasizing legacy migrations into Microsoft Exchange maintaining maximum functionality.",
        "meta_lang": "",
        "meta_favicon": "https://calendarservermigration.blogspot.com/favicon.ico",
        "meta_site_name": "",
        "canonical_link": "https://calendarservermigration.blogspot.com/2007/09/",
        "text": "By this point the idea is to make the actual insertion into Zimbra a boring anti-climax.\n\nWe have the same goal inserting legacy data into Microsoft Exchange, but because of Exchange architecture this is a little more intricate than Zimbra (So we deal with it separately).\n\nYour primary tool is called zinsert.exe, which you invoke from the Command Prompt (which those of us of a certain age refer to as \"DOS\").\n\nSimply typing zinsert (-Enter-) will give you a brief summary of functionality.\n\nFirst off, use ODBC (available under Control Panel) to point to the conversion database. Let's call your ODBC connection \"Zimbra.\"\n\nTo create a series of ICS files with appropriate cross-linked GUIDs, use this command:\n\nzinsert -fo -cs DSN=ZIMBRA -tf_utc_to_timezone\n\nIn general, converting for the appropriate time zone, use the -tf_utc_to_timezone option unless we determine another one is better (not likely, but we keep them there in case -- you never know what the US Congress is going to do with Daylight Savings Time).\n\nInserting into Zimbra\n\nThat's what the -post command is for, which as of this date we haven't actually had to use (also it will require knowing each user's password which is a pain)\n\nYou can use curl, or (thanks to a college in New Jersey), you can use this method.\n\nThis solution doesn't require an admin to know the user's password.\n\nIt does require a configured web server and assumes there is a separate ICS for each user calendar.\n\n1. The ICS files need to be placed on a web server that the Zimbra server will be able to access via http (or https). I'll assume a base of http://YOURDOMAIN/migrate/.\n\n2. Create a file (e.g. /tmp/importcals.zcs) that will be fed to zmprov with contents like this:\n\nselectMailbox USERID1\n\nemptyFolder Calendar <--- optional command\n\nimportURLIntoFolder Calendar http://YOURDOMAIN/migrate/USERID1.ics\n\nselectMailbox USERID2\n\nemptyFolder Calendar <--- optional command\n\nimportURLIntoFolder Calendar http://YOURDOMAIN/migrate/USERID2.ics\n\n3. Run that through zmprov.\n\nzmprov -f /tmp/importcals.zcs\n\nNB: This is for migration into Zimbra. Migration into Exchange is a whole different issue which we deal with separately.\n\nYou have your Oracle Calendar Server data, you've converted it into an Access database -- now you just need to map your users for Zimbra.\n\nWhy? Usually there's at least a handful of users who have changed their names through marriage, divorce, or the witness protection program.\n\nAlso since you're migrating anyway many sites use the opportunity to standardize their naming conventions.\n\nStep 1: Open the database and go to the Users Table:\n\nThere's a lot going on here, but don't let it scare you.\n\nIn the Email column just put your new Zimbra email\n\nNote that even though the login for \"Adam Ant\" is \"aant\" we can substitute \"adam_ant\" or anything else we need so long as it matches the Zimbra address.\n\nThis simple Query will duplicate your login IDs to the Email field, appending the appropriate domain name (which you'll need or else guests will not be notified of meeting updates). Of course, this is generally modifiable into anything that makes sense for your environment.\n\nNext step: inserting your data!\n\nSo you've gotten your calendar data out of Oracle Calendar Server and now you wonder \"What ELSE do I have to do with it?\"\n\nWell, you have to convert it into a (new) relational database so that we can reassemble any attributes not exported from OCS.\n\nLike what you ask? Guest lists, guest responses, recurrence patterns, all the sorts of things you want.\n\nDo you need to go through this? Well, if you want to do this all server-side and keep all the information that makes schedulers valuable, yes.\n\nThe tool that takes your exports runs in Windows and looks like this: How do I use this?\n\nWhile the design reminds you of an early farm tractor (which we are very proud of) - it's designed with the same single-minded focus: get the job done as quickly as possible and the heck with how it looks (you're tossing it out after this is done anyway).\n\nThe idea here is to take in the files you got from UNICPOUTU, and match them with users and resources from USERS.TXT and RESOURCES.TXT.\n\nSpecifically this will:\n\nMatch export data to users and resources (the users and resources will be mapped to your new calendar system)\n\nAdd guests to your meeting\n\nGroup one-time instances into “recurring meetings” (makes the insertion run faster)\n\nRemove old items you do not intend to insert (makes the insertion run faster)\n\nReformat OCS-specific items to calendar-neutral terms (e.g. map Daily Notes and Daily Events to All Day Events)\n\nNote that if you're planning on multiple test insertions you only need to read the users and resources into the database once. It is possible to parallelize conversions, e.g., convert A-L on one machine, M-Z on another and join them together to get the job done in half the time (but please talk with us before you do that).\n\nThis also includes a blank template database (MS Access format), which we recommend you rename a copy of to something descriptive, like \"December 1 migration test.\" Please preserve the database version in the file name; it really helps when debugging.\n\nLet's go into some details on the specifics.\n\nTime Zone: Select the Time Zone of your OCS node. This is really crucial otherwise everything will be off on your insertion by some multiple of hours. If you have users outside of the default time zone you can modify the USERS.TXT file for them (see earlier post).\n\nDrop Items Prior to this Date: You can selectively export items from certain date ranges -- but in case you have a data set with everything and want to pare it down for a test insertion, you have that option here.\n\nThreshold for recurrence patterns: When we get the events from OCS they are all individual events rather than a series. We reconstruct the series, but (as a little thinking will show you) with exceptions to recurrences this can get a little dicey. Our software analyzes the sequence and comes up with its best guess of the recurrence pattern, taking account the threshold you set.\n\nA couple of quick things to note:\n\nHistorical events (i.e., any events before the date you convert them) all go in as individual events (it's faster this way) with meeting guest list in the Agenda field (except for BCC guest whom only the meeting proposer sees)\n\nThere needs to be at least five recurring events before we attempt to re-create the sequence. (Quick math -- at an 80% threshold, one exception to a five event pattern puts you at the threshold)\n\nIf we can't match a pattern all events will go in as individual instances. So worst case scenario is that a recurring meeting or event comes in as a series of individual instances. (But as opposed to an ics RDATEs list these will display properly in Outlook clients).\n\nIf you migrate only a subset of users, meetings to and from users outside that subset will not show up. Think about this one: if the meeting owner or guest is not in the system you're migrating to -- how can they be on a meeting in your new system? This is the main reason we're always advocating \"Big Bang\" migrations for meeting-centric corporate cultures.\n\nHow does this work?\n\nIn two phases: the first phase reads the OCS exports and turns them into an intermediate file. The second phase reads the intermediate file into the database template.\n\nWhy not just put everything into the database as we're going along? It's faster this way.\n\nEverything in a calendar server migration is a trade-off between time and convenience.\n\nIt's certainly easier for the average admin to work with an Access file. But the overhead of constant transactions at the volume we need is huge. Saving them for the end makes the system much faster."
    }
}