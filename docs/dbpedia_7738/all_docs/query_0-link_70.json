{
    "id": "dbpedia_7738_0",
    "rank": 70,
    "data": {
        "url": "https://www.rapid7.com/blog/post/2017/02/14/how-to-install-suricata-nids-on-ubuntu-linux/",
        "read_more_link": "",
        "language": "en",
        "title": "How to Install Suricata NIDS on Ubuntu Linux",
        "top_image": "https://www.rapid7.com/globalassets/rapid7-og.jpg",
        "meta_img": "https://www.rapid7.com/globalassets/rapid7-og.jpg",
        "images": [
            "https://www.rapid7.com/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg",
            "https://www.rapid7.com/Areas/Docs/includes/img/r7-nav/icon-lock.svg",
            "https://www.rapid7.com/Areas/Docs/includes/img/r7-nav/Rapid7_logo.svg",
            "https://www.rapid7.com/Areas/Docs/includes/img/r7-nav/icon-lock.svg",
            "https://www.rapid7.com/Areas/Docs/includes/img/r7-nav/Rapid7_logo-short.svg",
            "https://www.rapid7.com/includes/img/up-arrow-lightgray.png?width=1200",
            "https://www.rapid7.com/includes/img/Rapid7_logo.svg?width=1200&quality=90",
            "https://www.rapid7.com/includes/img/logo-black.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "Rapid7"
        ],
        "publish_date": "2017-02-14T00:00:00",
        "summary": "",
        "meta_description": "",
        "meta_lang": "en",
        "meta_favicon": "/includes/img/favicon.ico",
        "meta_site_name": "Rapid7",
        "canonical_link": "https://www.rapid7.com/blog/post/2017/02/14/how-to-install-suricata-nids-on-ubuntu-linux/",
        "text": "Synopsiss\n\nSuricata is a free and open source fast network intrusion system that can be used to inspect the network traffic using a rules and signature language. Suricata is funded by the Open Information Security Foundation and used for network intrusion detection, network intrusion prevention and security monitoring prevention. It is capable of handling multiple gigabyte traffic, display it on screen and also send alerts through email. Suricata’s architecture is very similar to Snort and relies on signatures.\n\nFeatures\n\nSupports Multi-Threading, so you can use more than one CPU at a time.\n\nProvides built-in Hardware Acceleration, so you can use graphic cards to inspect network traffic.\n\nSupports Lua scripting that can be used to detect complex threats.\n\nSupports various operating system such as Unix/Linux, FreeBSD and Windows.\n\nSuricata is capable of inspecting multi-gigabit traffic easily.\n\nIn this tutorial, we will demonstrate how to install and configure Suricata IDS on Ubuntu Linux server.\n\nSystem Requirements\n\nNewly deployed Ubuntu 16.04 server.\n\nMinimum 4 GB RAM and multicore CPU for better performance.\n\nA static IP address 192.168.15.189 is configured on your server.\n\nPrepare the System for Deployment\n\nBefore starting with the Suricata, your system should be up to date and all installed software is running the latest version.\n\nFirst, log in to root user and update your system by running the following command:\n\napt-get update -y apt-get upgrade -y\n\nInstall Required Packages\n\nBefore installing Suricata, you will need to install Suricata’s dependencies.\n\nYou can install all the required dependencies by running the following command:\n\napt-get install libpcre3-dbg libpcre3-dev autoconf automake libtool libpcap-dev libnet1-dev libyaml-dev libjansson4 libcap-ng-dev libmagic-dev libjansson-dev zlib1g-dev\n\nBy default, Suricata works as an Intrusion Detection System. So you will also need to install some extra packages, if you want to use Suricata as an Intrusion Detection System and Intrusion Prevention System.\n\nRun the following command to install all of them:\n\napt-get install libnetfilter-queue-dev libnetfilter-queue1 libnfnetlink-dev\n\nOnce all the required packages are installed, you can proceed to the next step.\n\nInstall Suricata\n\nThere are two different ways you can install Suricata:\n\nInstall Suricata from Source\n\nInstall Suricata from Ubuntu PPA\n\nInstall Suricata from Source\n\nFirst, download the latest stable version of Suricata from it’s official website.\n\nOtherwise, you can download it directly with the following command:\n\nwget https://www.openinfosecfoundation.org/download/suricata-3.2.tar.gz\n\nOnce download is complete, extract the downloaded file with the following command:\n\ntar -xvzf suricata-3.2.tar.gz\n\nNext, change the directory to suricata-3.2 and build Suricata with IPS capabilities with the following command:\n\ncd suricata-3.2 ./configure --enable-nfqueue --prefix=/usr --sysconfdir=/etc --localstatedir=/var\n\nNext, install Suricata by running the following command:\n\nmake make install\n\nNext, install suricata default configuration files with the following command:\n\nmake install-conf\n\nInstall Suricata from Ubuntu PPA\n\nFirst, you will need to add the Suricata PPA to Ubuntu repository.\n\nTo do so, run the following command\n\nadd-apt-repository ppa:oisf/suricata-stable\n\nNext, update the repository with the following command:\n\napt-get update -y\n\nOnce, the repository is up-to-date. You can install the latest stable version of Suricata with the following command:\n\napt-get install suricata suricata-dbg -y\n\nConfigure Suricata\n\nSuricata is useless without any rules, so you will also need to install Suricata IDS rule sets. You can install all the rule sets by running the following command inside Suricata source directory:\n\nmake install-rules\n\nYou can see all the installed rule sets inside /etc/suricata/rules directory:\n\nls /etc/suricata/rules/\n\nOutput:\n\napp-layer-events.rules emerging-deleted.rules emerging-rpc.rules http-events.rules botcc.portgrouped.rules emerging-dns.rules emerging-scada.rules LICENSE botcc.rules emerging-dos.rules emerging-scan.rules modbus-events.rules BSD-License.txt emerging-exploit.rules emerging-shellcode.rules rbn-malvertisers.rules ciarmy.rules emerging-ftp.rules emerging-smtp.rules rbn.rules classification.config emerging-games.rules emerging-snmp.rules reference.config compromised-ips.txt emerging-icmp_info.rules emerging-sql.rules sid-msg.map compromised.rules emerging-icmp.rules emerging-telnet.rules smtp-events.rules decoder-events.rules emerging-imap.rules emerging-tftp.rules stream-events.rules dnp3-events.rules emerging-inappropriate.rules emerging-trojan.rules suricata-1.3-etpro-etnamed.yaml dns-events.rules emerging-info.rules emerging-user_agents.rules suricata-1.3-open.txt drop.rules emerging-malware.rules emerging-voip.rules suricata-1.3-open.yaml dshield.rules emerging-misc.rules emerging-web_client.rules tls-events.rules emerging-activex.rules emerging-mobile_malware.rules emerging-web_server.rules tor.rules emerging-attack_response.rules emerging-netbios.rules emerging-web_specific_apps.rules unicode.map emerging-chat.rules emerging-p2p.rules emerging-worm.rules emerging.conf emerging-policy.rules gen-msg.map emerging-current_events.rules emerging-pop3.rules gpl-2.0.txt\n\nOnce all the rule sets are installed, you will need to configure suricata by editing /etc/suricata/suricata.yaml file:\n\nnano /etc/suricata/suricata.yaml\n\nUnder the var section, you will need to change some important variables such as HOME_NET and EXTERNAL_NET. You can change these variables as per your infrastructure requirements:\n\nHOME_NET: \"[192.168.15.189]\" EXTERNAL_NET: \"!$HOME_NET\"\n\nSave and close the file when you are finished.\n\nNote:HOME_NET is the IP address or network block of the network you want to defend and 192.168.15.189 is the IP address of Suricata server. Suricata will alert on attacks to the HOME_NET.\n\nTest Suricata\n\nOnce everything is set up, It’s time to perform intrusion detection. Before starting, it is recommended to turn off any packet offload features on the NIC which Suricata is listening on.\n\nYou can turn off LRO/GRO on the interface eth0 with the following command:\n\nethtool -K eth0 gro off lro off\n\nNext, you will need to create a rule set to test Suricata.\n\nFirst, create a test.rules file inside /etc/suricata/rules directory.\n\nnano /etc/suricata/rules/test.rules\n\nAdd the following rules:\n\nalert icmp any any -> $HOME_NET any (msg:\"ICMP connection attempt\"; sid:1000002; rev:1;) alert tcp any any -> $HOME_NET 23 (msg:\"TELNET connection attempt\"; sid:1000003; rev:1;)\n\nThe above rules will generate an alert in /var/log/suricata/fast.log file when someone try to Ping or Telnet to the server.\n\nNext, you will also need to define path of this rule file in suricata.yaml:\n\nnano /etc/suricata/suricata.yaml\n\nUnder the rule-files: section, add the following line:\n\n- test.rules\n\nFinally, start the Suricata in live mode with the following command:\n\n/usr/bin/suricata -D -c /etc/suricata/suricata.yaml -i eth0\n\nSuricata is now up and listening on interface eth0.\n\nOn the remote machine, try to Ping and Telnet to the Suricata server with the following command:\n\nping 192.168.15.189 telnet 192.168.15.189\n\nNow, on the Suricata server, run the following command:\n\ntail -f /var/log/suricata/fast.log\n\nIf your Suricata server is operating correctly, you should see the following output:\n\n01/21/2017-17:30:45.344770 [**] [1:1000002:1] ICMP connection attempt [**] [Classification: (null)] [Priority: 3] {ICMP} 192.168.15.237:8 -> 192.168.15.189:0 01/21/2017-17:30:49.846571 [**] [1:1000003:1] TELNET connection attempt [**] [Classification: (null)] [Priority: 3] {TCP} 192.168.15.237:36922 -> 192.168.15.189:23\n\nReferences"
    }
}