{
    "id": "wrong_mix_domainrange_foundationPlace_00096_3",
    "rank": 59,
    "data": {
        "url": "https://www.cdata.com/kb/tech/marklogic-ado-odserv.rst",
        "read_more_link": "",
        "language": "en",
        "title": "Provide OData Services of MarkLogic Data from a WCF Application",
        "top_image": "https://www.cdata.com/kb/articles/ado-od-sf-odserv-1.png",
        "meta_img": "https://www.cdata.com/kb/articles/ado-od-sf-odserv-1.png",
        "images": [
            "https://www.cdata.com/ui/img/logo.svg",
            "https://files.cdata.com/media/media/ohwfj0h2/cdata-virtuality-47-blog.png",
            "https://files.cdata.com/media/media/czljt0wz/barc-ai-governance.png",
            "https://files.cdata.com/media/media/lyznk05l/generic-data-management-2.png",
            "https://www.cdata.com/ui/img/cdata-community.svg",
            "https://files.cdata.com/media/media/14uemfo5/logo_gie_primary.png",
            "https://www.cdata.com/ui/img/drivers/icon-marklogic.png",
            "https://www.cdata.com/kb/articles/ado-od-sf-odserv-1.png",
            "https://www.cdata.com/kb/articles/ado-od-sf-odserv-2.png",
            "https://www.cdata.com/kb/tech/..\\articles\\ado-od-sf-odserv-3.png",
            "https://www.cdata.com/kb/articles/ado-od-sf-odserv-4.png",
            "https://www.cdata.com/kb/articles/ado-od-sf-odserv-5.png",
            "https://www.cdata.com/kb/articles/apps-odata-power-pivot.done.png",
            "https://www.cdata.com/ui/img/logo.svg"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "In this article, we will demonstrate the process of generating an OData feed for MarkLogic data by developing a WCF Service Application.",
        "meta_lang": "en",
        "meta_favicon": "/favicon.ico?v=2",
        "meta_site_name": "CData Software",
        "canonical_link": "https://www.cdata.com/kb/tech/marklogic-ado-odserv.rst",
        "text": "In this article, we will demonstrate the process of generating an OData feed for MarkLogic data by developing a WCF Service Application.\n\nThe CData ADO.NET Provider for MarkLogic enables you to rapidly develop service-oriented applications using the Windows Communication Foundation (WCF) framework, providing MarkLogic data data to OData consumers. This article guides you through creating an entity data model for connectivity and a WCF Data Service to expose OData services. You can then consume the feed with various OData clients, such as Power Pivot or applications using the CData ADO.NET Provider for OData.\n\nCreate the OData Service\n\nFollow the steps below to create a WCF service application that will provide connectivity to MarkLogic data via OData.\n\nOpen Visual Studio and create a new project. Select the WCF Service Application template.\n\nDelete the autogenerated IService.cs and Service1.svc.\n\nInstall Entity Framework 6:\n\nUse the Package Manager Console in Visual Studio to install the latest version of Entity Framework. Run the following command to download and install Entity Framework automatically: Install-Package EntityFramework\n\nRegister the Entity Framework provider:\n\nAdd the following provider entry in the \"providers\" section of your App.config or Web.config file. This section should already exist if the Entity Framework installation was successful. <configuration> ... <entityFramework> <providers> ... <provider invariantName=\"System.Data.CData.MarkLogic\" type=\"System.Data.CData.MarkLogic.MarkLogicProviderServices, System.Data.CData.MarkLogic.Entities.EF6\" /> </providers> </entityFramework> </configuration>\n\nAdd a reference to System.Data.CData.MarkLogic.Entities.dll, located in lib/4.0 in the installation directory.\n\nBuild the project to complete the setup for using EF6.\n\nClick Project -> Add New Item -> ADO.NET Entity Data Model.\n\nIn the Entity Data Model wizard that is displayed, select the 'EF Designer from Database' option.\n\nIn the resulting Choose Your Connection dialog, click New Connection.\n\nIn the Connection properties dialog, select the CData MarkLogic Data Source and enter the necessary credentials.\n\nA typical connection string is below:\n\nUser='myusername';Password='mypassword';Server='http://marklogic';\n\nSet User, Password, and Server to the credentials for the MarkLogic account and the address of the server you want to connect to. You should also specify the REST API Port if you want to use a specific instance of a REST Server.\n\nSelect MarkLogic tables and views that you want OData clients to access.\n\nClick Project -> Add New Item -> WCF Data Service.\n\nSpecify the data source class and configure access to the new WCF Data Service. In the example below, the Access Rule for the entities is set to All. This means that any user will be able to read and modify data.\n\nusing System; using System.Collections.Generic; using System.Data.Services; using System.Data.Services.Common; using System.Linq; using System.ServiceModel.Web; using System.Web; namespace MarkLogicService{ public class MarkLogicDataService : DataService<MarkLogicEntities> { public static void InitializeService(DataServiceConfiguration config) { config.SetEntitySetAccessRule(\"*\", EntitySetRights.All); config.DataServiceBehavior.MaxProtocolVersion = DataServiceProtocolVersion.V3; } } }\n\nRun the project. Applications that support OData can now access the Salesforce data and reflect any changes. You can access the feed in your browser. The feed will resemble the following:\n\nConsume the OData Service from Power Pivot\n\nYou can now use the service from any OData client; for example, Excel Power Pivot.\n\nOpen Excel and click on the Power Pivot Window button.\n\nA new pop-up will appear. Select the option From Data Feeds.\n\nIn the resulting Table Import Wizard, enter the OData URL. For example, http://localhost:12449/MarkLogicDataService.svc/.\n\nAfter connecting to the OData service, click the Next button at the bottom of the window.\n\nA table listing of the available tables will appear in the next window of the wizard. Select which tables you want to import and click Finish.\n\nClick Close to import the data in Power Pivot.\n\nCodeProject"
    }
}