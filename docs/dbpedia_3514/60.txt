The story of Sweeney Todd, the London barber who cuts his customers' throats and has their bodies baked into pies by his Fleet Street neighbour, Mrs Lovett, is one of those gruesome stories we first hear as children. I have no recollection where I first came across this urban legend, though I do remember passing fleapit cinemas in the 1940s that were showing a British B-movie on the subject starring a great barnstorming exponent of Grand Guignol with the splendid name Tod Slaughter. The tale touches on all sorts of fears, including the vulnerability you feel in a barber's chair and, especially, cannibalism.

For his musical Sweeney Todd: The Demon Barber of Fleet Street, Stephen Sondheim drew on a little-known British play of 1973 by Christopher Bond that refined and embellished its Victorian sources. He worked once more with the British writer Hugh Wheeler, who before turning to the theatre had been a prolific author of detective novels under the pseudonym Patrick Quentin. Sondheim is also fascinated with crime and wrote an ingenious movie thriller The Last of Sheila with Anthony Perkins.

The musical was not a great success initially, and in the short-lived 1990 London production that marvellous actor Denis Quilley was too jovial as Sweeney. But it's now rightly regarded as a classic. More or less sung through with the minimum of dialogue, its lyrics are harsh, witty, ironic, its music influenced in part by Kurt Weill and Bernard Herrmann's scores for Hitchcock.

Tim Burton, who dropped the upbeat songs from the 1971 film of Charlie and the Chocolate Factory when he came to make a more sinister version three years ago, has found a perfect subject in Sweeney Todd, and he's working for the fifth time with Johnny Depp, an actor put on earth to play the part. His presence is powerful, his singing clear, dramatic, unembarrassed. The animated opening titles drip with blood, and when the gore starts to flow in Victorian London about half an hour later, it spurts and cascades until the final scene.

The film begins as Sweeney comes up the Thames in a sailing ship, he and his young companion Frank singing 'No place like London', a celebratory song for Frank but for Sweeney a hymn of hatred for the city's squalor and vice. Once ashore, Sweeney tells him the story of Benjamin Barker, a kindly man whose beautiful wife and small daughter are coveted by the evil Judge Turpin (Alan Rickman), and how the wife is destroyed when Barker is framed and transported to Australia.

Now Barker is back, disguised as Sweeney, with vengeance on his mind in a wonderful looking studio-created London, the work of production designer Dante Ferretti and cinematographer Dariusz Wolski. The sets are as splendid as those created by Martin Childs and photographed by Peter Deming in From Hell, the Hughes Brothers' film starring Johnny Depp as a Scotland Yard inspector investigating the Jack the Ripper murders, and they too appear to be influenced by Victorian paintings, especially the school of William Frith and the nocturnes of Atkinson Grimshaw and Whistler.

Depp has a ghoulish appearance, his unnatural pallor recalling his first appearance in a Burton film as the eponymous Edward Scissorhands, who has knives and scissors instead of fingers, which under stress turn from delicate instruments of refinement to weapons of bloody destruction. When Sweeney returns to his old shop, kept for him by the devoted Mrs Lovett (Helen Bonham Carter), he hymns his box of razors with a song that begins, 'These are my friends/ See how they glisten'. Mrs Lovett, a distraught pale-faced beauty with black rings around her bright eyes, wishes to restore him to normal life. But when he kills a blackmailer and she disposes of the body by putting it into the pie, the moral and political dice are cast. His obsessions with avenging the destruction of his family is all-consuming and becomes directed at a whole society. He constructs a special barber's chair to despatch his victims down a chute to the cellar, and it soon becomes an industrial process.

A major consequence is that Mrs Lovett's pies, once unpleasantly tasteless, become the toast of London, selling like hot cakes. The killing and the cannibalism become a metaphor for cut-throat capitalism and the transformation of our fellow human beings into a disposable consumer commodity.

In an extended dream sequence Mrs Lovett creates a light, bright idyllic world where she and Sweeney picnic in the countryside, bathe by the sea, get married and adopt the street orphan Toby as a son. This dream is shattered by the barber's obsession and by the depths to which they have sunk. Bloody retribution, melodramatic but tinged with tragedy, inevitably ensues. Before then there has been a deal of incidental humour and two considerable comic performances of a positively Dickensian kind by Timothy Spall as the creepy Beadle Bamford, sly toady to Judge Turpin (also Dickensian in style), and Sacha Baron Cohen as Pirelli, the phoney Italian barber and peddler of elixirs.

The film is jaunty, beautifully rhythmic in its camera movements and editing, extraordinarily rapid without being obtrusively hasty. Two hours were suddenly over and there I was in the foyer eating a warm meat pie, smiling at what I'd been lured into doing. This is a shocking film, the first musical, I believe, to get an 18 certificate (unless you consider Max Oph√ºls's La Ronde, which was awarded an 'X' back in 1950). But it's ultimately an exhilarating one.