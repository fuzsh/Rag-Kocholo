{
    "id": "dbpedia_2555_3",
    "rank": 58,
    "data": {
        "url": "https://github.com/nianticlabs/manydepth",
        "read_more_link": "",
        "language": "en",
        "title": "supervised depth estimation from short sequences",
        "top_image": "https://repository-images.githubusercontent.com/351760475/90692000-acec-11eb-9c75-4aabdd0996dc",
        "meta_img": "https://repository-images.githubusercontent.com/351760475/90692000-acec-11eb-9c75-4aabdd0996dc",
        "images": [
            "https://github.com/nianticlabs/manydepth/raw/master/assets/video_thumbnail.png",
            "https://github.com/nianticlabs/manydepth/raw/master/assets/cost_volume.jpg",
            "https://github.com/nianticlabs/manydepth/raw/master/assets/baseline.gif",
            "https://github.com/nianticlabs/manydepth/raw/master/assets/ours.gif",
            "https://github.com/nianticlabs/manydepth/raw/master/assets/manydepth_vs_monodepth2.jpg",
            "https://github.com/nianticlabs/manydepth/raw/master/assets/results_table.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "[CVPR 2021] Self-supervised depth estimation from short sequences - nianticlabs/manydepth",
        "meta_lang": "en",
        "meta_favicon": "https://github.com/fluidicon.png",
        "meta_site_name": "GitHub",
        "canonical_link": "https://github.com/nianticlabs/manydepth",
        "text": "Jamie Watson, Oisin Mac Aodha, Victor Prisacariu, Gabriel J. Brostow and Michael Firman – CVPR 2021\n\n[Link to paper]\n\nWe introduce ManyDepth, an adaptive approach to dense depth estimation that can make use of sequence information at test time, when it is available.\n\n✅ Self-supervised: We train from monocular video only. No depths or poses are needed at training or test time.\n\n✅ Good depths from single frames; even better depths from short sequences.\n\n✅ Efficient: Only one forward pass at test time. No test-time optimization needed.\n\n✅ State-of-the-art self-supervised monocular-trained depth estimation on KITTI and CityScapes.\n\nCost volumes are commonly used for estimating depths from multiple input views:\n\nHowever, cost volumes do not easily work with self-supervised training.\n\nIn our paper, we:\n\nIntroduce an adaptive cost volume to deal with unknown scene scales\n\nFix problems with moving objects\n\nIntroduce augmentations to deal with static cameras and start-of-sequence frames\n\nThese contributions enable cost volumes to work with self-supervised training:\n\nWith our contributions, short test-time sequences give better predictions than methods which predict depth from just a single frame.\n\nIf you find our work useful or interesting, please cite our paper:\n\n@inproceedings{watson2021temporal, author = {Jamie Watson and Oisin Mac Aodha and Victor Prisacariu and Gabriel Brostow and Michael Firman}, title = {{The Temporal Opportunist: Self-Supervised Multi-Frame Monocular Depth}}, booktitle = {Computer Vision and Pattern Recognition (CVPR)}, year = {2021} }\n\nOur ManyDepth method outperforms all previous methods in all subsections across most metrics, whether or not the baselines use multiple frames at test time. See our paper for full details.\n\nTo recreate the results from our paper, run:\n\nCUDA_VISIBLE_DEVICES=<your_desired_GPU> \\ python -m manydepth.train \\ --data_path <your_KITTI_path> \\ --log_dir <your_save_path> \\ --model_name <your_model_name>\n\nDepending on the size of your GPU, you may need to set --batch_size to be lower than 12. Additionally you can train a high resolution model by adding --height 320 --width 1024.\n\nFor instructions on downloading the KITTI dataset, see Monodepth2\n\nTo train a CityScapes model, run:\n\nCUDA_VISIBLE_DEVICES=<your_desired_GPU> \\ python -m manydepth.train \\ --data_path <your_preprocessed_cityscapes_path> \\ --log_dir <your_save_path> \\ --model_name <your_model_name> \\ --dataset cityscapes_preprocessed \\ --split cityscapes_preprocessed \\ --freeze_teacher_epoch 5 \\ --height 192 --width 512\n\nNote here the --freeze_teacher_epoch 5 command - we found this to be important for Cityscapes models, due to the large number of images in the training set.\n\nThis assumes you have already preprocessed the CityScapes dataset using SfMLearner's prepare_train_data.py script. We used the following command:\n\npython prepare_train_data.py \\ --img_height 512 \\ --img_width 1024 \\ --dataset_dir <path_to_downloaded_cityscapes_data> \\ --dataset_name cityscapes \\ --dump_root <your_preprocessed_cityscapes_path> \\ --seq_length 3 \\ --num_threads 8\n\nNote that while we use the --img_height 512 flag, the prepare_train_data.py script will save images which are 1024x384 as it also crops off the bottom portion of the image. You could probably save disk space without a loss of accuracy by preprocessing with --img_height 256 --img_width 512 (to create 512x192 images), but this isn't what we did for our experiments.\n\nYou can download weights for some pretrained models here:\n\nKITTI MR (640x192)\n\nKITTI HR (1024x320)\n\nCityScapes (512x192)\n\nTo evaluate a model on KITTI, run:\n\nCUDA_VISIBLE_DEVICES=<your_desired_GPU> \\ python -m manydepth.evaluate_depth \\ --data_path <your_KITTI_path> \\ --load_weights_folder <your_model_path> --eval_mono\n\nMake sure you have first run export_gt_depth.py to extract ground truth files.\n\nAnd to evaluate a model on Cityscapes, run:\n\nCUDA_VISIBLE_DEVICES=<your_desired_GPU> \\ python -m manydepth.evaluate_depth \\ --data_path <your_cityscapes_path> \\ --load_weights_folder <your_model_path> --eval_mono \\ --eval_split cityscapes\n\nDuring evaluation, we crop and evaluate on the middle 50% of the images.\n\nWe provide ground truth depth files HERE, which were converted from pixel disparities using intrinsics and the known baseline. Download this and unzip into splits/cityscapes.\n\nIf you want to evaluate a teacher network (i.e. the monocular network used for consistency loss), then add the flag --eval_teacher. This will load the weights of mono_encoder.pth and mono_depth.pth, which are provided for our KITTI models.\n\nWe provide some sample code in test_simple.py which demonstrates multi-frame inference. This predicts depth for a sequence of two images cropped from a dashcam video. Prediction also requires an estimate of the intrinsics matrix, in json format. For the provided test images, we have estimated the intrinsics to be equivalent to those of the KITTI dataset. Note that the intrinsics provided in the json file are expected to be in normalised coordinates.\n\nDownload and unzip model weights from one of the links above, and then run the following command:\n\npython -m manydepth.test_simple \\ --target_image_path assets/test_sequence_target.jpg \\ --source_image_path assets/test_sequence_source.jpg \\ --intrinsics_json_path assets/test_sequence_intrinsics.json \\ --model_path path/to/weights\n\nA predicted depth map rendering will be saved to assets/test_sequence_target_disp.jpeg."
    }
}