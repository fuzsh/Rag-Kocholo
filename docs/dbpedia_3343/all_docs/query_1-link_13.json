{
    "id": "dbpedia_3343_1",
    "rank": 13,
    "data": {
        "url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10888887/",
        "read_more_link": "",
        "language": "en",
        "title": "Scalable nonparametric clustering with unified marker gene selection for single-cell RNA-seq data",
        "top_image": "https://www.ncbi.nlm.nih.gov/corehtml/pmc/pmcgifs/pmc-card-share.jpg?_=0",
        "meta_img": "https://www.ncbi.nlm.nih.gov/corehtml/pmc/pmcgifs/pmc-card-share.jpg?_=0",
        "images": [
            "https://www.ncbi.nlm.nih.gov/coreutils/uswds/img/favicons/favicon-57.png",
            "https://www.ncbi.nlm.nih.gov/coreutils/uswds/img/icon-dot-gov.svg",
            "https://www.ncbi.nlm.nih.gov/coreutils/uswds/img/icon-https.svg",
            "https://www.ncbi.nlm.nih.gov/coreutils/nwds/img/logos/AgencyLogo.svg",
            "https://www.ncbi.nlm.nih.gov/corehtml/pmc/pmcgifs/logo-preprints.png",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10888887/bin/nihpp-2024.02.11.579839v1-f0001.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10888887/bin/nihpp-2024.02.11.579839v1-f0002.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10888887/bin/nihpp-2024.02.11.579839v1-f0003.jpg"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "Chibuikem Nwizu",
            "Madeline Hughes",
            "Michelle L. Ramseier",
            "Andrew W. Navia",
            "Alex K. Shalek",
            "Nicolo Fusi",
            "Srivatsan Raghavan",
            "Peter S. Winter",
            "Ava P. Amini",
            "Lorin Crawford"
        ],
        "publish_date": null,
        "summary": "",
        "meta_description": "Clustering is commonly used in single-cell RNA-sequencing (scRNA-seq) pipelines to characterize cellular heterogeneity. However, current methods face two main limitations. First, they require user-specified heuristics which add time and complexity to ...",
        "meta_lang": "en",
        "meta_favicon": "https://www.ncbi.nlm.nih.gov/coreutils/nwds/img/favicons/favicon.ico",
        "meta_site_name": "PubMed Central (PMC)",
        "canonical_link": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10888887/",
        "text": "Version 1. bioRxiv. Preprint. 2024 Feb 12.\n\nPMCID: PMC10888887\n\nPMID: 38405697\n\nThis is a preprint.\n\nIt has not yet been peer reviewed by a journal.\n\nThe National Library of Medicine is running a pilot to include preprints that result from research funded by NIH in PMC and PubMed.\n\nScalable nonparametric clustering with unified marker gene selection for single-cell RNA-seq data\n\n,1,2 ,3 ,4,5 ,4,5,6,7,8 ,4,5,6,7,9,10 ,3 ,5,8,9,11,§ ,5,8,§ ,3,§† and 1,3,12,§†\n\nChibuikem Nwizu\n\n1Center for Computational Molecular Biology, Brown University, Providence, RI, USA\n\n2Warren Alpert Medical School of Brown University, Providence, RI, USA\n\nFind articles by Chibuikem Nwizu\n\nMadeline Hughes\n\n3Microsoft Research, Cambridge, MA, USA\n\nFind articles by Madeline Hughes\n\nMichelle L. Ramseier\n\n4Institute for Medical Engineering and Science, Massachusetts Institute of Technology, Cambridge, MA, USA\n\n5Broad Institute of MIT and Harvard, Cambridge, MA, USA\n\nFind articles by Michelle L. Ramseier\n\nAndrew W. Navia\n\n4Institute for Medical Engineering and Science, Massachusetts Institute of Technology, Cambridge, MA, USA\n\n5Broad Institute of MIT and Harvard, Cambridge, MA, USA\n\n6Koch Institute for Integrative Cancer Research, Massachusetts Institute of Technology, Cambridge, MA, USA\n\n7Department of Chemistry, Massachusetts Institute of Technology, Cambridge, MA, USA\n\n8Department of Medical Oncology, Dana-Farber Cancer Institute, Boston, MA, USA\n\nFind articles by Andrew W. Navia\n\nAlex K. Shalek\n\n4Institute for Medical Engineering and Science, Massachusetts Institute of Technology, Cambridge, MA, USA\n\n5Broad Institute of MIT and Harvard, Cambridge, MA, USA\n\n6Koch Institute for Integrative Cancer Research, Massachusetts Institute of Technology, Cambridge, MA, USA\n\n7Department of Chemistry, Massachusetts Institute of Technology, Cambridge, MA, USA\n\n9Harvard Medical School, Boston, MA, USA\n\n10Ragon Institute of MGH, MIT, and Harvard, Cambridge, MA, USA\n\nFind articles by Alex K. Shalek\n\nNicolo Fusi\n\n3Microsoft Research, Cambridge, MA, USA\n\nFind articles by Nicolo Fusi\n\nSrivatsan Raghavan\n\n5Broad Institute of MIT and Harvard, Cambridge, MA, USA\n\n8Department of Medical Oncology, Dana-Farber Cancer Institute, Boston, MA, USA\n\n9Harvard Medical School, Boston, MA, USA\n\n11Department of Medicine, Brigham and Women’s Hospital, Boston, MA, USA\n\nFind articles by Srivatsan Raghavan\n\nPeter S. Winter\n\n5Broad Institute of MIT and Harvard, Cambridge, MA, USA\n\n8Department of Medical Oncology, Dana-Farber Cancer Institute, Boston, MA, USA\n\nFind articles by Peter S. Winter\n\nAva P. Amini\n\n3Microsoft Research, Cambridge, MA, USA\n\nFind articles by Ava P. Amini\n\nLorin Crawford\n\n1Center for Computational Molecular Biology, Brown University, Providence, RI, USA\n\n3Microsoft Research, Cambridge, MA, USA\n\n12Department of Biostatistics, Brown University, Providence, RI, USA\n\nFind articles by Lorin Crawford\n\n1Center for Computational Molecular Biology, Brown University, Providence, RI, USA\n\n2Warren Alpert Medical School of Brown University, Providence, RI, USA\n\n3Microsoft Research, Cambridge, MA, USA\n\n4Institute for Medical Engineering and Science, Massachusetts Institute of Technology, Cambridge, MA, USA\n\n5Broad Institute of MIT and Harvard, Cambridge, MA, USA\n\n6Koch Institute for Integrative Cancer Research, Massachusetts Institute of Technology, Cambridge, MA, USA\n\n7Department of Chemistry, Massachusetts Institute of Technology, Cambridge, MA, USA\n\n8Department of Medical Oncology, Dana-Farber Cancer Institute, Boston, MA, USA\n\n9Harvard Medical School, Boston, MA, USA\n\n10Ragon Institute of MGH, MIT, and Harvard, Cambridge, MA, USA\n\n11Department of Medicine, Brigham and Women’s Hospital, Boston, MA, USA\n\n12Department of Biostatistics, Brown University, Providence, RI, USA\n\n§Authors Contributed Equally\n\nContributed by\n\nAuthor contributions\n\nCN, APA, and LC conceived the study and developed the methods. CN and MH developed the algorithm and software. CN, MH, and MR led the analyses. SR, PSW, APA, and LC provided resources, supervised the project, and conducted secondary analyses. All authors interpreted the results and wrote and revised the manuscript.\n\nThis work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License, which allows reusers to distribute, remix, adapt, and build upon the material in any medium or format for noncommercial purposes only, and only so long as attribution is given to the creator.\n\nAssociated Data\n\nSupplementary Materials\n\nmedia-1.pdf (8.9M)\n\nGUID: 164A1C23-7D24-4073-B010-87824E160C83\n\nmedia-2.xlsx (47K)\n\nGUID: D0971ACE-4020-4B68-82FD-3F93D52FCF36\n\nmedia-3.xlsx (4.9M)\n\nGUID: A55C14FF-3853-4C94-98CE-6C0164175E9C\n\nmedia-4.xlsx (60K)\n\nGUID: 7B2F76B4-D55D-44EB-9D82-A17FFDD8D1FF\n\nmedia-5.xlsx (708K)\n\nGUID: 35CF8B78-596B-4872-80EA-81684E813F32\n\nData Availability Statement\n\nAll of the datasets analyzed in this paper are publicly available. The BRAIN-LARGE dataset can be accessed at https://www.10xgenomics.com/datasets/1-3-million-brain-cells-from-e-18-mice-2-standard-1-3-0. The individual PBMC data from Zheng et al.45 can be downloaded directly from https://www.10xgenomics.com/resources/datasets. Lastly, the immune cell atlas dataset can be accessed at https://cellgeni.cog.sanger.ac.uk/pan-immune/CountAdded_PIP_global_object_for_cellxgene.h5ad.\n\nAbstract\n\nClustering is commonly used in single-cell RNA-sequencing (scRNA-seq) pipelines to characterize cellular heterogeneity. However, current methods face two main limitations. First, they require user-specified heuristics which add time and complexity to bioinformatic workflows; second, they rely on post-selective differential expression analyses to identify marker genes driving cluster differences, which has been shown to be subject to inflated false discovery rates. We address these challenges by introducing nonparametric clustering of single-cell populations (NCLUSION): an infinite mixture model that leverages Bayesian sparse priors to identify marker genes while simultaneously performing clustering on single-cell expression data. NCLUSION uses a scalable variational inference algorithm to perform these analyses on datasets with up to millions of cells. By analyzing publicly available scRNA-seq studies, we demonstrate that NCLUSION (i) matches the performance of other state-of-the-art clustering techniques with significantly reduced runtime and (ii) provides statistically robust and biologically relevant transcriptomic signatures for each of the clusters it identifies. Overall, NCLUSION represents a reliable hypothesis-generating tool for understanding patterns of expression variation present in single-cell populations.\n\nIntroduction\n\nRecent advances in sequencing technologies have increased the throughput of genomic studies to millions of single cells, necessitating computational workflows to explore and analyze these data1. In single-cell RNA sequencing (scRNA-seq), unsupervised clustering and marker gene selection are integral steps in the exploratory phase of analysis2–5. Clustering facilitates the identification of cell types, while marker gene selection enables the annotation of gene modules and cluster-specific biological programs. However, there has yet to be a consensus on the best approach to clustering cells and identifying the transcriptomic signatures that characterize them6,7. This has resulted in a multitude of proposed clustering methods for single-cell data, many of which are reliant on various user-defined heuristics that prevent practitioners from performing an unbiased survey of data and limit each method’s “out-of-the-box” applicability when analyzing multiple studies.\n\nMany current clustering approaches take a subset of highly variable genes as input, use dimensionality reduction techniques to simplify the representation of single-cell expression for these genes, and then perform clustering on top of this reduced representation. K-nearest neighbor (KNN) algorithms8, for example, generate nearest-neighbor (NN) graphs using transcriptomic similarity scores between cells and then perform Louvain clustering on the estimated graphs. Popular methods such as Seurat9 and scLCA10 use principal component analysis (PCA) and singular value decomposition to learn a lower-dimensional representation of cells, respectively. Ensemble approaches such as scCCESS-SIMLR11 learn over a mixture of kernels to generate a final cell-cell similarity matrix which is then used in a spectral clustering algorithm.\n\nHowever, selecting an appropriate embedding for single-cell data is not always a straightforward task. Previous studies have shown that if the generated lower-dimensional representation does not accurately capture underlying biological relationships between cells, then both the quality of clustering and the generalizability of findings in downstream analyses can be compromised12,13. Factors such as the number of highly variable genes retained during data preprocessing and the number of components used to define the lower-dimensional embedding can affect the ability of a clustering algorithm to identify fine-grained differences between cell types7,14. Furthermore, nearly all state-of-the-art clustering methods require users to specify the number of clusters K to be used in the algorithm. Strategies such as consensus-finding11,15, outlier detection16, and iterative cluster merging and splitting17–19 rely on human-in-the-loop interactive steps within their algorithms to determine an “optimal” choice for K. Generally, requiring users to make these additional decisions adds significant time and complexity when using clustering as a preliminary analysis in bioinformatic workflows.\n\nPerhaps the biggest limitation of current single-cell clustering algorithms is that most do not identify top marker genes that are driving the inference of different biologically significant clusters; instead, they use post-selective inference to find genes that are differentially expressed between the inferred cell groups7,20. Since the point of clustering algorithms is to separate dissimilar data into different groups, it is expected a priori that there are differences between the groups and any test statistics computed by comparing the groups are likely to be inflated due to “data double dipping”. Many studies have shown that performing this post-selective inference uncorrected can lead to inflated type I error rates20,21. Though there has been work developed to correct for post-selection, these are still in nascency, and most do not yet scale to high-dimensional settings22–26. Recently, others have proposed unified frameworks for simultaneous clustering and marker gene selection using hierarchical tree-based algorithms27, regularized copula models28, and post hoc sensitivity measures29. However, these approaches rely on arbitrary thresholding to find “significant” marker genes and fail to theoretically test a well-defined null hypothesis, making them difficult to biologically interpret.\n\nWe present “Nonparametric CLustering of SIngle-cell populatiONs” (NCLUSION): a unified Bayesian nonparametric framework that simultaneously performs clustering and marker gene selection. NCLUSION works directly on normalized single-cell count data, bypassing the need to perform dimensionality reduction. By modeling the expression of each gene as a sparse hierarchical Dirichlet process normal mixture model30–35, NCLUSION both learns the optimal number of clusters based on the variation observed between cellular expression profiles and uses sparse prior distributions to identify genes that significantly influence cluster definitions. The key to our proposed integrative framework is that clustering and extracting marker genes concurrently is a more efficient approach to the exploratory analysis of scRNA-seq data, as it effectively allows each process to inform the other. Most importantly, our approach eliminates the need for human-in-the-loop decisions, significantly reducing the runtime and complexity of these analyses. Altogether, NCLUSION mitigates the need for heuristic choices (e.g., choosing specific lower-dimensional embeddings), avoids iterative hyper-parameter optimization, bridges the interpretability gap suffered by many unsupervised learning algorithms in single-cell applications, and scales to accommodate the growing sizes of emerging scRNA-seq datasets.\n\nResults\n\nNCLUSION simplifies traditional clustering workflows\n\nConventional scRNA-seq clustering approaches include numerous steps that require user heuristics or human-in-the-loop decisions which increase runtime and complexity ( ). These can range from deciding how to optimally embed high-dimensional expression data into a lower-dimensional space to selecting the number of clusters, K, to identify in the data. Furthermore, current methods require that marker gene selection is performed post-clustering, which can lead to inflated rates of false discovery20,21. In this work, we aim to address these challenges using a new approach: NCLUSION.\n\nNCLUSION leverages a Bayesian nonparametric mixture modeling framework to reduce the number of choices that users need to make while simultaneously performing variable selection to identify top cluster-specific marker genes for downstream analyses ( ; see Methods for details). There are three key components of our model formulation that distinguish it from traditional bioinformatic workflows. First, NCLUSION is fit directly on single-cell expression matrices and does not require the data to be embedded within a lower-dimensional space. Second, we implicitly assume a priori that cells can belong to one of infinitely many different clusters. This is captured by placing a Dirichlet process prior over the cluster assignment probabilities for each cell. By always setting the number of possible clusters K = ∞, we remove the need for users to iterate through different values until they find the optimal choice. Third, NCLUSION assumes that not all genes are important when assigning cells to a given cluster. To model this, we place a spike and slab prior on the mean expression of each gene within each cluster. This prior shrinks the mean of genes that play an insignificant role in cluster formation towards zero.\n\nTo identify cluster-specific marker genes, we start by estimating posterior inclusion probabilities (PIPs), which represent our confidence that a gene’s mean expression within a cluster is nonzero. These PIPs act as a signature that can be used to distinguish clusters. Since NCLUSION fits each gene and cell independently, signatures learned between clusters can share the same subsets of genes. To select for unique cell type markers, we multiply each PIP with a usage weight, which is calculated by performing min-max normalization over the proportion of clusters in which a gene is determined to be statistically significant (i.e., using the median probability model threshold36 PIP ≥ 0.5). We use these adjusted inclusion probabilities with the effect size sign (ESS) of each gene to filter for significant genes that are also up-regulated (indicated by positive ESS values). The genes remaining after filtering make up cluster-specific marker gene modules that provide insight into the biological features underlying cluster assignments.\n\nTo enable efficient posterior inference that can scale as the size of scRNA-seq datasets continues to grow, we train NCLUSION using variational expectation-maximization (EM). This algorithm leverages a “mean-field” assumption to approximate the true posterior distribution over model parameter estimates with a product of simpler distributions37–39. In training, our objective is to minimize the Kullback–Leibler (KL) divergence between the variational posterior and the true posterior40. Optimization during model fitting occurs using a coordinate ascent procedure where parameters are sequentially updated based on their gradients (Methods and Supplementary Material). With this variational approach, NCLUSION is capable of scaling well up to 1 million cells without applying any dimensionality reduction to the input data.\n\nWe evaluated NCLUSION against a set of state-of-the-art single-cell clustering methods using publicly available datasets. The methods we used for comparison include: Seurat9, scLCA10, k-nearest neighbors followed by the Leiden clustering algorithm (KNN+Leiden)41, SOUP42, and scCCESS-SIMLR11. Each of these methods operates by first reducing the dimensionality of the input data and then performing clustering on the reduced representation. To the best of our knowledge, NCLUSION is the only method to date that clusters on the expression matrix directly while jointly identifying cluster-specific salient genes. NCLUSION does not incur additional runtime cost due to this model design choice. In fact, NCLUSION boasts a faster runtime compared to other methods, particularly as the number of cells in a dataset grows. We showcase this scalability on the BRAIN-LARGE43 dataset ( ). To facilitate comparison across all baseline methods, we follow Lopez et al.14 and limit the analysis to 720 genes, while sub-sampling the number of cells from 500 to 1 million cells. As a practical reference, we use a grey dotted line to highlight the runtime for each method at the median scRNA-seq dataset size as determined in 2020: 31,000 cells44. We observed that only NCLUSION and KNN+Leiden were able to scale past 100,000 cells, while NCLUSION was the only method able to run on 1 million cells. Additionally, NCLUSION records competitive runtimes across varying numbers of genes (Supplementary Figure 1). These scalability results show the potential of NCLUSION’s utility for emerging large-scale single-cell studies.\n\nNCLUSION achieves competitive clustering performance with less runtime\n\nNext, we assessed the quality of clustering done by NCLUSION as compared to other baseline approaches. Clustering is done as a step to ensure accurate annotation of cell types during the exploratory analysis of new single-cell data sets. Here, we tested each model on scRNA-seq from FACS-purified peripheral blood mononuclear cells (PBMC)45. This dataset captures 10 cellular populations including CD14+ monocytes, CD34+ cells, and major lymphoid lineages (B and T cells), as well as other phenotypic lineages within the T cell population, including CD4+ helper T cells, CD8+ cytotoxic T cells, CD4+ regulatory T cells, and CD4+ memory T cells. After quality control (Methods), the final dataset contained 94,615 cells and 5,000 genes with the highest standard deviation (post log-normalization)20,46. We evaluated the performance of each clustering algorithm by comparing inferred cluster assignments to the cell type annotations from the original study, which were obtained via a combination of FACS analysis and clustering with Seurat45 ( – ).\n\nTo qualitatively assess clustering performance, we used contingency heat maps to evaluate how well each method captured the unique cell types across clusters ( ). For a given method, each i-th row of the heat map represents an annotation from the original study and each k-th column represents an inferred cluster identified by the method. The color saturation of each (i,k)-th element in the heat map indicates the fraction of a i-th cell annotation that a given method assigned to the k-th inferred cluster. Overall, all baselines were able to distinguish the B cell population from other cells, and each approach uniquely clustered a majority of the CD14+ monocytes together ( ). Furthermore, all methods except scCCESS-SIMLR were able to separate the natural killer (NK) cell population with an inferred cluster occupancy rate of greater than 75% (Supplementary Table 1). NCLUSION’s performance was most similar to that of Seurat (χ2-test P = 0.99 when assessing independence between their contingency tables). Both methods were able to identify major PBMC cell lineages and were the only approaches to divide the B cell, cytotoxic CD8+ T cells, and regulatory T cells into sub-populations47 ( ).\n\nAs a quantitative assessment of each method’s clustering performance, we used the FACS-derived experimental annotations as reference labels and calculated three validation metrics, each of which measures how much variation and sample diversity a clustering algorithm can explain from the data (Methods): the Jaccard similarity coefficient, the Gini-Simpson index, and McIntosh evenness, where values closer to 1 indicate better clustering performance. To assess the robustness and consistency of each method, we ran them on five different randomly subsampled partitions containing 80% of the cells in the dataset. We report the mean metric score for each clustering algorithm across these partitions, along with corresponding 95% confidence intervals ( ). NCLUSION’s performance consistently fell within the top three among all competing approaches. NCLUSION obtained the highest mean Jaccard coefficient of 0.72 (±8.91 × 10−3 standard deviation), with Seurat and scLCA each scoring lower values of 0.71 (±1.62 × 10−3 and ±1.48 × 10−2, respectively). When comparing performance using the Gini-Simpson index and McIntosh evenness measure, NCLUSION remained competitive with the other competing methods. Specifically, NCLUSION obtained a mean Gini-Simpson index of 0.84 (±3.87 × 10−3), within range of scLCA (0.86 ±2.20×10−2). NCLUSION also obtained the third highest McIntosh evenness score of 0.82 (±1.05×10−2), with only Seurat and scLCA scoring higher values of 0.88 (±8.23×10−3) and 0.96 (±2.12 × 10−2), respectively. Importantly, we found no statistically significant differences when comparing the median performance of NCLUSION to the other approaches (Kruskal–Wallis H-test P > 0.95 for all three metrics; Supplementary Table 1). Lastly, NCLUSION recorded the shortest runtime for this analysis without any iterative processes or optimization of hyperparameters. It finished approximately 254 seconds (4.23 minutes) faster than Seurat, more than 12900 seconds (215.00 mins or 3.58 hrs) faster than scLCA, and more than 41331 seconds (688.85 mins or 11.48 hrs) faster than scCCESS-SIMLR.\n\nNCLUSION automatically identifies cell type-specific marker genes\n\nThe key distinguishing property of NCLUSION is its inherent ability to perform variable selection. NCLUSION thus provides users with cluster labels for each cell as well as unique gene signatures that define each cluster. The statistical model underlying NCLUSION selects cluster-specific marker genes based on two criteria: (i) an adjusted posterior inclusion probability, PIP(j;k), which provides evidence that the j-th gene’s mean expression is uniquely nonzero within the k-th cluster and (ii) the sign of the j-th gene’s effect, ESS(j;k), which is used to determine whether it is uniquely up-regulated or down-regulated within the k-th cluster (Methods). We assessed the marker genes identified by NCLUSION for each of the inferred clusters in the PBMC dataset to determine whether they provide insights into the biology of different cell types ( – ).\n\nOverall, NCLUSION successfully identified cluster-specific marker genes that are known to be associated with examined cell types ( and Supplementary Table 2). For example, in clusters of cells mapping back to the T cell population, we observed that NCLUSION correctly identified marker genes known to play an important role in T cell biology, such as CD8A (PIP = 0.538), CD8B (PIP = 0.615)48, and CD40LG (PIP = 0.615)49. Furthermore, genes associated with cytotoxicity, such as GZMB (PIP = 0.692), tended to be selected in clusters largely containing CD8+ T cells and NK cells – two cell types that have been shown to have functionally similar cytotoxic activity50. In other clusters, where we observed genes associated with both B cells (e.g., CD19, PIP = 0.923; LINC00926, PIP = 0.923 MS4A1, PIP = 0.846)51–53 and myeloid lineages (e.g., MS4A6A, PIP = 0.846; S100A8, PIP 0.846; LYZ, PIP = 0.692)54, NCLUSION distinguished genes known to play an important role in T cell biology as statistically insignificant. This observation suggests that NCLUSION accounted for the variance among T cell and T cell-like expression patterns when distinguishing cell types in the PBMC dataset. We observed that our criteria for cluster-specific marker genes, based on high PIPs and positive ESS scores, strongly agreed with the relative over-expression of each gene in its respective cluster ( ).\n\nTo further evaluate marker gene quality, we computed gene module scores in order to compare the normalized expression for signature genes across clusters ( ). Here, we find that each module exhibits the highest expression within its respective cluster, with the most definitive signatures occurring within the B (inferred cluster 1), NK (inferred cluster 2), monocytic (inferred cluster 3), and CD34+ cells (inferred cluster 4) ( and Supplementary Figure 2). In clusters that contained heterogeneous combinations of T cell sub-populations, we still see an increased relative expression among cluster-specific marker genes, although not as distinct as in the other cell types.\n\nAs an additional analysis, we compared the similarity between the marker genes identified by NCLUSION with the list of marker genes that are identified by using a post hoc differential expression analysis with Seurat. Here, we took the FACS-derived experimental annotations from Zheng et al.45 and found differentially expressed genes by doing a one-versus-all Wilcoxon rank sum test for each cluster (mirroring the typical procedure in a conventional bioinformatic workflow). As expected, this post-selective inference procedure resulted in Seurat identifying a multitude of candidate marker genes for each cell type, even after Bonferroni correction. A direct comparison between NCLUSION and Seurat showed that the proposed Bayesian variable selection approach in the NCLUSION framework results in smaller and more refined transcriptomic signatures for downstream investigation ( and Supplementary Figures 3–12). For example, NCLUSION identified 32 cluster-specific marker genes for NK cells, 99% of which were also included in the 1,780 marker genes selected post hoc by Seurat. In total, an average of 98% of the marker genes identified by NCLUSION were included in the much larger sets of differentially expressed genes selected by Seurat across each of the FACS-annotated cell types.\n\nOver-representation analysis using gene product annotations in Gene Ontology (GO) further confirmed that the selective set of gene modules inferred by NCLUSION reflect known immune cell biology55–57 ( – and Supplementary Figures 13–24). For example, in the cluster containing predominantly B cells (inferred cluster 1), we observed an up-regulation of B cell receptor signaling (q-value = 7.21×10−15), B cell activation (q-value = 2.62×10−11), and antigen receptor-mediated signaling (q-value = 2.11×10−8)58,59. Notably, some of the biologically relevant GO terms found when using NCLUSION were not statistically significant when applying the larger sets of marker genes provided post hoc by Seurat. For instance, in the cluster with NK cells (inferred cluster 2), significant gene sets from NCLUSION included the positive regulation of lymphocyte chemotaxis (q-value = 2.80×10−6) and positive regulation of natural killer cell chemotaxis (q-value = 4.80×10−6)60–62. We also observed enrichment of the up-regulation of natural killer cell mediated cytotoxicity (q-value = 1.47×10−5), consistent with the known highly cytotoxic behavior of NK cells60,63. Each of these gene sets was insignificant when using differentially expressed genes from Seurat ( ). Lastly, in the monocyte dominated cluster (inferred cluster 3), the NCLUSION-generated module was enriched for both the lipopolysaccharide-mediated signaling pathway (q-value = 2.59×10−4) and tumor necrosis factor production (q-value = 2.89×10−4), two processes known to be associated with monocyte/macrophage-specific inflammatory responses64,65. Complete marker gene and GO analyses for all clusters inferred by NCLUSION and Seurat as a baseline in the PBMC dataset can be found in Supplementary Table 2. Together, these results demonstrate that NCLUSION can identify cluster-specific gene signatures that reflect underlying cellular phenotypes.\n\nNCLUSION generalizes to the Tissue Immune Atlas\n\nNext, we assessed the generalizability of NCLUSION by testing it on an additional scRNA-seq study: the tissue immune (IMMUNE) atlas dataset, which contains healthy white blood cells taken from different anatomical locations from multiple donors66. After extracting data from a single donor and performing quality control (Methods), we had a total of 88,057 cells and 5,000 genes with the highest standard deviation (post log-normalization) for the analysis.\n\nOnce again, we quantitatively evaluated the clustering performance of NCLUSION and the competing baselines using the annotations provided by the original study (Supplementary Figures 25–26). NCLUSION maintains competitive clustering performance as measured by Jaccard similarity, Gini-Simpson index, and McIntosh evenness, with all methods showing a similar median performance (Kruskal–Wallis H-test P > 0.80 for all three metrics) (Supplementary Figure 27 and Supplementary Table 3). Next, we analyzed the interpretability of the cluster-specific marker genes inferred by NCLUSION (Supplementary Figures 28–32 and Supplementary Table 4). Examination of the cluster structure between both the annotations provided by the original study and the clusters inferred by NCLUSION showed that NCLUSION primarily groups cells based on their hematopoietic lineage, inferring fewer clusters that broadly capture B, Plasma, cytotoxic T, non-cytotoxic T, and myeloid cell lineages. Here, we continued to observe the general pattern of genes with significant PIPs also being up-regulated in the same inferred cluster; however, this relationship was not exclusive as genes with high PIPs could also be significantly under-expressed (Supplementary Figures 28–29).\n\nBy again selecting cluster-specific marker genes to be those with both PIPs above the median probability model threshold and positive ESS, normalized gene module scores revealed increased expression of marker genes in corresponding and related clusters (Supplementary Figure 31). Similar to the PBMC analysis, NCLUSION appeared to use the variance among Macrophage-like and T cell-like expression patterns as a main factor in distinguishing cell types in the IMMUNE dataset. Cluster 1 primarily contained cells labeled as alveolar macrophages. Genes relevant to both macrophage biology, such as SLC8A1 (PIP = 0.5), and alveolar immune biology, such as TPSB2 (PIP = 0.749) and TPSB2 (PIP = 0.750), were selected in this cluster67,68. GO analysis in Cluster 1 revealed an enrichment in macrophage-related pathways (e.g., positive regulation of monocyte chemotaxis, q-value = 1.15×10−2; regulation of lipopolysaccharide-mediated signaling pathway, q-value = 1.24×10−2). In addition, we observed enrichment of processes related to the regulation of macrophage-derived foam cell differentiation, consistent with prior reports on alveolar macrophages67,69. Conversely, cells with T cell-like expression patterns were found predominantly in clusters 2, 8, and 9 (Supplementary Figure 25). Clusters 2 and 8 showed an up-regulation in salient cytotoxic T and NK cell marker genes such as KLRC1 (PIP = 0.625), KLRC2 (PIP = 0.5), and KLRC3 (PIP = 0.5) and were enriched for multiple T and NK cell cytotoxic behavior-related pathways (Supplementary Table 4). Lastly, cluster 9 contained over-expressed non-cytotoxic T cell markers such as CD40L (PIP = 0.5) and LEF1 (PIP = 0.5)70,71, and was enriched for GO processes such as T-helper 1 cell differentiation (q-value = 2.17×10−2) and T-helper 17 type immune response (q-value = 2.74×10−2).\n\nDiscussion\n\nWe present NCLUSION: a scalable Bayesian nonparametric framework designed to serve as an unbiased method for inferring phenotypic clusters and identifying cluster-specific marker genes in scRNA-seq experiments. We show how our approach simplifies traditional single-cell workflows, which often rely on the transformation of the data to a lower-dimensional representation to facilitate clustering and iteratively tune the number of clusters used to obtain optimal results. In contrast, NCLUSION operates on the full normalized gene expression matrix, eliminating the need for transformation to a lower-dimensional space; infers the optimal number of clusters without iterative user refinement; and simultaneously identifies cluster-specific marker genes that significantly drive the clustering. Notably, by leveraging a variational inference algorithm, NCLUSION can scale to scRNA-seq studies with a million cells. Through the analysis of a collection of large-scale publicly available datasets, we show that NCLUSION not only achieves clustering performance comparable to state-of-the-art methods but also provides refined sets of gene candidates for downstream analyses. By unifying clustering and marker gene selection, NCLUSION provides a flexible and unified statistical framework for inferring complex differential gene expression patterns observed in heterogeneous tissue populations21,72,73.\n\nThe current implementation of the NCLUSION framework offers many directions for future development and applications. First, the current formulation of NCLUSION models the gene expression of each cell independently and does not consider, for example, the correlation between genes with similar functionality or co-expression patterns between genes within the same signaling pathway. One possible extension of NCLUSION would be to incorporate additional genomic information into the sparse prior distributions used for Bayesian variable selection. For example, previous studies have proposed an integrative approach where the importance of a variable also depends on an additional set of covariates38,74,75. In the case of single-cell applications, we could assume that the prior probability of the j-th gene being a marker of the k-th cluster is also dependent upon its cellular pathway membership. Unlike the current spike-and-slab prior NCLUSION implements, this new prior would assume that biologically related pathways contain shared marker genes, essentially integrating the concept of gene set enrichment analysis into clustering. Second, although it helps NCLUSION scale to large datasets, variational expectation-maximization (EM) algorithms are known to both produce slightly miscalibrated parameter estimates and underestimate the total variation present within a dataset39,76,77. While this does not greatly affect the performance of NCLUSION in the evaluations presented in this paper, this can be seen as a limitation depending on the application of interest. For example, in the PBMC dataset, NCLUSION is unable to resolve all the different T cell subtypes that were annotated by Zheng et al.45 (e.g., ). This is most likely due to variational approximations being well-suited to describe the global variation across cells but at the cost of smoothing over local variation between smaller subpopulations. Considering other (equally scalable) ways to carry out approximate Bayesian inference may be relevant for future work78. Lastly, a thrust of recent work in genomics has been to develop methods that identify spatially variable marker genes as a key step during analyses of spatially-resolved transcriptomics data79. Future efforts could extend NCLUSION to this emerging modality by, for example, reformulating the method as a spatial Dirichlet process mixture model80.\n\nIn sum, NCLUSION provides a unified framework for simultaneous clustering and marker gene selection in single-cell transcriptomic data, yielding improvements in computational efficiency, interpretability, and scalability. We envision that NCLUSION will accelerate key analytic steps universal to single-cell analysis across diverse applications.\n\nOnline Methods\n\nOverview of NCLUSION\n\nWe provide a brief overview of the probabilistic framework underlying the “Nonparametric CLUstering of SIngle-cell populatiONs” (NCLUSION) model. Detailed derivations of the algorithm are provided in the Supplementary Material. Consider a study with single-cell RNA sequencing (scRNA-seq) expression data for i = 1,…,N cells that each have measurements for j = 1,…,G genes. Let this dataset be represented by the N × G matrix X where the row-vector xi = (xi1,…,xiG) denotes the expression profile for the i-th cell. We assume that the log-normalized gene expression for each cell follows a sparse hierarchical Dirichlet process normal mixture model30–32 of the form\n\nxij~∑k=1∞πk𝒩(μjk,σjk2)\n\n(1)\n\nwhere πk represents the marginal (unconditional) probability that a cell belongs to the k-th cluster, and μjk and σjk2 are the gene-specific means and variances within the k-th cluster. There are two key features in NCLUSION that are based on the formulation above. First, we assume that the formation of clusters is driven by a few important genes that have mean expression shifted away from zero. To that end, we place a sparsity-inducing spike and slab prior distribution on the mean effect of each gene\n\nμjk~ηk𝒩(0,λj2)+(1−ηk)δ0,\n\n(2)\n\nwhere δ0 is a point mass at zero, λj2 is the variance component of the “slab” distribution, and ηk is the prior probability that any given gene has a nonzero effect when assigning a cell to the k-th cluster. In practice, there are many different ways to estimate ηk. Following previous work38,39,81–83, one choice would be to assume a uniform prior over log ηk to reflect our lack of knowledge about the correct number of “marker” genes for each cell type that is present in the data. In this work, we set ηk = 1/G to represent our prior belief that each cluster is formed with at least one marker gene with a nonzero mean. To facilitate posterior computation and interpretable inference, we introduce a binary indicator variable ρjk ∈ {0,1} where we implicitly assume a priori that Pr[ρjk = 1] = ηk. Alternatively, we say that ρjk takes on a value of 1 when the effect of a gene μjk on cluster assignment is nonzero. As NCLUSION is trained, the posterior mean for unimportant genes will trend towards zero as the model attempts to identify subsets of marker genes that are relevant for each cluster. We then use posterior inclusion probabilities (PIPs) as general summaries of evidence that the j-th gene is statistically important in determining when a cell is assigned to the k-th cluster where\n\nPIP(j;k)≡Pr[μjk≠0∣X].\n\n(3)\n\nThe second key feature in Eq. (1) is that we do not assume to know the true number of clusters K. Instead, we take a nonparametric approach and attempt to learn K directly from the data. Once again, to facilitate posterior computation, we introduce a categorical latent variable ψi which indicates that the i-th cell is in the k-th cluster with prior probability πk. Explicitly, we write this as Pr[ψi = k] = πk. Here, we implement the stick-breaking construction of the Dirichlet process30 where we say\n\nπ~Dir(α0β),βk~χk∏l=1k−1(1−χl),χk~Beta(1,γ0)\n\n(4)\n\nwith π = (π1,…,π>K) having mean β and variance determined by the concentration hyper-parameters α0 and γ084. The concentration hyper-parameters α0 and γ0 are both non-negative scalars that effectively help to determine the number of clusters used in the model30,37. Larger values for these parameters increase the model’s sensitivity to variation in the data and encourage the creation of a greater number of smaller clusters. Smaller values for these parameters, on the other hand, decrease the model’s sensitivity to variation in the data and encourage the creation of fewer larger clusters. In this work, we encourage the creation of fewer clusters and fix α0 and γ0 to be less than or equal to 1 (Supplementary Material). After model training, we use the posterior distribution over the latent categorical indicators Pr[ψi = k |X] to determine the cluster assignment for each cell. It is worth noting that, although the prior number of normal components is infinite in Eq. (1), the posterior number of components after model fitting will be finite. This truncation reflects the fact that not all infinite states are used when conditioning on finite data84. Additionally, the algorithm used to estimate the parameters in the NCLUSION software penalizes empty clusters (see Supplementary Material), and, as a result, the model has the flexibility to automatically adjust its complexity based on the inferred complexity of the data being analyzed. This helps to increase the utility and adaptability of NCLUSION across a wide range of single-cell applications.\n\nSelection of cluster-specific marker genes\n\nNCLUSION jointly performs clustering on single-cell populations while also learning cluster-specific gene signatures. To achieve this, we use the spike and slab prior distribution specified in Eq. (2) and the resulting PIPs defined in Eq. (3) to find the most salient genes per cluster. Since the model fits to each j-th gene expression for the i-th cell independently, signatures learned between clusters can share subsets of the same genes. Genes that are identified as “important” across many different clusters can effectively be seen as ubiquitous housekeeping variables rather than significant marker genes of unique cell types. Therefore, we down-weight the inclusion probabilities to proportionally penalize genes based on the number of clusters in which they appear\n\nPIP*(j;k)=wj×PIP(j;k),wj=(1−SjK*)/(1−1K*)\n\n(5)\n\nwhere K* ≤ K is the finite number of occupied clusters learned by the model, and Sj is the number of clusters that the j-th gene is significant in according to a given selection threshold. We set this threshold to be 0.5 which corresponds to the median probability criterion in Bayesian statistics36. We combine the adjusted posterior inclusion probabilities with the effect size sign of each gene to find the most salient markers per cluster. NCLUSION not only identifies which genes are significant markers for each cluster but also estimates the size and sign of their effects (i.e., whether they are up-regulated or down-regulated depending on the direction of interest). We obtain the effect size sign by taking the sign of Cohen’s d85 between the expression of the j-th gene for cells in the k-th cluster and cells not in the k-th cluster (denoted by k′)\n\nESS(j;k)=sgn(μjk−μ¯jk′12(σjk2+σ¯jk′2))\n\n(6)\n\nwhere μ¯jk′=∑k′μjk′/(K*−1) and σ¯jk′2=∑k′σjk′2/(K*−1) are the average mean and variances for the j-th gene in all clusters outside of the k-th. Here, sgn(·) is the piecewise sign function where sgn(u) = + (i.e., positive) when u > 0, sgn(u) = − (i.e., negative) when u < 0, and sgn(u) = 0 when u = 0. In the main text, cluster-specific marker genes are selected as those that have a significant adjusted inclusion probability and are up-regulated in a given cluster such that PIP*(j;k) ≥ 0.5 and ESS(j;k) = +, respectively.\n\nPosterior inference via variational EM algorithm\n\nWe combine the likelihood in Eq. (1) and the prior distributions in Eqs. (2) and (4) to perform Bayesian inference. In current scRNA-seq datasets, it is less feasible to implement traditional Markov Chain Monte Carlo (MCMC) algorithms due to the large number of cells being studied. For model fitting, we instead use a variational expectation-maximization (EM) algorithm30,31,84, which allows us to estimate parameters within an optimization framework. The overall goal of variational inference is to approximate the true posterior distribution for model parameters using a set of approximating distributions. The EM algorithm optimizes parameters such that it minimizes the Kullback-Leibler divergence between the exact and approximate posterior distributions. To compute the variational approximations, we make the mean-field assumption that the true posterior can be “fully-factorized”86. The algorithm then follows two general steps. In the first step, we iterate through a combination of hyper-parameter values and compute variational updates for the other parameters using coordinate ascent. In the second step, we empirically compute (approximate) posterior values for the main model parameters {μ,ρ,π}. Detailed steps in the variational EM algorithm, explicit coordinate ascent updates for the model parameters, pseudocode, and other derivations are given in the Supplementary Material. Parameters in the variational EM algorithm are initialized by taking random draws from their assumed prior distributions. Iterations in the algorithm are terminated when at least one of two stopping criteria are met: (i) the difference between the lower bound of two consecutive updates is within some small range (specified by argument ∈), or (ii) a maximum number of iterations is reached. For the analyses run in this paper, we set ∈ = 1 for the first criterion and used a maximum of 150 iterations for the second.\n\nDatasets and preprocessing\n\nBelow we briefly describe all of the datasets and the preprocessing steps used in this work. Each of these datasets is relatively large (containing at least 20,000 cells) with unique molecular identifiers (UMI). The latter is important because prior research suggests that UMIs provide enough information to avoid overcounting issues due to amplification and zero-inflation14,87,88. We use an asterisk by the BRAIN-LARGE dataset to indicate that it was exclusively to test the scalability of NCLUSION and competing methods; therefore, clustering performance was not recorded. For the other datasets, we use cell type annotations provided by the original study as “true” reference labels during our analyses. Cells were filtered for quality using a custom scanpy89 (v.1.9.1) pipeline script (see Software Availability). Unless otherwise stated, all data was preprocessed by taking the logarithm (to the base 2) of the counts, dividing by a scaling factor of 10000, and then adding a pseudo-count (1.0) for stability. Additionally, unless otherwise stated, all results were produced using the top 5000 highly variable genes (HVG), which were determined by sorting the standard deviation of the transformed counts32.\n\nBRAIN-LARGE*.\n\nThis dataset originally contains 1.3 million mouse brain cells from 10x Genomics43. During preprocessing, we subset the data to a collection of 720 genes following a procedure outlined by Lopez et al.14. Next, we further filtered by only keeping cells that had at least one of these genes expressed. This left a total of 64,071 cells. Since the original study did not provide cell labels, we exclusively used this dataset to compare runtime performance. To do so, we up-sampled by randomly selecting groups of 64,071 cells to create a synthetic dataset of 1 million cells. We report the runtime for each method on datasets with 500, 1K, 5K, 10K, 50K, 100K, 500K, and 1M cells.\n\nPBMC.\n\nWe took scRNA-seq data from fluorescence-activated cell sorted (FACS) populations of peripheral blood mononuclear cells (PBMCs) provided by Zheng et al.45 and concatenated each population into one dataset. During preprocessing, we filtered out genes that were expressed in fewer than three cells. We also dropped cells with (i) fewer than 200 genes expressed, (ii) greater than 20% mitochondrial reads, and (iii) fewer than 5% ribosomal reads. This resulted in a final dataset with 94,615 high-quality cells representing 10 distinct cell types.\n\nIMMUNE.\n\nWe obtained filtered scRNA-seq data from approximately 330,000 immune cells from 12 organ donors in Domínguez Conde et al.66. To mitigate batch effects, we isolated 88,057 cells that were taken from a single organ donor (donor D496) with uniform chemistry annotations, containing 44 distinct immune cell types.\n\nOther methods\n\nWe selected five additional methods to compare against the performance of NCLUSION: (1) a Louvain algorithm implemented using the FindClusters function in Seurat9 (v.4.3.0.1); (2) a spectral clustering method called scLCA10 (v.0.0.0.9000), which optimizes both intra- and inter-cluster similarity; (3) a combination of a K-Nearest Neighbor (KNN) classifier with the Louvain community detection algorithm to find clusters implemented via scikit-learn41 (v.1.2.2) and scanpy89 (v.1.9.1), respectively; (4) a semi-soft clustering algorithm called SOUP42 (v.0.0.0.9000); and (5) an ensemble method called scCCESS-SIMLR (v.0.2.1), which leverages the spectral clustering approach SIMLR11,90. Additional details about each method are provided in the Supplementary Material.\n\nEvaluation\n\nBelow we describe the metrics and approaches used to compare performance across all methods. Our clustering evaluation procedure used extrinsic metrics that require reference labels to serve as the ground truth in our calculations.\n\nJaccard similarity.\n\nThis metric captures the amount of overlap between two finite sets. It ranges between [0, 1] where 1 denotes complete overlap and 0 signifies no overlap. The Jaccard similarity is calculated as follows90,91\n\nJ(𝒜,ℬ)=|𝒜∩ℬ||𝒜|+|ℬ|−|𝒜∩ℬ|\n\nwhere 𝒜 and ℬ represent the sets of inferred and reference labels, respectively.\n\nGini-Simpson index.\n\nThis metric is the complement to Simpson’s index92. It measures the probability that two cells taken at random from the dataset of interest (with replacement) represent different cell types. The Gini-Simpson index is calculated as the following\n\nD*=1−∑k=1KNk(Nk−1)N(N−1)\n\nwhere N is the total number of cells in the study, K is the number of inferred clusters (or cell types), and Nk represents the number of cells assigned to the k-th cluster. The Gini-Simpson index ranges between 0 < D* ≤ 1 where larger values indicate that more cellular heterogeneity is being captured by a given clustering algorithm.\n\nMcIntosh evenness.\n\nThis metric can also be seen as a variation of Simpson’s index93,94. It expresses the cellular heterogeneity captured by a clustering algorithm in geometric terms. Briefly, a group of cells can be represented as a point in a K-dimensional hyper-volume where each inferred cell type represents a dimension. The McIntosh evenness value is calculated as the following\n\nE=∑kNk2(N−K+1)2+K−1\n\nwhere N is the total number of cells in the study, K is the number of inferred clusters (or cell types), and Nk represents the number of cells assigned to the k-th cluster. The McIntosh evenness ranges between 0 < E ≤ 1 where larger values indicate that more cellular heterogeneity is being captured by a given clustering algorithm.\n\nAdjusted Rand index (ARI).\n\nThis metric captures the similarity between labels inferred by a method and the reference labels. It is based on the Rand index (RI) but corrects for the measurement’s sensitivity to chance. ARI ranges between [−1, 1] where 1 represents perfect agreement between label sets, 0 represents random agreement, and −1 represents perfect disagreement. ARI is calculated by\n\nARI=∑ij(nij2)−[∑i(ai2)∑j(bj2)](n2)1/2[∑i(ai2)+∑j(bj2)]−[∑i(ai2)∑j(bj2)](n2)\n\nwhere nij, ai, and bj are values obtained from a contingency table, and n=∑ijnij90,91,95.\n\nNormalized module expression.\n\nGenes with significantly adjusted PIPs in Eq. (5) and positive ESS in Eq. (6) were used to generate modules (i.e., a collection of marker genes) for each cluster. We calculated a score for each cluster to asses the exclusivity of expression within each module. This was done using the AddModuleScore function in Seurat (v.5.0.0) within the R programming language (v.4.2.0). We used a min-max scaling procedure to normalize the module scores between 0 and 1 across all clusters. This was to facilitate qualitative evaluation across all generated gene modules. The violin plots were generated using the VlnPlot function in Seurat (v.5.0.0).\n\nGene set over-enrichment analysis.\n\nWe also performed gene set enrichment analysis on each of the learned gene modules across clusters. This was done via an over-enrichment analysis within the GSEApy package96 (v.1.0.5) in Python (v.3.7.4). This method uses a hypergeometric test to calculate the enrichment of genes in a supplied module with respect to the gene sets within an ontology. In this work, we use the ontology labeled “GO Biological Process 2023”55–57. The gene sets in this particular ontology represent a combination of biological processes, pathways, and phenotypes. In this analysis, we use q-values to determine the enrichment of a given gene set with a significance threshold set to 0.05. The q-value is the analog of a p-value that has been corrected for testing multiple hypotheses.\n\nSoftware availability\n\nAn open-source software implementation of NCLUSION is available on GitHub at https://github.com/microsoft/nclusion. Guided tutorials and all code needed to reproduce the results and figures in this work can be found at http://microsoft.github.io/nclusion.\n\nSupplementary Material\n\nSupplement 1\n\nClick here to view.(8.9M, pdf)\n\nSupplement 2\n\nClick here to view.(47K, xlsx)\n\nSupplement 3\n\nClick here to view.(4.9M, xlsx)\n\nSupplement 4\n\nClick here to view.(60K, xlsx)\n\nSupplement 5\n\nClick here to view.(708K, xlsx)\n\nAcknowledgements\n\nWe thank members of the Crawford, Raghavan, and Shalek Labs for insightful comments on earlier versions of this manuscript. This research was conducted by using a combination of computational resources and services provided by Microsoft Research and the Center for Computation and Visualization at Brown University. This research was also supported in part by an Alfred P. Sloan Research Fellowship and a David & Lucile Packard Fellowship for Science and Engineering awarded to LC. CN was a trainee supported under the Brown University Predoctoral Training Program in Biological Data Science (NIH T32 GM128596). SR is supported by NCI K08 award 1K08CA260442, the Claudia Adams Barr Program in Innovative Basic Cancer Research, and the Dana-Farber Cancer Institute Hale Family Center for Pancreatic Cancer Research.\n\nCompeting interests\n\nSR holds equity in Amgen and receives research funding from Microsoft. All other authors have declared that no competing interests exist.\n\nData availability\n\nAll of the datasets analyzed in this paper are publicly available. The BRAIN-LARGE dataset can be accessed at https://www.10xgenomics.com/datasets/1-3-million-brain-cells-from-e-18-mice-2-standard-1-3-0. The individual PBMC data from Zheng et al.45 can be downloaded directly from https://www.10xgenomics.com/resources/datasets. Lastly, the immune cell atlas dataset can be accessed at https://cellgeni.cog.sanger.ac.uk/pan-immune/CountAdded_PIP_global_object_for_cellxgene.h5ad.\n\nReferences\n\n1. Miao Zhen, Humphreys Benjamin D., McMahon Andrew P., and Kim Junhyong. Multi-omics integration in the age of million single-cell data. Nature Reviews Nephrology, 17(11):710–724, November 2021. ISSN 1759–5061, 1759–507X. doi: 10.1038/s41581-021-00463-x. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n2. Wolf F. Alexander, Angerer Philipp, and Theis Fabian J.. Scanpy: large-scale single-cell geneexpression data analysis. Genome Biology, 19(1):15, February 2018. ISSN 1474–760X. doi: 10.1186/s13059-017-1382-0. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n3. Guo Minzhe, Wang Hui, Potter S. Steven, Whitsett Jeffrey A., and Xu Yan. Sincera: A pipeline forsingle-cell rna-seq profiling analysis. PLOS Computational Biology, 11(11):e1004575, November 2015. ISSN 1553–7358. doi: 10.1371/journal.pcbi.1004575. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n4. Lun Aaron T.L., McCarthy Davis J., and Marioni John C.. A step-by-step workflow for low-level analysis of single-cell rna-seq data with bioconductor. F1000Research, 5:2122, October 2016. ISSN 2046–1402. doi: 10.12688/f1000research.9501.2. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n5. Haque Ashraful, Engel Jessica, Teichmann Sarah A., and Lonnberg Tapio. A practical guide to single-cell rna-sequencing for biomedical research and clinical applications. Genome Medicine, 9 (1):75, August 2017. ISSN 1756–994X. doi: 10.1186/s13073-017-0467-4. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n6. Stegle Oliver, Teichmann Sarah A., and Marioni John C.. Computational and analytical challengesin single-cell transcriptomics. Nature Reviews Genetics, 16(33):133–145, March 2015. ISSN 1471–0064. doi: 10.1038/nrg3833. [PubMed] [CrossRef] [Google Scholar]\n\n7. Kiselev Vladimir Yu, Andrews Tallulah S., and Hemberg Martin. Challenges in unsupervised clustering of single-cell rna-seq data. Nature Reviews Genetics, 20(55):273–282, May 2019. ISSN 1471–0064. doi: 10.1038/s41576-018-0088-9. [PubMed] [CrossRef] [Google Scholar]\n\n8. Amezquita Robert A., Lun Aaron T. L., Becht Etienne, Carey Vince J., Carpp Lindsay N., Geistlinger Ludwig, Marini Federico, Rue-Albrecht Kevin, Risso Davide, Soneson Charlotte, Waldron Levi, Hervé Pagés Mike L. Smith, Huber Wolfgang, Morgan Martin, Gottardo Raphael, and Hicks Stephanie C.. Orchestrating single-cell analysis with bioconductor. Nature Methods, 17(22): 137–145, February 2020. ISSN 1548–7105. doi: 10.1038/s41592-019-0654-x. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n9. Satija Rahul, Farrell Jeffrey A, Gennert David, Schier Alexander F, and Regev Aviv. Spatialreconstruction of single-cell gene expression data. Nature Biotechnology, 33:495–502, 2015. doi: 10.1038/nbt.3192. URL 10.1038/nbt.3192. [PMC free article] [PubMed] [CrossRef] [CrossRef] [Google Scholar]\n\n10. Cheng Changde, Easton John, Rosencrance Celeste, Li Yan, Ju Bensheng, Williams Justin, Heather L Mulder Yakun Pang, Chen Wenan, and Chen Xiang. Latent cellular analysis robustly reveals subtle diversity in large-scale single-cell rna-seq data. Nucleic Acids Research, 47(22):e143, Dec 2019. ISSN 0305–1048. doi: 10.1093/nar/gkz826. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n11. Wang Bo, Zhu Junjie, Pierson Emma, Ramazzotti Daniele, and Batzoglou Serafim. Visualization and analysis of single-cell rna-seq data by kernel-based similarity learning. Nature Methods, 14 (44):414–416, Apr 2017. ISSN 1548–7105. doi: 10.1038/nmeth.4207. [PubMed] [CrossRef] [Google Scholar]\n\n12. van der Maaten Laurens and Hinton Geoffrey. Visualizing data using t-sne. Journal of Machine Learning Research, 9(86):2579–2605, 2008. ISSN 1533–7928. [Google Scholar]\n\n13. Leland McInnes John Healy, and Melville James. Umap: Uniform manifold approximation and projection for dimension reduction, 2020. URL http://arxiv.org/abs/1802.03426.arXiv:1802.03426 [cs, stat].\n\n14. Lopez Romain, Regier Jeffrey, Cole Michael B., Jordan Michael I., and Yosef Nir. Deep generative modeling for single-cell transcriptomics. Nature Methods, 15(12):1053–1058, Dec 2018. ISSN 1548–7091, 1548–7105. doi: 10.1038/s41592-018-0229-2. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n15. Kiselev Vladimir Yu, Kirschner Kristina, Schaub Michael T., Andrews Tallulah, Yiu Andrew, Chandra Tamir, Natarajan Kedar N., Reik Wolf, Barahona Mauricio, Green Anthony R., and Hemberg Martin. Sc3: consensus clustering of single-cell rna-seq data. Nature Methods, 14(55): 483–486, May 2017. ISSN 1548–7105. doi: 10.1038/nmeth.4236. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n16. Grün Dominic, Lyubimova Anna, Kester Lennart, Wiebrands Kay, Basak Onur, Sasaki Nobuo, Clevers Hans, and van Oudenaarden Alexander. Single-cell messenger rna sequencing reveals rare intestinal cell types. Nature, 525(75687568):251–255, September 2015. ISSN 1476–4687. doi: 10.1038/nature14966. [PubMed] [CrossRef] [Google Scholar]\n\n17. Tasic Bosiljka, Menon Vilas, Nguyen Thuc Nghi, Kim Tae Kyung, Jarsky Tim, Yao Zizhen, Levi Boaz, Gray Lucas T., Sorensen Staci A., Dolbeare Tim, Bertagnolli Darren, Goldy Jeff, Shapovalova Nadiya, Parry Sheana, Lee Changkyu, Smith Kimberly, Bernard Amy, Madisen Linda, Sunkin Susan M., Hawrylycz Michael, Koch Christof, and Zeng Hongkui. Adult mouse cortical cell taxonomy revealed by single cell transcriptomics. Nature Neuroscience, 19(22):335–346, February 2016. ISSN 1546–1726. doi: 10.1038/nn.4216. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n18. žurauskienė Justina and Yau Christopher. pcareduce: hierarchical clustering of single cell transcriptional profiles. BMC Bioinformatics, 17(1):140, March 2016. ISSN 1471–2105. doi: 10.1186/s12859-016-0984-y. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n19. Zeisel Amit, Muñoz-Manchado Ana B., Codeluppi Simone, Lönnerberg Peter, Manno Gioele La, Juréus Anna, Marques Sueli, Munguba Hermany, He Liqun, Betsholtz Christer, Rolny Charlotte, Castelo-Branco Gonçalo, Hjerling-Leffler Jens, and Linnarsson Sten. Cell types in the mouse cortex and hippocampus revealed by single-cell rna-seq. Science, 347(6226):1138–1142, March 2015. doi: 10.1126/science.aaa1934. [PubMed] [CrossRef] [Google Scholar]\n\n20. Luecken Malte D and Theis Fabian J. Current best practices in single-cell rna-seq analysis: a tutorial. Molecular Systems Biology, 15(6):e8746, Jun 2019. ISSN 1744–4292. doi: 10.15252/msb.20188746. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n21. David Lähnemann Johannes Köster, Szczurek Ewa, McCarthy Davis J., Hicks Stephanie C., Robinson Mark D., Vallejos Catalina A., Campbell Kieran R., Beerenwinkel Niko, Mahfouz Ahmed, Pinello Luca, Skums Pavel, Stamatakis Alexandros, Attolini Camille Stephan-Otto, Aparicio Samuel, Baaijens Jasmijn, Balvert Marleen, de Barbanson Buys, Cappuccio Antonio, Corleone Giacomo, Dutilh Bas E., Florescu Maria, Guryev Victor, Holmer Rens, Jahn Katharina, Lobo Thamar Jessurun, Keizer Emma M., Khatri Indu, Kielbasa Szymon M., Korbel Jan O., Kozlov Alexey M., Kuo Tzu-Hao, Lelieveldt Boudewijn P.F., Mandoiu Ion I., Marioni John C., Marschall Tobias, Mölder Felix, Niknejad Amir, Raczkowski Lukasz, Reinders Marcel, de Ridder Jeroen, Saliba Antoine-Emmanuel, Somarakis Antonios, Stegle Oliver, Theis Fabian J., Yang Huan, Zelikovsky Alex, McHardy Alice C., Raphael Benjamin J., Shah Sohrab P., and Schönhuth Alexander. Eleven grand challenges in single-cell data science. Genome Biology, 21(1):31, Feb 2020. ISSN 1474–760X. doi: 10.1186/s13059-020-1926-6. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n22. Gao Lucy L., Bien Jacob, and Witten Daniela. Selective inference for hierarchical clustering. Journal of the American Statistical Association, page 2116331, October 2022. ISSN 0162–1459, 1537–274X. doi: 10.1080/01621459.2022.2116331. [CrossRef] [Google Scholar]\n\n23. Neufeld Anna, Gao Lucy L., Popp Joshua, Battle Alexis, and Witten Daniela. Inference after latentvariable estimation for single-cell rna sequencing data. Biostatistics, December 2022. ISSN 1465–4644, 1468–4357. doi: 10.1093/biostatistics/kxac047. [PubMed] [CrossRef] [Google Scholar]\n\n24. Grabski Isabella N., Street Kelly, and Irizarry Rafael A.. Significance analysis for clustering with single-cell rna-sequencing data. Nature Methods, 20(88):1196–1202, Aug 2023. ISSN 1548–7105. doi: 10.1038/s41592-023-01933-9. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n25. Vandenbon Alexis and Diez Diego. A clustering-independent method for finding differentially expressed genes in single-cell transcriptome data. Nature Communications, 11(11):4318, August 2020. ISSN 2041–1723. doi: 10.1038/s41467-020-17900-3. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n26. Zhang Jesse M, Kamath Govinda M, and David N Tse. Valid post-clustering differential analysis for single-cell rna-seq. Cell Systems, 9(4):383–392, 2019. [PMC free article] [PubMed] [Google Scholar]\n\n27. Zhang Jesse M, Fan Jue, H Christina Fan David Rosenfeld, and Tse David N. An interpretable framework for clustering single-cell rna-seq datasets. BMC bioinformatics, 19(1):1–12, 2018. [PMC free article] [PubMed] [Google Scholar]\n\n28. Lall Snehalika, Ray Sumanta, and Bandyopadhyay Sanghamitra. Rgcop-a regularized copula based method for gene selection in single-cell rna-seq data. PLOS Computational Biology, 17 (10):e1009464, 2021. [PMC free article] [PubMed] [Google Scholar]\n\n29. Townes F William, Hicks Stephanie C, Aryee Martin J, and Irizarry Rafael A. Feature selection and dimension reduction for single-cell rna-seq based on a multinomial model. Genome Biology, 20:1–16, 2019. [PMC free article] [PubMed] [Google Scholar]\n\n30. Blei David M. and Jordan Michael I.. Variational inference for dirichlet process mixtures. Bayesian Analysis, 1(1):121–143, Mar 2006. ISSN 1936–0975, 1931–6690. doi: 10.1214/06-BA104. [CrossRef] [Google Scholar]\n\n31. Gelman Andrew, Carlin John B, Stern Hal S, Dunson David B, Vehtari Aki, and Rubin Donald B. Bayesian Data Analysis, Third Edition. CRC Press, Hoboken, 2013. ISBN 978-1-4398-9820-8. [Google Scholar]\n\n32. Prabhakaran Sandhya, Azizi Elham, Carr Ambrose, and Pe’er Dana. Dirichlet process mixture model for correcting technical variation in single-cell gene expression data. JMLR Workshop and Conference Proceedings, 48:1070–1079, 2016. ISSN 1938–7288. [PMC free article] [PubMed] [Google Scholar]\n\n33. Sun Zhe, Chen Li, Xin Hongyi, Jiang Yale, Huang Qianhui, Cillo Anthony R, Tabib Tracy, KKolls Jay, Bruno Tullia C, Lafyatis Robert, et al. A bayesian mixture model for clustering droplet-based single-cell transcriptomic data from population studies. Nature communications, 10(1):1649, 2019. [PMC free article] [PubMed] [Google Scholar]\n\n34. Duan Tiehang, Pinto José P, and Xie Xiaohui. Parallel clustering of single cell transcriptomic data with split-merge sampling on dirichlet process mixtures. Bioinformatics, 35(6):953–961, 2019. [PubMed] [Google Scholar]\n\n35. Sun Zhe, Wang Ting, Deng Ke, Wang Xiao-Feng, Lafyatis Robert, Ding Ying, Hu Ming, and Chen Wei. Dimm-sc: a dirichlet mixture model for clustering droplet-based single cell transcriptomic data. Bioinformatics, 34(1):139–146, 2018. [PMC free article] [PubMed] [Google Scholar]\n\n36. Barbieri Maria Maddalena and Berger James O.. Optimal predictive model selection. The Annals of Statistics, 32(3):870–897, Jun 2004. ISSN 0090–5364, 2168–8966. doi: 10.1214/009053604000000238. [CrossRef] [Google Scholar]\n\n37. Zeng Ping and Zhou Xiang. Non-parametric genetic prediction of complex traits with latent dirichlet process regression models. Nature Communications, 8(1):456, Dec 2017. ISSN 2041–1723. doi: 10.1038/s41467-017-00470-2. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n38. Carbonetto Peter and Stephens Matthew. Scalable variational inference for bayesian variable selection in regression, and its accuracy in genetic association studies. Bayesian Analysis, 7:73–108, Mar 2012. ISSN 1936–0975, 1931–6690. doi: 10.1214/12-BA703. [CrossRef] [Google Scholar]\n\n39. Demetci Pinar, Cheng Wei, Darnell Gregory, Zhou Xiang, Ramachandran Sohini, and Crawford Lorin. Multi-scale inference of genetic trait architecture using biologically annotated neural networks. PLOS Genetics, 17(8):e1009754, 2021. ISSN 1553–7404. doi: 10.1371/journal.pgen.1009754. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n40. Blei David M., Kucukelbir Alp, and McAuliffe Jon D.. Variational inference: A review for statisticians. Journal of the American Statistical Association, 112(518):859–877, April 2017. ISSN 0162–1459, 1537–274X. doi: 10.1080/01621459.2017.1285773. tex.ids: bleiVariationalInferenceReview2017a arXiv: 1601.00670. [CrossRef] [Google Scholar]\n\n41. Pedregosa F., Varoquaux G., Gramfort A., Michel V., Thirion B., Grisel O., Blondel M., Pretten-hofer P., Weiss R., Dubourg V., Vanderplas J., Passos A., Cournapeau D., Brucher M., Perrot M., and Duchesnay E.. Scikit-learn: Machine learning in Python. Journal of Machine Learning Research, 12:2825–2830, 2011. [Google Scholar]\n\n42. Zhu Lingxue, Lei Jing, Klei Lambertus, Devlin Bernie, and Roeder Kathryn. Semisoft clustering of single-cell data. Proceedings of the National Academy of Sciences, 116(2):466–471, Jan 2019. doi: 10.1073/pnas.1817715116. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n43. 10x Genomics. Support: single cell gene expression datasets, 2023. URL https://www.10xgenomics.com/resources/datasets.\n\n44. Svensson Valentine, da Veiga Beltrame Eduardo, and Pachter Lior. A curated database reveals trends in single-cell transcriptomics. Database: The Journal of Biological Databases and Curation, 2020:baaa073, Nov 2020. ISSN 1758–0463. doi: 10.1093/database/baaa073. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n45. Zheng Grace X. Y., Terry Jessica M., Belgrader Phillip, Ryvkin Paul, Bent Zachary W., Wilson Ryan, Ziraldo Solongo B., Wheeler Tobias D., McDermott Geoff P., Zhu Junjie, Gregory Mark T., Shuga Joe, Montesclaros Luz, Underwood Jason G., Masquelier Donald A., Nishimura Stefanie Y., Schnall-Levin Michael, Wyatt Paul W., Hindson Christopher M., Bharadwaj Rajiv, Wong Alexander, Ness Kevin D., Beppu Lan W., Deeg H. Joachim, McFarland Christopher, Loeb Keith R., Valente William J., Ericson Nolan G., Stevens Emily A., Radich Jerald P., Mikkelsen Tarjei S., Hindson Benjamin J., and Bielas Jason H.. Massively parallel digital transcriptional profiling of single cells. Nature Communications, 8(11):14049, Jan 2017. ISSN 2041–1723. doi: 10.1038/ncomms14049. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n46. Vargo Alexander HS and Gilbert Anna C. A rank-based marker selection method for high throughput scrna-seq data. BMC bioinformatics, 21(1):1–51, 2020. [PMC free article] [PubMed] [Google Scholar]\n\n47. Michielsen Lieke, Reinders Marcel J. T., and Mahfouz Ahmed. Hierarchical progressive learning of cell identities in single-cell data. Nature Communications, 12(11):2799, May 2021. ISSN 2041–1723. doi: 10.1038/s41467-021-23196-8. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n48. Baume Daniel M., Caligiuri Michael A., Manley Thomas J., Daley John F., and Ritz Jerome. Differential expression of cd8α and cd8β associated with mhc-restricted and non-mhc-restricted cytolytic effector cells. Cellular Immunology, 131(2):352–365, December 1990. ISSN 0008–8749. doi: 10.1016/0008-8749(90)90260-X. [PubMed] [CrossRef] [Google Scholar]\n\n49. Choi Haeyoun, Lee Hyun-Joo, Sohn Hyun-Jung, and Kim Tai-Gyu. Cd40 ligand stimulation affects the number and memory phenotypes of human peripheral cd8+ t cells. BMC Immunology, 24(1): 15, June 2023. ISSN 1471–2172. doi: 10.1186/s12865-023-00547-2. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n50. Norris Suzanne, Doherty Derek G., Collins Clive, Gerry McEntee Oscar Traynor, Hegarty John E., and O’Farrelly Cliona. Natural t cells in the human liver: cytotoxic lymphocytes with dual t cell and natural killer cell phenotype and function are phenotypically heterogenous and include vα24-jαq and γδ t cell receptor bearing cells. Human Immunology, 60(1):20–31, Jan 1999. ISSN 0198–8859. doi: 10.1016/S0198-8859(98)00098-6. [PubMed] [CrossRef] [Google Scholar]\n\n51. Willis Simon N., Tellier Julie, Liao Yang, Trezise Stephanie, Light Amanda, O’Donnell Kristy, Garrett-Sinha Lee Ann, Shi Wei, Tarlinton David M., and Nutt Stephen L.. Environmental sensing by mature b cells is controlled by the transcription factors pu.1 and spib. Nature Communications, 8(11):1426, November 2017. ISSN 2041–1723. doi: 10.1038/s41467-017-01605-1. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n52. Zuccolo Jonathan, Deng Lili, Unruh Tammy, Sanyal Ratna, Bau Jeremy, Storek Jan, Demetrick Douglas, Luider Joanne, Auer-Grzesiak Iwona, Mansoor Adnan, and Deans Julie. Expression of ms4a and tmem176 genes in human b lymphocytes. Frontiers in Immunology, 4, 2013. ISSN 1664–3224. URL https://www.frontiersin.org/articles/10.3389/fimmu.2013.00195. [PMC free article] [PubMed] [Google Scholar]\n\n53. Chen Zheng, Yu Mincheng, Yan Jiuliang, Guo Lei, Zhang Bo, Liu Shuang, Lei Jin, Zhang Wentao, Zhou Binghai, Gao Jie, Yang Zhangfu, Li Xiaoqiang, Zhou Jian, Fan Jia, Ye Qinghai, Li Hui, Xu Yongfeng, and Xiao Yongsheng. Pnoc expressed by b cells in cholangio-carcinoma was survival related and lair2 could be a t cell exhaustion biomarker in tumor microenvironment: Characterization of immune microenvironment combining single-cell and bulk sequencing technology. Frontiers in Immunology, 12, 2021. ISSN 1664–3224. URL https://www.frontiersin.org/articles/10.3389/fimmu.2021.647209. [PMC free article] [PubMed] [Google Scholar]\n\n54. Evren Elza, Ringqvist Emma, Tripathi Kumar Parijat, Sleiers Natalie, Rives Inés Có, Alisjahbana Arlisa, Gao Yu, Sarhan Dhifaf, Halle Tor, Sorini Chiara, Lepzien Rico, Marquardt Nicole, Michaëlsson Jakob, Smed-Sörensen Anna, Botling Johan, Karlsson Mikael C.I., Villablanca Eduardo J., and Willinger Tim. Distinct developmental pathways from blood monocytes generate human lung macrophage diversity. Immunity, 54(2):259–275.e7, February 2021. ISSN 10747613. doi: 10.1016/j.immuni.2020.12.003. [PubMed] [CrossRef] [Google Scholar]\n\n55. Fang Zhuoqing, Liu Xinyuan, and Peltz Gary. Gseapy: a comprehensive package for performing gene set enrichment analysis in python. Bioinformatics, 39(1):btac757, January 2023. ISSN 1367–4811. doi: 10.1093/bioinformatics/btac757. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n56. Durinck Steffen, Moreau Yves, Kasprzyk Arek, Davis Sean, De Moor Bart, Brazma Alvis, and Huber Wolfgang. Biomart and bioconductor: a powerful link between biological databases and microarray data analysis. Bioinformatics, 21(16):3439–3440, August 2005. ISSN 1367–4803. doi: 10.1093/bioinformatics/bti525. [PubMed] [CrossRef] [Google Scholar]\n\n57. Chen Edward Y., Tan Christopher M., Kou Yan, Duan Qiaonan, Wang Zichen, Meirelles Gabriela Vaz, Clark Neil R., and Ma’ayan Avi. Enrichr: interactive and collaborative html5 gene list enrichment analysis tool. BMC Bioinformatics, 14:128, April 2013. ISSN 1471–2105. doi: 10.1186/1471-2105-14-128. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n58. Ashburner Michael, Ball Catherine A., Blake Judith A., Botstein David, Butler Heather, Cherry J. Michael, Davis Allan P., Dolinski Kara, Dwight Selina S., Eppig Janan T., Harris Midori A., Hill David P., Issel-Tarver Laurie, Kasarskis Andrew, Lewis Suzanna, Matese John C., Richardson Joel E., Ringwald Martin, Rubin Gerald M., and Sherlock Gavin. Gene ontology: tool for the unification of biology. Nature Genetics, 25(11):25–29, May 2000. ISSN 1546–1718. doi: 10.1038/75556. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n59. Carbon Seth and Mungall Chris. Gene ontology data archive, Jul 2023. URL https://zenodo.org/record/8200914.\n\n60. Vivier Eric, Tomasello Elena, Baratin Myriam, Walzer Thierry, and Ugolini Sophie. Functions of natural killer cells. Nature Immunology, 9(55):503–510, May 2008. ISSN 1529–2916. doi: 10.1038/ni1582. [PubMed] [CrossRef] [Google Scholar]\n\n61. Paul Sourav and Lal Girdhari. The molecular mechanism of natural killer cells function and its importance in cancer immunotherapy. Frontiers in Immunology, 8, 2017. ISSN 1664–3224. URL https://www.frontiersin.org/articles/10.3389/fimmu.2017.01124. [PMC free article] [PubMed] [Google Scholar]\n\n62. Jaeger Baptiste N., Donadieu Jean, Cognet Céline, Bernat Claire, Ordoñez-Rueda Diana, Barlogis Vincent, Mahlaoui Nizar, Fenis Aurore, Narni-Mancinelli Emilie, Beaupain Blandine, Bellanné-Chantelot Christine, Bajénoff Marc, Malissen Bernard, Malissen Marie, Vivier Eric, and Ugolini Sophie. Neutrophil depletion impairs natural killer cell maturation, function, and homeostasis. The Journal of Experimental Medicine, 209(3):565–580, March 2012. ISSN 0022–1007. doi: 10.1084/jem.20111908. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n63. Jiang Kun, Zhong Bin, Gilvary Danielle L., Corliss Brian C., Hong-Geller Elizabeth, Wei Sheng, and Djeu Julie Y.. Pivotal role of phosphoinositide-3 kinase in regulation of cytotoxicity in natural killer cells. Nature Immunology, 1(55):419–425, November 2000. ISSN 1529–2916. doi: 10.1038/80859. [PubMed] [CrossRef] [Google Scholar]\n\n64. Meng Fanying and Lowell Clifford A.. Lipopolysaccharide (lps)-induced macrophage activation and signal transduction in the absence of src-family kinases hck, fgr, and lyn. The Journal of Experimental Medicine, 185(9):1661–1670, May 1997. ISSN 0022–1007. [PMC free article] [PubMed] [Google Scholar]\n\n65. Baer Mark, Dillner Allan, Schwartz Richard C., Sedon Constance, Nedospasov Sergei, and Johnson Peter F.. Tumor necrosis factor alpha transcription in macrophages is attenuated by an autocrine factor that preferentially induces nf-κb p50. Molecular and Cellular Biology, 18(10):5678–5689, Oct 1998. ISSN 0270–7306. [PMC free article] [PubMed] [Google Scholar]\n\n66. Domínguez Conde C., Xu C., Jarvis L. B., Rainbow D. B., Wells S. B., Gomes T., Howlett S. K., Suchanek O., Polanski K., King H. W., Mamanova L., Huang N., Szabo P. A., Richardson L., Bolt L., Fasouli E. S., Mahbubani K. T., Prete M., Tuck L., Richoz N., Tuong Z. K., Campos L., Mousa H. S., Needham E. J., Pritchard S., Li T., Elmentaite R., Park J., Rahmani E., Chen D., Menon D. K., Bayraktar O. A., James L. K., Meyer K. B., Yosef N., Clatworthy M. R., Sims P. A., Farber D. L., Saeb-Parsy K., Jones J. L., and Teichmann S. A.. Cross-tissue immune cell analysis reveals tissue-specific features in humans. Science, 376(6594):eabl5197, May 2022. doi: 10.1126/science.abl5197. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n67. Cohen Merav, Giladi Amir, Gorki Anna-Dorothea, Solodkin Dikla Gelbard, Zada Mor, Hladik Anastasiya, Miklosi Andras, Salame Tomer-Meir, Halpern Keren Bahar, David Eyal, Itzkovitz Shalev, Harkany Tibor, Knapp Sylvia, and Amit Ido. Lung single-cell signaling interaction map reveals basophil role in macrophage imprinting. Cell, 175(4):1031–1044.e18, November 2018. ISSN 00928674. doi: 10.1016/j.cell.2018.09.009. [PubMed] [CrossRef] [Google Scholar]\n\n68. Neubert Patrick, Homann Arne, Wendelborn David, Bar Anna-Lorena, Krampert Luka, Trum Maximilian, Schröder Agnes, Ebner Stefan, Weichselbaum Andrea, Schatz Valentin, Linz Peter, Veelken Roland, Schulte-Schrepping Jonas, Aschenbrenner Anna C., Quast Thomas, Kurts Christian, Geisberger Sabrina, Kunzelmann Karl, Hammer Karin, Binger Katrina J., Titze Jens, Müller Dominik N., Kolanus Waldemar, Schultze Joachim L., Wagner Stefan, and Jantsch Jonathan. Ncx1 represents an ionic na+ sensing mechanism in macrophages. PLoS Biology, 18(6):e3000722, June 2020. ISSN 1544–9173. doi: 10.1371/journal.pbio.3000722. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n69. Gibeon D., Zhu J., Sogbesan A., Banya W., Rossios C., Saito J., Rocha J. P., Hull J. H., Menzies-Gow A. N., Bhavsar P. K., and Chung K. F.. Lipid-laden bronchoalveolar macrophages in asthma and chronic cough. Respiratory Medicine, 108(1):71–77, January 2014. ISSN 0954–6111. doi: 10.1016/j.rmed.2013.10.005. [PubMed] [CrossRef] [Google Scholar]\n\n70. Jaiswal A. I., Dubey C., Swain S. L., and Croft M.. Regulation of cd40 ligand expression on naive cd4 t cells: a role for tcr but not co-stimulatory signals. International Immunology, 8(2):275–285, February 1996. ISSN 0953–8178. doi: 10.1093/intimm/8.2.275. [PubMed] [CrossRef] [Google Scholar]\n\n71. Mookerjee-Basu Jayati and Dietmar J. Kappes. New ingredients for brewing cd4+t (cells): Tcf-1 and lef-1. Nature Immunology, 15(77):593–594, July 2014. ISSN 1529–2916. doi: 10.1038/ni.2927. [PubMed] [CrossRef] [Google Scholar]\n\n72. Vavoulis Dimitrios V., Francescatto Margherita, Heutink Peter, and Gough Julian. Dgeclust: differential expression analysis of clustered count data. Genome Biology, 16(1):39, February 2015. ISSN 1465–6906. doi: 10.1186/s13059-015-0604-6. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n73. Soneson Charlotte and Robinson Mark D.. Bias, robustness and scalability in single-cell differential expression analysis. Nature Methods, 15(44):255–261, April 2018. ISSN 1548–7105. doi: 10.1038/nmeth.4612. [PubMed] [CrossRef] [Google Scholar]\n\n74. Zhu Xiang and Stephens Matthew. Large-scale genome-wide enrichment analyses identify new trait-associated genes and pathways across 31 human phenotypes. Nature Communications, 9(1): 4361, 2018. [PMC free article] [PubMed] [Google Scholar]\n\n75. Ma Ying, Sun Shiquan, Shang Xuequn, Keller Evan T, Chen Mengjie, and Zhou Xiang. Integrative differential expression and gene set enrichment analysis using summary statistics for scrna-seq studies. Nature Communications, 11(1):1585, 2020. [PMC free article] [PubMed] [Google Scholar]\n\n76. Blei David M, Kucukelbir Alp, and McAuliffe Jon D. Variational inference: A review for statisticians. Journal of the American Statistical Association, 112(518):859–877, 2017. [Google Scholar]\n\n77. Giordano Ryan, Broderick Tamara, and Jordan Michael I. Covariances, robustness and variational bayes. Journal of Machine Learning Research, 19(51), 2018. [Google Scholar]\n\n78. Zhang Cheng, Shahbaba Babak, and Zhao Hongkai. Variational hamiltonian monte carlo via score matching. Bayesian Analysis, 13(2):485, 2018. [PMC free article] [PubMed] [Google Scholar]\n\n79. Weber Lukas M, Saha Arkajyoti, Datta Abhirup, Hansen Kasper D, and Hicks Stephanie C. nnsvg for the scalable identification of spatially variable genes using nearest-neighbor gaussian processes. Nature Communications, 14(1):4059, 2023. [PMC free article] [PubMed] [Google Scholar]\n\n80. Reich Brian J and Bondell Howard D. A spatial dirichlet process mixture model for clustering population genetics data. Biometrics, 67(2):381–390, 2011. [PMC free article] [PubMed] [Google Scholar]\n\n81. Guan Yongtao and Stephens Matthew. Bayesian variable selection regression for genome-wide association studies and other large-scale problems. The Annals Applied Statistics, 5(3):1780–1815, 2011. doi: 10.1214/11-AOAS455. URL https://projecteuclid.org:443/euclid.aoas/1318514285. [CrossRef] [Google Scholar]\n\n82. Zhou Xiang, Carbonetto Peter, and Stephens Matthew. Polygenic modeling with Bayesian sparse linear mixed models. PLOS Genetics, 9(2):e1003264, 2013. [PMC free article] [PubMed] [Google Scholar]\n\n83. Zhu Xiang and Stephens Matthew. Bayesian large-scale multiple regression with summary statistics from genome-wide association studies. The Annals Applied Statistics, 11(3):1561–1592, 2017. doi: 10.1214/17-AOAS1046. URL https://projecteuclid.org:443/euclid.aoas/1507168840. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n84. Hughes Michael C, Kim Dae Il, and Sudderth Erik B. Reliable and scalable variational inference for the hierarchical dirichlet process. Artificial Intelligence and Statistics, page 9, 2015. [Google Scholar]\n\n85. Cohen Jacob. Statistical Power Analysis for the Behavioral Sciences. Academic press, 2013. [Google Scholar]\n\n86. Wand Matthew P., Ormerod John T., Padoan Simone A., and Frühwirth Rudolf. Mean field variational bayes for elaborate distributions. Bayesian Analysis, 6(4):847–900, 2011. doi: 10.1214/11-BA631. URL 10.1214/11-BA631. [CrossRef] [CrossRef] [Google Scholar]\n\n87. Svensson Valentine. Droplet scrna-seq is not zero-inflated. Nature Biotechnology, 38(2):147–150, Feb 2020. ISSN 1546–1696. doi: 10.1038/s41587-019-0379-5. [PubMed] [CrossRef] [Google Scholar]\n\n88. Svensson Valentine. Reply to: Umi or not umi, that is the question for scrna-seq zero-inflation. Nature Biotechnology, 39(2):160–160, Feb 2021. ISSN 1546–1696. doi: 10.1038/s41587-020-00811-5. [PubMed] [CrossRef] [Google Scholar]\n\n89. Alexander Wolf F., Angerer Philipp, and Theis Fabian J.. Scanpy: large-scale single-cell gene expression data analysis. Genome Biology, 19(1):15, Feb 2018. ISSN 1474–760X. doi: 10.1186/s13059-017-1382-0. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n90. Yu Lijia, Cao Yue, Yang Jean Y. H., and Yang Pengyi. Benchmarking clustering algorithms on estimating the number of cell types from single-cell rna-sequencing data. Genome Biology, 23(1): 49, Feb 2022. ISSN 1474–760X. doi: 10.1186/s13059-022-02622-0. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n91. Wagner Silke and Wagner Dorothea. Comparing clusterings - an overview, 2007. URL https://publikationen.bibliothek.kit.edu/1000011477.\n\n92. Simpson Edward H. Measurement of diversity. nature, 163(4148):688–688, 1949. [Google Scholar]\n\n93. McIntosh Robert P. An index of diversity and the relation of certain concepts to diversity. Ecology, 48(3):392–404, 1967. [Google Scholar]\n\n94. Peet Robert K. The measurement of species diversity. Annual review of ecology and systematics, 5(1):285–307, 1974. [Google Scholar]\n\n95. Vinh Nguyen Xuan, Epps Julien, and Bailey James. Information theoretic measures for clusterings comparison: is a correction for chance necessary? In Proceedings of the 26th Annual International Conference on Machine Learning, pages 1073–1080, 2009. [Google Scholar]\n\n96. Fang Zhuoqing, Liu Xinyuan, and Peltz Gary. Gseapy: a comprehensive package for performing gene set enrichment analysis in python. Bioinformatics, 39(1):btac757, Jan 2023. ISSN 1367–4811. doi: 10.1093/bioinformatics/btac757. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\nArticles from bioRxiv are provided here courtesy of Cold Spring Harbor Laboratory Preprints"
    }
}