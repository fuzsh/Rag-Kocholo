{
    "id": "dbpedia_45_2",
    "rank": 72,
    "data": {
        "url": "https://discussion.fedoraproject.org/t/problems-with-wayland-after-updating-to-fedora-39/95501",
        "read_more_link": "",
        "language": "en",
        "title": "Problems with wayland after updating to fedora 39",
        "top_image": "https://redhat.discourse-cdn.com/fedoraproject/original/2X/4/4701afb8ed62770e56cfd748606abe1c0d616b84.png",
        "meta_img": "https://redhat.discourse-cdn.com/fedoraproject/original/2X/4/4701afb8ed62770e56cfd748606abe1c0d616b84.png",
        "images": [
            "https://emoji.discourse-cdn.com/twitter/slightly_smiling_face.png?v=12",
            "https://avatars.discourse-cdn.com/v4/letter/n/f5a326/48.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            "wayland",
            "mutter",
            "gnome",
            "f39"
        ],
        "tags": null,
        "authors": [
            "newsnews (news news)",
            "codingturtle (Turtle GK)",
            "computersavvy (Jeff V)"
        ],
        "publish_date": "2023-11-09T16:02:21+00:00",
        "summary": "",
        "meta_description": "A few days ago I updated from Fedora Workstation 38 to Fedora Workstation 39. However, there was a big problem: I could no longer log in. Every time the login screen came up and I entered and confirmed my password, it loaded, but then I was thrown back to the login screen. \nWhen I selected X11, howe&hellip;",
        "meta_lang": "en",
        "meta_favicon": "https://redhat.discourse-cdn.com/fedoraproject/optimized/2X/4/4a936c14d6cd5d29d6b7baf2511e406eeabed12c_2_32x32.png",
        "meta_site_name": "Fedora Discussion",
        "canonical_link": "https://discussion.fedoraproject.org/t/problems-with-wayland-after-updating-to-fedora-39/95501",
        "text": "A few days ago I updated from Fedora Workstation 38 to Fedora Workstation 39. However, there was a big problem: I could no longer log in. Every time the login screen came up and I entered and confirmed my password, it loaded, but then I was thrown back to the login screen.\n\nWhen I selected X11, however, it worked.\n\nSo I tried to start wayland from the console with str+alt+f5 with the command:\n\nsudo dbus-run-session -- gnome-shell --display-server --wayland &> SomeFile2.txt\n\nand then I had the following output:\n\ndbus-daemon[5378]: [session uid=0 pid=5378] Activating service name='org.gtk.vfs.Daemon' requested by ':1.0' (uid=0 pid=5379 comm=\"gnome-shell --display-server --wayland\" label=\"unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\") dbus-daemon[5378]: [session uid=0 pid=5378] Successfully activated service 'org.gtk.vfs.Daemon' libmutter-Message: 16:43:02.047: Running GNOME Shell (using mutter 45.1) as a Wayland display server libmutter-Message: 16:43:02.103: Made thread 'KMS thread' realtime scheduled libmutter-Message: 16:43:02.106: Device '/dev/dri/card1' prefers shadow buffer libmutter-Message: 16:43:02.111: Added device '/dev/dri/card1' (amdgpu) using atomic mode setting. libmutter-Message: 16:43:02.113: Created gbm renderer for '/dev/dri/card1' libmutter-Message: 16:43:02.113: Boot VGA GPU /dev/dri/card1 selected as primary ** Message: 16:43:02.115: Obtained a high priority EGL context ** Message: 16:43:02.116: Obtained a high priority EGL context dbus-daemon[5378]: [session uid=0 pid=5378] Activating service name='org.a11y.Bus' requested by ':1.3' (uid=0 pid=5379 comm=\"gnome-shell --display-server --wayland\" label=\"unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\") dbus-daemon[5378]: [session uid=0 pid=5378] Successfully activated service 'org.a11y.Bus' libmutter-Message: 16:43:02.392: Using public X11 display :0, (using :1 for managed services) (gnome-shell:5379): libmutter-WARNING **: 16:43:02.392: WL: error: XDG_RUNTIME_DIR is invalid or not set in the environment (gnome-shell:5379): libmutter-ERROR **: 16:43:02.392: Failed to create socket == Stack trace for context 0x55d91c16b0f0 == A connection to the bus can't be made\n\nUnfortunately I have not much experience and it would be grateful for any help or corrections if I have done something wrong\n\nIf it helps, here are some information about my device:\n\n## Hardware Information: - **Hardware Model:** Lenovo Yoga 6 13ALC7 - **Memory:** 8.0 GiB - **Processor:** AMD Ryzen™ 5 5500U with Radeon™ Graphics × 12 - **Graphics:** AMD Radeon™ Graphics - **Disk Capacity:** (null) ## Software Information: - **Firmware Version:** JECN15WW(V1.08) - **OS Name:** Fedora Linux 39 (Workstation Edition) - **OS Build:** (null) - **OS Type:** 64-bit - **GNOME Version:** 45.1 - **Windowing System:** X11 - **Kernel Version:** Linux 6.5.10-300.fc39.x86_64\n\nI think, as far as I could tell, this was more of a Kde problem. I tried something similar on gnome once, but I had no success.\n\nIn general, though, I’ve also noticed that the error is slightly different, as I’ve realized that it’s some Wayland issue with Fedora 39 - at least I think so.\n\nThe thing that would help me is if you can’t log in at the login screen either, press ctrl+alt+f5 to get to the console and run gnome + wayland manually once and see if it gives the same errors\n\n(With this command):\n\nsudo dbus-run-session -- gnome-shell --display-server --wayland\n\nThis way I know whether it is a problem with my device or whether it occurs more often and is therefore a general problem.\n\nThank you for your help !\n\nI am experiencing a similar thing after updating from Fedora Workstation 38 to 39. After running\n\nsudo dbus-run-session -- gnome-shell --display-server --wayland &> ErrorOut.txt\n\nI get the following output:\n\ndbus-daemon[6062]: [session uid=0 pid=6062] Activating service name='org.gtk.vfs.Daemon' requested by ':1.0' (uid=0 pid=6063 comm=\"gnome-shell --display-server --wayland\" label=\"unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\") dbus-daemon[6062]: [session uid=0 pid=6062] Successfully activated service 'org.gtk.vfs.Daemon' libmutter-Message: 23:12:37.927: Running GNOME Shell (using mutter 45.1) as a Wayland display server libmutter-Message: 23:12:37.979: Made thread 'KMS thread' realtime scheduled libmutter-Message: 23:12:37.980: Device '/dev/dri/card1' prefers shadow buffer libmutter-Message: 23:12:37.980: Added device '/dev/dri/card1' (nvidia-drm) using atomic mode setting. libmutter-Message: 23:12:38.009: Device '/dev/dri/card0' prefers shadow buffer libmutter-Message: 23:12:38.105: Added device '/dev/dri/card0' (i915) using atomic mode setting. libmutter-Message: 23:12:38.107: Created gbm renderer for '/dev/dri/card1' libmutter-Message: 23:12:38.108: Created gbm renderer for '/dev/dri/card0' libmutter-Message: 23:12:38.108: Boot VGA GPU /dev/dri/card0 selected as primary ** Message: 23:12:38.109: Obtained a high priority EGL context ** Message: 23:12:38.110: Obtained a high priority EGL context dbus-daemon[6062]: [session uid=0 pid=6062] Activating service name='org.a11y.Bus' requested by ':1.3' (uid=0 pid=6063 comm=\"gnome-shell --display-server --wayland\" label=\"unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023\") dbus-daemon[6062]: [session uid=0 pid=6062] Successfully activated service 'org.a11y.Bus' libmutter-Message: 23:12:38.284: Using public X11 display :0, (using :1 for managed services) (gnome-shell:6063): libmutter-WARNING **: 23:12:38.284: WL: error: XDG_RUNTIME_DIR is invalid or not set in the environment (gnome-shell:6063): libmutter-ERROR **: 23:12:38.284: Failed to create socket == Stack trace for context 0x55e55c364760 == A connection to the bus can't be made\n\nI have a NVIDIA GPU, but the kernel and rpmfusion are up-to-date (535.129.03), here is the info about my system:\n\n## Hardware Information: - **Hardware Model:** Dell Inc. Precision 3551 - **Memory:** 64.0 GiB - **Processor:** Intel® Core™ i5-10400H × 8 - **Graphics:** Intel® UHD Graphics (CML GT2) - **Graphics 1:** Quadro P620 - **Disk Capacity:** 1.0 TB ## Software Information: - **Firmware Version:** 1.23.0 - **OS Name:** Fedora Linux 39 (Workstation Edition) - **OS Build:** (null) - **OS Type:** 64-bit - **GNOME Version:** 45.1 - **Windowing System:** X11 - **Kernel Version:** Linux 6.5.11-300.fc39.x86_64\n\nWhat appreciate any input. Thanks!\n\nI can contribute small findings about my Wayland problems: As all software is up to date and I have no clue on how to avoid these Gnome/Wayland/NVidia issue, I have tested a few things after updating my FC39 completely today.\n\nLogging in under Gnome/Wayland still does not work on my user account on FC39.\n\nExactly the same configuration worked for years until the latest updates of FC38.\n\nLogging in using Gnome/X11 under FC39 works flawlessly.\n\nNext I have created a new user account and what a surprise: The Gnome/Wayland session is working fine using this new and unused user account!\n\nMy assumption: Some of the .config/* data is causing the termination of the Wayland session.\n\nCan anybody reproduce this?\n\nDoes anybody have a hint on where to find trouble spots in the user configuration?\n\nI do not see other differences at the moment between the two login users…\n\nThank you in advance!\n\nThomas\n\nHere is my configuration, if required:\n\n# Systemdetailsbericht --- ## Berichtdetails - **Erstellungsdatum:** 2023-11-13 18:44:43 ## Hardware Information: - **Hardware-Modell:** ASUS TUF GAMING B660-PLUS WIFI D4 - **Speicher:** 48,0 GiB - **Prozessor:** 12th Gen Intel® Core™ i5-12400F × 12 - **Grafik:** NVIDIA GeForce RTX™ 3060 Ti - **Festplattenkapazität:** 20,0 TB ## Software Information: - **Firmware-Version:** 2801 - **Name des Betriebssystems:** Fedora Linux 39 (Workstation Edition) - **Betriebssystem-Build:** (null) - **Betriebssystem-Typ:** 64-bit - **GNOME-Version:** 45.1 - **Fenstermanager:** X11 - **Kernel-Version:** Linux 6.5.11-300.fc39.x86_64\n\nHunting for the setting which might hinder the start of a Wayland session on FC39 was not successful until now, but I have found another strange behavior with partial success:\n\nI opened up Gnome Tweaks (“GNOME Optimierung” in the German user interface) and have reset the settings to default by means of the corresponding menu entry.\n\nNow I need to login twice: First attempt most often fails, but the second attempt is successful. The Wayland session starts:\n\n# Systemdetailsbericht --- ## Berichtdetails - **Erstellungsdatum:** 2023-11-14 20:45:29 ## Hardware Information: - **Hardware-Modell:** ASUS TUF GAMING B660-PLUS WIFI D4 - **Speicher:** 48,0 GiB - **Prozessor:** 12th Gen Intel® Core™ i5-12400F × 12 - **Grafik:** NVIDIA GeForce RTX™ 3060 Ti - **Festplattenkapazität:** 20,0 TB ## Software Information: - **Firmware-Version:** 2801 - **Name des Betriebssystems:** Fedora Linux 39 (Workstation Edition) - **Betriebssystem-Build:** (null) - **Betriebssystem-Typ:** 64-bit - **GNOME-Version:** 45.1 - **Fenstermanager:** Wayland - **Kernel-Version:** Linux 6.5.11-300.fc39.x86_64\n\nThis is not a sattisfying solution and far from robust, but the first time I can start Gnome/Wayland using my account. This does not feel very relyable and I needed to reset the Gnome Tweaks again. Thus this solution does not seem to be persistent.\n\nDid anybody else find a superior solution?\n\nJust a remark on my system configuration: I am using a dual screen setup.\n\nIs this a pattern for this failure? Or to be more direct: Are youalso running a dual screen system while observing this problem?\n\nI followed your suggestion and “Reset to default” in Gnome Tweaks, but it did not allow me to log in with my default account under Wayland, even after repeatedly trying to enter the password. I even de-installed Gnome Tweaks, but this didn’t work either.\n\nSomething else that I tried (and that did not work) is to de-install the current NVIDIA driver and install the NVIDIA 470xx driver instead.\n\nEven before the upgrade to F39 I occasionally experienced some weird behavior, usually after system updates: the first login attempt would fail, but the second one would work, however GNOME extensions were deactivated. Back then I was not bothered too much and did not link it to Wayland.\n\nhi guys,\n\nI think I have a similar problem.\n\n(my english is too bad, this post was translated with DeepL)\n\nmy configuration : OS : F39 Laptop : LENOVO LEGION GPU 1 : AMD Radeon, GPU 2 : Nvidia RTX 3070 with two exteral scrreens\n\nFirst of all, i had no problem when u was with F38.\n\nwhen I only use the laptop screen or a single external screen, everything is OK.\n\nBut when I use the 2 external screens :\n\nWhen I connect, window display is very slow (about 2 seconds lag). On the other hand, the mouse cursor moves without lag.\n\nIf I close the session and reconnect (with the same account, everything is normal.\n\nOn 1st startup (with slow display), if I unplug the HDMI/ISB-C cable from one of the two external screens, the display returns to normal.\n\nI think it’s a problem linked to the NVIDIA driver (in association with the last 2 Kernels) since, unless I’m mistaken, it’s the Nvidia card that manages the display of the external screens on my laptop. Maybe we just need to wait for updates.\n\nThank you for the hint, George!\n\nAFAIK, the kernel options are located in the grubenv binary file. Correct? There is only one file with one set of options for every kernel. Is this correct? The file had been updated, thus it could be a source of the problem. But how can I analyze this file?\n\nThe fallback values in grub.cfg are:\n\nroot=UUID=364f2d1f-b939-4aae-8b1a-bbc6d242a18e ro rootflags=subvol=@root initcall_blacklist=simpledrm_platform_driver_init resume=UUID=3e13fa5e-eddf-4dd5-95b7-2022af12a5b7 rhgb quiet initcall_blacklist=simpledrm_platform_driver_init rd.driver.blacklist=nouveau modprobe.blacklist=nouveau nvidia-drm.modeset=1\n\nI can’t tell whether this is equivalent to the contents of grubenv…\n\nThe options do not seem to have changed. Noveau is blacklisted for NVidia drivers. Do you see any potential source of problems here?\n\nIs there another option to analyze the kernel command line?"
    }
}