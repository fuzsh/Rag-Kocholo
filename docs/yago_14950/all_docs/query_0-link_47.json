{
    "id": "yago_14950_0",
    "rank": 47,
    "data": {
        "url": "https://dokumen.pub/january-2012-ieee-mtt-v060-i01-2012-01-60-1nbsped.html",
        "read_more_link": "",
        "language": "en",
        "title": "JANUARY 2012 IEEE MTT",
        "top_image": "https://dokumen.pub/img/january-2012-ieee-mtt-v060-i01-2012-01-60-1nbsped.jpg",
        "meta_img": "https://dokumen.pub/img/january-2012-ieee-mtt-v060-i01-2012-01-60-1nbsped.jpg",
        "images": [
            "https://dokumen.pub/dokumenpub/assets/img/dokumenpub_logo.png",
            "https://dokumen.pub/img/200x200/january-2022-ieee-spectrum.jpg",
            "https://dokumen.pub/img/200x200/december-2012-ieee-mtt-v060-i12-2012-12b-60-12nbsped.jpg",
            "https://dokumen.pub/img/200x200/december-2012-ieee-mtt-v060-i12-2012-12a-60-12nbsped.jpg",
            "https://dokumen.pub/img/200x200/july-2012-ieee-mtt-v060-i07-2012-07-60-7nbsped.jpg",
            "https://dokumen.pub/img/200x200/april-2012-ieee-mtt-v060-i04-2012-04-60-4nbsped.jpg",
            "https://dokumen.pub/img/200x200/march-2012-ieee-mtt-v060-i03-2012-03b-60-3nbsped.jpg",
            "https://dokumen.pub/img/200x200/august-2012-ieee-mtt-v060-i08-2012-08-60-8nbsped.jpg",
            "https://dokumen.pub/img/200x200/september-2012-ieee-mtt-v060-i09-2012-09-60-9nbsped.jpg",
            "https://dokumen.pub/img/200x200/november-2012-ieee-mtt-v060-i11-2012-11-60-11nbsped.jpg",
            "https://dokumen.pub/img/200x200/june-2012-ieee-mtt-v060-i06-2012-06a-60-6nbsped.jpg",
            "https://dokumen.pub/img/200x200/january-2012-ieee-mtt-v060-i01-2012-01-60-1nbsped.jpg",
            "https://dokumen.pub/dokumenpub/assets/img/dokumenpub_logo.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "...",
        "meta_lang": "en",
        "meta_favicon": "https://dokumen.pub/dokumenpub/assets/img/apple-icon-57x57.png",
        "meta_site_name": "dokumen.pub",
        "canonical_link": "https://dokumen.pub/january-2012-ieee-mtt-v060-i01-2012-01-60-1nbsped.html",
        "text": "Citation preview\n\nJANUARY 2012\n\nVOLUME 60\n\nNUMBER 1\n\nIETMAB\n\n(ISSN 0018-9480)\n\nPAPERS\n\nTheory and Numerical Methods Multi-Mode Coupling Wave Theory for Helically Corrugated Waveguide ...... ......... ......... ........ ........ L. Zhang, W. He, K. Ronald, A. D. R. Phelps, C. G. Whyte, C. W. Robertson, A. R. Young, C. R. Donaldson, and A. W. Cross Passivity Enforcement for Admittance Models of Distributed Networks Using an Inverse Eigenvalue Method . ......... .. .. ........ ......... ......... ........ ......... ......... ........ ......... ......... ........ ......... . C. S. Saunders and M. B. Steer\n\n1\n\nPassive Components and Circuits Extended Passband Bandstop Filter Cascade With Continuous 0.85–6.6-GHz Coverage ........ ........ ......... ......... .. .. ........ ......... ......... ........ ......... ......... ........ ......... .. E. J. Naglich, J. Lee, D. Peroulis, and W. J. Chappell Design Method for Ultra-Wideband Bandpass Filter With Wide Stopband Using Parallel-Coupled Microstrip Lines .. .. .. ........ ......... ......... ........ ......... ......... ........ ......... ......... ........ ......... ......... ........ .... A. M. Abbosh Design of a Broadband Eight-Way Coaxial Waveguide Power Combiner ....... ......... ......... M. Amjadi and E. Jafari\n\n21\n\nHybrid and Monolithic RF Integrated Circuits -Band CMOS Differential and Quadrature Voltage-Controlled Oscillators for Low Phase-Noise and Low-Power Applications ... ......... ........ ......... ......... ........ ......... ......... ........ ......... ..... H.-Y. Chang and Y.-T. Chiu Low-Voltage -Band Divide-by-3 Injection-Locked Frequency Divider With Floating-Source Differential Injector ... .. .. ........ ......... ......... ........ ......... ......... ..... Y.-T. Chen, M.-W. Li, H.-C. Kuo, T.-H. Huang, and H.-R. Chuang Compact Wideband Linear CMOS Variable Gain Amplifier for Analog-Predistortion Power Amplifiers ....... ......... .. .. ........ ......... ......... ........ ......... ......... ........ ..... Y.-Y. Huang, W. Woo, H. Jeon, C.-H. Lee, and J. S. Kenney A Dual-Mode CMOS RF Power Amplifier With Integrated Tunable Matching Network ........ ........ ......... ......... .. .. ........ ......... ......... ........ ......... ........ Y. Yoon, J. Kim, H. Kim, K. H. An, O. Lee, C.-H. Lee, and J. S. Kenney Switching Behavior of Class-E Power Amplifier and Its Operation Above Maximum Frequency ....... ......... ......... .. .. ........ ......... ......... ........ ......... ......... ........ ......... ......... ..... S. Jee, J. Moon, J. Kim, J. Son, and B. Kim\n\n8\n\n31 39\n\n46 60 68 77 89\n\n(Contents Continued on Back Cover)\n\n(Contents Continued from Front Cover) Broadband Doherty Power Amplifier via Real Frequency Technique .... ........ .... ...... ........ G. Sun and R. H. Jansen A 17–35 GHz Broadband, High Efficiency PHEMT Power Amplifier Using Synthesized Transformer Matching Technique ...... ......... ........ ......... . ........ ........ ......... ....... P.-C. Huang, Z.-M. Tsai, K.-Y. Lin, and H. Wang A 50-Mb/s CMOS QPSK/O-QPSK Transmitter Employing Injection Locking for Direct Modulation . ......... ......... .. .. ........ ......... ......... ........ ......... ....... S. Diao, Y. Zheng, Y. Gao, S.-J. Cheng, X. Yuan, M. Je, and C.-H. Heng An Open-Loop Half-Quadrature Hybrid for Multiphase Signals Generation .... ......... ......... H.-S. Chen and L. H. Lu A Phased Array RFIC With Built-In Self-Test Capabilities ...... ......... ........ ..... O. Inac, D. Shin, and G. M. Rebeiz Instrumentation and Measurement Techniques Fast Multiharmonic Active Load–Pull System With Waveform Measurement Capabilities ...... ........ ......... ......... .. .. ........ ......... ......... ........ ......... ......... ........ ......... ......... ........ ......... .. M. Thorsell and K. Andersson Broadband Electromagnetic Modeling of Woven Fabric Composites .... ........ ......... ......... ........ ......... ......... .. .. ........ ......... ......... ........ ......... ......... ........ ........ M. S. Mirotznik, S. Yarlagadda, R. McCauley, and P. Pa Low-DC Voltage-Controlled Steering-Antenna Radome Utilizing Tunable Active Metamaterial ....... ......... ......... .. .. ........ ......... ......... ........ . T. Jiang, Z. Wang, D. Li, J. Pan, B. Zhang, J. Huangfu, Y. Salamin, C. Li, and L. Ran Conformal Ink-Jet Printed -Band Phased-Array Antenna Incorporating Carbon Nanotube Field-Effect Transistor Based Reconfigurable True-Time Delay Lines ........ ........ .. M. Y. Chen, D. Pham, H. Subbaraman, X. Lu, and R. T. Chen RF Applications and Systems Distortion Mechanisms Originating From Modal Noise in Radio Over Multimode Fiber Links . ........ ......... ......... .. .. ........ ......... ......... ........ ......... ......... ........ ... G. Alcaro, D. Visani, L. Tarlazzi, P. Faccin, and G. Tartarini The Performance of a Fiber-Optic Link Using Unbiased Balanced Photodiodes for Antenna Array Calibration ........ .. .. ........ ......... ......... ........ J. F. Diehl, V. J. Urick, C. S. McDermitt, F. Bucholtz, P. S. Devgan, and K. J. Williams\n\n99 112 120 131 139\n\n149 158 170 179\n\n185 195\n\nLETTERS\n\nComments on “A Compact Dual-Band 90 Coupler With Coupled-Line Sections” ..... ......... . ....... ....... M.-J. Park\n\n201\n\nInformation for Authors .. ........ ......... ......... ........ ......... .......... ........ ......... ......... ........ ......... ......... .\n\n202\n\nIEEE MICROWAVE THEORY AND TECHNIQUES SOCIETY\n\nThe Microwave Theory and Techniques Society is an organization, within the framework of the IEEE, of members with principal professional interests in the field of microwave theory and techniques. All members of the IEEE are eligible for membership in the Society upon payment of the annual Society membership fee of $17.00, plus an annual subscription fee of $23.00 per year for electronic media only or $46.00 per year for electronic and print media. For information on joining, write to the IEEE at the address below. Member copies of Transactions/Journals are for personal use only. ADMINISTRATIVE COMMITTEE N. KOLIAS, President A. ABUNJAILEH S. BARBIN L. BOGLIONE\n\nM. GUPTA President Elect\n\nT. BRAZIL W. CHAPPELL\n\nG. LYONS, Secretary\n\nN. KOLIAS S. KOUL\n\nM. GOUKER K. ITOH\n\nT. LEE M. MADIHIAN\n\nHonorary Life Members\n\nT. ITOH A. A. OLINER\n\nW. CHAPPELL, Treasurer\n\nA. MORTAZAWI V. NAIR\n\nDistinguished Lecturers\n\nP. STAECKER K. TOMIYASU\n\nJ-C. CHIAO M. GUPTA\n\nS. KOUL L. PIERANTONI\n\nD. PASQUET G. PONCHAK D. SCHREURS\n\nR. SORRENTINO B. SZENDRENYI R. WEIGEL\n\nD. SCHREURS J. WOOD\n\nK. WU Q. XUE\n\nPast Presidents\n\nR. SNYDER (2011) S. M. EL-GHAZALY (2010) B. PERLMAN (2009)\n\nMTT-S Chapter Chairs Albuquerque: H. J. WAGNON Atlanta: K. NAISHADHAM Austria: A. SPRINGER Baltimore: J. SCHOFIELD Bangalore/India: K. VINOY Beijing: Z. FENG Belarus: A. GUSINSKY Benelux: G. VANDENBOSCH Boston: J. MULDAVIN Bombay/India: M. KADU Brasilia: J. BEZERRA/ M. VINICIUS ALVES NUNES Buenaventura: M. QUDDUS Bulgaria: K. ASPARUHOVA Canada, Atlantic: Z. CHEN Cedar Rapids/Central Iowa: M. ROY Central Indiana: C. FULTON Central & South Italy: L. TARRICONE Central No. Carolina: M. HUGHES Central Texas: J. PRUITT Chengdu: Z. NEI Chicago: D. ERRICOLO Cleveland: M. SCARDELLETTI Columbus: D. PSYCHOUDAKIS Connecticut: C. BLAIR Croatia: D. BONEFACIC Czech/Slovakia: J. DRINOVSKY Dallas: C. SANABRIA Dayton: A. TERZUOLI\n\nEditor-In-Chief GEORGE E. PONCHAK NASA Glenn Research Center Cleveland, OH USA Editorial Assistant KIM TANGER OAI USA\n\nDelhi/India: S. KOUL Delhi/India, Amity Univ: J. P. GODARA Delhi/India, ABES Eng. College: S. MITTAL Delhi/India, IIT Delhi: M. S. PARIHAR Delhi/India, Jamia Millia Islamia: A. KHAN Delhi/India, Rajasthan Tech. Univ.: P. K. SHARMA Delhi/India, Swami Keshvanand Inst.: A. S. POONIA Denver: M. JANEZIC Eastern No. Carolina: T. NICHOLS Egypt: E. HASHEESH Finland: A. LUUKANEN Florida West Coast: J. WANG Foothills: F. FREYNE France: P. EUDELINE Germany: G. BOECK Greece: R. MAKRI Gujarat/India: R. J. SHARMA Harbin: Q. WU Hawaii: R. MIYAMOTO Hong Kong: Q. XUE Houston: S. A. LONG Houston, College Station: G. H. HUFF Hungary: L. NAGY Huntsville: E. GREGORIAN Hyderabad: L. MERUGU India/Calcutta: D. GUHA\n\nIndia: D. BHATNAGER Indonesia: E. T. RAHARDO Israel: S. AUSTER Japan: K. HONJO Kansai: I. AWAI Kitchener-Waterloo: R. R. MANSOUR Lebanon: E. NASSAR Lithuania: V. URBANAVICIUS Long Island/New York: J. COLOTTI Los Angeles, Coastal: V. RADISIC Los Angeles, Metro/San Fernando: T. CISCO Macau: K. W. TAM Madras/India: S. SALIVAHANAN Malaysia: M. ESA Malaysia, Penang: B. L. LIM Melbourne: R. BOTSFORD Milwaukee: S. G. JOSHI Mohawk Valley: E. P. RATAZZI Monterrey/Mexico: R. M. RODRIGUEZ-DAGNINO Morocco: M. ESSAAIDI Montreal: K. WU Morocco: M. ESSAAIDI Nagoya: T. OHIRA Nanjing: W. XUN Nanjing/Southeast Univ: W. HONG New Hampshire: D. SHERWOOD New Jersey Coast: J. SINSKY New South Wales: K. ESSELLE New Zealand: A. WILLIAMSON North Italy: G. VECCHI North Jersey: K. DIXIT\n\nNorthern Australia: J. MAZIERSKA Northern Canada: M. DANESHMAND Northern Nevada: B. S. RAWAT Norway: K. M. GJERTSEN Orange County: H. J. DE LOS SANTOS Oregon: K. MAYS Orlando: S. EBADI Ottawa: Q. YE Philadelphia: Q. VASSEUR Phoenix: S. ROCKWELL Poland: J. PIOTROWSKI Portugal: N. BORGES DE CARVALHO Princeton/Central Jersey: A. KATZ Queensland: A. ROBINSON Rio de Janeiro: J. R. BERGMANN Rochester: G. PETTIS Romania: G. LOJEWSKI Russia, Moscow: V. A. KALOSHIN Russia, Nizhny-Novgorad: G. L. PAKHOMOV Russia, Novosibirsk: A. YAROSLAVTSEV Russia, Saratov/Penza: N. M. RYSKIN Russia, Saint Petersburg: S. P. ZUBKO Russia, Tomsk: R. V. MESCHERIAKOV San Diego: J. TWOMEY Santa Clara Valley/San Francisco: N. SHAMS Seattle: L. CAI Seoul: C. SEO Serbia and Montenegro: B. MILOVANOVIA Shanghai: J. MAO Singapore: M. ONG LING CHUEN South Africa: R. GESCHKE\n\nSouth Australia: C. FUMEAUX South Brazil: J. R. BERGMANN Southeastern Michigan: T. OZDEMIR Southern Alberta: E. FEAR Spain: J. I. ALONSO Springfield: P. R. SIQUEIRA Sri Lanka: V. R. HERATH Sweden: A. RYDBERG Switzerland: M. MATTES Syracuse: H. P. PARTAL Taegu: Y.-H. JEONG Tainan: T. HORNG Taipei: C.-S. LU Thailand: P. AKKARAEKTHALIN Toronto: G. V. ELEFTHERIADES Tucson: H. XIN Tunisia: A. GHARSALLAH Turkey: B. SAKA Twin Cities: M. J. GAWRONSKI UK/RI: A. REZAZADEH Ukraine, Kiev: Y. PROKOPENKO Ukraine, Rep. of Georgia: G. GHVEDASHVILI Ukraine, Vinnitsya: V. M. DUBOVOY Ukraine, West: I. IVASENKO Uttar Pradesh/India: N. ALAM Utter Pradesh/India: R. C. AGARWAL Vancouver: S. MCCLAIN Venezuela: J. B. PENA Victoria: K. GHORBANI Virginia Mountain: T. A. WINSLOW Washington DC/Northern Virginia: M. NUESLEIN Winnipeg: V. OKHMATOVSKI Xian: X. SHI\n\nAssociate Editors HERBERT ZIRATH Chalmers Univ. Technol. Goteborg, Sweden WENDY VAN MOER Vrije Universiteit Brussel Brussels JAE-SUNG RIEH Korea Univ. Seoul, Korea QUAN XUE City Univ. Hong Kong Hong Kong LEI ZHU Nanyang Technol. Univ. Singapore\n\nKEVIN J. CHEN Hong Kong Univ. Sci. Technol. Hong Kong MING YU COM DEV Cambridge, ON, Canada CHIN-WEN TANG Nat. Chung Cheng Univ. Taiwan JOHN PAPAPOLYMEROU Georgia Inst. Technol. Atlanta, GA USA\n\nJ. WOOD, Editor-in-Chief, IEEE Microwave Magazine C. TZUANG, Editor-in-Chief, IEEE Microwave and Wireless Component Letters\n\nN. SCOTT BARKER Univ. Virginia Charlottesville, VA USA COSTAS D. SARRIS Univ. Toronto. Toronto, ON, Canada CHRISTOPHE FUMEAUX The Univ. Adelaide Adelaide, South Australia, Australia DEUKHYOUN HEO Washington State Univ. Pullman, WA USA BERTAN BAKKALOGLU Arizona State Univ. Tempe, AZ USA\n\nP. H. SIEGEL, Editor-in-Chief, IEEE Trans. Terahertz Science and Technology T. LEE, Web Master\n\nIEEE Officers MICHAEL R. LIGHTNER, Vice President, Educational Activities DAVID A. HODGES, Vice President, Publication Services and Products HOWARD E. MICHEL, Vice President, Member and Geographic Activities STEVE M. MILLS, President, Standards Association FREDERICK C. MINTZER, Vice President, Technical Activities JAMES M. HOWARD, President, IEEE-USA\n\nGORDON W. DAY, President PETER W. STAECKER, President-Elect CELIA L. DESMOND, Secretary HAROLD L. FLESCHER, Treasurer MOSHE KAM, Past President\n\nPETER N. CLOUT, Director, Division IV—Electromagnetics and Radiation\n\nIEEE Executive Staff DR. E. JAMES PRENDERGAST, Executive Director & Chief Operating Officer THOMAS SIEGERT, Business Administration MATTHEW LOEB, Corporate Activities DOUGLAS GORHAM, Educational Activities EILEEN LACH, General Counsel & Corporate Compliance BETSY DAVIS, SPHR, Human Resources CHRIS BRANTLEY, IEEE-USA\n\nALEXANDER PASIK, Information Technology PATRICK MAHONEY, Marketing CECELIA JANKOWSKI, Member and Geographic Activities ANTHONY DURNIAK, Publications Activities JUDITH GORMAN, Standards Activities MARY WARD-CALLAN, Technical Activities\n\nIEEE Periodicals Transactions/Journals Department Staff Director: FRAN ZAPPULLA Editorial Director: DAWN MELLEY Production Director: PETER M. TUOHY Managing Editor: MONA MITTRA Senior Editor: CHRISTINA M. REZES\n\nIEEE TRANSACTIONS ON MICROWAVE THEORY AND TECHNIQUES (ISSN 0018-9480) is published monthly by the Institute of Electrical and Electronics Engineers, Inc. Responsibility for the contents rests upon the authors and not upon the IEEE, the Society/Council, or its members. IEEE Corporate Office: 3 Park Avenue, 17th Floor, New York, NY 10016-5997. IEEE Operations Center: 445 Hoes Lane, Piscataway, NJ 08854-4141. NJ Telephone: +1 732 981 0060. Price/Publication Information: Individual copies: IEEE Members $20.00 (first copy only), nonmember $157.00 per copy. (Note: Postage and handling charge not included.) Member and nonmember subscription prices available upon request. Copyright and Reprint Permissions: Abstracting is permitted with credit to the source. Libraries are permitted to photocopy for private use of patrons, provided the per-copy fee indicated in the code at the bottom of the first page is paid through the Copyright Clearance Center, 222 Rosewood Drive, Danvers, MA 01923. For all other copying, reprint, or republication permission, write to Copyrights and Permissions Department, IEEE Publications Administration, 445 Hoes Lane, Piscataway, NJ 08854-4141. Copyright © 2012 by The Institute of Electrical and Electronics Engineers, Inc. All rights reserved. Periodicals Postage Paid at New York, NY and at additional mailing offices. Postmaster: Send address changes to IEEE TRANSACTIONS ON MICROWAVE THEORY AND TECHNIQUES, IEEE, 445 Hoes Lane, Piscataway, NJ 08854-4141. GST Registration No. 125634188. CPC Sales Agreement #40013087. Return undeliverable Canada addresses to: Pitney Bowes IMEX, P.O. Box 4332, Stanton Rd., Toronto, ON M5W 3J4, Canada. IEEE prohibits discrimination, harassment and bullying. For more information visit http://www.ieee.org/nondiscrimination. Printed in U.S.A.\n\nDigital Object Identifier 10.1109/TMTT.2011.2181011\n\nIEEE TRANSACTIONS ON MICROWAVE THEORY AND TECHNIQUES, VOL. 60, NO. 1, JANUARY 2012\n\n1\n\nMulti-Mode Coupling Wave Theory for Helically Corrugated Waveguide Liang Zhang, Wenlong He, Kevin Ronald, Alan D. R. Phelps, Colin G. Whyte, Craig W. Robertson, Alan R. Young, Craig R. Donaldson, and Adrian W. Cross\n\nAbstract—Helically corrugated waveguide has been used in various applications such as gyro-backward wave oscillators, gyro-traveling wave amplifier and microwave pulse compressor. A fast prediction of the dispersion characteristic of the operating eigenwave is very important when designing a helically corrugated waveguide. In this paper, multi-mode coupling wave equations were developed based on the perturbation method. This method was then used to analyze a five-fold helically corrugated waveguide used for X-band microwave compression. The calculated result from this analysis was found to be in excellent agreement with the results from numerical simulation using CST Microwave Studio and vector network analyzer measurements. Index Terms—Coupling coefficients, coupling wave theory (CWT), dispersion curve, helically corrugated waveguide.\n\nI. INTRODUCTION\n\nS\n\nTRAIGHT hollow metal waveguides with uniform cross section can only support modes whose phase velocity is larger than the speed of light, while waveguides with periodic corrugations can propagate modes with phase velocity less than the speed of light and are suitable for particle beam-wave interactions. Periodically corrugated waveguides have been used in many applications, including slow-wave structures with axial periodicity for conventional backward wave oscillators (BWOs) and traveling wave tubes (TWTs)[1], and magnetrons [2] with azimuthal periodicity. Corrugated waveguide structures have also been used as Bragg reflectors [3], [4]. The helically corrugated waveguide, which contains both axial and azimuthal periodicity, has attracted significant interest in the last 10 years and has successfully found applications in the gyrotron traveling wave amplifier (gyro-TWA) [5], [6], as a dispersive medium for frequency-swept microwave pulse compression[7], [8] and in the gyrotron backward wave oscillator (gyro-BWO)[9], [10]. The electrodynamic properties of the helically corrugated waveguide are important, as the dispersion characteristic of the operating eigenwave can be changed by Manuscript received March 28, 2011; revised September 13, 2011; accepted September 20, 2011. Date of publication November 02, 2011; date of current version December 30, 2011. This work was supported by the U.K. EPSRC Research Grant EP/E058868/1. The work of L. Zhang was supported by SUPA and SORSAS under the award of a SUPA prize research studentship. The authors are with SUPA, Department of Physics, University of Strathclyde, Glasgow, G4 0NG, Scotland, U.K. (e-mail: [email protected]; [email protected]; [email protected]; [email protected]; colin. [email protected]; [email protected]; [email protected]; [email protected]; [email protected]). Color versions of one or more of the figures in this paper are available online at http://ieeexplore.ieee.org. Digital Object Identifier 10.1109/TMTT.2011.2170848\n\nchoosing different corrugation depths and corrugation periods to meet the needs of different applications. In a gyro-TWA or gyro-BWO, a constant group velocity in the operating frequency range is desired, while in a microwave compressor, a linearly varying group velocity in the frequency band is preferred. Several methods have been developed to investigate the dispersion characteristics of the helically corrugated waveguide by analytical and numerical techniques. The simplest and fastest method to calculate the dispersion curves is the coupled wave theory based on the method of perturbation [11]–[13]. It assumes that the change in the cross section is small and can be treated as a first order derivative of a regular cross section. Reference [12] gives the dispersion relation between two TE modes and [11] gives the results of the coupling coefficients between two TE modes, two TM modes, and one TE mode with one TM mode but no derivations were presented. It is found that when the corrugation depth is less than 15% of the mean radius of the waveguide, the coupled wave theory gives reasonably accurate results. The coupled wave theory played an important role in the preliminary design of the three-fold helical waveguide in which the dispersion of the operating eigenwave is simply a result from the coupling between two TE modes in the operating frequency mode and mode. range, i.e., the spatial harmonic However, the three-fold helical waveguide has limited power capability. A helical waveguide working with a higher eigenwave mode can achieve higher power capability as a larger radius can be used. However operating with higher mode means more modes would take part in the coupling and therefore the resultant dispersion curve would be more complicated to calculate. For example, in a five-fold helical waveguide the spatial mode would couple with the , , harmonic of the and modes. The coupled mode equation, which only considers two TE modes, would therefore not be accurate in obtaining the dispersion characteristics of the five-fold helical waveguide. Necessary modifications to include the coupling between TE and TM modes are required and will be presented in this paper. The dispersion curve of the helically corrugated waveguide can also be numerically simulated by using some computer codes, such as the finite-element method (FEM), the eigensolver in CST Microwave Studio, the electromagnetic field solver in the particle-in-cell (PIC) code MAGIC and the transient solver in CST Microwave Studio, which use a finite-difference time-domain method (FDTD) [14]. By using these codes, accurate results can be obtained if the mesh grid is dense enough. However, these 3-D simulations have the disadvantage of requiring long computational times to complete the simulations,\n\n0018-9480/$26.00 © 2011 IEEE\n\n2\n\nIEEE TRANSACTIONS ON MICROWAVE THEORY AND TECHNIQUES, VOL. 60, NO. 1, JANUARY 2012\n\nfor example, two or three days on a powerful desktop PC using a reasonably dense mesh grid and they are therefore not suitable for optimizing the dimensions of the helical waveguide for a particular application. It should be noticed that the helically corrugated waveguide can also be regarded as a type of twisted waveguide. A helicoidal coordinate transform can be employed to convert the twisted waveguide into a straight uniform waveguide, thus downgrading the 3-D problem into a 2-D one [15]. The price of using this technique is the uniform material properties in the twisted waveguide will become non-uniform and position dependent. This transformation method can greatly reduce the computing time in resolving the eigenwave dispersion when applying the FEM and FDTD methods in the 2-D geometries [16], [17]. It should be noted that the dispersions of the coupled waves and those initial partial waves are all existing and calculated at the same time when this method is used. The dispersion curves of these modes would be interweaved and very close to each other, especially when a higher modes are considered. Therefore the dispersion curves of the operating eigenwaves of the helically corrugated waveguide would be difficult to identify. The field patterns of the eigenmodes can be helpful when identifying the operating dispersion curve, however, it is very difficult to recognize by computer automatically, thus it is not suitable for the optimization routing. On the other hand, this operating eigenwave from the transformation method can be easily identified by using the calculated result from the coupled wave theory as a reference. It is evident that the analytical calculation using the coupled wave theory is very useful in the preliminary design of the helically corrugated waveguide. It is also useful to accurately and rapidly predict the dispersion of the eigenwave when used in combination with the transformation method. In this paper, a detailed description of the coupling coefficient between TE modes and TM modes and the extended eigenwave equations caused by multi-mode coupling are discussed in Section II. Dispersion calculation of a five-fold helically corrugated waveguide is described in Section III. The comparison between the theoretical calculation and the experiment is presented in Section IV.\n\nFig. 1. Coupling between the TE mode and the spatial harmonic mode in a three-fold helical waveguide.\n\nTE\n\nmode In three-fold helically corrugated waveguide, the would couple with the circularly polarized mode of opposite rotation and generate an operating eigenwave, as shown in Fig. 1. From the synchronism condition, coupling between . However, with higher modes requires larger fold number larger more modes would satisfy the synchronism condition and they would couple with each other and hence contribute to the dispersion characteristic. A. Coupling Coefficients The coupling coefficient is the basis of the coupled wave theory as it indicates how strong the coupling between two modes is. In this paper, we start from the general equations of the coupling coefficients between two TE modes, two TM modes and one TE (mode ) to one TM (mode ) modes as shown in (3). The derivation of these equations can be found in [18], which contains a detailed introduction to the coupled mode theory\n\nII. PRINCIPLE OF THE COUPLED WAVE THEORY The equation of the helical profile of the inner surface in a cylindrical coordinate system can be written as (1) (3) where is the mean radius of the circular waveguide, is the is the fold number, and is the axial pecorrugation depth, riod of the corrugation. When the corrugation depth is not zero, two modes will couple when their axial and azimuthal wave numbers satisfy the synchronism conditions (2) where and and and respectively.\n\nare the axial wavenumbers of modes 1 and 2, are the azimuthal indices of modes 1 and 2,\n\nwhere is the function to describe the difference between the perturbed non-uniform waveguide and the uniform waveguide. , there is no coupling between the two modes. When , are the axial wave numbers of the coupled modes and is the free-space wave number. , are the transverse wave numbers of modes and . , are the transverse eigenfunctions of the TE and TM modes of the unperturbed regular waveguide. is the normal vector directed towards the waveguide wall. is chosen so that axes , , to form a right-handed coordinate system.\n\nZHANG et al.: MULTI-MODE COUPLING WAVE THEORY FOR HELICALLY CORRUGATED WAVEGUIDE\n\nIn circular waveguide, the transverse wave number and eigenfunction in a cylindrical coordinate system are in the form of\n\nfor TE mode for TM mode\n\n3\n\ntical application, is always chosen as a negative value indialso is a negacating an opposite rotating mode and hence tive value. The integral in this equation will become unity if we apply the synchronism condition. Then the final coupling coefficients for the helically corrugated waveguide become\n\n(4)\n\n(7)\n\n(5) where is the zero of the derivation of and is the is the root of . In pracfirst kind of Bessel function. tical applications, the operating mode in the helically corrugated . As the radial number in the waveguide always satisfies modes does not contribute to the following derivation, symbols and are used to denote the azimuthal number of the two coupling modes for simplicity. The difference between the helically corrugated cross seccan be written tion and the circular waveguide at position . For a small corrugation, we have as . As is in terms of the first-order derivation of the mean radius, if only the first-order approximation of the coupling coefficient is taken into account then only the zero-order approximation of the other terms in (3) needs to be considand ered. In polar coordinates, we can simply make . Substituting these into (3), we can get a simpler form of the coupling coefficients, as\n\nEquation (7) has the same form as the ones in [11], while the . coupling coefficient in [11] has been normalized to B. Coupled Mode Equations Although the coupling coefficient indicates the strength of the coupling between two modes, it is useful to know the strength of the coupling modes in the resultant eigenwave. They can be solved from the coupled mode equations [18] and the coupling coefficient, as (8) , are the normalized voltages of mode and in where the helically corrugated waveguide, respectively, and is the phase of mode or in the waveguide, and is the phase difference between the two coupled modes in the waveguide with the length of one if the synchronism conditions are apperiod . becomes plied. and in the helically The normalized voltages of mode corrugated waveguide can be solved as (9) where\n\nThey are completely determined by which is dependent on the axial wavenumbers of the coupling modes and the coupling coefficient. C. Dispersion Curve Function\n\n(6)\n\nThe new dispersion curve caused by two-mode coupling will satisfy the following equation: (10)\n\nIn the helically corrugated waveguide, only the modes that satisfy the synchronism conditions can couple with each other. Thus we have . It should be noted that, in the prac-\n\nare the dispersion relations of the coupling modes where , which are functions of the axial wavenumber . For a TE/TM\n\n4\n\nIEEE TRANSACTIONS ON MICROWAVE THEORY AND TECHNIQUES, VOL. 60, NO. 1, JANUARY 2012\n\nFig. 3. Schematic view of the five-fold helical waveguide.\n\nIII. DISPERSION CALCULATION OF A FIVE-FOLD HELICALLY CORRUGATED WAVEGUIDE Fig. 2. Coupling modes in a five-fold helical waveguide.\n\nmode in the circular waveguide, the dispersion relation can be written as (11) is the negative Because, as noted in Section II-A, mode spatial harmonic wave, the dispersion curve is shifted to the left to produce the following dispersion relation: by (12) Equation (10) is a fourth-order linear equation. Given a wave number , we can get four eigenvalues by solving the equation. However, only two of them have practical physical meaning, and lower and they are named as upper coupled mode coupled mode . If there is no coupling between the two , the eigenfunction will degenerate into modes, that is and two separate dispersion curve functions, i.e., . The and will degenerate into the previous uncoupled partial eigenwaves. There is no straightforward dispersion curve equation available that can take into account all of the considered modes for a helically corrugated waveguide operating in a higher mode. However, from the dispersion diagram, it is clear that the coupling frequencies between any two modes, as shown in Fig. 2 which shows the five-fold helical waveguide case, are different. Thus an alternative method is to calculate the coupled eigenwaves in sequence by using the two-mode coupling equation, either from the lower frequency to the higher frequency, or vice versa. Here the sequence from higher to lower frequencies is and can be reused. First, two eigenwaves does not have solved from (10)–(12). Then eigenwave an intersection with the next mode, thus it is saved as an eigenin Fig. 2). Eigenwave couples with the next wave ( ( in Fig. 2) and by using mode to generate refers to the eigencurve and (10), while here , are the axial wavenumbers in the intersection of mode and the next coupled mode. By repeating this process, all the eigenwaves caused by the mode coupling in the helically corrugated waveguide can be obtained.\n\nOne of the applications of the helically corrugated waveguide is as a dispersive medium for pulse compression. A three-fold corrugated waveguide operating in X-band was previously designed and was used in an experiment that achieved a compression factor of 25 [19]. The maximum power capability of the waveguide is about 1 MW. To pursue higher power capability [20], a five-fold helically corrugated waveguide with larger radius operating in the same frequency range has been investigated. A general schematic view of a five-fold helical waveguide is shown in Fig. 3. The desired coupled modes are the mode and the mode. As known spatial harmonic mode, the from the synchronism condition, besides the possible modes that can couple with the are the and modes in the lower frequency range and the effects need to be investigated. A fast prediction of the operating dispersion curve can be obtained by using the multi-mode coupling method, as shown in mode is much smaller Fig. 2. The cut-off frequency of the and modes, thus it will not contribute to than the the operating eigenwave in the frequency range of interest for the microwave compressor. The choice of the mean radius of the helically corrugated waveguide needs to balance the dispersion characteristic as well as the power capability. A smaller has a larger cut-off frequency gap between the , and modes, thus it is possible to reduce the effect caused by and modes. However, a the coupling between the small radius can also reduce the power capability, which is opposite to the original aim. The axial period of the helical waveguide determines the intersection points of the coupled modes, greatly contributes to the coupling and the corrugation depth coefficients, a larger corrugation depth results in stronger coupling. An optimum set of parameters can be searched for simply by parameter sweeping, or from an optimization algorithm to find an optimum balance among the requirements, such as the power capability, the operating frequency range, and the dispersion characteristic of the operating eigenwave. IV. COMPARISON BETWEEN THE CALCULATION AND THE EXPERIMENT The five-fold helically corrugated waveguide was studied 32.84 mm, 2.43 mm, and with dimensions of 33.26 mm. The dispersion curve was also measured using a 65 GHz vector network analyzer (VNA) (Anritsu 37397A). The experimental setup is shown in Fig. 4. From left to right, a rectangular to circular mode converter ( in Fig. 4) was first\n\nZHANG et al.: MULTI-MODE COUPLING WAVE THEORY FOR HELICALLY CORRUGATED WAVEGUIDE\n\nFig. 4. Experimental setup for measuring the dispersion curve of the five-fold helical waveguide.\n\n5\n\nan integer, and is the length of the helically corrugated waveguide in the measurement, it agrees well with the dispersion mode, as shown in Fig. 5. At a frequency curve of the 8.8 GHz a small content of the mode exists in of 8.6 mode, this the helical waveguide in conjunction with the causes the measured dispersion result in this frequency range to be spiky as it is the mixed phase information of the two modes. V. CONCLUSION In this paper, a detailed description of the multi-mode coupled wave theory for calculation of the dispersion characteristic of helically corrugated waveguide is given and it is applied to analyze a five-fold helical waveguide. This calculated result from the theory was found to be in good agreement with the CST Microwave Studio simulation result, as well as the VNA measurements. ACKNOWLEDGMENT The authors would like to thank V. L. Bratman, G. G. Denisov, S. V. Samsonov, and S.V. Mishakin for their helpful discussions.\n\nFig. 5. Dispersion curve from coupled mode theory, CST Microwave Studio simulation, and the VNA measurement.\n\nused to convert the fundamental mode in rectangular mode in the circular waveguide to a linearly polarized waveguide. This is followed by an elliptical polarizer ( in Fig. 4) that converts the linearly polarized mode into a left wave. A four-fold helical mode converter hand rotating ( in Fig. 4) was then used to convert the circularly polarized mode into a circularly polarized mode. The mode convertor was designed to have conversion efficiency in the frequency range of 8.75 10.0 GHz. Finally a five-fold helical taper ( in Fig. 4) was used before introducing the mode into the five-fold helically corrugated waveguide ( in Fig. 4) to make sure the mode smoothly converted to the operating eigenwave without reflection. On the other side of the helical waveguide, the same configuration was used. Fig. 5 shows the dispersion curves calculated from the coupled mode theory, simulated from the eigensolver in CST Microwave Studio as well as measured by the VNA. From the coupled mode calculation, there are four eigenwaves resulting from and the , the , the mode coupling between the and the modes. Eigenwave 2 is the operating eigenwave for microwave compression. The dispersion curves from coupled mode theory, simulation using CST Microwave Studio and measurement using a VNA agree well with each other in the frequency range 8.75 10.0 GHz, as shown in Fig. 5. However the measured dispersion at the lower frequency 8.75 GHz underwent a change of trend. This is band 7.6 due to the fact that the frequency is out of the operating band -tomode convertor. The dominant power in of the mode the helically corrugated waveguide is still in the in this lower frequency band. If the measured result in this , where is frequency range is shifted by a factor of\n\nREFERENCES [1] A. S. Gilmour, Principles of Traveling Wave Tubes. Boston, MA: Artech House, 1994. [2] , R. J. Barker, J. H. Booske, N. C. Luhmann, and S. N Gregory, Eds. , Modern Microwave and Millimeter-Wave Power Electronics. New York: IEEE, 2005. [3] C. K. Chong, D. B. McDermott, M. M. Razegh, N. C. Luhmann, J. Pretterebner, D. Wagner, M. Thumm, M. Caplan, and B. Kulke, “Bragg reflectors,” IEEE Trans. Plasma Sci., vol. 20, no. 3, pp. 393–402, Mar. 1992. [4] N. Ginzburg, N. Peskov, A. Sergeev, A. D. R. Phelps, A. W. Cross, and I. V. Konoplev, “The use of a hybrid resonator consisting of one dimensional and two dimensional bragg reflectors for generation of spatially coherent radiation in a coaxial free-electron laser,” Phys. Plasmas, vol. 9, no. 6, pp. 2798–2802, 2002. [5] V. L. Bratman, A. W. Cross, G. G. Denisov, W. He, A. D. R. Phelps, K. Ronald, S. V. Samsonov, and C. G. W. A. R. Young, “High-gain wide-band gyrotron traveling wave amplifier with a helically corrugated waveguide,” Phys. Rev. Lett., vol. 84, no. 12, pp. 2746–2749, 2000. [6] A. W. Cross, W. He, A. D. R. Phelps, K. Ronald, C. G. Whyte, A. R. Young, C. W. Robertson, E. G. Rafferty, and J. Thomson, “Helically corrugated waveguide gyrotron traveling wave amplifier using a thermionic cathode electron gun,” Appl. Phys. Lett., vol. 90, p. 253501, 2007. [7] S. V. Samsonov, A. D. R. Phelps, V. L. Bratman, G. Burt, G. G. Denisov, A. W. Cross, K. Ronald, W. He, and H. Yin, “Compression of frequency-modulated pulses using helically corrugated waveguides and its potential for generating multigigawatt rf radiatione,” Phys. Rev. Lett., vol. 92, p. 118301, 2004. [8] G. Burt, S. V. Samsonov, A. D. R. Phelps, V. L. Bratman, K. Ronald, G. G. Denisov, W. He, A. R. Young, A. W. Cross, and I. V. Konoplev, “Microwave pulse compression using a helically corrugated waveguide,” IEEE Trans. Plasma Sci., vol. 33, no. 2, pp. 661–667, Feb. 2005. [9] W. He, A. W. Cross, A. D. R. Phelps, K. Ronald, C. G. Whyte, S. V. Samsonov, V. L. Bratman, and G. G. Denisov, “Theory and simulations of a gyrotron backward wave oscillator using a helical interaction waveguide,” Appl. Phys. Lett., vol. 89, p. 091504, 2006. [10] W. He, K. Ronald, A. R. Young, A. W. Cross, A. D. R. Phelps, C. G. Whyte, E. G. Rafferty, J. Thomson, C. W. Robertson, D. C. Speirs, S. V. Samsonov, V. L. Bratman, and G. G. Denisov, “Gyro-BWO experiments using a helical interaction waveguide,” IEEE Trans. Electron Devices, vol. 52, no. 5, pp. 839–844, May 2005.\n\n6\n\nIEEE TRANSACTIONS ON MICROWAVE THEORY AND TECHNIQUES, VOL. 60, NO. 1, JANUARY 2012\n\n[11] G. G. Denisov and M. G. Reznikov, “Corrugated cylindrical resonators for short-wavelength relativistic microwave oscillators,” Radiophys. Quantum Electron., vol. 25, no. 5, pp. 407–413, 1982. [12] S. J. Cooke and G. G. Denisov, “Linear theory of a wide-band gyro-TWT amplifier using spiral waveguide,” IEEE Trans. Plasma Sci., vol. 26, no. 3, pp. 519–530, Mar. 1998. [13] G. G. Denisov, V. L. Bratman, A. D. R. Phelps, and S. V. Samsonov, “Gyro-TWT with a helical operating waveguide: New possibilities to enhance efficiency and frequency bandwidth,” IEEE Trans. Plasma Sci., vol. 26, no. 3, pp. 508–518, Mar. 1998. [14] G. Burt, S. V. Samsonov, K. Ronald, G. G. Denisov, A. R. Young, V. L. Bratman, A. D. R. Phelps, A. W. Cross, I. V. Konoplev, W. He, J. Thomson, and C. G. Whyte, “Dispersion of helically corrugated waveguides: Analytical, numerical, and experimental study,” Phys. Rev. E, vol. 70, no. 4, p. 046402, 2004. [15] L. Lewin, Theory of Waveguides: Techniques for the Solution of Waveguide Problems. London, U.K.: Newnes Butterworths, 1975. [16] A. Nicolet and F. Zolla, “Finite element analysis of helicoidal waveguides,” IET Sci., Meas., Technol., vol. 1, no. 1, pp. 67–70, 2007. [17] J. L. Wilson, C. Wang, A. E. Fathy, and Y. W. Kang, “Analysis of rapidly twisted hollow waveguides,” IEEE Trans. Plasma Sci., vol. 57, no. 1, pp. 130–139, Jan. 2009. [18] B. Z. Katsenelenbaum, L. M. D. Ro, M. Pereyaslavets, M. S. Ayza, and M. K. A. Thumm, Theory of Non-Uniform Waveguides: The CrossSection Method. London, U.K.: The IET, 1999. [19] M. McStravick, S. V. Samsonov, K. Ronald, S. V. Mishakin, W. He, G. G. Denisov, C. G. Whyte, V. L. Bratman, A. W. Cross, A. R. Young, P. MacInnes, C. W. Robertson, and A. D. R. Phelps, “Experimental results on microwave pulse compression using helically corrugated waveguide,” J. Appl. Phys., vol. 108, no. 5, p. 054908, 2010. [20] V. L. Bratman, G. G. Denisov, N. G. Kolganov, S. V. Mishakin, S. V. Samsonov, A. W. Cross, W. He, L. Zhang, M. McStravick, C. G. Whyte, A. R. Young, K. Ronald, C. W. Robertson, and A. D. R. Phelps, “Generation of 3 GW microwave pulses in x-band from a combination of a relativistic backward-wave oscillator and a helical-waveguide compressor,” Phys. Plasmas, vol. 17, p. 110703, 2010.\n\nLiang Zhang received the B.Sc. degree in applied physics from the University of Science and Technology of China, Hefei, China, in 2004 and the M.Sc. degree in application of nuclear techniques from the China Academy of Engineering Physics, Chengdu, China, in 2007, respectively. He is currently pursuing the Ph.D. degree in physics from the Scottish Universities Physics Alliance, Department of Physics, University of Strathclyde, Glasgow, U.K. His main research interests include pulse-power technology, and Gyrotron-TWT/backward-wave oscillators.\n\nWenlong He received the B.Sc. degree in physics from Suchow University, Jiangsu, China, in 1983, the M.Sc. degree in accelerator physics from the China Academy of Engineering Physics, Chengdu, China, in 1988, and the Ph.D. degree in relativistic electron beams and masers from the Department of Physics, University of Strathclyde, Glasgow, U.K., in 1995. He is currently a Senior Research Fellow with the Scottish Universities Physics Alliance, Department of Physics, University of Strathclyde. His main research interests include relativistic electron beams, CARMs, FELs, Gyrotron-TWT/backward-wave oscillators, and other highpower microwave devices.\n\nKevin Ronald was born in Glasgow, U.K. He received the B.Sc. (with honors) and Ph.D. degrees in physics from the University of Strathclyde, Glasgow, U.K., in 1992 and 1997, respectively. He is currently a Lecturer with the Scottish Universities Physics Alliance, Department of Physics, University of Strathclyde.\n\nAlan D. R. Phelps was born in the U.K. in 1944. He received the B.A. degree (with honors) in physics and the M.A. degree from Cambridge University, Cambridge, U.K., in 1966 and 1970, respectively, and the D.Phil. degree for plasma research from Oxford University, Oxford, U.K., in 1970. He has been with the University of Strathclyde, Glasgow, U.K., since 1978, where he initially founded a research group, became a Full Professor in 1993, and is currently with the Scottish Universities Physics Alliance, Department of Physics, where he was the Head of the department from 1998 to 2001. His research interests include high-power free-electron radiation sources and plasmas. Dr. Phelps is a Fellow of the Institute of Physics and of the Royal Society of Edinburgh.\n\nColin G. Whyte was born in Selkirk, U.K., in 1969. He received the B.Sc. degree in physics from the University of Glasgow, Glasgow, U.K., in 1991 and the M.Sc. degree in laser physics and pulsed-power technology and the Ph.D. degree in physics from the University of St Andrews, St Andrews, U.K., in 1992 and 1996, respectively. He has been with the University of Strathclyde, Glasgow, U.K., since 1996 in the ABP Group, Department of Physics, where he is also currently with SUPA. His research interests include the design and experimental investigation of high-power broadband microwave amplifiers and oscillators, including novel helical gyro-TWT devices and reverse-guide-field free-electron lasers. He also designs and builds high-voltage pulsed-power supplies.\n\nCraig W. Robertson was born in Ayrshire, U.K., in 1977. He received the B.Sc. (with honors) degree in physics and the Ph.D. degree from the University of Strathclyde, Glasgow, U.K., in 1999 and 2004, respectively. He is currently with SUPA, Department of Physics, University of Strathclyde. His interests include lowtemperature plasma production and diagnostics, as well as high-power microwave sources.\n\nAlan R. Young received the B.Sc. degree in physics, the M.Sc. degree in information technologies systems, and the Ph.D. degree, with a dissertation on high-quality electron beams for CARMs, from the University of Strathclyde, Glasgow, U.K., in 1993, 1994, and 1998, respectively. He has since continued to work as a Research Fellow with the Department of Physics, University of Strathclyde, on a variety of gyro-devices, including CARM and gyro-TWT, where he is also currently with SUPA.\n\nZHANG et al.: MULTI-MODE COUPLING WAVE THEORY FOR HELICALLY CORRUGATED WAVEGUIDE\n\nCraig R. Donaldson received the B.Sc. (with honors) degree in physics, the M.Sc. degree in high power RF and the Ph.D. degree in physics from the University of Strathclyde, Glasgow, U.K., in 2005, 2006, and 2009, respectively. He is currently with SUPA, Department of Physics, University of Strathclyde. His main research interests include electron-beam generation, gyro-TWT/BWOs, and helically corrugated waveguides.\n\n7\n\nAdrian W. Cross received the B.Sc. degree (with honors) in physics and the Ph.D. degree from the University of Strathclyde, Glasgow, U.K., in 1989 and 1993, respectively. He joined the Atoms, Beams, and Plasmas Group, University of Strathclyde, in 1993 initially as a Research Fellow and then as a Lecturer in 2000, Senior Lecturer in 2005, and is now a Reader with the Department of Physics. From 2002 to 2007, he was an Engineering and Physical Science (EPSRC) Advanced Fellow. He has been involved in various aspects of research on gyrotrons, cyclotron autoresonance masers, free-electron lasers, superradiant sources, gyrotron travelling wave amplifiers and plasma applications. More recently, he has primarily been concerned with research on microwave pulse compression, THz radiation sources and pseudospark physics.\n\n8\n\nIEEE TRANSACTIONS ON MICROWAVE THEORY AND TECHNIQUES, VOL. 60, NO. 1, JANUARY 2012\n\nPassivity Enforcement for Admittance Models of Distributed Networks Using an Inverse Eigenvalue Method Christopher S. Saunders, Student Member, IEEE, and Michael B. Steer, Fellow, IEEE Abstract—Most transient circuit simulators are based on admittance representations of the constituent circuit elements. It is therefore natural to use admittance parameter descriptions of linear networks, preferably in the form of rational transfer functions that can be directly implemented in the analysis. A problem arises when the measured or calculated frequency-domain response of a linear distributed network must be derived from data that has inherent error, is of limited bandwidth, or is not in the appropriate rational form. A reduced-order rational model that is causal, stable, and passive must be developed. Previous methods of deriving rational functions for the admittance parameters of a network do guarantee stability and causality, but passivity of the model must be assured through subsequent post-processing. Enforcing passivity requires modification of the state-space parameters of the model with consequent introduction of errors. This paper reports on a procedure to simultaneously achieve passivity, accuracy, causality, and stability in the development of an admittance macromodel described using a matrix of rational functions. An iterative inverse eigenvalue algorithm enforces passivity, and is applied by conjoining sets of eigenvalue and admittance constraints. These constraints form a monolithic projection matrix, which simultaneously addresses both passivity and accuracy of the model. Index Terms—Circuit–field interactions, inverse eigenvalue problem, linear device modeling, passive models, passive reduced-order modeling, transient nonlinear circuit simulation.\n\nI. INTRODUCTION\n\nis conveniently developed from an -domain rational transfer function. The set of rational transfer functions is thus a macromodel of the distributed network. The rational macromodel of a distributed network approximates the measured or numerically derived frequency-dependent admittance parameters of the network [3]–[11]. The usage of an admittance parameter macromodel is desirable for rapidly and directly integrating circuit–field interactions in a circuit simulator [7], [12]–[16]. It is, however, essential that the macromodel be causal, stable, and passive. Causality and stability are typically assured by choosing a particular form of the rational transfer functions, such as Foster’s canonical form [8]. However, passivity is not simultaneously assured [17] and so post-processing algorithms [18]–[29] have been previously used to ensure passivity. Unfortunately, this procedure results in a reduction in the accuracy of the macromodel. This paper details the application of an iterative inverse eigenvalue method to simultaneously achieve high accuracy and passivity of an admittance-parameter macromodel by using admittance constraints. These constraints yield a robust method for ensuring that the macromodel is an accurate representation of the original network. The proposed admittance constraints also increase algorithm autonomy by providing instantaneous feedback that automatically selects the appropriate perturbation set that will both achieve passivity and preserve accuracy.\n\nT\n\nHE RESPONSE of a linear distributed network is characterized initially as a table of network parameter values collected over a discrete set of frequencies. Using this characterization in a transient circuit simulator requires transformation of the network parameters into an appropriate form. For transient circuit simulation, inverse Fourier transformation of the frequency-domain network parameters yields a set of impulse responses that may be used [1]. However, most transient circuit simulation is based on a modified nodal admittance formulation that is derived by combining the stamps of individual elements [2]. The stamp of a distributed network is the collection of the stamps of individual admittance parameters, each of which Manuscript received April 27, 2011; revised September 19, 2011; accepted September 27, 2011. Date of publication November 04, 2011; date of current version December 30, 2011. This work was supported by the U.S. Army Research Laboratory (ARL) and the U.S. Army Research Office (ARO) under Grant W911NF-05-1-0337. The authors are with the Department of Electrical and Computer Engineering, North Carolina State University, Raleigh, NC 27695 USA (e-mail:[email protected]). Color versions of one or more of the figures in this paper are available online at http://ieeexplore.ieee.org. Digital Object Identifier 10.1109/TMTT.2011.2171500\n\nII. RATIONAL MACROMODELING Transient simulation generally proceeds by developing the modified nodal admittance matrix (MNAM) of a companion circuit derived from the original circuit following time discretization and nonlinear discretization [2]. For a distributed linear network, the contribution to the MNAM comes from the stamp for a rational approximation of each admittance parameter of the network. It is possible to expand the rational function of the admittance into a circuit consisting of resistor, inductor, capacitor, and coupled inductor primitives [12], [13], and the contribution from each primitive then incorporated in the MNAM. However, it is more robust to insert the contribution of the rational transfer function directly [7], [15]. Utilizing a set of measured or calculated admittance parameter data, an -domain pole-residue model of an admittance parameter can be generated by applying the vector fitting algorithm [3]–[5] to generate a rational approximation of the form\n\n0018-9480/$26.00 © 2011 IEEE\n\n(1)\n\nSAUNDERS AND STEER: PASSIVITY ENFORCEMENT FOR ADMITTANCE MODELS OF DISTRIBUTED NETWORKS\n\nwhere is the admittance parameter in the th row and th column of the -port admittance matrix at the frequency , the variables and are, respectively, the th residue and pole of the partial fraction transfer function, and is a real-valued constant conducare generally complex, and tance. Alternative methods [6], [7], [30], [31] may also be used to develop the rational approximation of the admittance parameters. In any case, a state-space model of the complete linear system can readily be derived from the rational approximation and written as [3], [6], [7]\n\n9\n\nare equal to the parameter , which the eigenvalues of according to the following relationship: (6) at the critical value of By evaluating the eigenspectrum of , any purely imaginary eigenvalue of indicates a frequency where an eigenvalue of is equal to zero. These frequencies thus represent the set of possible boundaries between passivity and nonpassivity of the macromodel. are purely imaginary, they If any of the eigenvalues of are collected to form a set of boundary frequencies\n\n(2) (7) where is an identity matrix, is a diagonal matrix containing is a matrix composed of zeros and the poles of the model, ones, is a matrix containing the residues of the model, and is a matrix containing the constant conductances. This statespace representation of the admittance parameters of the circuit can be developed and constructed either by fitting the model ), as using a common pole-set for the port responses ( described in [21], [24], [27], [28], and [32], or by using a unique admittance responses, as detailed in pole set for each of the [18] and [32]. While the macromodel generated by the rational fitting algorithms referred to above is guaranteed to be both causal and stable, passivity of the model is not assured. Violations of passivity are typically due to the finite frequency resolution and limited bandwidth of the original frequency-domain data. Typically, passivity is enforced through additional model processing. III. PASSIVITY CONDITION The model of a circuit element described by admittance parameters is known to be passive if the eigenvalues of the Hermitian part of the admittance matrix are positive for all frequencies [20], [32]: (3) is the th eigenvalue of the Hermitian part where of the admittance matrix. The Hermitian part of the admittance matrix is defined as (4) where the superscript indicates the complex conjugate transpose. Performing an exhaustive search for passivity violations is computationally unfeasible, and even the use of high-frequency resolution during evaluation is not sufficient to guarantee passivity. A more reliable analytic method involves the construction of a Hamiltonian matrix from the constituent matrices in the state-space admittance representation of the circuit [19], [20], [28], [32]–[34]\n\nwhere tonian matrix\n\nwhich is subsequently used to determine the frequency bands is not over which the model is nonpassive. For example, if a null set, then the macromodel violates the passivity condition, (3), within at least one frequency band bounded by the elements of . To determine the regions over which the model contains passivity violations, a set of test frequencies, , is chosen that contains a minimum of one frequency point between each of the elements of , as well as two additional frequencies: one below the minimum boundary frequency and one above the maximum evaluated at boundary frequency. Thus, the eigenvalues of the test frequencies indicate whether the model meets the passivity condition, (3), for the admittance parameter description of the circuit. IV. ENHANCED INVERSE EIGENVALUE PASSIVITY ENFORCEMENT ALGORITHM The proposed algorithm for enforcing passivity operates by calculating successive iterative solutions of a constrained inverse eigenvalue algorithm. The algorithm seeks the optimal update to the model parameters that modifies the eigenvalues of at a set of specified frequencies to obtain a passive macromodel, while simultaneously seeking to enforce a set of admittance constraints to maintain a highly accurate model. Prior methods have sought to preserve accuracy using relative error control [20], quadratic programming [33], [34], energy norms [28], [34], and periodic re-selection of perturbation sets [18], in a secondary iterative loop. In contrast, the proposed method generates a monolithic perturbation-projection matrix that integrates passivity enforcement and efficient error control within a single iterative nonlinear problem. The algorithm proceeds by determining which of the model parameters in (1) will be altered during the optimization, and defining a set of corresponding perturbations (8)\n\n(5)\n\nwhere is the th perturbation amongst the set of perturis the magnitude of the perturbation, is a bations in , is the perturbed real-valued scalar perturbation weight, and parameter in (1) to which the perturbation is applied,\n\n. The eigenspectrum of the Hamilcan be used to identify the frequencies at\n\n(9)\n\n10\n\nIEEE TRANSACTIONS ON MICROWAVE THEORY AND TECHNIQUES, VOL. 60, NO. 1, JANUARY 2012\n\nwhere superscripts and , respectively, denote the real and imaginary portions. The modifications to the state-space model of (2) from the application of these perturbations is described in detail in [18]. Establishing the set of required modifications begins by choosing the set of frequencies, , at which passivity or model accuracy must be enforced (10) is the th frequency at which either a passivitywhere enforcing eigenvalue constraint or an accuracy-preserving adis the total number mittance constraint is to be enforced, and of such frequencies. Note that, in general, the number of perturis not equal to . bations To determine the magnitude, , of the th perturbation required, the effect of an individual perturbation on the admittance parameter model is calculated at each frequency as\n\n(11) to be This notation defines the perturbed model at the th equal to the unperturbed admittance model iteration of the algorithm subjected to a unit-magnitude perturbation , evaluated at frequency , as detailed in [18]. The Hermitian part of the perturbed admittance matrix is (12) As will be shown in Section IV-B, and are used to map the projection of the perturbation onto the admittance space. These projections are then used to successively create a sequence of linear problems to be solved iteratively, and will be utilized to calculate the appropriate perturbation magnitudes to modify the macromodel in accordance with the optimization goals.\n\nA. General Solution The algorithm developed here to simultaneously achieve passivity and high accuracy is cast as a sequence of linear least square (LS) problems of the form (13) which are solved iteratively. Here, the subscript refers to the th iterate, is the projection coefficient matrix for the th is the difference vector used to constrain the iterate, and , eigenvalues and admittances. Equation (13) is solved for the vector of perturbation magnitudes applied at the conclusion of the th iteration. and are composed of sub-elements, each Both of which is constructed to enforce either the optimization of an\n\nfor passivity or to impose an accuracy eigenvalue set of . Thus, constraint on the admittance matrix\n\n.. .\n\n.. .\n\n.. .\n\n.. .\n\n(14)\n\nand the general form of the sub-elements and are identical regardless of the type of constraint imposed. That is, comprises sub-mathe projection coefficient matrix trices, each defined as\n\n(15) is the projection coefficient sub-matrix for the th and constraint during the th iteration. Each sub-matrix is composed of a set of projection vectors with vector approximating the modification of the constrained variables during of unit the th iteration, caused by applying perturbation magnitude at frequency . The construction of a projection vector depends on the type of constraint imposed, and is discussed in detail in Section IV-B. at the beginning of each itIn addition to constructing eration, the difference vector utilized to impose the constraints, , is constructed from a set of sub-vectors, which are concatenated as shown in (14) to form the full constraint vector. Each sub-vector is a linear function of the current and previous and , respeciterates’ constrained-variable values, tively, the previous iterate’s constraint sub-vector, , and , as the desired final values of the constrained-variables,\n\n(16) The parameter is a real-valued scalar scaling parameter in the interval used to adjust the step size of the constrainedvariable modification, providing a tradeoff of algorithm convergence rate and stability. Similarly, is a scaling parameter over the same interval and is the coefficient of an additional correction term included to assist with convergence degradation caused by nonlinear relationships between the perturbations and the constrained variables. Note that for the initial iteration ) only, the coefficient is set to zero. ( Once all of the sub-elements have been constructed, they are concatenated to form the complete linear LS problem (14) for the th iterate. Since the problem is in many cases an can be solved for using the under-determined LS problem, Moore–Penrose pseudoinverse [35] (17) which ensures that the minimum two-norm solution is calculated.\n\nSAUNDERS AND STEER: PASSIVITY ENFORCEMENT FOR ADMITTANCE MODELS OF DISTRIBUTED NETWORKS\n\nThe solution for magnitudes\n\nis a vector of parameter perturbation\n\n(18) is the magnitude of the th perturbation that where should be applied at the conclusion of the th iteration (see [18]). Once these perturbations have been applied, is updated, and the process repeated until the necessary passivity and accuracy criterion have been met, i.e., when the constrained variables are within a suitable tolerance of the desired final values. B. Detailed Sub-Element Construction This section details the construction of the four types of subelements used in this algorithm. There are two methods of enforcing both eigenvalue constraints and admittance constraints. For both cases, there is a constraint on the full set of values, and a reduced-order constraint, which allows for more computationally efficient optimization. 1) Full Eigenvalue Set Constraint: To enforce passivity of the macromodel at a given frequency, the eigenvalues of must all the Hermitian part of the admittance matrix from (7) to determine the be nonnegative. Having utilized frequency bands of passivity violations, the enforcement of passivity within a nonpassive region at frequency is achieved by constructing and as follows. To calculate the eigenvalues of the Hermitian part of the admittance matrix, the Schur decomposition [35] is used, having the form (19) is a unitary matrix, and is an upper where on the diagdiagonal matrix with the eigenvalues of onal. Since the decomposed matrix is Hermitian, the columns of are the eigenvectors of , and is strictly . diagonal, containing the eigenvalues of projection The components of (19) are used to form the coefficient vector (20) which describes the modification of the eigenvalues of caused by a unit-magnitude perturbation at the frequency . operator extracts the principal diagonal of a matrix (The and places the elements in a column vector.) The eigenvalues of are used to form a column vector (21) which is the vector of constrained-variable values for the th iteration at frequency . The column vector of eigenvalues is (16). used in the iterative construction The final set of eigenvalues is selected to ensure passivity at the constrained frequency by choosing the values to be\n\n11\n\nThat is, if an eigenvalue is already positive and greater than a tolerance , no modification is required. Otherwise, there is a violation of passivity, and the final eigenvalue is set equal to a ) enforcing a buffer with tolerance parameter (e.g., the boundary of passivity. 2) Partial Eigenvalue Set Constraint: In some circumstances, it may be more appropriate to establish a constraint that seeks only to optimize a partial subset of the eigenvalues to achieve a passive macromodel. For an -port model, utilizing the full eigenvalue set entails the concatenation of a that is to the projection coefficient sub-matrix full projection coefficient matrix for each frequency, which can be reduced has an eigenvalue constraint. The size of by implementing a constraint on a partial set of eigenvalues, . The projection subsequently expediting the computation of coefficient vectors are then calculated as\n\n(23) which is similar to the formulation used for the full eigenvalue set, except for the inclusion of the column extraction matrix . This matrix has the form (24) and is the th column of the identity matrix, and is the number of columns extracted for the th constrained frequency. are purely real, they are natSince the eigenvalues of urally sorted along the diagonal from least to greatest, and thus extracts the projection upon the minimumthe use of valued eigenvalues. eigenvalues are similarly extracted through The minimum pre-multiplication (25) which are then used in the construction of the sub-vector (16). The vector of desired final values for the partial eigenvalue set is constructed identically to (22), except that the vector is constructed to only constrain the first eigenvalues if else (26) in accordance with the size of the partial eigenvalue set. 3) Full Admittance Matrix Constraint: In addition to the constraints on the eigenvalues to enforce passivity, further constraints may be applied to ensure the accuracy of the macromodel. This is done by including projected admittance parameter modifications in the iterative LS problem. Introducing a constraint of this form begins with the formation of an admittance projection matrix (27)\n\nif else (22)\n\nis an matrix, which defines the modifiwhere cations to the admittance parameters of the macromodel during\n\n12\n\nIEEE TRANSACTIONS ON MICROWAVE THEORY AND TECHNIQUES, VOL. 60, NO. 1, JANUARY 2012\n\nthe th iteration caused by a unit-magnitude perturbation at frequency . To properly integrate this constraint into the LS problem, the columns of the projection matrix must be concatenated to form projection coefficient sub-vector the\n\n(28) . which is in the proper form for inclusion in Since the full set of complex admittances of the macromodel are the constrained variables for this constraint, the admittance subvalues must similarly be concatenated to form the vector\n\nadmitaccumulated admittance error uniformly across the tance parameters. Similarly, the imaginary portion is defined as\n\n(33) The value of this aggregate complex constrained variable for the th iteration is defined as\n\n(29) and the desired final values of the constrained admittances are simply the initial admittance values, rearranged to form the column sub-vector (30) These vectors are utilized to create the desired constrained-varifor a full admittance matrix conable modification vector straint, as in (16). 4) Aggregate Admittance Matrix Constraint: While utilizing a full admittance matrix constraint provides excellent accuracy preservation at the constrained frequencies, it necessitates the whose diinclusion of a projection coefficient sub-matrix . The expansion of the LS problem by a submension is matrix of this size for each constrained frequency may introduce an unnecessary computational burden. An alternative aggregate admittance matrix constraint is proposed, which assists the algorithm in maintaining model accuracy during passivity enforcement, while reducing the computational complexity of the iterative algorithm. For the aggregate admittance matrix constraint, the projection coefficient vector is composed of a single complex value (31) where the superscripts and , respectively, denote the real and is defined as imaginary parts. The real portion of\n\n(32) is an exponential weighting parameter used where the value is chosen as for accuracy control by the algorithm. When is calculated as the sum of the abunity, the value is solute differences in the admittance parameter values. If increased, the algorithm will increasingly favor distributing the\n\n(34) where the real portion is calculated as (35) and the imaginary portion is calculated as (36) Since the aggregate constraint is a measure of the deviation of the perturbed model relative to the original macromodel, the desired final value for this constraint is zero (37) These components are then used to construct the desired constrained variable modification for the aggregate admittance matrix constraint, as in (16). 5) Integral Admittance Matrix Constraint: An admittance constraint can be further aggregated through integration of an aggregate admittance constraint over a specified frequency band. When the th constraint is specified as an integral admittance constraint, the projection coefficient vector is composed of a single complex value (38) and are the lower and upper frequencies where of the constrained frequency band, respectively, and and are defined identically to the aggregate admittance constraint quantities of (32) and (32). Numerically, this integration must be redefined as weighted summation using a suitable integration method. Thus, the projection coefficient vector entry is rewritten as\n\n(39)\n\nSAUNDERS AND STEER: PASSIVITY ENFORCEMENT FOR ADMITTANCE MODELS OF DISTRIBUTED NETWORKS\n\n13\n\nwhere is the number of discrete steps used in the summation is the appropriate coeffito approximate the integration, and cient for the selected integration method. Extending this numerical integration to the remaining constraint elements leads to the definition of the th iteration’s constraint variable as\n\n(40) and the desired final value of the constraint is (41) Utilizing this constraint allows a frequency band to be constrained with only the addition of a single row to the projec. The constraint of admittances over tion coefficient matrix a band of frequencies may be desirable in many cases, and in these cases, a tradeoff between the accuracy achieved using a set of stricter constraints, such as the full admittance matrix constraint, must be weighed against the additional computational complexity leading to further computational expense.\n\nFig. 1. Eigenvalue curves of a fitted power splitter model, which originally contains passivity violations [curves (a) and (b)]; with subsequent passivity enforcement introducing a new passivity violation [curves (c) and (d)]; and after, using a partial eigenvalue constraint to nullify the newly introduced passivity violation [curves (e) and (f)]. Note that only the two minimal eigenvalue curves are visible due to the scale of the figure.\n\nC. Summary This section detailed the implementation of an enhanced inverse eigenvalue passivity enforcement algorithm. The method enables the correction and preservation of passivity for a statespace macromodel, while enabling accuracy control through the inclusion of additional constraints on the admittance parameters of the model. The iterative nonlinear nature of the algorithm enables the simultaneous modification of the poles, residues, and constant-coefficient terms of the model to achieve a passive macromodel, which retains a high degree of accuracy within the specified frequency band. V. CONSTRAINT PROPERTIES The constraints proposed in Section IV yield significant performance benefits during passivity enforcement. The following cases detail scenarios during which the use of the constrained iterative inverse eigenvalue algorithm provides for the rapid development of an accurate passive macromodel. A. Eigenvalue Constraints Here we consider the scenario where first a rational transfer function model, (1), is fitted to a set of measured admittance parameter data of a power splitter, and then an iterative perturbation technique is used to correct any passivity violations that arise. The admittance matrix eigenvalues of the original fitted model are shown as curves (a) and (b) in Fig. 1, which shows passivity violations are present in the regions where the eigenare negative. values of Correction of these passivity violations proceeds by using eigenvalue constraints in the violating frequency bands, detailed in Sections IV-B.1 and IV-B.2, to ensure that the minimum eigenvalue is above the tolerance value . The use of a full\n\neigenvalue set results in a more tightly constrained problem, assisting in minimizing the modifications made to the model during passivity enforcement, at the cost of higher computational complexity. A partial eigenvalue set constraint is more computationally efficient during passivity enforcement, but may allow larger perturbations to the model due to the unconstrained portion of the eigenvalues. Using partial eigenvalue set constraints in conjunction with admittance constraints is proposed as a solution, which will allow passive and accurate models to be developed with computational efficiency. It is known that during passivity enforcement using iterative perturbational techniques, new passivity violations may arise [33], [36]. In the example of Fig. 1, the original attempt at passivity correction introduces a new passivity violation at 5 MHz, as seen in curves (c) and (d). Newly introduced violations are difficult to predict, but may be eliminated a posteriori by discarding the iteration that introduced the new violation, and placing an additional eigenvalue constraint at the frequency where the new violation arose. Using a partial eigenvalue constraint to enforce only the minimum eigenvalue at 5 MHz to be greater than allows the algorithm to enforce passivity of the macromodel without the introduction of the additional violation, as seen in curves (e) and (f) of Fig. 1. The additional constraint of the minimum eigenvalue at a chosen frequency , yielding a computationally adds only a single row to efficient method of passivity constraining. B. Admittance Constraints In general, admittance matrix constraints (in addition to eigenvalue-based passivity constraints) enable the algorithm to\n\n14\n\nIEEE TRANSACTIONS ON MICROWAVE THEORY AND TECHNIQUES, VOL. 60, NO. 1, JANUARY 2012\n\nFig. 2. Mean admittance error caused by correction of a passivity violation at a single frequency, utilizing three different constraint sets: using only eigenvalue constraints to correct the passivity violation [curve (a)]; using an aggregate admittance constraint in conjunction with eigenvalue constraints [curve (b)]; and using a full admittance matrix constraint in conjunction with eigenvalue constraints [curve (c)].\n\nrespond to the sensitivity of the admittances to model parameter perturbations, and thus determine the perturbation magnitudes that achieve both passivity and accuracy. The aggregate admittance matrix constraint provides a computationally efficient method for ensuring the accuracy of the admittance parameters of the macromodel, by introducing only a relatively small increase of complexity in the solution for the perturbation . For each frequency at which there is magnitude vector an admittance constraint, the use of the full admittance matrix rows in constraint requires the inclusion of an additional , whereas the use of the the projection coefficient matrix aggregate admittance matrix constraint only requires a single additional row per constrained frequency. An example that demonstrates the tradeoff between the two methods of admittance constraining is shown in Fig. 2. The macromodel of a four-port power splitter used in this example originally contained a minor passivity violation at low frequency, which was then corrected using varying constraint sets from the proposed method. As seen in the figure, both forms of admittance constraints assist the algorithm in preserving model accuracy many orders of magnitude greater than if there were no admittance constraint for the chosen frequency band. The full admittance matrix constraint is seen to achieve a better preservation of model accuracy, but the addition of a full admittance matrix constraint for any single frequency requires the expansion of the iteratively solved linear problem by rows, whereas the aggregate admittance matrix constraint will add only a single row. For this example, 20 frequency points were included in the admittance constraints for the four-port model, introducing 320 additional rows for the full admittance matrix constrained problem, and only 20 additional rows for the aggregate admittance matrix constraints. The aggregate\n\nFig. 3. Absolute value of the admittances of the original model (solid lines), the model corrected using an aggregate admittance constraint while correcting a passivity violation (dashed lines), and the model corrected using a full admittance constraint while correcting a passivity violations (dashed–dotted lines.) The lower subplot displays the relative error of the model generated using the aggregate admittance constraint (solid lines), and the model generated using the full admittance constraint (dashed lines).\n\nconstraint provides an excellent means to preserve the accuracy of a macromodel without excessively increasing the computational complexity of the iterative algorithm. It is also possible that when implementing a full admittance matrix constraint, while the algorithm maintains accuracy at the specified frequencies, it may introduce unacceptable errors outside the constrained frequency band. This phenomenon is demonstrated by the four-port power splitter example in Fig. 3, where the application of a full admittance matrix constraint is used to preserve the accuracy in the 1165–1175-MHz frequency band, but during passivity enforcement there is a significant loss of error at the unconstrained frequencies. Applying the proposed aggregate admittance matrix constraint alternatively provides a method to preserve accuracy at the chosen frequencies with a relatively minor loss of out-of-band accuracy. VI. APPLICATIONS In this section, a rational macromodel is generated to first model a four-port microwave power splitter and second to model an RF bandpass filter, followed by an autonomously generated macromodel of the four-port microwave power splitter. For all examples, port-based admittance parameter data was obtained from the conversion of measured scattering parameter data. Fitting of a rational model to the measured power splitter data leads to passivity violations, some of which are well outside the frequency band of interest, as well as violations that are located within close proximity to the in-band frequencies. However, in transient simulation, it is critical that the model be passive at all frequencies. It is shown that the inverse eigenvalue-based passivity enforcement is effective in rendering a passive model. The second example is the development of the model of a bandpass\n\nSAUNDERS AND STEER: PASSIVITY ENFORCEMENT FOR ADMITTANCE MODELS OF DISTRIBUTED NETWORKS\n\nFig. 4. Admittance parameter magnitudes for a power splitter model, with passivity corrected using perturbation selection with no admittance constraints. The upper subplot shows the admittances before passivity enforcement (solid lines) and after passivity enforcement (dashed lines.) The lower subplot indicates the absolute magnitude of the admittance error.\n\nfilter. The directly fitted model has passivity violations located outside the passband of the filter, but due to the small magnitude of the in-band admittances, the model is susceptible to perturbations that, while ensuring passivity, can also introduce significant admittance errors. For this model it is shown that it is critical to simultaneously apply passivity and admittance constraints. Finally, the autonomously generated model example is included to display the utility of the algorithm in handling a severe passivity violation with no user intervention, enabled by the simultaneous perturbations of the linear and nonlinear model parameters under both eigenvalue and admittance constraints.\n\nA. Power-Splitter Example This section describes the application of the proposed algorithm to enforce passivity on the rational macromodel of a four-port power splitter (Mini-Circuits, Model SCN-3-16). The rational macromodel directly fitted to the measured response of the component is highly accurate, but there are several passivity violations. The results of applying passivity enforcement with no admittance constraints, but periodically utilizing careful user-directed selection of the perturbation set similar to the method in [18], is shown in Fig. 4. The use of this passivity enforcement method results in a passive macromodel that maintains a reasonable degree of accuracy, but which requires significant user intervention in periodically re-selecting the perturbations allowed during the algorithm. The targeted application of the power splitter is a communications band with a 10-MHz bandwidth centered at 1.17 GHz. Admittance constraints will be applied over the 1695–1705-MHz band, as this is where the model is required to be most accurate. To facilitate accuracy preservation, a set of 20 linearly spaced\n\n15\n\nFig. 5. Admittance parameter magnitudes for a power splitter model, with passivity corrected using admittance constraints. The upper subplot shows the admittances before passivity enforcement (solid lines), and after passivity enforcement (dashed lines). The lower subplot indicates the absolute magnitude of the admittance error.\n\nfrequency values in this band are appended to , for which aggregate admittance constraints are applied. Thus, during each iteration, the perturbation set includes the real and imaginary parts of all residues, the real parts of all poles, and all the constant coefficient terms, and the admittance constraints provide feedback within the algorithm to ensure that amongst the perturbation set, only the perturbations that enforce passivity and preserve accuracy are utilized. The result of this approach is displayed in Fig. 5, where it is seen that the passband error of the corrected macromodel is significantly reduced. A comparison of the mean absolute error in the two passive macromodels is shown in Fig. 6, where it is seen that the application of admittance constraints provides a significant contribution to the preservation of model accuracy. Both methods are shown to generate passive macromodels, as indicated by the eigenvalue curves in Fig. 7. While the inclusion of these 20 aggregate admittance constraints adds as many rows to the projection coefficient matrix , the additional computation required for the construction of and the iterative computation of the pseudoinverse is offset by the potential benefit yielded from the inclusion of these constraints. It is clear from the data presented in the figures that the amount of error introduced can be significantly reduced by including admittance constraints, but potential time savings may also result from including them. Since accuracy preservation is built directly into the algorithm through admittance constraints, there is little need for user intervention during the algorithm to re-select perturbation sets in order to reduce the error introduced. The increase in autonomy yielded from the reduction in time consumed by user interaction, though qualitative and thus difficult to measure, enables the algorithm to generate accurate macromodels in a time-efficient manner.\n\n16\n\nIEEE TRANSACTIONS ON MICROWAVE THEORY AND TECHNIQUES, VOL. 60, NO. 1, JANUARY 2012\n\nFig. 6. Comparison of the mean absolute admittance error between passivity enforced using aggregate admittance constraints in the passband [curve (a)] and using perturbation selection with no admittance constraints [curve (b)].\n\nFig. 7. Eigenvalue curves for the power combiner macromodel, showing the original model with passivity violations (solid lines), macromodel after passivity enforcement using admittance constraints in the passband (dashed line), and using perturbation selection with no admittance constraints (dashed–dotted line.).\n\nB. Bandpass Filter Example The algorithm is used in this section to enforce passivity for a bandpass filter macromodel (Trilithic, Model 7BC465/5-3-KK) with a passband from 460–465 MHz, fitted from a set of measured data. The original macromodel contains passivity violations outside the passband of the filter, but which must be eliminated due the wideband nature of pulsed communication signals. While these violations are removed, it is paramount that the\n\nFig. 8. Admittance parameter magnitudes for a bandpass filter model, with passivity corrected using perturbation selection with no admittance constraints. The upper subplot shows the admittances before passivity enforcement (solid lines) and after passivity enforcement (dashed lines). The lower subplot indicates the absolute magnitude of the admittance error.\n\nfilter model remain accurate in the passband. Implementing admittance constraints provides an effective method of efficiently modifying the macromodel to achieve this objective. In this example, once again the accuracy of the model must be preserved for a certain set of frequencies to guarantee that the macromodel will accurately recreate the measured response. There is a well-defined passband for this element, and the use of admittance constraining for accuracy preservation is shown to be highly beneficial in enforcing passivity of the model. In Fig. 8, the results of enforcing passivity without the use of admittance constraints is shown. In this case, the perturbation set was periodically re-selected through user intervention, in order to ensure the set of perturbations did not allow excessive error to accumulate within the passband. In contrast, when the bandpass filter macromodel is corrected utilizing admittance constraints as shown in Fig. 9, the resulting macromodel is significantly more accurate in the passband, without the need for user intervention. Both methods successfully generate a passive model of the bandpass filter, as demonstrated by the eigenvalue curves in Fig. 10. While periodically re-selecting the perturbation set can yield passive macromodels that are reasonably accurate, the use of admittance constraints is seen to be highly beneficial in that it yields more accurate macromodels and requires less user intervention during modeling. By applying admittance constraints, the algorithm inherently avoids perturbations that correct for passivity, but degrade accuracy. This allows a single comprehensive perturbation set to be used, which thus requires no user input for periodic alteration of the perturbations. In Fig. 11, the mean error introduced by the methods reported on in Figs. 8 and 10 are compared, along with an example of the algorithm applied without any re-selection of perturbations nor\n\nSAUNDERS AND STEER: PASSIVITY ENFORCEMENT FOR ADMITTANCE MODELS OF DISTRIBUTED NETWORKS\n\nFig. 9. Admittance parameter magnitudes for a power splitter model, with passivity corrected using admittance constraints. The upper subplot shows the admittances before passivity enforcement (solid lines) and after passivity enforcement (dashed lines.) The lower subplot indicates the absolute magnitude of the admittance error.\n\n17\n\nFig. 11. Comparison of the mean absolute admittance error in the bandpass filter model between passivity enforced using no perturbation selection or admittance constraining [curve (a)], using perturbation selection with no admittance constraints [curve (b)], and using aggregate admittance constraints in the passband [curve (c)].\n\nis achieved without the need for user intervention to identify the proper perturbation set. The result displayed in Fig. 12 demonstrates the capabilities and usefulness of the algorithm. A pulsed 468-MHz signal with a 2- s period and a 50% duty cycle is applied as an input to the bandpass filter, and a comparison of the measured and simulated filter outputs is displayed. The model on which the proposed algorithm was applied is seen to yield accurate and stable simulation results. However, the model that was not corrected is seen to generate errant transient simulation results. The enhanced inverse eigenvalue algorithm is thus seen to provide critical functionality in accurately modeling distributed linear networks. C. Autonomous Macromodel Development Example\n\nFig. 10. Eigenvalue curves for the bandpass filter macromodel, showing the original model with passivity violations (solid lines), macromodel after passivity enforcement using admittance constraints in the passband (dashed line), and using perturbation selection with no admittance constraints (dashed–dotted line.).\n\nadmittance constraints. It is seen that re-selecting the perturbation set yields a significant increase in model accuracy, which motivates the use of this method despite the periodic user intervention required for altering the perturbation set. However, applying the proposed algorithm to enforce passivity while constraining the passband admittances is seen to yield superior performance with minimal error introduced in the passband. This\n\nTo fully realize the potential benefits of the proposed algorithm, the ability to concurrently modify the linear model parameters and nonlinear poles is combined with the ability to simultaneously constrain both eigenvalues and admittances in a fully autonomous model generation procedure. For this example, the measured data for the four-port pole splitter serves as the input, and a fully passive macromodel is generated as the output with no user interaction required. The measured power splitter data is used as the input to a MATLAB script, which first generates a common-pole macromodel of the linear network utilizing the methods described in [3]–[5]. While the generated macromodel is an accurate representation over the measured frequencies, in this case, a large magnitude passivity violation presents at a frequency below the measured frequency band. Typically, this could be addressed by attempting to recreate the macromodel with an alternate weighting function or pole order since a variety of alternative passivity enforcement methods are capable of handling only\n\n18\n\nIEEE TRANSACTIONS ON MICROWAVE THEORY AND TECHNIQUES, VOL. 60, NO. 1, JANUARY 2012\n\nFig. 13. Iterative progression of the eigenvalue curves during the autonomous passivity enforcement. The eigenvalue curves (solid lines) originally contain a large magnitude passivity violation near 8.5 MHz. As the algorithm iterates, the local minima of the curves (“x” markers) are automatically calculated and selected for inclusion in the passivity constraint set. Fig. 12. Output response of the bandpass filter to a pulsed 468-MHz input signal. The upper subplot shows the measured response of the bandpass filter, the middle subplot shows the simulated response of the bandpass filter using a model for which the passivity enforcement algorithm developed here has been applied, and the lower subplot shows the unstable output response of a model with passivity violations.\n\nminor passivity violations. However, such a procedure may involve an unacceptable amount of user interaction, and the proposed inverse eigenvalue passivity enforcement algorithm is capable of handling these scenarios in a methodical fashion. Addressing large passivity violations is handled by the proposed algorithm by enabling the simultaneous modification of the linear parameters, as well as the nonlinear pole parameters, in correcting the passivity violations. However, while the use of such a perturbation set is effective at handling large passivity violations, significant model error may accumulate during the iterative passivity enforcement procedure due to both the large magnitude of the violation and the increased size of the perturbation set. The proposed admittance constraints resolve this issue by constraining the algorithm to retain accuracy over the specified frequencies. The capability of the proposed algorithm in handling even large passivity violations while maintaining accuracy makes it suitable for use in an autonomous fashion. After generation of the initial macromodel, a script is used to locate a set of local minima in the eigenvalue curves, which are also the localized set of largest magnitude passivity violations. These local minima are updated periodically (e.g., after every 30 iterations of the proposed algorithm), as displayed in Fig. 13, while the admittance constrained frequency band is held constant for all iterations. This iterative procedure will thus select the frequencies where passivity correction will be applied, and regardless of the magnitude of the violation, will modify the macromodel to enforce passivity while minimizing the accumulated model error for the chosen frequencies.\n\nFig. 14. Mean absolute error of the autonomously generated model with the large passivity violation after passivity correction. Displays the error using a perturbation set, which includes linear coefficients, poles, and applies admittance constraining [curve (a)]; using a perturbation set, which includes only linear coefficients and applies admittance constraining [curve (b)]; using a perturbation set, which includes linear coefficients, poles, and no admittance constraining [curve (c)]; and using a perturbation set, which includes only linear coefficients and no admittance constraining [curve (d)].\n\nThe results of the proposed algorithm under various configurations is displayed in Fig. 14. It is seen from this example that handling large magnitude passivity violations that may occur during the original model fitting procedure can be addressed using the proposed algorithm through the use of a broad perturbation set, which includes linear coefficients and poles, as well as incorporating admittance constraints. This makes the proposed algorithm suitable for autonomous use, where there is a qualitative savings of time through reduction of user interaction, enabled by the ability of the proposed algorithm to handle a large magnitude passivity violations while preserving accuracy.\n\nSAUNDERS AND STEER: PASSIVITY ENFORCEMENT FOR ADMITTANCE MODELS OF DISTRIBUTED NETWORKS\n\nVII. DISCUSSION As demonstrated by the set of examples, the greatest benefits may be yielded when allowing an inclusive set of perturbations to be considered while enacting an appropriate set of admittance constraints. The wide number of available perturbations allows the algorithm to manipulate those macromodel parameters that best achieve the desired goal, and the inclusion of admittance constraints sets the optimization goal to be not only one of achieving passivity, but also of preserving accuracy. The presented examples display the quantitative gains that are clearly achieved by this method, where even large-magnitude passivity violations can be addressed within a macromodel while still retaining sensitivity to accuracy. Further qualitative gains, while difficult to measure, are achieved utilizing the proposed algorithm since the algorithm can be relied upon to retain accuracy during passivity enforcement even when handling large-magnitude passivity violations, which thus enables the method to be applied without supervision in an autonomous model generation algorithm. Many alternative passivity enforcement methods in the literature address only the modification of the linear coefficients of the model, and thus rarely attempt to modify the poles, which may to be critical in addressing certain passivity violations, as demonstrated in the examples. By combining the inclusive (i.e., including poles and linear coefficients) perturbation set of the proposed method with admittance constraints for accuracy preservation, we demonstrate the strength of the proposed method. With regards to complexity of the algorithm, the inclusion of additional allowed perturbations expands the column count of the projection matrix utilized in this method, while the addition of further constraints on the admittances contributes additional rows to this matrix. In addition, the inclusion of additional allowed perturbations or admittance constraints requires additional computations to be carried out during the formation of the projection matrix. Thus, it is seen that this method can lead to an increase of complexity, which leads to greater iterative computation time. However, there is a difficult to measure qualitative gain in this method, where the method is intended to enable “first pass success” in achieving an accurate and passive macromodel. The additional cost in computation should be offset by the time saved by avoiding excessive user involvement in the algorithm. Addressing algorithm convergence, because the problem is itself nonlinear, the convergence to an absolute minimum cannot be guaranteed. However, in this case, an absolute minimum is unnecessary since the actual goal is to achieve a model that meets the passivity criteria while maintaining an acceptable accuracy, where what is acceptable may vary with each particular case. A first step in ensuring convergence is to find an accurate initial fit of the model, which often assists convergence. However, when this is not possible (due to autonomous operation where user intervention is not applied or due to an out-of-band passivity violation) the proposed method handles these cases by using trust regions. Rather than trying to rapidly converge the model, the model is perturbed by only a fraction of the necessary amount to meet the final target within each iteration. Utilizing\n\n19\n\nthis approach, the proposed method has been shown to be capable of handling difficult scenarios in an autonomous manner, converging to accurate and passive resultant models. VIII. CONCLUSIONS This paper has presented an enhanced iterative inverse eigenvalue method to enforce passivity in admittance parameter-based macromodels while simultaneously and efficiently preserving accuracy. The approach defines a set of perturbations to the constituent macromodel variables, and then projects the effect of these perturbations onto the set of variables constrained by the optimization. The parameters being optimized are composed of the eigenvalue constraints used to enforce passivity, and admittance constraints, which ensure accuracy of the perturbed model. The resulting model is both passive and accurate. This procedure provides significant benefits in both model accuracy and autonomy of the algorithm. The admittance constraints are built directly into the iterative algorithm used to enforce passivity via the projection matrix, allowing the algorithm to automatically choose the perturbations that maintain accuracy of the model without requiring user intervention. Previous methods utilized a broad perturbation set that included the residues, poles, and constant coefficient terms in the perturbation set, whose use can assist with accuracy preservation [18], but which often must be periodically re-selected during the iterative procedure to obtain optimal performance. In the method presented here, the algorithm, guided by eigenvalue and admittance constraints, generates a macromodel that can be directly used in an MNAM-based circuit simulator [7], [12], [13], [15]. REFERENCES [1] D. Winkelstein, M. B. Steer, and R. Pomerleau, “Simulation of arbitrary transmission line networks with nonlinear terminations,” IEEE Trans. Circuits Syst., vol. 38, no. 4, pp. 418–422, Apr. 1991. [2] Computer Methods for Circuit Analysis and Design, J. Vlach and K. Singhal, Eds. New York: Van Nostrand, 1994. [3] B. Gustavsen and A. Semlyen, “Rational approximation of frequency domain responses by vector fitting,” IEEE Trans. Power Del., vol. 14, no. 3, pp. 1052–1061, Jul. 1999. [4] B. Gustavsen, “Improving the pole relocating properites of vector fitting,” IEEE Trans. Power Del., vol. 21, no. 3, pp. 1587–1592, Jul. 2006. [5] D. Deschrijver, M. Mrozowski, T. Dhaene, and D. DeZutter, “Macromodeling of multiport systems using a fast implementation of the vector fitting method,” IEEE Microw. Wireless Compon. Lett., vol. 18, no. 6, pp. 383–385, Jun. 2008. [6] D. Deschrijver, B. Haegeman, and T. Dhaene, “Orthonormal vector fitting: A robust macromodeling tool for rational approximation of frequency domain response"
    }
}