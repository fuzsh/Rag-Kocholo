{
    "id": "dbpedia_5752_2",
    "rank": 37,
    "data": {
        "url": "https://statisticalhorizons.com/is-dummy-variable-adjustment-ever-good-for-missing-data/",
        "read_more_link": "",
        "language": "en",
        "title": "Is Dummy Variable Adjustment Ever Good for Missing Data?",
        "top_image": "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-11.52.08-AM.png",
        "meta_img": "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-11.52.08-AM.png",
        "images": [
            "https://www.facebook.com/tr?id=595016237513447&ev=PageView&noscript=1",
            "https://statisticalhorizons.com/wp-content/uploads/2021/11/Statistical-Horiozons-logo.png",
            "https://statisticalhorizons.com/wp-content/uploads/2021/11/Allison_web.jpeg",
            "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-11.52.08-AM.png",
            "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-11.52.08-AM.png",
            "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-12.03.58-PM.png 366w, https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-12.03.58-PM-300x146.png 300w",
            "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-12.03.58-PM.png",
            "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-11.43.55-AM-1.png",
            "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-11.43.55-AM-1.png",
            "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-12.08.40-PM.png 526w, https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-12.08.40-PM-300x29.png 300w",
            "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-12.08.40-PM.png",
            "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-12.13.03-PM-1.png",
            "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-12.13.03-PM-1.png",
            "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-12.29.58-PM.png",
            "https://statisticalhorizons.com/wp-content/uploads/2022/09/Screen-Shot-2022-09-26-at-12.29.58-PM.png",
            "https://statisticalhorizons.com/wp-content/uploads/2021/11/Statistical-Horiozons-logo.png",
            "https://statisticalhorizons.com/wp-content/uploads/2022/07/Code-Horizons-Coding-Seminars-Logo-Aqua.png",
            "https://statisticalhorizons.com/wp-content/uploads/2021/11/Statistical-Horiozons-logo-white.png",
            "https://statisticalhorizons.com/wp-content/uploads/2021/11/Statistical-Horiozons-logo-white.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "Ashley Fontillas"
        ],
        "publish_date": "2022-09-27T13:02:00+00:00",
        "summary": "",
        "meta_description": "Paul Allison describes specific situations in which dummy variable adjustment (DVA) is effective for handling missing data.",
        "meta_lang": "en",
        "meta_favicon": "https://statisticalhorizons.com/wp-content/uploads/2021/12/cropped-Statistical-Horizons-favicon-32x32.png",
        "meta_site_name": "Statistical Horizons",
        "canonical_link": "https://statisticalhorizons.com/is-dummy-variable-adjustment-ever-good-for-missing-data/",
        "text": "For many years, one of the more popular ways of handling missing data was a technique known as dummy variable adjustment (DVA), a method designed to handle missing data on predictor variables in regression analysis (Cohen and Cohen 1975). It works with any kind of regression—linear, logistic, Cox, etc. And, as I will explain, it’s intuitive and easy to implement.\n\nUnfortunately, it’s wrong. In a now-famous article, Michael Jones (1996), demonstrated that DVA (also known as the missing indicator method) generally yields biased estimates, even when data are missing completely at random. For this reason, contemporary reviews of missing data methods usually sweep DVA into the dustbin.\n\nIn this post, I’m going to pull it out. Although Jones performed an enormous service in showing us the pitfalls of DVA, I’ll argue that there are two situations in which DVA can be an effective missing data method, possibly better than my usual go-to methods of multiple imputation and (full information) maximum likelihood.\n\nLEARN MORE IN A SEMINAR WITH PAUL ALLISON\n\nBefore we dive into that argument, let’s take a brief look at how DVA works. Suppose you want to do a linear regression of Y on two variables, X and Z, but there are a substantial number of cases that have missing values on X. You create a dummy (indicator) variable D that has a value of 1 if X is observed and 0 if X is missing. In addition, for the missing values of X, you substitute some constant value c. All three variables, X, Z, and D, then go into the regression as predictors.\n\nIn a fundamental sense, the model is invariant to the choice of c. In particular, the coefficients of X and Z will be the same no matter what c is. But the coefficient of D does depend on c. To facilitate interpretation of that coefficient, it’s often attractive to make c the mean of X for the non-missing cases.\n\nThen, you just run the regression of Y on X, Z, and D. Done! That gives you estimates for the coefficients in this equation:\n\nHow are these coefficients interpreted?\n\nb2 is the effect of Z, controlling for everything we know about X.\n\nb3 is the effect of X on Y controlling for Z, among those with X observed.\n\nIf c is the mean of X, b1 is the predicted value of Y for someone who is at the mean value of X minus the predicted value of Y for those who are missing on X.\n\nIn other words, the coefficient of the dummy for missingness tells us how much the missing cases differ on the dependent variable Y from an average individual who is not missing.\n\nWhat if Z also has missing values? Then you just do the same things you did for X. You create another dummy variable that indicates whether or not Z is missing, and you plug in the mean of Z (or any other constant) for the missing values. The new dummy variable also goes into the regression. This can be extended to any number of predictors with missing data.\n\nHere’s what’s attractive about this method:\n\nIt’s not hard to do.\n\nIt works with any kind of regression.\n\nNo cases are lost.\n\nAll the available information is incorporated into the regression model.\n\nThe estimated standard errors will be accurate (if the usual assumptions about the error term are satisfied).\n\nThis last point is particularly noteworthy because many traditional methods (like pairwise deletion or single imputation) do a poor job of getting the standard errors right.\n\nUnfortunately, as Jones showed, the coefficient estimates tend to be biased. Without going into the details of his proof, the intuition for this bias is pretty clear. If you substitute any constant value for the missing values of X, you’re reducing the true variability in that variable. If X and Z are correlated, that will lead to bias in the coefficient of Z. And that further induces bias in the coefficient of X.\n\nThis can happen even if the data are missing completely at random, and that makes DVA a non-starter. But wait! I’m now going to suggest two important situations in which Jones’s results do not rule out DVA.\n\n1. Data are missing on X because that variable doesn’t apply or has no meaning for some subset of the sample.\n\nAn implicit assumption of Jones’s proof is that there are true values of X that are not observed and that have some impact on the dependent variable. But what if there are no such values?\n\nConsider this typical example. Suppose you want to estimate a regression model in which Y is a measure of depression and X is a measure of marital satisfaction. However, 30% of the individuals in your sample are unmarried and, hence, their marital satisfaction is missing. Would it make any sense to do multiple imputation to impute their marital satisfaction? I think not.\n\nHere’s an approach that makes more sense. Let’s assume that the data generating mechanism consists of two equations, one for married people and another for unmarried people:\n\nThe obvious difference between these two equations is that X (marital satisfaction) does not appear in the equation for the unmarried people. The Z variable could be any other potential predictor of depression, say, education.\n\nYou could, of course, estimate these two equations separately for married and unmarried people. However, if you think that the effect of Z (or any other covariates) is the same for married and unmarried people, you’ll get much larger standard errors for the two separate estimates than if you had estimated a single estimate for both groups. Plus, if you have more than one “doesn’t apply” variable, you might have to estimate several different equations.\n\nTo fix this, let’s assume that the coefficient of Z is the same for both married and unmarried people, i.e.,\n\nAs before, we’ll let D = 1 if data are present for X (the married people), otherwise 0. Relying on a standard algebraic trick for combining equations for two groups using dummy variables, we get\n\nThis equation contains the “main effect” of D and the interaction of D and X. Multiplying X by D is equivalent to setting X to 0 when X is missing. But this is just the DVA model with c = 0. And if the ε satisfies the usual assumptions for linear regression, OLS applied to this model will yield “best unbiased estimates” of all coefficients.\n\nNote also that for c = 0, the coefficient of D is the difference in the intercept for the original two equations for married and unmarried. On the other hand, if c is set equal to the sample mean of X, the coefficient of D has the interpretation described earlier. For this example, it would be the expected value of Y for married people who are at the mean of marital satisfaction minus the expected value of Y for those who are unmarried (controlling for any other variables in the model).\n\nYou could also add an interaction between Z and D, but that would be the equivalent of estimating the two equations separately (except that the error variances would be constrained equal).\n\nThe upshot is that DVA does a very good job of estimating the coefficients of a plausible model for the “doesn’t apply” situation. It’s hard to see how maximum likelihood or multiple imputation could improve on it. In fact, I did a small simulation which showed that DVA does a better job in this situation than either maximum likelihood or multiple imputation, both of which produced estimates that were substantially biased. (See Appendix 1 for details).\n\n2. Missing data on baseline covariates in randomized controlled trials.\n\nWhen analyzing data from a randomized controlled trial (RCT), it’s very common to estimate the treatment effect while controlling for one or more covariates that are measured at baseline, usually in an ANCOVA framework. Although a simple ANOVA would yield an unbiased estimate of the treatment effect, it’s desirable to include covariates in order to reduce the error variance in the model, thereby reducing the standard error of the treatment estimate. That, in turn, increases statistical power to test the treatment effect.\n\nBaseline covariates often have missing data, however. It would be counterproductive to delete cases with missing data because that would tend to increase the standard errors, as well as violate the intention-to-treat principle. By contrast, DVA can be an effective method (Puma et al. 2009, Groenwold et al. 2012). As Jones noted in his original 1996 paper, bias only becomes a problem for DVA when the variable with missing data is correlated with other variables in the model. But in an RCT, baseline covariates are uncorrelated with the treatment by design. Consequently, DVA should not introduce any bias in the treatment effect.\n\nBut multiple imputation or maximum likelihood would also seem to be reasonable choices in the RCT situation. How does DVA compare with those methods? Again, I did a small simulation to compare the three methods for estimating the linear regression of Y on X and Z, when X and Z are uncorrelated. (See Appendix 2 for details).\n\nIn the simulation, Z is a dichotomous treatment indicator and X is a baseline covariate with missing data. The results showed that when data on X are missing completely at random, all three methods are approximately unbiased for the coefficients of both X and Z.\n\nWhat about standard errors? As estimated by DVA, the standard error for the X coefficient was about 17% larger than those for maximum likelihood and multiple imputation. But we really don’t care about that coefficient. What we care about is the treatment effect, namely the coefficient of Z. For that coefficient, DVA yielded a smaller standard error than those for maximum likelihood or multiple imputation, although the differences were not large. The differences became substantially larger when X was not missing at random.\n\nThe upshot is that DVA seems to be at least as good, and possibly somewhat better, than maximum likelihood or multiple imputation for estimating the treatment effect for an RCT with baseline covariates that have missing data.\n\nReferences\n\nCohen, J., and Cohen, P. (1975), Applied Multiple Regression Correlation Analysis for the Behavioral Sciences, New York John Wiley.\n\nGroenwold, R. H., White, I. R., Donders, A. R. T., Carpenter, J. R., Altman, D. G., & Moons, K. G. (2012). “Missing covariate data in clinical research: when and when not to use the missing-indicator method for analysis.” Cmaj, 184(11), 1265-1269. https://doi.org/10.1503/cmaj.110977\n\nPuma, Michael J., Robert B. Olsen, Stephen H. Bell, and Cristofer Price (2009). “What to Do When Data Are Missing in Group Randomized Controlled Trials” (NCEE 2009-0049). Washington, DC: National Center for Education Evaluation and Regional Assistance, Institute of Education Sciences, U.S. Department of Education. https://ies.ed.gov/pubsearch/pubsinfo.asp?pubid=NCEE20090049\n\nAppendix 1. Simulation to Evaluate DVA for “does not apply” applications.\n\nData were generated based on the model shown above for married and unmarried people. Specifically,\n\nwhere X and Z are both standard normal with a correlation of 0.50. In both equations, ε is standard normal and independent of X and Z.\n\nBecause I was only concerned about bias, not sampling variation, I generated a single large sample, with 10,000 married and 10,000 unmarried. X was then made to be missing (completely at random) with a probability of 0.50.\n\nThe next step was to estimate the regression of Y on X and Z, using three different methods: DVA, multiple imputation, and full information maximum likelihood. All data generation and analysis were done with R.\n\nFor DVA, I just used the lm function. I used the lavaan package for maximum likelihood and the jomo package for multiple imputation (25 data sets imputed via the multivariate normal MCMC method). R code is shown below.\n\nHere are the results.\n\nDVA Maximum Likelihood Multiple Imputation\n\nVariable Estimate S.E. Estimate S.E. Estimate S.E. X 2.010 .020 1.846 .019 1.844 .019 Z 2.006 .015 1.780 .017 1.781 .017\n\nSince the true coefficients were both 2.0, it’s clear that DVA is producing approximately unbiased results. As expected, maximum likelihood and multiple imputation produced estimates that were very similar to each other. However, both sets of estimates were about 8 to 10% lower than the true values.\n\nThis simulation should only be regarded as exploratory. I only used one set of parameter values, a single covariate, a strictly linear model, and a single missing data mechanism. Nevertheless, it strongly suggests that multiple imputation and maximum likelihood may yield biased estimates for a plausible “does not apply” model.\n\nR Code for “Does Not Apply” Simulation\n\n#Appendix 1\n\nlibrary(lavaan)\n\nlibrary(jomo)\n\nlibrary(mitools)\n\nlibrary(mice)\n\n#Generate data\n\nset.seed(3495)\n\nn <- 10000\n\nz_mar <- rnorm(n)\n\nx_mar <- .5*z_mar + sqrt(1-.5*.5)*rnorm(n)\n\ny_mar <- 3 + 2*z_mar + 2*x_mar + 2*rnorm(n)\n\nz_sing <- rnorm(n)\n\nx_sing <- rep(NA, n)\n\ny_sing <- 4 + 2*z_sing + 2*rnorm(n)\n\ndat <- data.frame(y=c(y_mar, y_sing),\n\nz=c(z_mar, z_sing),\n\nx=c(x_mar, x_sing))\n\ndat$d <- ifelse(is.na(dat$x), 0, 1)\n\ndat$x.dva <- ifelse(is.na(dat$x), 0, dat$x)\n\n#DVA method\n\nmod.dva <- lm(y ~ x.dva + z + d, data=dat)\n\nsummary(mod.dva)\n\n#Maximum likelihood\n\nmod.ml <- sem('y ~ x + z', data=dat, missing='fiml.x')\n\nsummary(mod.ml)\n\n#Multiple imputation\n\ndatsub <- subset(dat,select=-c(d,x.dva))\n\noutjomo <-jomo(datsub, nimp=25)\n\nmi_list <- imputationList(split(outjomo, outjomo$Imputation)[-1])\n\nmi_results <- with(mi_list, lm(y ~ x + z))\n\nsummary(pool(as.mira(mi_results)),type=\"all\")\n\nAppendix 2. Simulation to Evaluate DVA for RCTs.\n\nI generated data according to the model\n\nwhere Z is a treatment indicator with values of 1 and 0, each with probability 0.50. Both X and ε are standard normal variates, independent of each other and of Z. I then made X missing (completely at random) with probability 0.50.\n\nIn order to get model-free estimates of the standard errors, I generated 1,000 samples, each of size 200. For each sample, the model was estimated by DVA, maximum likelihood and multiple imputation.\n\nAll data generation and analysis were done with R. For DVA, I just used the built-in lm function. I used the lavaan package for maximum likelihood and the jomo package for multiple imputation (10 data sets per sample). Both maximum likelihood and multiple imputation were based on the multivariate normal assumption, which is satisfied for these data by design. R code is shown below.\n\nThe following table reports the means of the coefficient estimates and the standard deviations (estimated standard errors) of those estimates across the repeated samples.\n\nDVA Maximum Likelihood Multiple Imputation\n\nVariable Estimate S.E. Estimate S.E. Estimate S.E. X 1.987 .209 2.011 .177 1.975 .180 Z 2.004 .340 1.998 .344 1.979 .345\n\nAll three methods appear to be approximately unbiased for the coefficients of both X and Z. Maximum likelihood and multiple imputation produced noticeably smaller standard errors than DVA for the coefficient of X. But, as already noted, we don’t care about that coefficient. For the treatment effect, DVA has the smallest standard error, although the differences are not large and may well be within the range of Monte Carlo error.\n\nI then switched things up to make X not missing at random, and in an extreme way. Specifically, all values of X less than 0 were missing, and all values greater than 0 were observed. That changed the results in an unexpected way:\n\nDVA Maximum Likelihood Multiple Imputation\n\nVariable Estimate S.E. Estimate S.E. Estimate S.E. X 1.997 .346 2.612 .333 2.519 .339 Z 1.987 .296 1.995 .377 1.981 .376\n\nNow, the coefficients for X are unbiased for DVA but clearly biased upward for maximum likelihood and multiple imputation (by about 30%). All three methods are approximately unbiased for the treatment effect, but DVA has a standard error more than 20% lower than the other two.\n\nThis simulation should only be regarded as exploratory. I only used one set of parameter values, a single sample size, a single covariate, a strictly linear model, and only two missing data mechanisms. But, at the least, it should tell us that DVA is a strong contender for dealing with missing baseline covariate values in RCTs.\n\nR Code for RCT Simulation"
    }
}