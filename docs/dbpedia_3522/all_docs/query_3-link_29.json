{
    "id": "dbpedia_3522_3",
    "rank": 29,
    "data": {
        "url": "https://support.microsoft.com/en-us/office/create-a-relationship-between-tables-in-excel-fe1b6be7-1d85-4add-a629-8a3848820be3",
        "read_more_link": "",
        "language": "en",
        "title": "Create a relationship between tables in Excel",
        "top_image": "https://support.microsoft.com/favicon-32x32.png",
        "meta_img": "https://support.microsoft.com/favicon-32x32.png",
        "images": [
            "https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE1Mu3b?ver=5c31",
            "https://support.content.office.net/en-us/media/4873755a-8b1e-497e-bc54-101d1e75d3e7.png",
            "https://support.content.office.net/en-us/media/21daf83c-8ee5-483b-971c-7c960da8f1b4.png",
            "https://support.content.office.net/en-us/media/a838cc8c-0dad-488c-bdb1-cf0457549a3e.png",
            "https://support.microsoft.com/images/Facebook-GrayScale.png",
            "https://support.microsoft.com/images/Linkedin-GrayScale.png",
            "https://support.microsoft.com/images/Mail-GrayScale.png",
            "https://support.content.office.net/en-us/media/f4e85874-2a1a-438d-9c3c-17b069c454c0.png",
            "https://support.content.office.net/en-us/media/a9241eee-a729-4513-97b4-5b87c381c21b.png",
            "https://support.content.office.net/en-us/media/9e557d93-f803-44df-a274-1282d542cf63.png",
            "https://support.content.office.net/en-us/media/fbf6e41b-ddbe-43db-a616-7a8e48d43d18.png",
            "https://support.content.office.net/en-us/media/9255871d-06a6-4de5-9236-5fd7af100c5c.png",
            "https://support.content.office.net/en-us/media/ccb7c2a6-17dd-4cc3-88b7-8da966e59f59.png",
            "https://support.content.office.net/en-us/media/bcd2fdf1-530a-482f-b96d-5f2f2a49ac66.png",
            "https://support.content.office.net/en-us/media/f4e85874-2a1a-438d-9c3c-17b069c454c0.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "Ever used VLOOKUP to bring data from one table into another? Learn a much easier way to join tables in a workbook by creating relationships.",
        "meta_lang": "en",
        "meta_favicon": "/apple-touch-icon.png",
        "meta_site_name": "",
        "canonical_link": "https://support.microsoft.com/en-us/office/create-a-relationship-between-tables-in-excel-fe1b6be7-1d85-4add-a629-8a3848820be3",
        "text": "Example: Relating time intelligence data to airline flight data\n\nYou can learn about both table relationships and time intelligence using free data on the Microsoft Azure Marketplace. Some of these datasets are very large, requiring a fast internet connection to complete the data download in a reasonable period of time.\n\nStart Power Pivot in Microsoft Excel add-in and open the Power Pivot window.\n\nClick Get External Data > From Data Service > From Microsoft Azure Marketplace. The Microsoft Azure Marketplace home page opens in the Table Import Wizard.\n\nUnder Price, click Free.\n\nUnder Category, click Science & Statistics.\n\nFind DateStream and click Subscribe.\n\nEnter your Microsoft account and click Sign in. A preview of the data should appear in the window.\n\nScroll to the bottom and click Select Query.\n\nClick Next.\n\nChoose BasicCalendarUS and then click Finish to import the data. Over a fast internet connection, import should take about a minute. When finished, you should see a status report of 73,414 rows transferred. Click Close.\n\nClick Get External Data > From Data Service > From Microsoft Azure Marketplace to import a second dataset.\n\nUnder Type, click Data.\n\nUnder Price, click Free.\n\nFind US Air Carrier Flight Delays and click Select.\n\nScroll to the bottom and click Select Query.\n\nClick Next.\n\nClick Finish to import the data. Over a fast internet connection, this can take 15 minutes to import. When finished, you should see a status report of 2,427,284 rows transferred. Click Close. You should now have two tables in the data model. To relate them, we’ll need compatible columns in each table.\n\nNotice that the DateKey in BasicCalendarUS is in the format 1/1/2012 12:00:00 AM. The On_Time_Performance table also has a datetime column, FlightDate, whose values are specified in the same format: 1/1/2012 12:00:00 AM. The two columns contain matching data, of the same data type, and at least one of the columns (DateKey) contains only unique values. In the next several steps, you’ll use these columns to relate the tables.\n\nIn the Power Pivot window, click PivotTable to create a PivotTable in a new or existing worksheet.\n\nIn the Field List, expand On_Time_Performance and click ArrDelayMinutes to add it to the Values area. In the PivotTable, you should see the total amount of time flights were delayed, as measured in minutes.\n\nExpand BasicCalendarUS and click MonthInCalendar to add it to the Rows area.\n\nNotice that the PivotTable now lists months, but the sum total of minutes is the same for every month. Repeating, identical values indicate a relationship is needed.\n\nIn the Field List, in “Relationships between tables may be needed”, click Create.\n\nIn Related Table, select On_Time_Performance and in Related Column (Primary) choose FlightDate.\n\nIn Table, select BasicCalendarUS and in Column (Foreign) choose DateKey. Click OK to create the relationship.\n\nNotice that the sum of minutes delayed now varies for each month.\n\nIn BasicCalendarUS and drag YearKey to the Rows area, above MonthInCalendar.\n\nYou can now slice arrival delays by year and month, or other values in the calendar.\n\nTips: By default, months are listed in alphabetical order. Using the Power Pivot add-in, you can change the sort so that months appear in chronological order.\n\nMake sure that the BasicCalendarUS table is open in the Power Pivot window.\n\nOn the Home table, click Sort by Column.\n\nIn Sort, choose MonthInCalendar\n\nIn By, choose MonthOfYear.\n\nThe PivotTable now sorts each month-year combination (October 2011, November 2011) by the month number within a year (10, 11). Changing the sort order is easy because the DateStream feed provides all of the necessary columns to make this scenario work. If you’re using a different time intelligence table, your step will be different.\n\n“Relationships between tables may be needed”\n\nAs you add fields to a PivotTable, you’ll be informed if a table relationship is required to make sense of the fields you selected in the PivotTable.\n\nAlthough Excel can tell you when a relationship is needed, it can’t tell you which tables and columns to use, or whether a table relationship is even possible. Try following these steps to get the answers you need.\n\nStep 1: Determine which tables to specify in the relationship\n\nIf your model contains just a few tables, it might be immediately obvious which ones you need to use. But for larger models, you could probably use some help. One approach is to use Diagram View in the Power Pivot add-in. Diagram View provides a visual representation of all the tables in the Data Model. Using Diagram View, you can quickly determine which tables are separate from the rest of the model.\n\nNote: It’s possible to create ambiguous relationships that are invalid when used in a PivotTable or Power View report. Suppose all of your tables are related in some way to other tables in the model, but when you try to combine fields from different tables, you get the “Relationships between tables may be needed” message. The most likely cause is that you’ve run into a many-to-many relationship. If you follow the chain of table relationships that connect to the tables you want to use, you will probably discover that you have two or more one-to-many table relationships. There is no easy workaround that works for every situation, but you might try creating calculated columns to consolidate the columns you want to use into one table.\n\nStep 2: Find columns that can be used to create a path from one table to the next\n\nAfter you’ve identified which table is disconnected from the rest of the model, review its columns to determine whether another column, elsewhere in the model, contains matching values.\n\nFor example, suppose you have a model that contains product sales by territory, and that you subsequently import demographic data to find out if there is correlation between sales and demographic trends in each territory. Because the demographic data comes from a different data source, its tables are initially isolated from the rest of the model. To integrate the demographic data with the rest of your model, you’ll need to find a column in one of the demographic tables that corresponds to one you’re already using. For example if the demographic data is organized by region, and your sales data specifies which region the sale occurred, you could relate the two datasets by finding a common column, such as a State, Zip code, or Region, to provide the lookup.\n\nBesides matching values, there are a few additional requirements for creating a relationship:\n\nData values in the lookup column must be unique. In other words, the column can’t contain duplicates. In a Data Model, nulls and empty strings are equivalent to a blank, which is a distinct data value. This means that you can’t have multiple nulls in the lookup column.\n\nData types of both the source column and lookup column must be compatible. For more information about data types, see Data types in Data Models.\n\nTo learn more about table relationships, see Relationships between tables in a Data Model.\n\nTop of Page"
    }
}