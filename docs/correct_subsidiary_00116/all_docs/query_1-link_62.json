{
    "id": "correct_subsidiary_00116_1",
    "rank": 62,
    "data": {
        "url": "https://community.spiceworks.com/t/physical-pdc-stuck-on-local-cmos-clock/951273",
        "read_more_link": "",
        "language": "en",
        "title": "Physical PDC Stuck on local CMOS Clock",
        "top_image": "https://global.discourse-cdn.com/spiceworks/original/1X/7a73606d7df2f794c4789897e49693fb3c471b23.png",
        "meta_img": "https://global.discourse-cdn.com/spiceworks/original/1X/7a73606d7df2f794c4789897e49693fb3c471b23.png",
        "images": [
            "https://secure.intelligence52.com/795141.png",
            "https://avatars.discourse-cdn.com/v4/letter/7/bbce88/48.png",
            "https://avatars.discourse-cdn.com/v4/letter/7/bbce88/48.png",
            "https://sea1.discourse-cdn.com/spiceworks/user_avatar/community.spiceworks.com/chrishobgood/48/84722_2.png",
            "https://avatars.discourse-cdn.com/v4/letter/7/bbce88/48.png",
            "https://sea1.discourse-cdn.com/spiceworks/user_avatar/community.spiceworks.com/chrishobgood/48/84722_2.png",
            "https://sea1.discourse-cdn.com/spiceworks/user_avatar/community.spiceworks.com/moorebeers/48/46054_2.png",
            "https://sea1.discourse-cdn.com/spiceworks/user_avatar/community.spiceworks.com/chrishobgood/48/84722_2.png",
            "https://sea1.discourse-cdn.com/spiceworks/user_avatar/community.spiceworks.com/moorebeers/48/46054_2.png",
            "https://global.discourse-cdn.com/spiceworks/original/4X/0/7/8/07838fcd6d9a7e9575cf333d2a6673ee0110d796.png",
            "https://global.discourse-cdn.com/spiceworks/original/4X/e/a/5/ea59d2a1db14a4593e495765748624d3f8541677.png",
            "https://global.discourse-cdn.com/spiceworks/original/4X/b/7/e/b7ea74d89977907b0379480933042c199fc4428d.png",
            "https://zdbb.net/l/z0WVjCBSEeGLoxIxOQVEwQ/"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            "windows-server",
            "question"
        ],
        "tags": null,
        "authors": [
            "chrishobgood (ChrisHobgood)",
            "moorebeers (MooreBeers)"
        ],
        "publish_date": "2023-05-04T10:31:55+00:00",
        "summary": "",
        "meta_description": "My Physical PDC is stuck on the CMOS clock. \nI’ve tried everything I could find on the internet. Nothing has worked so far. So here I am. \nRunning Server 2019 Essentials. On a Dell PowerEdge T130. \nThe PDC clock time is &hellip;",
        "meta_lang": "en",
        "meta_favicon": "https://global.discourse-cdn.com/spiceworks/optimized/1X/a254df83358a951c43ed6ee756b5e0011a8d58bc_2_32x32.png",
        "meta_site_name": "Spiceworks Community",
        "canonical_link": "https://community.spiceworks.com/t/physical-pdc-stuck-on-local-cmos-clock/951273",
        "text": "My Physical PDC is stuck on the CMOS clock.\n\nI’ve tried everything I could find on the internet. Nothing has worked so far. So here I am.\n\nRunning Server 2019 Essentials. On a Dell PowerEdge T130.\n\nThe PDC clock time is 10 minutes off what the NTPs servers query.\n\nUnder the Windows Date & Time settings, the time is greyed out and the message; “Some settings are hidden or managed by your organization” appears above it.\n\nAlso, none of the workstations are syncing with it. Some as much as 40 minutes off.\n\nI don’t recall configuring any time settings GPO’s and looked to confirm. though I could have missed it somewhere.\n\nThe registry settings match the w32tm configuration shown below.\n\nI can ping all the NTP servers I have listed. I don’t know what else to look for.\n\nWindows PowerShell transcript start\n\nStart time: 20230504081614\n\nUsername: AD\\administrator\n\nRunAs User: AD\\administrator\n\nConfiguration Name:\n\nMachine: DC01 (Microsoft Windows NT 10.0.17763.0)\n\nHost Application: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\nProcess ID: 12108\n\nPSVersion: 5.1.17763.3770\n\nPSEdition: Desktop\n\nPSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.17763.3770\n\nBuildVersion: 10.0.17763.3770\n\nCLRVersion: 4.0.30319.42000\n\nWSManStackVersion: 3.0\n\nPSRemotingProtocolVersion: 2.3\n\nSerializationVersion: 1.1.0.1\n\nTranscript started, output file is C:\\Users\\Administrator\\Documents\\PowerShell_transcript.DC01.wPHuBc8B.20230504081614.txt\n\nPS C:\\Users\\Administrator> w32tm /query /configuration\n\n[Configuration]\n\nEventLogFlags: 2 (Local)\n\nAnnounceFlags: 5 (Local)\n\nTimeJumpAuditOffset: 28800 (Local)\n\nMinPollInterval: 6 (Local)\n\nMaxPollInterval: 10 (Local)\n\nMaxNegPhaseCorrection: 172800 (Local)\n\nMaxPosPhaseCorrection: 172800 (Local)\n\nMaxAllowedPhaseOffset: 300 (Local)\n\nFrequencyCorrectRate: 4 (Local)\n\nPollAdjustFactor: 5 (Local)\n\nLargePhaseOffset: 50000000 (Local)\n\nSpikeWatchPeriod: 900 (Local)\n\nLocalClockDispersion: 10 (Local)\n\nHoldPeriod: 5 (Local)\n\nPhaseCorrectRate: 7 (Local)\n\nUpdateInterval: 100 (Local)\n\n[TimeProviders]\n\nNtpClient (Local)\n\nDllName: C:\\Windows\\SYSTEM32\\w32time.DLL (Local)\n\nEnabled: 1 (Local)\n\nInputProvider: 1 (Local)\n\nAllowNonstandardModeCombinations: 1 (Local)\n\nResolvePeerBackoffMinutes: 15 (Local)\n\nResolvePeerBackoffMaxTimes: 7 (Local)\n\nCompatibilityFlags: 2147483648 (Local)\n\nEventLogFlags: 1 (Local)\n\nLargeSampleSkew: 3 (Local)\n\nSpecialPollInterval: 1024 (Local)\n\nType: NTP (Local)\n\nNtpServer: 0.us.pool.ntp.org 1.us.pool.ntp.org 2.us.pool.ntp.org 3.us.pool.ntp.org (Local)\n\nNtpServer (Local)\n\nDllName: C:\\Windows\\SYSTEM32\\w32time.DLL (Local)\n\nEnabled: 1 (Local)\n\nInputProvider: 0 (Local)\n\nAllowNonstandardModeCombinations: 1 (Local)\n\nPS C:\\Users\\Administrator> w32tm /query /source\n\nLocal CMOS Clock\n\nPS C:\\Users\\Administrator> Stop-Transcript\n\nWindows PowerShell transcript end\n\nEnd time: 20230504081716\n\n@ntp-support-desk\n\nWindows PowerShell transcript start\n\nStart time: 20230504101323\n\nUsername: AD\\administrator\n\nRunAs User: AD\\administrator\n\nConfiguration Name:\n\nMachine: DC01 (Microsoft Windows NT 10.0.17763.0)\n\nHost Application: C:\\Windows\\System32\\WindowsPowerShell\\v1.0\\powershell.exe\n\nProcess ID: 1988\n\nPSVersion: 5.1.17763.3770\n\nPSEdition: Desktop\n\nPSCompatibleVersions: 1.0, 2.0, 3.0, 4.0, 5.0, 5.1.17763.3770\n\nBuildVersion: 10.0.17763.3770\n\nCLRVersion: 4.0.30319.42000\n\nWSManStackVersion: 3.0\n\nPSRemotingProtocolVersion: 2.3\n\nSerializationVersion: 1.1.0.1\n\nTranscript started, output file is C:\\Users\\Administrator\\Documents\\PowerShell_transcript.DC01.xk7w4V4q.20230504101323.txt\n\nPS C:\\Users\\Administrator> w32tm /query /peers\n\n#Peers: 4\n\nPeer: 0.us.pool.ntp.org\n\nState: Pending\n\nTime Remaining: 0.0000000s\n\nMode: 0 (reserved)\n\nStratum: 0 (unspecified)\n\nPeerPoll Interval: 0 (unspecified)\n\nHostPoll Interval: 0 (unspecified)\n\nPeer: 1.us.pool.ntp.org\n\nState: Pending\n\nTime Remaining: 0.0000000s\n\nMode: 0 (reserved)\n\nStratum: 0 (unspecified)\n\nPeerPoll Interval: 0 (unspecified)\n\nHostPoll Interval: 0 (unspecified)\n\nPeer: 2.us.pool.ntp.org\n\nState: Pending\n\nTime Remaining: 0.0000000s\n\nMode: 0 (reserved)\n\nStratum: 0 (unspecified)\n\nPeerPoll Interval: 0 (unspecified)\n\nHostPoll Interval: 0 (unspecified)\n\nPeer: 3.us.pool.ntp.org\n\nState: Pending\n\nTime Remaining: 0.0000000s\n\nMode: 0 (reserved)\n\nStratum: 0 (unspecified)\n\nPeerPoll Interval: 0 (unspecified)\n\nHostPoll Interval: 0 (unspecified)\n\nPS C:\\Users\\Administrator> w32tm /query /status\n\nLeap Indicator: 0(no warning)\n\nStratum: 1 (primary reference - syncd by radio clock)\n\nPrecision: -23 (119.209ns per tick)\n\nRoot Delay: 0.0000000s\n\nRoot Dispersion: 10.0000000s\n\nReferenceId: 0x4C4F434C (source name: “LOCL”)\n\nLast Successful Sync Time: 5/4/2023 8:02:10 AM\n\nSource: Local CMOS Clock\n\nPoll Interval: 6 (64s)\n\nPS C:\\Users\\Administrator> Stop-Transcript\n\nWindows PowerShell transcript end\n\nEnd time: 20230504101437\n\nBack for another round:\n\nSo I started a new job before my first post and was slowly getting thing under control thanks to no documentation. I started getting issues recently that time was off on some devices (not on our domain but still) so I started to check what was setup here. Like @chrishobgood I’m seeing fluctuations on many of the systems all are claiming to use CMOS as their time no matter what I do GPO or Registry. I’ve even gone so far as to follow an old stand by:\n\nand it still doesn’t work, just like what’s posted here. No matter what is done it’s like the system just refuse to change from CMOS even when I can get them to work for a short time.\n\nUnlinke @chrishobgood ​ I don’t have access to the firewall or our main Router, but Ping and Test-NetConnection all show as communication work as expected. I’m guessing I’ll be following you down this road for a bit as well.\n\nOkay…So after a few more minutes to dig around I found the following post:\n\nIt turns out that this person’s switches had a DoS protection turned on that was impeding time traffic because the Time Service and the DoS protection used the same UDP Port 123. I hope this helps. I’m doing some work on the network here to see if this will resolve or mitigate some of the issues we’re seeing here too.\n\n@chrishobgood ​ ( @chrishobgood2 ​)\n\nAfter a Weekend of letting the setting talk hold I can confirm that the switches at our company were blocking Time Updates and turning off the DoS protection on each switch resolved the issue. Though this doesn’t feel like an answer to me since we’re taking a layer of protection of out service. Not sure if our switches can use a different port, or if we need to define NTP Ports in each switch so they will allow it to pass without interruption. Does anyone have any thoughts on this or should this be considered resolved/dead?"
    }
}