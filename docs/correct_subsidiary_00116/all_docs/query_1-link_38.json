{
    "id": "correct_subsidiary_00116_1",
    "rank": 38,
    "data": {
        "url": "https://www.firewall.cx/cisco/cisco-routers/cisco-router-ntp.html",
        "read_more_link": "",
        "language": "en",
        "title": "Configuring NTP on a Cisco Router (NTP Client and NTP Server)",
        "top_image": "https://www.firewall.cx/images/layout/favicon-4.png",
        "meta_img": "https://www.firewall.cx/images/layout/favicon-4.png",
        "images": [
            "https://www.firewall.cx/templates/yootheme/cache/49/firewallcx-logo-200x48-491326c2.png",
            "https://www.firewall.cx/templates/yootheme/cache/49/firewallcx-logo-200x48-491326c2.png",
            "https://www.firewall.cx/templates/yootheme/cache/19/hornet-security-50x50-v2-195717c9.webp",
            "https://www.firewall.cx/templates/yootheme/cache/2f/zoho-netflow-50x50-2019-v1-2f3f1dac.png",
            "https://www.firewall.cx/templates/yootheme/cache/19/hornet-security-50x50-v2-195717c9.webp",
            "https://www.firewall.cx/templates/yootheme/cache/78/zoho-patchmanager-50x50-2019-78af124e.png",
            "https://www.firewall.cx/templates/yootheme/cache/56/zoho-eventlog-50x50-v1-5600893f.png",
            "https://www.firewall.cx/templates/yootheme/cache/19/hornet-security-50x50-v2-195717c9.webp",
            "https://www.firewall.cx/templates/yootheme/cache/fa/zoho-firewall-analyzer-50x50-2023-v1-fa5d296a.png",
            "https://www.firewall.cx/templates/yootheme/cache/18/zoho-opmanager-50x50-2019-v1-18e9de12.png",
            "https://www.firewall.cx/images/stories/collaborations/hornet-security-vm-backup-800x140-v2.webp#joomlaImage://local-images/stories/collaborations/hornet-security-vm-backup-800x140-v2.webp?width=800&height=140",
            "https://www.firewall.cx/images/stories/tk-cisco-routers-ntp-1.jpg",
            "https://www.firewall.cx/images/stories/collaborations/hornet-security-m365-100x140-v1.webp",
            "https://www.firewall.cx/images/stories/collaborations/hornet-security-vm-backup-100x140-v2.webp",
            "https://www.firewall.cx/images/stories/collaborations/zoho-opmanager-100x140-2019-v1.png",
            "https://www.firewall.cx/images/stories/collaborations/zoho-netflow-100x140-2019-v1.png",
            "https://www.firewall.cx/images/stories/collaborations/zoho-patchmanager-100x140-2019.png",
            "https://www.firewall.cx/images/stories/collaborations/zoho-eventlog-100x140-v1.png",
            "https://www.firewall.cx/images/stories/collaborations/hornet-security-the-swarm-100x140-v2.webp",
            "https://www.firewall.cx/images/stories/collaborations/zoho-firewall-analyzer-100x140-2023-v1.jpg"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "Complete guide to NTP Server and Client configuration on Cisco router. Includes troubleshooting commands,  examples and parameters.",
        "meta_lang": "en",
        "meta_favicon": "/images/layout/favicon-4.png",
        "meta_site_name": "",
        "canonical_link": null,
        "text": "Network Time Protocol (NTP) is a vital service not only for Cisco devices but almost every network device. Any computer-based device needs to be accurately synchronised with a reliable time source such as an NTP server.\n\nThis article will show you how to configure your Cisco router to synchronise its software clock from external sources such as NTP servers. We will also show you how to configure your router to act as an NTP server for your internal network devices, ensuring all devices are synchronised.\n\nWhen it comes to Cisco routers, obtaining the correct time is extremely important because a variety of services depend on it. The logging service shows each log entry with the date and time - very critical if you're trying to track a specific incident or troubleshoot a problem.\n\nGenerally, most Cisco routers have two clocks (most people are unaware of this!): a battery-powered hardware clock, referenced as the 'calendar' in the IOS CLI, and a software clock, referenced as the 'clock' in the IOS CLI.\n\nThe software clock is the primary source for time data and runs from the moment the system is up and running. The software clock can be updated from a number of sources:\n\nBecause the software clock can be configured to be updated from an external source, it is considered more accurate in comparison to the hardware clock. The hardware clock can be configured to be updated from the software clock.\n\nExample Scenario\n\nFirst example involves setting up the router to request NTP updates and synchronise itself from a public NTP server. This will ensure the router's time is constantly synchronised, however it will not act as an NTP server for internal hosts:\n\nWe'll need to configure the router to resolve FQDN using our ISP's name server:\n\nNow we instruct our Cisco router to obtain its updates from the public NTP server.\n\nAs soon we issue the command, the router will resolve the FQDN into an ip address and begin its synchronisation. Right after issuing the command, we can verify the router is correctly configured and awaiting synchronisation:\n\nR1# show ntp associations\n\naddress ref clock st when poll reach delay offset disp\n\n~195.97.91.220 131.188.3.221 2 30 64 1 0.000 -1539.9 7937.5\n\n* sys.peer, # selected, + candidate, - outlyer, x falseticker, ~ configured\n\nR1# show ntp status\n\nClock is unsynchronised, stratum 16, no reference clock\n\nnominal freq is 250.0000 Hz, actual freq is 250.0006 Hz, precision is 2**24\n\nreference time is 00000000.00000000 (02:00:00.000 Greece Mon Jan 1 1900)\n\nclock offset is 0.0000 msec, root delay is 0.00 msec\n\nroot dispersion is 0.00 msec, peer dispersion is 0.00 msec\n\nloopfilter state is 'FSET' (Drift set from file), drift is -0.000002405 s/s\n\nsystem poll interval is 64, never updated.\n\nThe 'show ntp associations' command shows that the system is configured (~) to synchronise with our selected NTP server, however, it is not yet synchronised. When it is, expect to see the star (*) symbol in front of the tilde (~). The 'ref. clock' column shows the IP address of the NTP server from which our public server (1.gr.pool.ntp.org) is synchronising.\n\nIt is also worth noting the column named 'st' which is equal to two (2). This represents the stratum level. The higher the stratum, the closer to the Atomic clock source we are. As a general rule, always try to synchronise with a server that has a low stratum.\n\nThe 'show ntp status' command confirms that we are yet to be synchronised with the NTP server as it clearly states that the 'clock is unsynchronised' and also shows us the current system time: 1st of Jan. 1900.\n\nAfter a couple of minutes, we re-visit the CLI prompt and re-issue the commands with the following results:\n\nLooking at the new output, we can see that our Cisco router is now synchronising with the configured peer (*) - public NTP server. Polling of the public NTP server will occur every 64 seconds, as shown in the command output.\n\nThe 'show ntp status' command also confirms the synchronisation, however, notice that the router has set its stratum level to 3. This is expected as the reference is stratum 2. The time is now correctly shown (01:17:15.562 Athens Sun Apr 23 2023).\n\nSynchronising Software Clock and Hardware Clock\n\nHere we'll see how in fact the software and hardware clocks on a Cisco router can have different times and how we can synchronise them between each other.\n\nThe following two commands show the difference in time between the two clocks on our Cisco router:\n\nWhile the difference is minor, we want to keep everything in our network synchronised as precisely as possible.\n\nKeep in mind that 'show clock' refers to the software clock and 'show calendar' refers to the hardware clock of your router.\n\nTo synchronise the two clocks all we need to do is issue the following command:\n\nThe 'ntp update-calendar' forces the hardware clock to synchronise with the system's software clock. After a couple of minutes, we check to see if the two clocks have synchronised:\n\nWe can see now that both clocks are accurately synchronised.\n\nConfiguring The System as an Authoritative NTP Server\n\nIf you want your system to become an authoritative NTP server from which other internal routers or machines can synchronise, you can achieve this with the following command:\n\nThe router now acts as an NTP server and is able to respond to internal clients NTP requests. Executing the 'ntp association' command reveals our router is obtaining its time synchronisation from itself:\n\nTroubleshooting and Monitoring NTP Status\n\nTroubleshooting NTP messages and events is important when you are trying to verify everything is working correctly. You might notice that your Cisco router is not able to create a peer connection with a configured NTP server or your internal LAN clients might not be able to synchronise with your Cisco router; In any case, knowing how to troubleshoot NTPs is something every engineer must be aware of.\n\nThankfully Cisco provides a number of options that allow you to troubleshoot many aspects of your NTP service.\n\nThe most useful debug commands are the 'debug ntp events', 'debug ntp adjust' and 'debug ntp core'. These three commands provide enough debugging to help you troubleshoot problems you might encounter.\n\nClosing, if you would like more information on the ntp associations created by your router you can try the following command:\n\nThe 'show ntp associations detail' command will provide much information on the association created with the NTP servers. This is most helpful when you see you are unable to create an association with an NTP server.\n\nSummary\n\nThis article provided an insight to NTP configuration on Cisco routers. We analysed why the NTP service is important and how it can be used to keep every node in a network synchronised. We examined different methods of NTP synchronisation and provided a fairly in-depth analysis.\n\nIf you have found the article useful, we would really appreciate you sharing it with others by using the provided services on the top left corner of this article. Sharing our articles takes only a minute of your time and helps Firewall.cx reach more people through such services."
    }
}