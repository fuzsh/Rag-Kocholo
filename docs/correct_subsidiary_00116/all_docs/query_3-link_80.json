{
    "id": "correct_subsidiary_00116_3",
    "rank": 80,
    "data": {
        "url": "https://www.computernetworkingnotes.com/ccna-study-guide/how-to-configure-ntp-in-cisco-router.html",
        "read_more_link": "",
        "language": "en",
        "title": "How to Configure NTP in Cisco Router",
        "top_image": "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/intro/how-to-configure-ntp-in-cisco-router.png",
        "meta_img": "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/intro/how-to-configure-ntp-in-cisco-router.png",
        "images": [
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-01-ntp-digram.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-02-ntp-example.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-03-ntp-server-client.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-04-ntp-practice-lab.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-05-importing-gns-lab.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-06-importing-gns-select-lab.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-07-save-location.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-08-start-lab.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-09-access-console.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-10-adjust-time-r1.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-11-loop-back-interface.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-12-router-rip.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-13-ntp-master.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-14-ntp-broadcast.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-15-save-config.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-16-ntp-server-client.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-17-ntp-updated-r2.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-18-configure-ntp-client-r3.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-19-configure-ntp-client-r4.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-20-configure-ntp-status.png",
            "https://www.computernetworkingnotes.com/wp-content/uploads/ccna-study-guide/images/csg01-21-ntp-status.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": "2020-01-12T00:00:00",
        "summary": "",
        "meta_description": "This tutorial explains how to configure NTP Server and NTP Client in Cisco Router step by step with practical example. Learn basic concepts of NTP such as what NTP is, how NTP works, NTP stratum levels, meaning of synchronized and un-synchronized NTP clock in detail.",
        "meta_lang": "en",
        "meta_favicon": "https://www.computernetworkingnotes.com/wp-content/themes/cnn/favipack/apple-touch-icon.png",
        "meta_site_name": "ComputerNetworkingNotes",
        "canonical_link": "https://www.computernetworkingnotes.com/ccna-study-guide/how-to-configure-ntp-in-cisco-router.html",
        "text": "This tutorial explains how to configure NTP Server and NTP Client in Cisco Router step by step with practical example. Learn basic concepts of NTP such as what NTP is, how NTP works, NTP stratum levels, meaning of synchronized and un-synchronized NTP clock in detail.\n\nBasic concepts of NTP\n\nBy default networking devices have their own mechanism or clock to read and use the time. Unless devices are not connected with each other, there is no problem. But if devices are connected with each other with different time settings, applications or services which depend on time for functionality will not work or deliver unexpected results.\n\nLet’s understand it with a simple example.\n\nA user got “Certificate is not valid” message while he tried to access bank’s website so he called the support person. Support person figured out that time setting was incorrect in user’s computer. Once setting was configured correctly, user was able to connect with bank’s website.\n\nCan you guess what went wrong in this example?\n\nWell… In order to mitigate security risks (such as phishing attack), usually financial sites issue a digital certificate. Browsers use this certificate to the check the identity of the website. This certificate remains valid only for certain time period. Web browser uses local system’s time to authenticate the certificate. If browser finds any unusual difference between both times, it doesn’t validate the certificate and issues a warning message to user. This is what exactly happened in this example.\n\nLet’s take another example. Sales section of a company opens at 7.00 AM and close at 7.00 PM. Company wants to allow users to access its server only in business hours. So it configured a time based firewall in router which connects users with server. In this router clock is running 12 hours ahead from the server’s clock.\n\nWill this setup work?\n\nNope, users will never be able to login in server in working hours. Router uses its own clock to authenticate the access. With this setup, router allows users to login between 7.00 PM to 7.00 AM instead of 7.00 AM to 7.00 PM.\n\nAbove examples explain how time synchronization plays a crucial role in networking. NTP is a dedicated protocol for time synchronization. It allows us to use a centralized time for all our networking devices. NTP stands for Network Time Protocol.\n\nNTP mode in Cisco Router\n\nA Cisco router can be configured in three modes: -\n\nNTP Server only\n\nNTP Server /Client\n\nNTP Client only\n\nNTP Server Mode\n\nIn this mode, Router reads time from NTP Source. Unless we manually define the NTP source, router uses its own clock as NTP source. As per requirement, we can configure router’s clock or can use an external clock as NTP source. Once NTP Source is configured, NTP Server router advertises this time in network. In this mode, router only advertises NTP updates. It doesn’t accept any NTP update for other NTP server.\n\nNTP Server/Client Mode\n\nIn this mode, router receives updates from NTP server and advertises them from its own interfaces. This way router plays both roles. As NTP Client it receives NTP updates and as NTP Server it advertises NTP updates.\n\nIn this mode, as a NTP Server, instead of using its own NTP Source, router uses received NTP updates from other NTP server to advertise the NTP updates. This feature allows us to use a single centralized NTP source at NTP Server.\n\nNTP Client Mode\n\nIn this mode, router only receives NTP updates. It does not advertise received updates. It uses them to sync its own clock.\n\nLAB Setup for NTP configuration\n\nTo understand NTP configuration in detail with practical example, let’s create a simple topology in GNS3 as illustrate in following figure\n\nTo learn how to install GNS3 step by step with examples, see this tutorial\n\nLearn how to install and configure GNS3 for CCNA lab\n\nConfigure following IP addresses\n\nConfigure RIP routing protocol in all routers.\n\nCan I use packet tracer for this practice?\n\nSadly, necessary commands to configure NTP server are not available in Packet Tracer. We have to use the real Cisco router or simulator software which uses real Cisco IOS for simulation such as GNS3 or Cisco virtual lab. This tutorial uses GNS3.\n\nFor this tutorial I assume that above essential IP addresses are configured properly in network and RIP routing protocol is running.\n\nIf you don’t want to configure this configuration manually, download this pre-configured topology and load it in GNS3.\n\nNTP practice Lab without IOS\n\nBy default GNS3 does not install Cisco ISO. In this tutorial I used Cisco 2600 router. If this router is not available in your GNS3, download this pre-configured topology. In contains necessary IOS file and configuration.\n\nNTP practice Lab with IOS\n\nImporting NTP practice LAB in GNS3\n\nClick File menu and click Import portable project\n\nSelect the appropriate downloaded LAB file\n\nTo extract and use this lab, wizard will create a new project. Choose the descriptive name for the project and select the folder location where you want to save this project and click save button\n\nOnce practice lab is imported, click start button to start the LAB.\n\nNTP stratum plays key role in NTP configuration. So before we learn how to configure NTP, let’s quickly understand what stratum is and how it is used in NTP.\n\nNTP Stratum\n\nNTP devices read time from NTP source. Stratum defines the reliability and accuracy of NTP source. It uses a scale of stratum 0 to stratum 15 for NTP sources. In this scale, stratum 0 is the most reliable and stratum 15 is the worst reliable source of time.\n\nStratum-0 devices use the atomic clock and provide the most accurate time. To use this time, devices need lot of CPU power and memories. Usually these types of devices are used in critical sectors such as Defense, Research, Space and Weather department.\n\nSince syncing clock with stratum-0 devices consumes lot of CPU power and memories, regular computers and networking devices never sync their clocks with these devices. This also applies on Cisco routers. We cannot configure regular Cisco router to use this time.\n\nPublic Time Servers stand next in this scale and are generally referred as stratum-1 devices. These servers sync their clock with stratum-0 devices and provide an optimized time for regular devices. To use this optimized time, devices do not need any additional CPU power or memories. Any regular device can use this time. We can configure any Cisco router to use this time.\n\nIn real life, usually companies deploy a dedicate NTP (time) server which gets its time from stratum 1 server and later this NTP server is used as centralized source of time in entire network.\n\nIn exam we are not allowed to connect with internet. Since internet is not available, we cannot use the public NTP server. Luckily NTP allows us to use any valid source of time. We can use router’s internal clock as NTP source for the practice and as well as in exam (if it is asked).\n\nRegardless which time source you use, configuration steps are same. You can use same commands and steps to configure NTP in real life environment.\n\nConfigure NTP Server\n\nTo deploy a router as NTP server, following steps are required.\n\nAdjust router clock\n\nConfigure Loop back interface\n\nAdd loopback interface’s network in routing table\n\nConfigure NTP Server\n\nConfigure active interfaces to act as NTP Server only\n\nAdjust router clock\n\nIn order to use router’s internal clock as NTP source, we have to match it with current time.\n\nAccess command prompt of router R1 through console line\n\nLet’s view the current time with show clock command before updating it\n\nR1#show clock *00:15:05.392 UTC Fri Mar 1 2002\n\nOutput of this command provides information about time, time zone and date. As we can see in above output, all these settings are configured incorrectly and need to be set correctly. To adjust these settings following commands are used\n\nRun following commands to adjust these settings correctly\n\nR1#configure terminal R1(config)#clock timezone EST -5 R1(config)#clock summer-time EDT recurring R1(config)#exit R1#clock set 18:45:26 5 April 2018 R1#show clock\n\nFirst command takes us in global configuration mode.\n\nBy default router uses universal time zone. Second command allows us to localize the time zone. Let’s understand this command in detail.\n\nclock timezone: -\n\nThis is the main command.\n\nEST [Keyword]: -\n\nThis parameter allows us to set a descriptive name for our time zone. Router does not care what name we choose here, it accepts any value and displays that as our time zone. Since router uses this parameter to display the name of time zone, we should always choose the meaningful value here such as keyword which represents our time zone for example EST (US Eastern Standard Time), IST (Indian Standard Time), CST (Central Standard Time), etc.\n\n-5 [Value]: -\n\nThis parameter is what router uses to calculate the time from UTC (Universal Time Coordinated) time. The “-5” value in this field, tells router that our time zone is 5 hour behind from UTC time.\n\nThird command allows us to adjust the “day light saving time”. In this command: -\n\nclock summer-time: -\n\nThis is the main command.\n\nEDT [Keyword]: -\n\nThis parameter allows us to set a descriptive name for “day light saving time”. Just like previous command, router does not care what name we choose here, it will display the chosen value as the name of “day light saving time”. We should choose the name which reflects “day light saving time” in our time zone such as EDT (Eastern Daylight Time).\n\nrecurring [Value]: - Router uses this parameter to take the appropriate action when “day light saving time” occurred. The recurring value tells the router to spring forward an hour and fall back an hour automatically each year.\n\nDST (Daylight Saving Time) is a concept to utilize the natural daylight in better way. In this concept, clocks are forwarded one hour from standard time during the spring and are set one hour back again in autumn. More information about this concept is available here\n\nhttps://en.wikipedia.org/wiki/Daylight_saving_time\n\nThis command is optional. If your company does not use this concept, just skip this command.\n\nFourth command is used to exit from global configuration mode.\n\nFifth command allows us to set the date and time. In this command: -\n\nset clock: -\n\nThis is the main command.\n\n18:45:26 [Time in HH:MM:SS]: -\n\nThis parameter sets time is 24 hours format (hours: Minute: Second).\n\n5 April 2018 [Date in DD:MM:YYYY]: -\n\nThis parameter sets date.\n\nSixth command verifies that date, time and time zone are updated correctly.\n\nFollowing figure shows above commands step by step.\n\nConfigure Loopback interface\n\nAlthough NTP allows us to use any interface for NTP Server reference, but we should always use loopback interface for this purpose. A physical interface can be down due to several reasons, but loopback interface once up, remains up until we manually shut it down. Let’s create a loopback interface in R1\n\nAdd loopback interface’s network in routing\n\nUnless we add loopback interface’s network address in routing table, other devices will not be able to able to connect with it. In our lab, we used RIP routing protocol. To add loopback interface’s network address in routing table, use following commands: -\n\nR1#router rip R1(config-router)#network 100.0.0.0 R1(config-router)#exit\n\nConfigure NTP Server\n\nNTP server configuration is straightforward. It takes only two commands to deploy a router as NTP Server.\n\nRouter(config)#ntp master [stratum level] Router(config)#ntp source [Interface / hostname or IP address of NTP Source]\n\nIn first command stratum level is optional. If we do not specify it, router will use default value. Default stratum level of router’s internal clock is 7.\n\nIn second command, we have to specify the NTP source. We can use any valid NTP source here.\n\nTo use a public NTP server, type its IP address here. In order to use public NTP server,router must be connected with Internet and UDP port 123 must be allowed in firewall.\n\nTo use another NTP server from internal network, type the IP address of that server.\n\nTo use internal clock of this router, use any configured IP address in any interface of this router.\n\nSince in our lab we are using R1’s internal clock as NTP source, we can use the IP address of serial 0/0 interface or can use the IP address of serial 0/1 interface or can use the IP address of loopback interface. The only benefit of using loopback interface’s IP address over physical interface’s IP address is that loopback interface remains always on.\n\nConfigure interfaces to act as NTP Server only\n\nBy default, router works in NTP Server/client mode. In NTP Server/client mode, router advertises and listen NTP broadcast from all active interfaces. If we want to deploy this router as NTP Server only, we have to configure all active interfaces in a way that they only broadcast the NTP message. Luckily this process is also very simple. It requires only following command in each active interface.\n\nRouter(config-if)ntp broadcast\n\nWe have two active interfaces in router R1. Let’s configure them to only broadcast the NTP messages.\n\nNow save running configuration\n\nR1#copy running-config startup-config\n\nThat’s all settings we need in NTP Server only router.\n\nConfigure NTP Server/Client\n\nBy default, routers work in this mode. So no additional configuration is required to deploy a router in this mode. But wait… there is a twist in tail.\n\nBy default in this mode, router uses its own clock as NTP source.\n\nSo if we want to build a hierarchy where this router receives time from other NTP server, we must have to change the NTP source in this router.\n\nFollowing command is used to change the NTP source\n\nRouter(config)#ntp server [NTP Source IP Address]\n\nIn our lab, we are using R1 as main NTP server. In order to deploy router R2 as NTP Server/Client router where it reads time from R1, we have to use following command in R2\n\nR2(config)#ntp server 100.0.0.1\n\nConfigure the NTP server IP address and save the configuration\n\nIf you don’t see the updated time just after the above process, just relax and wait. It does not update immediately. Usually updating process takes 2 to 3 minutes. But once clock is synchronized with server, time will be updated automatically.\n\nConfigure NTP Client only\n\nTo configure a router as NTP client only, we need two commands.\n\nRouter(config)#ntp server [NTP Server IP address] Router(config-if)#ntp broadcast client\n\nAs explained earlier, first command insists router to use NTP server time instead of its own local time and second command configures active interface to listen NTP broadcast message only.\n\nLet’s configure R3 and R4 as NTP clients only. Earlier I explained, we can use any configured IP address from NTP server router to get the NTP updates. To understand it more clearly, this time we will use R2’s serial interface’s IP address to connect with NTP server.\n\nFollowing figure shows step by step commands to configure R3 as NTP client only\n\nFollowing figure shows step by step commands to configure R4 as NTP client only\n\nTesting and troubleshooting NTP setup\n\nFor testing and troubleshooting, NTP offers two show commands; ntp status and ntp associations. Let’s understand these two commands in detail.\n\nshow ntp status command\n\nThis command lists a lot of information. For CCNA we only need to pay attention on first line. First line contains three column; clock status, stratum level and ntp source. Let’s understand these columns in detail.\n\nClock status: -\n\nThis column shows whether the clock is synchronized or not. If you have just configured the router and show clock command is not displaying the updated time, check this column. Updated time will be displayed only when clock is synchronized.\n\nStratum level: -\n\nThis column shows after synchronization where this router’s time stands in reliability scale. If router is not connected with any NTP server or clock is not synchronized with any NTP source, this column will always show value 16. If router is synchronized with any NTP source, this column will display the stratum level of this router in NTP hierarchy. Usually it remains one level down from NTP source unless it is modified manually.\n\nKey points\n\nStratum 0 represents atomic clock and not used in Cisco router\n\nStratum 1-15 are valid levels and used in Cisco router. 1 is the most reliable and 15 is the worst (but still valid) NTP source.\n\nStratum 16 represents a situation where router is either not connected with any NTP source or not synchronized with any NTP server yet.\n\nBy default, after synchronization, router keeps its time one level down from NTP source or server. It allows us to build a proper hierarchy.\n\nDefault stratum level of router’s internal clock is 7.\n\nNTP source: -\n\nThis column shows the source or reference of NTP source from where this time is synchronized.\n\nshow ntp associations\n\nJust like show ntp status command, this command also provides a lot of information. From this information again we only need to focus on first three columns; address, ref clock and st. Let’s understand these columns in detail\n\naddress:-\n\nThis is the address of NTP server from where this router received NTP updates. This column may contains two additional symbols; * and ~. The * show NTP mode in which NTP server is working and ~ shows how NTP is getting time from NTP source.\n\nref clock: -\n\nThis is the NTP source from where NTP server received the time.\n\nst.:-\n\nThis is the stratum level of NTP source.\n\nFollowing figure shows the output of this command from all routers\n\nPractice for you\n\nIn this lab, we connected R1 and R2 with two serial links. Remove any one link. Run show ntp status and show ntp association commands again in all routers to view the difference.\n\nCan you figure out why nothing changed in output?\n\nIf you don’t know the answer, relax and study this tutorial again. Answer of this question is already explained in tutorial. All you need to do is just pay a little bit extra attention while rereading this tutorial.\n\nIf you know the answer, congratulations you have learned NTP concepts and configuration.\n\nThat’s all for this tutorial. If have any query, suggestion or feedback regarding this tutorial, let me know. If you like tutorial, let others know by sharing it."
    }
}