{
    "id": "wrong_mix_domain_subsidiary_00000_1",
    "rank": 69,
    "data": {
        "url": "http://www.daknetworks.com/blog/308-upgrading-polycom-phones-across-entire-location",
        "read_more_link": "",
        "language": "en",
        "title": "Upgrading Polycom Phones Across Entire Location",
        "top_image": "",
        "meta_img": "",
        "images": [
            "http://www.daknetworks.com/templates/daknetworks/images/arrow.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            "keywords go here"
        ],
        "tags": null,
        "authors": [
            "Doug Kruhm"
        ],
        "publish_date": null,
        "summary": "",
        "meta_description": "description goes here",
        "meta_lang": "en",
        "meta_favicon": "",
        "meta_site_name": "",
        "canonical_link": null,
        "text": "[NOTE: please read entire document before proceeding.]\n\nUpgrading all the Polycom phones across an entire location has been a mission. Again, there's so much mis-information and different setups it is hard to weed through it all.\n\nIn short, you need first provision the phones.\n\nSecondly, you need to update the firmware and software. In older Polycom phones, called SoundPoint phones, you need 2 files uploaded to your phone-server for each model of phone-set. The 2 files are:\n\nthe bootrom/bootloader/updater file.\n\nthe sip/uc-software/application (sip.ld) file.\n\nIn newer Polycom phone, called VVX phones, the bootrom/bootloader/updater file is automatically included in the sip/uc-software/application (sip.ld) file.\n\nSTAGE 1: Provision Polycom Phones\n\nPolycom phones can boot with power or POE (hint, use POE). Without a configuration, they won't do anything except complain. Configurations are great because they determine nearly everything on the phone. You can set phone call features, backgrounds and even speakerphone volume. In fact, you can set just about everything.\n\nThe configuration can be kept in one of the following locations:\n\nphone: settings set by the buttons on the phone.\n\nweb: settings set by the web interface.\n\nserver: central server that provides the configuration.\n\nWe are interested in large deployments, so we will focus on central server deployments. This is important because the configuration of the setup is usually more than just the phone server and attention is needed elsewhere. If your phone are getting configurations and you don't see them in the phone set or on the phone server, the the DHCP server is where to look.\n\nCentral server deployments can serve the configuration files through:\n\nFTP\n\nTFTP\n\nHTTP/HTTPS\n\nMost deployments will use FTP since it can be setup everywhere; meaning inside the office and outside the office. On the other hand, TFTP will only be available inside the office.\n\nUpon booting, phones will naturally try to get an IP address from a DHCP server. When they talk to the DHCP server, the server can respond with some options to tell the Polycom phones where to look for the configuration files.\n\nThe options are:\n\nOPTION-066: this is a typical TFTP server option. However, it may already be in use by something else so Polycom had to put in a higher priority option customized just for Polycom phones.\n\nOPTION-160: this is a Polycom specific TFTP server option. Polycom phones are hard-coded to look for this option first. This will have to be added as an option on a MS DHCP server.\n\nTo add the option to MS DHCP:\n\n-start the DHCP server-manager\n\n-right-click IPV4 or IPV6 (on the left-hand side).\n\n-click SET-PREDEFINED-OPTIONS\n\n-click ADD\n\n-type:\n\nNAME: Polycom Boot Server Name\n\nDATA: String\n\nCODE: 160\n\nDESCRIPTION: doesn't-matter\n\nTo add the OPTION-160 to the DHCP scope:\n\n-expand IPV4.\n\n-expand the SCOPE.\n\n-right-click SCOPE-OPTIONS.\n\n-click SERVER-OPTIONS.\n\n-scroll down to 160.\n\n-checkmark 160.\n\n-for STRING-VALUE, type: ftp://PlcmSpIp: This e-mail address is being protected from spambots. You need JavaScript enabled to view it\n\n(replace with your IP phone server address)\n\n-click OK\n\nThis is the secret sauce and test it out before roll-out on large deployments by rebooting just one phone. This will set the value on the phone. If the value is set incorrectly and is unable to find the central-server, the phone will not be able to obtain the configuration files and will use the cached configuration. The only way I know to clear the cache is to login to the web interface:\n\n-click UTILITIES > SOFTWARE-UPGRADE\n\n-click CLEAR-UPGRADE-SERVER\n\nIf that doesn't work, factory default the phone. This can be harder than it sounds.\n\n-hold 1-3-5; type in 456 or type in the macaddress from the bottom of the phone (001122334455)\n\n-press HOME > SETTINGS > ADVANCED > ADMINISTRATOR-SETTINGS > RESET-TO-DEFAULTS > RESET-LOCAL-CONFIG\n\n(wipes macaddress-phone.cfg from server)\n\n-press HOME > SETTINGS > ADVANCED > ADMINISTRATOR-SETTINGS > RESET-TO-DEFAULTS > RESET-WEB-CONFIG\n\n(wipes macaddress-web.cfg from server)\n\n-press HOME > SETTINGS > ADVANCED > ADMINISTRATOR-SETTINGS > RESET-TO-DEFAULTS > RESET-TO-FACTORY\n\n(wipes all configuration containers on the device)\n\n-press HOME > SETTINGS > ADVANCED > ADMINISTRATOR-SETTINGS > RESET-TO-DEFAULTS > FORMAT-FILE-SYSTEM\n\n(wipes app from phone and will require provisioning server to work again)\n\nYou can see if the provisioning worked by looking at the phone:\n\n-press HOME > SETTINGS > STATUS > PLATFORM > CONFIGURATION\n\n-see the boot server, boot type and configuration files.\n\nSTAGE 2: THE BOOTROM/UPLOADER\n\n1-First, download the BOOTLOADER/BOOTROM/UPDATER files here for the SOUNDPOINT phones (the VVX phones have thier BOOTROM/UPDATER included in the sip.ld file):\n\nhttp://downloads.polycom.com/voice/voip/uc/SoundPoint_IP_BootROM_4_4_0_Upgrader_release_sig.zip\n\n(or if you have a SoundStation 6000/7000, you need the B version here:\n\nhttp://downloads.polycom.com/voice/voip/uc/SoundPoint_IP_BootROM_4_4_0B_Upgrader_release_sig.zip)\n\n2-unzip the download and inside the folder you will see the bootloader files like:\n\n2345-12560-001.bootrom.ld\n\n3-Take all the BOOTROM files and upload them to your phone-server (provisioning server) in the tftpboot directory.\n\n(fyi - the tftpboot directory will be at the root of the filesystem: /tftpboot.)\n\nThe chart below will show what bootrom goes with what phone-set model.\n\nFILES DESCRIPTION bootrom.ld Concatenated BootROM 2345-12345-001.bootrom.ld ????? (Probably SoundPoint IP 300/302/320/330) 2345-12360-001.bootrom.ld SoundPoint IP 321 2345-12365-001.bootrom.ld SoundPoint IP 331 2345-12375-001.bootrom.ld SoundPoint IP 335 2345-12450-001.bootrom.ld SoundPoint IP 450 2345-12500-001.bootrom.ld SoundPoint IP 550 2345-12560-001.bootrom.ld SoundPoint IP 560 2345-12600-001.bootrom.ld SoundPoint IP 650 2345-12670-001.bootrom.ld SoundPoint IP 670 2345-17960-001.sip.ld VVX 1500 3111-15600-001.bootrom.ld SoundStation IP 6000 3111-17823-001.dect.ld VVX D60 Wireless Handset & Base Station 3111-19000-001.sip.ld SoundStation Duo 3111-30900-001.bootrom.ld SoundStation IP 5000 3111-33215-001.sip.ld SoundStructure 3111-36150-001.sip.ld SpectraLink 8440 3111-36152-001.sip.ld SpectraLink 8450 3111-36154-001.sip.ld SpectraLink 8452 3111-40000-001.bootrom.ld SoundStation IP 7000 3111-40250-001.sip.ld VVX 101 3111-40450-001.sip.ld VVX 201 3111-44500-001.sip.ld VVX 500 3111-44600-001.sip.ld VVX 600 3111-46135-002.sip.ld VVX 300 3111-46161-001.sip.ld VVX 310 3111-46157-002.sip.ld VVX 400 3111-46162-001.sip.ld VVX 410 3111-48300-001.sip.ld VVX 301 3111-48350-001.sip.ld VVX 311 3111-48400-001.sip.ld VVX 401 3111-48450-001.sip.ld VVX 411 3111-48500-001.sip.ld VVX 501 3111-48600-001.sip.ld VVX 601 3111-48810-001.sip.ld VVX 150 3111-48820-001.sip.ld VVX 250 3111-48830-001.sip.ld VVX 350 3111-48840-001.sip.ld VVX 450\n\nGreat! You are halfway there.\n\nSTAGE 3: THE SIP.LD FILE aka POLYCOM-UC-SOFTWARE aka APPLICATION)\n\nThe SIP.LD file is the image that will be served by the TFTP/FTP central server. This is the same as the APPLICATION VERSION or the SIP APPLICATION VERSION.\n\n1-First, look at the Polycom Matrix for older phones (ie SOUNDPOINT/SOUNDSTATION phones) here:\n\nhttp://downloads.polycom.com/voice/voip/sip_sw_releases_matrix.html\n\nOr the Polycom Matrix for newer phones (ie VVX phones) here:\n\nhttp://downloads.polycom.com/voice/voip/uc_sw_releases_matrix.html\n\n2-Second, download the most recent version of the firmware (get the SPLIT-DOWNLOAD [not combined-download]). There are many options here but they should be boiled down to either \"Current GA for Microsoft Lync\" or \"Current GA Release\"\n\n(Hopefully it's obvious, the MS Lync is for MS Lync servers. If you do not know what that is, don't worry about it as it is not the one you need).\n\n(As of this writing the Current General Availability for SOUNDPOINT phone-sets is v4.0.11).\n\n3-unzip the download and inside the folder, you will see SIP.LD files like:\n\n2345-12560-001.sip.ld\n\n4-Take all the LD files and upload them to your phone-server (provisioning server) in the tftpboot directory. Overwrite any files that are currently there (even if they are from the bootrom zip from above).\n\n[This process is easier than figuring out if we need the files or not. Having everything will not hurt anything.]\n\n5-Once there, rename the file according to your system. Use the guide above as direction. I had to rename the files as such:\n\nsip.SPIP560.4.0.11.revc.ld\n\nsip.VVX410.5.7.0.revc.ld\n\nSTAGE 4: CONFIG FILES\n\n----------From here, there might be some troubleshooting. Namely, some of the old config files may not work with the most recent firmware. Edit the files accordingly in the tftpboot directory.\n\nEach phone will have a MAC-address number on the back. Something like, 0004123EDT78.\n\nSo, each phone will have a base-config file of mac-number.cfg. Something like, 0004123EDT78.cfg\n\nThe phones are hard coded to look for this file.\n\nThe first part of the file will dictate that SIP.LD/APPLICATON file. It will look like this:\n\nAPPLICATION APP_FILE_PATH=\"sip.[PHONE_MODEL].3.2.3.revc.ld\"\n\nWith our directory structure in place, we can have the same model of phones use different APPLICATION versions at the same time. And we can have different models of phones use different APPLICATION versions at the same time. All of this is done by changing the base-config file.\n\nThis file will determine what SIP.LD file to use and what further config files to use. Before the update, the contents will look something like this:\n\n<APPLICATION APP_FILE_PATH=\"sip.[PHONE_MODEL].3.2.3.revc.ld\" CONFIG_FILES=\"deviceset-12345.cfg, phone-0004123EDT78.cfg, sip.3.2.3.revc.cfg\" MISC_FILES=\"0004123EDT78-directory.xml\" LOG_FILE_DIRECTORY=\"\" OVERRIDES_DIRECTORY=\"\" CONTACTS_DIRECTORY=\"\" LICENSE_DIRECTORY=\"\">\n\n</APPLICATION>\n\nAfter the update, you need to edit the file to look something like this:\n\n<APPLICATION APP_FILE_PATH=\"sip.[PHONE_MODEL].4.0.11.revc.ld\" CONFIG_FILES=\"deviceset-12345.cfg, phone-0004123EDT78.cfg, sip.4.0.11.revc.cfg\" MISC_FILES=\"0004123EDT78-directory.xml\" LOG_FILE_DIRECTORY=\"\" OVERRIDES_DIRECTORY=\"\" CONTACTS_DIRECTORY=\"\" LICENSE_DIRECTORY=\"\">\n\n</APPLICATION>\n\nYou can do this file-by-file if needed.\n\nOr you can run one command on the phone-server.\n\n1-make sure you are in the tftpboot directory\n\n2-make a directory for the backup of the files:\n\nmkdir cfgfiles\n\n3-copy all the base config files into this directory:\n\ncp ./000*.cfg ./cfgfiles\n\n(or cp ./6416*.cfg ./cfgfiles)\n\n4-change all the files at once:\n\nsed -i -e \"s/3.2.3.revc.ld/4.0.11.revc.ld/g\" ./000*.cfg\n\nThis will update all the base-config files to tell the phone-sets to use the new SIP.LD/APPLICATION files.\n\nPHONE OVERRIDE FILES\n\nPhone override files are changes made from the phone-set and are named <MAC Address>-phone.cfg. So something like, 0004123EDT78-phone.cfg\n\nOn my phone-server, the older phone override files were named phone-0004123EDT78.cfg\n\nIf they have parameters older than v3.3.0, you will get an error message. To fix, see below in the \"UPDATE CONFIG FILE WITH UTILITY\" section.\n\nWEB OVERRIDE FILES\n\nIf you change something via the phone-set web interface, it will save the settings in a web-override file named <MAC Address>-web.cfg. So something like, 0004123EDT78-web.cfg\n\nSTAGE 5: REBOOT\n\nNow reboot the phone. It should upgrade the bootrom automatically. You do not need to do anything as the phone is hard coded to look for and use the newest bootrom available.\n\nAfter the bootrom is updated, the application/sip.ld will update. This process may take around 10 minutes per phone.\n\nIf you have a POE switch, you can do this across the network by unplugging the POE switch. Wait about 1 minute. Plug the POE switch back in. Then wait about 15 minutes for all the phone to upgrade.\n\n(Of course, wait for after hours time period.)\n\nSTAGE 6: UPDATE CONFIG FILE WITH UTILITY\n\nIf you have an older config file, the Polycom phone-set will give an error. Something like, \"phone-0004123EDT78.cfg is pre-3.3.0 params.\" Basically it is saying that you are trying to config a parameter that doesn't exist.\n\nYou can see what config files are being used and which have errors by:\n\n-press HOME > SETTINGS > STATUS > PLATFORM > CONFIGURATION\n\nscroll down on the phone and it will show the number of PRE-3.3.0, ERRORS, DUPLICATES and OK's.\n\nConsequently, you will have to update your config files to remove those parameters.This can be done parameter-by-parameter by looking at the log file on the phone (or server) and manually adjusting for each.\n\nOr you can do this automatically with a Windows software utility called: CFCUtility. Your results may vary so be careful with the utility.\n\n-download it here:\n\nhttp://support.polycom.com/PolycomService/support/us/support/eula/ucs/UCConfig_agreement.html\n\n-unzip.\n\n-in the CFCUtiliy folder, create a folder called \"config-files\".\n\n-on the central-server, make sure you are in the tftpboot directory.\n\n-make a backup directory:\n\nmkdir cfgphonefiles\n\n-copy all the phone files to this directory (as a backup for safe keeping):\n\ncp ./*cfg ./cfgphonefiles/\n\n-gather all the config-files in the folder called \"config-files\".\n\n(this can be done by mounting usb drive, ftp, scp, etc)\n\n-from a Windows command-line change to the CFCUtiliy folder.\n\n-type: cfcUtility.exe -t ./config-files\n\n-it will ask you some generic questions and accept the defaults.\n\nNow you can transfer the files back to the phone-server in the tftpboot directory.\n\n-reboot the phone(s).\n\n(remember, if you have a POE switch unplug the switch and plug back in for a network-wide solution)\n\n-it will reboot 2 or 3 times on it's own.\n\nUNCOMPLICATING CONFIG FILES\n\nAll the configuration for the phones can be done in one config file if we really wanted to. Or we could have one really long config file for each phone. But for sanity's sake, we break this out.\n\nIn the tftpboot directory, you will have some files for each phone-set:\n\n0004123EDT78.cfg (the base config. The backup is in the cfgfiles directory)\n\n0004123EDT78-phone.cfg (the new phone override, used automatically)\n\n0004123EDT78-web.cfg (the new web override, used automatically)\n\nphone-0004123EDT78.cfg (the old phone override, used by the base-config file. This file is converted and a backup is in the cfgphonefiles directory. It can be deleted since it is not being used.)\n\nOther config files can be present as well (but not required). In the unzip folder of the Polycom UC Software from STAGE-3, you can find the generic config files:\n\napplications.cfg\n\ndect.cfg\n\ndevice.cfg\n\nfeatures.cfg\n\nfirewall-nat.cfg\n\nH323.cfg\n\nlync.cfg\n\npstn.cfg\n\nreg-advanced.cfg\n\nreg-basic.cfg\n\nregion.cfg\n\nsip-basic.cfg\n\nsip-interop.cfg\n\nsite.cfg\n\ntr069.cfg\n\nvideo.cfg\n\nvideo-integration.cfg\n\nEach has it's own place in life. I usually see:\n\n64167f920093-reg-basic.cfg (for the line registration)\n\n64167f920093-features.cfg (for the features of the phone)\n\npolycom.UC5.7.0.sip-basic-11325.cfg (for the line registration of the location)\n\npolycom.UC5.7.0.device-11325.cfg (for device settings for the location)\n\npolycom.UC5.7.0.sip-interop-11325.cfg (for interoffice operation settings)\n\npolycom.UC5.7.0.site-11325.cfg (for site settings like timezone)\n\nYou can see the entire list of options/values by inspecting the 73,000 line file in the unzip download:\n\nPolycom-UC-Software-5-7-0-rts18-release-sig-split\\Config\\polycomConfig.xsd\n\nFOR NEWER FIRMWARE VERSIONS, SINGLE PHONE\n\nFor newer phone-sets with updated firmware versions, simply redirect the provisioning server to: voipt2.polycom.com/<version-number>\n\ngo to phone\n\npress Menu > Settings > Advanced (default password: 456) > Administration Settings > Network Configuration > Provisioning-Server\n\nchange Server Type to HTTP.\n\ntype: voipt2.polycom.com (for Server Address)\n\nExample: to load the latest SIP 4.04 = voipt2.polycom.com/404\n\nExample: to load the latest SIP 4.0.11 = voipt2.polycom.com/4011\n\nreboot the phone-set\n\nwait 15 minutes\n\nonce updated, change the server back to the local provisioning-server\n\nFor a current live directory list go here:\n\nhttp://voipt2.polycom.com/WEBCONTENT/directory.html\n\nNOTES:"
    }
}