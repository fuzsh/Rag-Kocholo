{
    "id": "dbpedia_4812_1",
    "rank": 78,
    "data": {
        "url": "https://forum.netgate.com/topic/158914/acme-with-siteground",
        "read_more_link": "",
        "language": "en",
        "title": "ACME with Siteground",
        "top_image": "https://forum.netgate.com/assets/uploads/profile/315366-profileavatar.jpeg",
        "meta_img": "https://forum.netgate.com/assets/uploads/profile/315366-profileavatar.jpeg",
        "images": [
            "https://forum.netgate.com/assets/uploads/system/site-logo.png?v=797m7udd4uq",
            "https://forum.netgate.com/assets/uploads/profile/315366-profileavatar.jpeg",
            "https://forum.netgate.com/assets/uploads/profile/301-profileavatar.png",
            "https://forum.netgate.com/assets/uploads/profile/301-profileavatar.png",
            "https://forum.netgate.com/assets/uploads/profile/315366-profileavatar.jpeg",
            "https://forum.netgate.com/assets/uploads/profile/315366-profileavatar.jpeg",
            "https://forum.netgate.com/assets/uploads/profile/301-profileavatar.png",
            "https://forum.netgate.com/assets/uploads/profile/301-profileavatar.png",
            "https://forum.netgate.com/assets/uploads/profile/315366-profileavatar.jpeg",
            "https://forum.netgate.com/assets/uploads/profile/315366-profileavatar.jpeg",
            "https://forum.netgate.com/assets/uploads/profile/301-profileavatar.png",
            "https://forum.netgate.com/assets/uploads/profile/301-profileavatar.png",
            "https://forum.netgate.com/assets/uploads/profile/315366-profileavatar.jpeg",
            "https://forum.netgate.com/assets/uploads/profile/315366-profileavatar.jpeg",
            "https://forum.netgate.com/assets/uploads/profile/301-profileavatar.png",
            "https://forum.netgate.com/assets/uploads/profile/301-profileavatar.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            "pfSense",
            "Netgate",
            "TNSR",
            "SCLR",
            "Firewall",
            "Router"
        ],
        "tags": null,
        "authors": [],
        "publish_date": "2020-12-06T04:29:49.403000+00:00",
        "summary": "",
        "meta_description": "I had used DNS-manual method before I realized this was a manual thing that required you to create/download a certificate every three months. Not ideal. So b...",
        "meta_lang": "en",
        "meta_favicon": "/assets/uploads/system/favicon.ico?v=797m7udd4uq",
        "meta_site_name": "Netgate Forum",
        "canonical_link": "https://forum.netgate.com/topic/158914/acme-with-siteground",
        "text": "I had used DNS-manual method before I realized this was a manual thing that required you to create/download a certificate every three months. Not ideal.\n\nSo basically, I have a SOHO firewall appliance (Netgate SG-3100) running the latest version of pfsense (2.4.5-RELEASE-p1 (arm)) and have just updated the ACME package to the latest version (0.6.9_2).\n\nI use SiteGround for my DNS, and am familiar with creating TXT records for verification.\n\nMy problem is, I have no idea what the ideal set-up/configuration is so that ACME will automatically pull down certificates every three months for Let's Encrypt.\n\nI was fiddling with my production certificate (expired) and that timed out (too many failed attempts). So I deleted all of my previous configuration and created a new entry just for STAGING server while I try to figure it out.\n\nObviously, if I want something to work automatically, unattended, DNS-manual is not the way to go.\n\nI looked at method \"DNS-NSupdate / RFC 2136\" but that just throws errors, as I'm likely missing one of the steps. I'm not entirely sure this is the method I want to use.\n\nI don't have a web-site in my SOHO (my actual domain is hosted at SiteGround), so I can't just place a .html verification file, at least I don't think I can with the firewall appliance.\n\nI do have full control over my DNS by signing into SiteGround and using cPanel to go into the Advanced DNS configuration tool.\n\nSo what's the best/ideal way to get my certificates auto-renewing properly?\n\nI feel silly asking, as I have decades of experience with computers, networking, web-sites, SSL...but I'm used to a much longer period of time for certificates (one year at least), and I usually process those manually.\n\nSo, while I love the idea of free certificates through Let's Encrypt, the auto-renewal isn't entirely intuitive when you're using an appliance.\n\nAs an aside, back when I had a CentOS server sitting as a dual-homed firewall and web-server, I was easily able to configure cron/certificates to pull certs (it would check every day), and install them properly. I switched to the Netgate appliance, because I wanted something lower powered, and easier to configure. So far, it's been awesome...but the Let's Encrypt/ACME stuff hasn't been that intuitive. (I realize all of those things are third-party, and free, and you get what you pay for but...I'd like it to kinda \"just work.\")\n\nI don't mind spending time trying to figure it out, but it might be nice if there were specific directions - with examples - for the ideal method, given my configuration.\n\nAny ideas?\n\nOh, and I'm not sure if I mentioned this or not, but basically, the reason why I want to use the Let's Encrypt with my SOHO firewall, is so that I can browse to the URL in any browser, without having to use a site exception.\n\nRight now, I can connect to my site using the IP address, and add an exception for that, but it throws errors, and I don't know how long browsers are going to allow for site exceptions, with the way Chrome is dealing with security these days. I like to be able to browse to my firewall using the DNS name, but it (Firefox/Chrome) definitely isn't having that.\n\nAnyway, hope I've given enough information. Please let me know if I've missed anything that would help.\n\nHi,\n\n@amarand said in ACME with Siteground:\n\nI looked at method \"DNS-NSupdate / RFC 2136\"\n\nYou can't pick the (example) nsupdate method. The chice of method depands complely what your registrar offers you. SiteGround should have manuals/FAQ/etc that inform you how you can access the zone info of your domain. The \"how' here is not the classic GUI access (edit : your cPanel) , but something that's called an API.\n\nDepending on the API, you could choose a acme method from here https://github.com/acmesh-official/acme.sh/tree/master/dnsapi\n\n@amarand said in ACME with Siteground:\n\nthe auto-renewal isn't entirely intuitive\n\nActually, it is.\n\nRead this : https://letsencrypt.org/how-it-works/ and understand also : \"without human intervention\". Not on your side - neither at their side (this means billions of economy).\n\nYou'll - that is : acme -be using the API of your registrar. This enables you to use a script on your side (== acme) to connect to a script on their side (the API).\n\nThe method used depends on how the API is implemented on the registrar's side. Some authentication has to be sued so the API knows it's YOU (== your script).\n\nDNS-NSupdate / RFC 2136 exists because bind, worlds best know domain name DNS server, implemented it. It's probably the oldest method.\n\nBtw : the manual method is a bare bone method that always works always, as it depends only on you having access to the zone info of your domain name using some GUI.\n\nThe issue is that it is : you'll be doing the zone update manually.\n\nLetsencrypt adds to that : every 90 days.\n\nNow : the real question - and I could not find the answer : does SiteGround has some API available ?\n\nI know, using their cPanel stuff, you can obtain a cert. But's that's not what you are looking for.\n\nEdit : example !\n\nTake www.ovh.com : a big europeen registrar / web hoster / datacenter owner / etc etc.\n\nGo to their site : at the bottom you find API - then go to \"Explore the API\".\n\nLook for \"/domain/zone/{zoneName}/record\" - click on it.\n\nNow you see what parameters are needed.\n\nNow, check the method fire : the source : https://github.com/acmesh-official/acme.sh/blob/master/dnsapi/dns_ovh.sh\n\nLine 155 : there you see the method being used.\n\nThe TTL is hard set to 60 seconds.\n\nThe fieldType is also hard coded to TXT, as that is what acme/Letsenscypt uses.\n\nThis method need :\n\nYour domain.tld name\n\nThe subDomain, which will be \"_acme-challenge\"\n\nThe TXT filed will contain a challenge code to be put into the TXT field. This code is give to the acme script by Letsensrypt. For example : 'bmDWOCHFZRtOOCr_vU-mEfTIqA6i9ib0R3V6-RMF3FE'.\n\nWhen the script method actually managed to communicate with the API, after a typical 60 to 360 seconds of delay (to be set in acme by you - don't make it to small ! DNS slaves have to synchronise with the now update zone file on the domain master first) Letsencrypt will check if \"_acme-challeng.your-domain.tld'\" has a TXT record, and if so, if this TXT contains 'bmDWOCHFZRtOOCr_vU-mEfTIqA6i9ib0R3V6-RMF3FE'.\n\nIf that's the case, there is proof that the acme script controls the DNS of the domain name : a cert can be handed over, because \"you\", with a script, proofed you're the owner of the domain.\n\n@amarand said in ACME with Siteground:\n\nI don't understand\n\nTake a mirror, and put yourself in front of it.\n\nNow, ask the guy in the mirror :\n\nDo you want to do this manual procedure every 90 - typically 60 - days ?\n\nIf yes : you're ok, you know what to do.\n\nIf no : automatize it (or have some one else doing it for you). Check the word Automatic here. Automatic does not mean your registrar and/ir web host can obtain certificates for your domain. That will be them using acme to inject certificates in the web server you use. That's for kids, mums, and grand pa.\n\nA real (see this list again) registrar has an API. The API is not only usefull for DNS matters. It could be used to control everything that ius domain/DNS/mail/server/billing related. See the API example I showed.\n\nWhen you go for a domain name, a shared web host / dedicated server / what ever, it's not the price neither the GUI or extranet that control these things. Many of use have many of these services and it becomes impossible to click click click click click.\n\nThat's where these API kicks in.\n\nMost registrars offer an 'API' type access these days, as the click click click click click is just to tedious.\n\nacme.sh has a manual method, as it is perfect to help understand what happens at what moment.\n\nDNS servers have for dedicated method to update the zone records of a domain, just think about the dyndns concept (I presume you know what that is) : it's identical ! Dyndns changes the IP of an 'A' record, that's all it does.\n\nWith acme.sh you're creating TXT records (and after the check is done, they are deleted). This can and should be scripted. That's why Letsencrypot was created in the first place.\n\nSee also https://docs.netgate.com/pfsense/en/latest/packages/acme/settings-validation.html\n\nDyndns : a pfsense article from the past : https://docs.netgate.com/pfsense/en/latest/services/dyndns/rfc2136.html\n\n@amarand said in ACME with Siteground:\n\nif my DNS service provider (SiteGround) is not on the list, .....\n\nI did a search for \"SiteGround DNS API\" and nothing useful came back, so I suspect they don't have one. \"SiteGround\" is not listed as a script in the acme.sh/dnsapi directory you shared.\n\nI was hoping that documents, manuals, and other materials in your possession, as you are a client, would mention the access needed for acme.sh (or certbot, or ..... ). See the LE site for details.\n\nIs there not some users / support forum ? You're never the only one asking the same question ?\n\n@amarand said in ACME with Siteground:\n\nand I've already wasted days trying to figure it out.\n\nDays ?\n\nA mail or ticket tothe support would do.\n\nSomething like :\n\nDo you support : https://letsencrypt.org/about/\n\nThey will confirm that they do .... for their proucts like web servers on hosts, shard hosts etc.\n\nYou want something different : a domain name with an accessible (API) DNS service.\n\nThat's could be something that SiteGround does not offer ....\n\nedit : [The final answer](site:community.letsencrypt.org SiteGround).\n\nNot really an issue as you can take away your domain name, place it with another registrar, and keep the other services that you have at SiteGround.\n\n@amarand said in ACME with Siteground:\n\nAlso, your replies are extremely condescending.\n\nAh ... the mirror I guess.\n\nI fully understand that you do want something better as manually updating.\n\nBut, it's up to you.\n\nAnd you know now - you just wrote it, what needs to be done to make it work.\n\nAgain :\n\nI don't understand why ACME/Let's Encrypt needs an API hook into my DNS/SiteGround/registrar.\n\nwhen you click-through the manual procedure with acme.sh, create your TXT recods etc, a log is created here /tmp/acme/[acme.sh-acountname]/ a log file.\n\nHave a look at that file, and you see what' being done so LE decides to give you a certificate.\n\nIt is a rather complex procedure : if humans have to do this every time, failures can happen quickly.\n\nOne might say : Certificates are \"security\" and complex things. Obtaining one is \"as hard\".\n\nWhy the LE certificates are only valid 90 days is explain : one of the raeasons is : they have to be free of charge.\n\nIt all boils down to : if you want to use LE, you have to script it.\n\nThat's why the pfSense package comes in.\n\nYou'll be needing a domain from a registrar that offers API access - or another type of method that acme.sh accepts.\n\nI didn't meant to be condescending, I just want you to find out the what and especially the why parts. I can't bring you a turn key solution. You can.\n\n@gertjan\n\nGoing back to your original analogy (DynDNS), why can't it be as simple as place a TXT file in the DNS manually, and then all future/subsequent requests go through automatically? With DynDNS, all it has to do is sign in with your credentials, and say \"okay, update my DNS entry with this IP address.\" That uses a username and password scheme. It also can be a boot-time script or a cron job.\n\nThe \"proof\" that I own the domain should be as simple as placing something ONCE in my DNS, and that \"proof\" is valid as long as it's there.\n\nIs that not a feature that Let's Encrypt supports? Is the only way to \"prove\" my domain, to have a SCRIPT place a one-time-use TXT entry via API? Or are there other automated methods?\n\nFor example: with web-sites, you can use PKI (public key/private key) to confirm you are who you are, and, of course, you could put a \"works forever\" key into the DNS as well.\n\nMy concern isn't the scripting part - my concern is that the script \"must\" (?) change a value in my DNS, which isn't something I feel comfortable granting. And even if I did feel comfortable with it, I don't think SiteGround offers a DNS API hook.\n\nSo are there other automated methods (obviously I don't want to be doing anything manual more than once) that will work, if I don't have a DNS API with SiteGround, assuming I don't want to leave my current service provider, as I have a pre-paid contract until 2022?"
    }
}