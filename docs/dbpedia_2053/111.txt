The agency returned Hassan Ghul to Pakistan not long after the CIA closed its remaining secret prisons in eastern Europe in 2006.

The CIA had been given assurances that Ghul, a native of Pakistan, would not go free. But Ghul was let go and he later rejoined al-Qaida, angering the CIA officers who had worked so hard to remove him from the battlefield, according to former and current U.S. intelligence officials.

The Ghul revelation comes at a time when the U.S. is rethinking its relationship with Pakistan and whether it can be a trusted ally in fighting terrorism. Members of Congress have talked about ending aid to Pakistan after bin Laden was found inside Pakistan, hiding out in an urban area not far from a military garrison. Last week, CIA Director Leon Panetta confronted Pakistan’s intelligence service about tipping off militants running bomb factories aimed at killing U.S. troops in Afghanistan.

Ghul’s return to Pakistan frustrated former CIA officers, who at the time believed Ghul should have been moved to Guantanamo Bay along with 14 other high-value detainees such as Abu Zubaydah, a major al-Qaida facilitator, and Khalid Shaikh Mohammed, the self professed mastermind of the 9/11 attacks.

A U.S. official said Pakistan made promises that it would hold Ghul, only to let him go and allow him to re-establish contact with al-Qaida. A senior Pakistani intelligence official said he had no information about Ghul.

The officials spoke on condition of anonymity because details about Ghul’s case remain classified.

Former CIA officials say Ghul was part of Zubaydah’s clandestine network of money men and couriers. He was well-known to the CIA before the 9/11 attacks.

The CIA had been pressing Pakistan to arrest Ghul for years and later learned after 9/11 that he had been hiding at safe houses in the Lahore area belonging to the terrorist group, Lashkar-e-Taiba, which was behind the 2008 attacks in Bombay, India. Bombay is known in India as Mumbai.

But Pakistan’s spy service,the ISI, refused to pick up Ghul.

When the CIA figured out that Ghul was traveling to meet with al-Qaida operatives who had gone to Iraq after the 2003 invasion to fight the U.S., the agency decided to act. In a joint operation with the Kurds, Ghul was nabbed in northern Iraq in January 2004, former CIA officials said. Pakistan was furious when it learned the CIA had Ghul and pressed the U.S. to return him.

Instead, Ghul was taken to Bagram Air Base in Afghanistan but was later removed over questions about whether the transfer was legal, former CIA officials said. Ghul thenwas taken to a CIA “black site” - a secret prison - in eastern Europe and provided crucial information about bin Laden’s most trusted courier before he was exposed to harsh interrogation techniques. Ghul’s information later allowed the CIA to realize that finding the courier probably would lead to bin Laden.

Ghul also provided key information about the whereabouts of terrorists in Pakistan’s lawless tribal areas, the officials said. He provided other precise information as well.

“He was very useful,” a former CIA officer said.

Former CIA officials said that in the rush to close the secret prisons, the U.S. was looking for ways to get rid of some of the remaining two dozen or so detainees in the agency’s now-defunct interrogation and detention program. With Pakistan offering to take Ghul, U.S. officials figured they could also build some good will by giving him back, and the CIA had the ISI’s pledge that he wouldn’t go free.

It’s not clear why Pakistan wanted Ghul back so badly, but former CIA officers who targeted Ghul said he had ties to the Lashkar-e-Taiba terror group, which had the backing of the ISI.

Information for this article was contributed by Kathy Gannon of The Associated Press.