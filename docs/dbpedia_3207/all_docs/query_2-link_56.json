{
    "id": "dbpedia_3207_2",
    "rank": 56,
    "data": {
        "url": "https://stackoverflow.com/questions/5402381/receiving-login-prompt-using-integrated-windows-authentication",
        "read_more_link": "",
        "language": "en",
        "title": "Receiving login prompt using integrated windows authentication",
        "top_image": "https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded",
        "meta_img": "https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded",
        "images": [
            "https://www.gravatar.com/avatar/a9130dd2b5d15cdb0188a045db5b06f7?s=64&d=identicon&r=PG",
            "https://i.sstatic.net/zxtO0.jpg",
            "https://i.sstatic.net/sLmIJ.jpg",
            "https://i.sstatic.net/6iNSr.jpg",
            "https://i.sstatic.net/Z2O1c.jpg",
            "https://i.sstatic.net/m5eDV.jpg",
            "https://i.sstatic.net/J9kqz.jpg",
            "https://www.gravatar.com/avatar/b924bc0147903cbd7a4506d7d26ab328?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/2aae72c4b5ad8969b0b0bdf1ada895d0?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/1ae9b6f1281acb7067114c928c94448c?s=64&d=identicon&r=PG&f=y&so-version=2",
            "https://www.gravatar.com/avatar/ff9a366a07cf149b62aa43eea92d57c0?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/3f2491af9df41b0fdd5a359b6260dba0?s=64&d=identicon&r=PG",
            "https://i.sstatic.net/CzvPq.png",
            "https://i.sstatic.net/PUs5X.png",
            "https://i.sstatic.net/sN2df.png",
            "https://i.sstatic.net/Yq4Vu.png",
            "https://www.gravatar.com/avatar/e01f4ab4fa4ede8a7a23fe91ba902337?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/c218f42e9765c37897ed49c918435ed2?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/088fd28beb2be70156e761fbafbde968?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/6e0cf2313a308c2396b3794f1f4b1fbe?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/4c6dac7c864bf14305b214fea856a976?s=64&d=identicon&r=PG",
            "https://i.sstatic.net/LIKHb.png",
            "https://i.sstatic.net/rMWK2.png",
            "https://www.gravatar.com/avatar/9922dc136a85af3dfdbcde26a62c620a?s=64&d=identicon&r=PG",
            "https://i.sstatic.net/TpVPR.png",
            "https://www.gravatar.com/avatar/1768efe5a72335dc663d0a947093520d?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/42dab934a52d39799cde27aec807c07f?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/1cbdac51ebc37bc1be3a7a9f4374c52d?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/ce0afb63d022acf3f0c8ae7790da027b?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/723a66dfcc40b7fa1efa8f40b34e84a5?s=64&d=identicon&r=PG&f=y&so-version=2",
            "https://www.gravatar.com/avatar/3e27678f541bcfcbeeb6cb75f432b0b5?s=64&d=identicon&r=PG",
            "https://i.sstatic.net/jnFyc.png",
            "https://www.gravatar.com/avatar/64839d31baaefafa58120e1a5a503d66?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/ba94bcd2ed2bef9f8762a7d72630cbb8?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/ed6968bbc4cd6b665656a551f3951537?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/1a351fc08c93698927e8d145497f0f2f?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/6a099856042e0a129e651d4ba36b430e?s=64&d=identicon&r=PG&f=y&so-version=2",
            "https://i.sstatic.net/1pKHv.jpg?s=64",
            "https://graph.facebook.com/736232822/picture?type=large",
            "https://i.sstatic.net/eln2A.jpg",
            "https://www.gravatar.com/avatar/3f4cc42e252d3ca82fb0c6ae0e3baf54?s=64&d=identicon&r=PG",
            "https://stackoverflow.com/posts/5402381/ivc/9e88?prg=14274969-174c-4218-bfe6-b13aa633547b"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": "2011-03-23T08:08:47",
        "summary": "",
        "meta_description": "I have a .NET 3.5 application running under IIS 7 on Windows 2003 server and cannot get integrated windows authentication working properly as I continue to get prompted for a login. I have set Wind...",
        "meta_lang": "en",
        "meta_favicon": "https://cdn.sstatic.net/Sites/stackoverflow/Img/favicon.ico?v=ec617d715196",
        "meta_site_name": "Stack Overflow",
        "canonical_link": "https://stackoverflow.com/questions/5402381/receiving-login-prompt-using-integrated-windows-authentication",
        "text": "I have a .NET 3.5 application running under IIS 7 on Windows 2003 server and cannot get integrated windows authentication working properly as I continue to get prompted for a login. I have set Windows Authentication to enabled in IIS with all other security types disabled and my application web.config file authentication/authorization is set up as:\n\n<system.web> <compilation debug=\"true\" strict=\"false\" explicit=\"true\" targetFramework=\"3.5\" /> <authenticationmode=\"Windows\"/> <authorization> <deny users = \"?\" /> </authorization> </system.web>\n\nWith this setup, I'm expecting behind the scene verification of the Windows user to allow access and deny anonymous users. However, what I'm getting is a Windows login pop-up when I try to access the site.\n\nI have been troubleshooting this issue for a few days now and cannot figure out the problem. Based on posts with similar problems, I confirmed my URL does not include any periods, double checked that my IE settings are set to Enable Integrated Windows Authentication, and also added my URL to my intranet sites, but still getting the pop-up.\n\nTo troubleshoot it further, I enabled Anonymous Authentication in IIS and modified my web.config file to which lets me right in and then added Response.Write(System.Security.Principal.WindowsIdentifity.getcurrent().user.name.toString()) to try to see what user is being used in the authentication. The result I'm getting is IIS APPPOOL\\myapp which is obviously the IIS application pool for my application.\n\nI really appreciate any help anyone can provide so that I'm still using only windows authentication but don't get the pop-up and the windows authentication is performed against the actual Windows user.\n\nThanks.\n\nAdditional note after troubleshooting further:\n\nJust noticed that when the login fails and the Windows login prompt displays again, it is showing the username that attempted to login as \"SERVERNAME\"\\\"USERNAME\" which led me to believe it was trying to validate the user against the server vs. the domain. To confirm this, I created a local user account directly on the app server with the same username and password as the network domain user and tried to login again. The result was that I received the login prompt again but when I entered the username and password this time, I was able to successfully login. The network user and app server are on the same domain so really not sure why IIS authentication is pointing to the local app server accounts and not to the domain accounts. I realize this is an IIS question at this point so posting on forums.iis.net as well but appreciate any advice anyone may have since have been troubleshooting this for days.\n\nWindowsIdentity.GetCurrent is correct: you should get the APPPOOL user. This is because the ASP.NET process, which is executing your code, is the current identity. If you want it to return the user hitting the site's identity, you'll need to add the following line in your web.config:\n\n<identity impersonate=\"true\" />\n\nThis causes the process to assume the identity of the user requesting the page. All actions will be performed on their behalf, so any attempts to read folders on the network or access database resources and the like will mean the current user will need permissions to those things. You can read more about impersonation here. Note that depending on how your web/database server topology is set up, you may run into delegation issues with impersonation turned on.\n\nBut your original issue is that it appears the identity cannot be determined and you're getting a login popup. I'll note that you do not need the <deny> block if you have disabled anonymous authentication in IIS. We never include it (except in special <location> blocks and such) so I would say you might try removing it and trying again. Everything else sounds right, though.\n\nYou didn't specify what user is running the application pool in IIS. Is it a custom account or is it the default one? If it is custom, is it a domain account or a local account on the web server? Custom accounts can sometimes require a few more steps, such as registering a SPN. Also, it may be a problem with the custom account not having permission in AD for resolving the incoming user's account.\n\nYou might also check the IIS logs to see what response is being returned. It'll most likely be a 401, but it should have a sub number after it like 401.2 or something. That sub-number can sometimes help determine the root problem. This KB article lists five.\n\nanswered Nov 28, 2011 at 18:13\n\nSean HanleySean Hanley\n\n5,70777 gold badges4343 silver badges5454 bronze badges"
    }
}