{
    "id": "dbpedia_4245_3",
    "rank": 38,
    "data": {
        "url": "https://www.mdpi.com/1424-8220/24/8/2578",
        "read_more_link": "",
        "language": "en",
        "title": "A Method to Correct the Temporal Drift of Single-Photon Detectors Based on Asynchronous Quantum Ghost Imaging",
        "top_image": "https://pub.mdpi-res.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g001-550.jpg?1713419309",
        "meta_img": "https://pub.mdpi-res.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g001-550.jpg?1713419309",
        "images": [
            "https://pub.mdpi-res.com/img/design/mdpi-pub-logo-black-small1.svg?da3a8dcae975a41c?1724334283",
            "https://pub.mdpi-res.com/img/design/mdpi-pub-logo-black-small1.svg?da3a8dcae975a41c?1724334283",
            "https://pub.mdpi-res.com/img/journals/sensors-logo.png?8600e93ff98dbf14",
            "https://www.mdpi.com/bundles/mdpisciprofileslink/img/unknown-user.png",
            "https://www.mdpi.com/bundles/mdpisciprofileslink/img/unknown-user.png",
            "https://www.mdpi.com/bundles/mdpisciprofileslink/img/unknown-user.png",
            "https://pub.mdpi-res.com/img/design/orcid.png?0465bc3812adeb52?1724334283",
            "https://www.mdpi.com/bundles/mdpisciprofileslink/img/unknown-user.png",
            "https://www.mdpi.com/bundles/mdpisciprofileslink/img/unknown-user.png",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g001-550.jpg",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g001.png",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g002-550.jpg",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g002.png",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g003-550.jpg",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g003.png",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g004-550.jpg",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g004.png",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g005-550.jpg",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g005.png",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g006-550.jpg",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g006.png",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g007-550.jpg",
            "https://www.mdpi.com/sensors/sensors-24-02578/article_deploy/html/images/sensors-24-02578-g007.png",
            "https://pub.mdpi-res.com/img/design/mdpi-pub-logo-white-small.png?71d18e5f805839ab?1724334283"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "Carsten Pitsch",
            "Dominik Walter",
            "Leonardo Gasparini",
            "Helge Bürsing",
            "Marc Eichhorn"
        ],
        "publish_date": "2024-04-18T00:00:00",
        "summary": "",
        "meta_description": "Single-photon detection and timing has attracted increasing interest in recent years due to their necessity in the field of quantum sensing and the advantages of single-quanta detection in the field of low-level light imaging. While simple bucket detectors are mature enough for commercial applications, more complex imaging detectors are still a field of research comprising mostly prototype-level detectors. A major problem in these detectors is the implementation of in-pixel timing circuitry, especially for two-dimensional imagers. One of the most promising approaches is the use of voltage-controlled ring resonators in every pixel. Each of these runs independently based on a voltage supplied by a global reference. However, this yields the problem that the supply voltage can change across the chip which, in turn, changes the period of the ring resonator. Due to additional parasitic effects, this problem can worsen with increasing measurement time, leading to drift in the timing information. We present here a method to identify and correct such temporal drifts in single-photon detectors based on asynchronous quantum ghost imaging. We also show the effect of this correction on recent quantum ghost imaging (QGI) measurement from our group.",
        "meta_lang": "en",
        "meta_favicon": "https://pub.mdpi-res.com/img/mask-icon-128.svg?c1c7eca266cd7013?1724334283",
        "meta_site_name": "MDPI",
        "canonical_link": "https://www.mdpi.com/1424-8220/24/8/2578",
        "text": "by\n\nCarsten Pitsch\n\n1,* ,\n\nDominik Walter\n\n1,\n\nLeonardo Gasparini\n\n2 ,\n\nHelge Bürsing\n\n1 and\n\nMarc Eichhorn\n\n1,3\n\n1\n\nFraunhofer Institute of Optronics, System Technologies and Image Exploitation (IOSB), Gutleuthausstr. 1, 76275 Ettlingen, Germany\n\n2\n\nFondazione Bruno Kessler, Center for Sensors & Devices, Integrated Readout ASICs & Image Sensors, Via Sommarive 18-Povo, 38123 Trento, Italy\n\n3\n\nInstitute of Control Systems (IRS), Karlsruhe Institute of Technology, Fritz-Haber-Weg 1, 76131 Karlsruhe, Germany\n\n*\n\nAuthor to whom correspondence should be addressed.\n\nSensors 2024, 24(8), 2578; https://doi.org/10.3390/s24082578\n\nSubmission received: 22 February 2024 / Revised: 15 April 2024 / Accepted: 16 April 2024 / Published: 18 April 2024\n\n(This article belongs to the Section Optical Sensors)\n\nAbstract\n\n:\n\nSingle-photon detection and timing has attracted increasing interest in recent years due to their necessity in the field of quantum sensing and the advantages of single-quanta detection in the field of low-level light imaging. While simple bucket detectors are mature enough for commercial applications, more complex imaging detectors are still a field of research comprising mostly prototype-level detectors. A major problem in these detectors is the implementation of in-pixel timing circuitry, especially for two-dimensional imagers. One of the most promising approaches is the use of voltage-controlled ring resonators in every pixel. Each of these runs independently based on a voltage supplied by a global reference. However, this yields the problem that the supply voltage can change across the chip which, in turn, changes the period of the ring resonator. Due to additional parasitic effects, this problem can worsen with increasing measurement time, leading to drift in the timing information. We present here a method to identify and correct such temporal drifts in single-photon detectors based on asynchronous quantum ghost imaging. We also show the effect of this correction on recent quantum ghost imaging (QGI) measurement from our group.\n\n1. Introduction\n\nSingle-photon detectors have advanced significantly in recent years due to their necessity in both low-level-light and quantum applications. Current single-photon avalanche diode (SPAD) cameras, based on photon counting, already achieve resolutions in the megapixel regime. However, for many applications, such as ToF-LiDAR [1,2,3,4,5,6], fluorescence lifetime imaging (FLIM) [7,8,9,10], biophotonics [11,12,13,14], and quantum sensing [15,16].\n\nTo realize such detectors, SPAD cameras can be outfitted with dedicated timing circuitry in each pixel/group of pixels. These circuits, called time-to-digital converters (TDCs), allow for the registration of the time-of-arrival (ToA) of a single photon per TDC and frame, typically with a resolution of 10 s to 100 s of ps [17,18]. They can be realized in a variety of designs [19,20] and usually return the ToA as an 8 to 12 bit value referenced to the end of the measurement frame. While each design has its dedicated issues, keeping the timing information consistent is a challenge for each.\n\nFor 2D detectors, TDC design proves especially challenging as they have to be integrated into the pixel. Commonly used delay-line TDCs [19], which are based on oversampling a global clock signal, are usually very large compared to the size of the SPAD and lead to a highly reduced detector fill factor. One option to reduce TDC size is to use independent TDCs, i.e., a design based on a ring resonator architecture controlled by a common supply voltage. Such structures are, of course, susceptible to instabilities in the supply voltage, leading to a change in the timing period represented by the TDC value. This can prove to be a major limitation as it usually leads to either jitter in the recording or falsified information, i.e., in ToF-LiDAR applications.\n\nThis problem is well known, and different experimental setups have been used in the past to identify and address such nonlinearities of TDCs, using experimental measurement techniques [7,21], hardware design [22], or post-processing techniques [23,24]. Using these techniques, the drift in timing information can be calibrated, depending on the nonlinear effects experienced by the TDC.\n\nIn this work, we demonstrate a method to experimentally determine the nonlinearities of pixel-level-TDCs by using an asynchronous quantum ghost imaging scheme first demonstrated in [16]. Using this setup, we were able to analyze and correct the temporal drift of a 2D SPAD array used which was outfitted with ring resonator-based TDCs in every pixel. This allowed for single-photon detection with a ~210 ps temporal resolution [25] while maintaining a high fill factor. The single-pixel TDC layout led to a direct, pixel-dependent correction of the timing information. As the detector only returns the TDC value directly, the dependence of the information on this parameter was the only influence we were able to investigate.\n\nHowever, neither the nonlinearities nor the correction routine are bound to this hardware. Thus, this correction routine can also be applied to a number of different temporally resolving single-photon detectors. In other TDC architectures, other parameters might be given, i.e., START and STOP bits. The method also allows one to investigate dependencies on these parameters, if they are given (see for example [26]). It is only bound by the deterministic nature of the influence/parameter under investigation and fundamentally limited by the cumulated jitter of the SPAD detector [27], the quenching circuit, and the TDC [23].\n\n2. Sources of Temporal Drift\n\nMultiple architectures exist for the in-pixel timestamping of circuits in time-resolved, single-photon image sensors, including analog [28] and digital [29,30] implementations. The latter ones are typically based on ring oscillators and can be divided into two main groups: one based on a global ring, whose phases are distributed across the entire array [31,32], and one with replicas of a ring oscillator in every pixel [33]. With a local ring, power consumption is optimized thanks to the reversed start–stop operation. This way, only pixels that detect a photon (typically a small fraction of the entire array) draw current from the supply, while area compactness is achieved using a small technology node [22], or by sacrificing some resolution [25,34].\n\nIn theory, photons detected at the same time in different pixels of the detector should return the same timestamp. In reality, the timing information from different pixels will exhibit (usually small) variations from non-idealities, resulting in (slightly) different timing information for every pixel/TDC. Many effects can influence this mismatch, such as jitter, a drop in supply voltage due to the large power consumption of the TDCs (Figure 1), mismatches in the fabrication of the timestamping channels, and skew in the distribution of the common reference signal(s) (Figure 2). While jitter is a random process which can only be analyzed statistically, the influence of the other parameters can be deterministic and can therefore be addressed in the detector’s design or its post-processing.\n\nThe power distribution network affects the uniformity of the oscillators due to the voltage drop that occurs when the ring oscillators of the TDC are running. This drop is caused by the current I, which flows in the metal connections of the TDC with a non-zero resistance R. Thus, it is also referred to as an “IR drop”. Figure 1 shows a pictorial representation of the power distribution network of a SPAD imager and the associated IR drop. Typically, a ring of power supply (VDD) and ground (GND) pairs surround the pixel array, distributed horizontally and/or vertically to all pixels to avoid routing them over the active area.\n\nEach pixel contributes to the resistive and capacitive load according to the employed technology, the metal layers used, and the design layout. This increases the voltage drop further down the line, reducing the supply voltage and/or increasing the ground-level voltage the TDC is operated with. This effect is inversely proportional to the length of the transmission line and thus more intense toward the center of the array. The effects can be mitigated by using a regulating transistor for the VDD, but grows worse with an increasing number of TDCs running in parallel. Thus, it poses a limit on the maximum number of detectable photons per observation window.\n\nThe manufacturing process causes small differences between the transistor layout and the fabricated counterpart, which introduce ring-to-ring mismatches in the frequency of the oscillation and non-linearities in the TDC transfer function. These can be mitigated in the design phase (i.e., by using a non-minimum transistor size) and calibrated in post-processing since the behavior of a specific TDC is determined during fabrication and remains unchanged during operation.\n\nAnother source of non-ideality is the distribution of the reference timing signal which, despite being a global signal, is routed from the periphery to the array. This leads to a delay between pixels, also known as skew (see Figure 2). It can be analyzed by modeling the distribution of the control signal as a transmission line consisting of the resistive and capacitive load of each pixel. The resistance in this model is caused by the metal connections themselves, while the capacitance includes the parasitic effects of the gates and the metal-to-metal/metal-to-substrate connections. These parasitic effects lead to a variation in the control signal, smearing its edges toward later pixels. As the receiver logic is based on edge detection, this leads to a shift in the detection of the control signal, as depicted in Figure 2.\n\nTo mitigate this, the overall resistance–capacitance (RC) needs to be minimized. While the capacitance C is typically dominated by the transistor gates and thus cannot be reduced significantly, the resistance R is determined by the width of the metal connections. However, these connections cannot be made arbitrarily wide as they also impact detector performance. In order to achieve a high fill factor and a small pixel pitch, which are required for scalability to large arrays, the lines should be as narrow as possible. Considering both effects in the design phase leads to an optimum width of the connections depending on the design of the array and the envisioned application.\n\nThe skew can be further reduced by properly designing the architecture of the driving logic, as shown in Figure 3. Even for small array sizes (meaning low numbers of TDCs), a single buffer cannot provide enough driving power. Thus, the most simple configuration includes a two-level buffer configuration in which a main buffer drives a set of row-level buffers. In this case, the skew shows a vertical gradient due to the distribution of signal from the main buffer to the row buffers and a horizontal gradient due to the row buffers driving the pixels.\n\nThe vertical gradient can be strongly mitigated by using a buffer tree to distribute the signal to the row buffers at the cost of higher complexity and increased power consumption. If the horizontal skew is still too large, the driver can be duplicated on the opposite side of the array so that each driver serves half of the pixels. Alternatively, the tree configuration can be extended inside the pixel array. In this way, the row buffers drive a sub-set of the pixels in each row, and the pixels regenerate the signal and redistribute it locally.\n\n3. Correction Approach\n\nIn order to measure the temporal drift of the detector under investigation, we exploit the temporal correlation of photon pairs created by spontaneous parametric down-conversion (SPDC) arising from their simultaneous creation [35]. This correlation is usually used in quantum applications, like quantum ghost imaging [15,36], in order to identify photons pairs by so-called coincidence detection.\n\nIn our approach, we use a novel setup for quantum ghost imaging (QGI) based on asynchronous detection [16]. This setup allows us to project the detections of two remote detectors in the same time base, which, in turn, allows us to reference their detections to each other. In contrast to QGI, we do not use the spatial correlation of photons to perform imaging but solely the temporal correlation of photons to obtain a timing reference for the detections of the SPAD array. This allows for an investigation of the timing characteristics of a SPAD array by a coincidence analysis.\n\nWe are further able to store all relevant data returned by the array for every detection, which allows us to filter the measurement data by specific parameters and investigate their effects on the temporal information of the coincidence analysis. This allows for a detailed analysis of every parameter and parameter combination of the detections of the SPAD camera, allowing us to investigate any deterministic dependency.\n\n3.1. Measurement System\n\nThe measurement system is an adapted version of the QGI system described in [16] and shown in Figure 4. The data of the measurements presented in [16] are also used in Section 4 to show the improvement in coincidence detection by correcting the camera’s timing.\n\nAs a photon pair source, a 2 mm long, periodically poled potassium titanyl phosphate (KTP) crystal, which is pumped by a 405 nm laser, is used. The crystal’s poling period of 4.25 µm allows for collinear phase matching for non-degenerate photon pairs at 550 nm (signal) and 1550 nm (idler), allowing for the use of readily available, low-jitter infrared SPADs as a timing reference (ID230, [37]). For synchronization, a high-resolution single-photon counting (TCSPC) board (TimeHarp 260 PICO, [38]) is connected to both detectors to enable timestamping every detection with ps resolution.\n\nThe optical system is optimized such that the signal emission is distributed over the entire array and the idler emission is optimized for incoupling into the fiber-bound idler detector. This way, coincidence detection is enabled over the whole aperture of the array, which is verified by a preliminary QGI measurement. In particular, due to the fiber-coupling of the idler detector, the assumption of coincidence detection over the whole array is not appropriate from the distribution of the signal emission over the aperture alone is not appropriate.\n\nTo ensure the reproducibility of results, more than one measurement should be performed, with their relevant data being compounded for further analysis. Since the amount of processible data is currently limited by the RAM of the system, and significantly more data must be recorded for evaluation, this was already ensured by the automatic restarting of the measurement after a given time interval.\n\n3.2. Drift Determination\n\nBy comparing the timestamps of both signal and idler detections, a coincidence analysis is enabled. This analysis can be filtered by each parameter individually or specific parameter combinations. In particular, it allows one to filter the detections by both pixel position and the detected ToA given by the TDC value, as shown in Figure 5.\n\nThis allows one to analyze differences in both the temporal base resolution of each pixel’s TDC (resulting in “linear drift”) and its behavior over the measurement time (resulting in “nonlinear drift”, see Figure 5). In the case that more information is provided (e.g., START/STOP codes for fine resolution, as in [26]), the influence of these parameters can also be analyzed.\n\nAs the uncertainty values in the correlation of the photons and the timing jitter of the reference detector (~150 ps) are smaller than the resolution of the detector under investigation (~210 ps resolution), the coincidence evaluation allows us to determine any influence of the available parameters on the temporal behavior of the detection. It allows this analysis not just in terms of drift in the timing information, but also e.g., in timing jitter by the investigation of the peak broadening. For such an analysis, however, the jitter of the reference detector should be decreased further to reduce its influence.\n\n4. Results\n\nIn order to test the approach and validate the improvement, we performed the correction on recently published measurements detailed in [16]. The resulting coincidence peaks and improvements are shown in Figure 6 and Figure 7.\n\nTo do so, we built the measurement setup shown in Figure 4, operated it with a 20 mW pulsed laser as pump, and investigated the detector used in [16]. In order to obtain enough data for a detailed analysis, we performed continuous measurements over 4 days. Due to limitations in the processible amount of data, individual measurements were limited to 2 h and then automatically restarted.\n\nFor further processing, each of the measurements was evaluated individually, filtered by pixels. This isolated the individual TDCs associated with each pixel, which showed individual timing drifts (see Section 2). The temporal behavior of the TDCs was then analyzed by filtering each pixel’s data, this time by the value of the TDC itself (corresponding to the ToA of the photon). To ensure enough data yield for a meaningful analysis, the TDCs (8 bit = 256 values) were grouped into 16 groups with 16 TDC values each. The processed data were then stored and compounded with all other measurements for further analysis.\n\nIn order to allow for the evaluation of the complete set of measurements, the data of the coincidence evaluation had to be reduced. To do so, a 5 ns wide coincidence window was defined around the peak determined by the preliminary QGI measurement used for calibration (see Section 3.1). This window was split into sections 100 ps large for which a histogram analysis of the coincidence counts was performed. The results where then saved as a (32 × 32 × 16 × 50) array (Row × Column × TDC group × Coincidence window), allowing us to simply add up the coincidence counts of each measurement, increasing the amount of data and thus the validity of the drift estimation.\n\nThe evolution of the coincidence peak over the TDC value is exemplary, as shown in Figure 5a for a single pixel and selected TDC values. With the data shown, the coincidence peak is analyzed by fitting a normal Gaussian distribution to the coincidence distribution. The mean of this fit is then used to determine the drift of each pixel’s timing information, as shown exemplarily in Figure 5b for selected pixels.\n\nDue to the detector’s architecture (see [25]), the highest TDC values (~above 200) are unlikely to occur, resulting in too few data for valid analysis. To avoid problems, the TDC groups were filtered by the amount of overall data before they were considered for the estimation of the temporal drift. Thus, the evaluation shown in Figure 5b shows different limits on its x scale, none of which are above a TDC value of 200.\n\nThe drift was estimated by fitting a polynomial function of the second order to the data obtained and projecting said estimation to all possible TDC values (256 values). In an initial correction approach, the parameters of the fit were passed to the evaluation code of the original dataset of [16], calculating the offset for each detection. However, this approach highly increased the runtime of the code for the coincidence evaluation and thus was not fit for usage. Instead, the offset of the coincidence peak (mean) to a global reference value was calculated for every possible TDC value. With these values, a lookup table was created. For every detection, we then added the dedicated lookup value (determined by the pixel number and TDC value) to our detection time, thus eliminating the drift.\n\nApplying this correction to the measurement of [16], the coincidence peak could be improved from a full width of about 2 ns (FWHM: 700 ps) with a linear correction to about 700 ps (FWHM: 300 ps), as shown in Figure 6. This peak width already comes close to the resolution of the detector’s TDCs of ~210 ps [25]. We presume this peak width is currently also limited by the resolution of the reference detector in the idler, which shows a jitter of ~150 ps [37], and the TDC resolution used for the correction (groups of 16 values). It should be mentioned that the linear correction in [16] was already refined using coincidence data. The drift correction, however, was based on a coarse linear correction detailed in [25]. The coincidence peak achieved with this coarse correction is shown in Figure 7 for the free space measurement of [16], resulting in a peak width of about 3 ns and significant “tail”. Both the peak width and tail could be highly improved using the proposed correction/calibration method.\n\n5. Outlook\n\nWe have shown here a method to accurately determine the temporal behavior of single-photon cameras, exploiting the temporal correlation of photon pairs created by SPDC.\n\nThe correction of this temporal drift allowed us to increase the temporal resolution of the coincidence analysis of a recent asynchronous QGI measurement by a factor of ~3. The achieved resolution of a ~700 ps full peak width is already close to the base resolution of the detector under investigation (~210 ps) and the reference detector used (~150 ps). It might be improved further by a more detailed analysis of TDC dependence, especially by increasing the resolution of the drift determination, optimally by analyzing each individual TDC value instead of groups of 16 values. For this analysis to be valid, however, more data should be acquired.\n\nAnother improvement would be the use of a more precise bucket detector, i.e., a super-conducting nanowire single-photon detector (SNSPD). Using a low-jitter silicon detector as a bucket might also be an option, but for most SPAD imagers, the wavelength of the signal photons should be kept in the 550 nm regime due to the detection efficiency of the pixels. The realization of SPDC with this signal wavelength and an idler wavelength in the silicon detection range does lead to problems regarding the photon-pair source. Due to energy conservation, a UV laser would need to be used, leading to problems regarding the degradation of the nonlinear crystal.\n\nHowever, the system is not limited by the use of SPDC but only the fundamental temporal correlation of the photons. Thus, any source of time-correlated photon states (i.e., also four-wave mixing) could be used. The correlation must only be verified to be more exact than the resolution of the detectors.\n\nCompared to other experimental calibration techniques, like temporally shifted lasers [7], this method allows for the calibration of every pixel’s TDC with potentially lower uncertainty. As for a laser-based scheme, the emission and detection usually underly Poissonian photon statistics, reducing the achievable timing resolution of the analysis.\n\nFor a good correction, fast switching and relatively powerful lasers would typically be needed to reduce this effect. The resulting flood illumination can, however, impact detector performance, especially the timing properties under investigation, leading, e.g., to voltage instabilities in the TDCs. This would, in turn, falsify the temporal information and correction for key low-level light applications.\n\nOur approach, however, works with illumination levels similar to other quantum and low-level-light applications, which ensures the same detection characteristics.\n\nAuthor Contributions\n\nConceptualization, C.P. and D.W.; methodology, C.P. and D.W.; software, C.P., D.W. and L.G.; validation, C.P. and D.W.; formal analysis, C.P.; investigation, C.P. and D.W.; writing—original draft preparation, C.P. and L.G.; writing—review and editing, D.W.; visualization, C.P. and L.G.; supervision, H.B. and M.E.; project administration, H.B.; funding acquisition, H.B. and M.E. All authors have read and agreed to the published version of the manuscript.\n\nFunding\n\nThis research received no external funding.\n\nInformed Consent Statement\n\nNot applicable.\n\nData Availability Statement\n\nData are contained within the article.\n\nConflicts of Interest\n\nThe authors declare no conflict of interest.\n\nReferences\n\nGyongy, I.; Dutton, N.A.W.; Henderson, R.K. Direct Time-of-Flight Single-Photon Imaging. IEEE Trans. Electron. Devices 2022, 69, 2794–2805. [Google Scholar] [CrossRef]\n\nJahromi, S.; Jansson, J.-P.; Keranen, P.; Kostamovaara, J. A 32 × 128 SPAD-257 TDC Receiver IC for Pulsed TOF Solid-State 3-D Imaging. IEEE J. Solid-State Circuits 2020, 55, 1960–1970. [Google Scholar] [CrossRef]\n\nNiclass, C.; Rochas, A.; Besse, P.-A.; Charbon, E. Design and characterization of a CMOS 3-D image sensor based on single photon avalanche diodes. IEEE J. Solid-State Circuits 2005, 40, 1847–1854. [Google Scholar] [CrossRef]\n\nSesta, V.; Pasquinelli, K.; Federico, R.; Zappa, F.; Villa, F. Range-Finding SPAD Array With Smart Laser-Spot Tracking and TDC Sharing for Background Suppression. IEEE Open J. Solid-State Circuits Soc. 2022, 2, 26–37. [Google Scholar] [CrossRef]\n\nLindner, S.; Zhang, C.; Antolovic, I.M.; Wolf, M.; Charbon, E. A 252 × 144 SPAD Pixel Flash Lidar with 1728 Dual-Clock 48.8 PS TDCs, Integrated Histogramming and 14.9-to-1 Compression in 180NM CMOS Technology. In Proceedings of the 2018 IEEE Symposium on VLSI Circuits, Honolulu, HI, USA, 18–22 June 2018. [Google Scholar]\n\nBronzi, D.; Villa, F.; Tisa, S.; Tosi, A.; Zappa, F. SPAD Figures of Merit for Photon-Counting, Photon-Timing, and Imaging Applications: A Review. IEEE Sens. J. 2016, 16, 3–12. [Google Scholar] [CrossRef]\n\nErdogan, A.T.; Walker, R.; Finlayson, N.; Krstajic, N.; Williams, G.; Girkin, J.; Henderson, R. A CMOS SPAD Line Sensor with Per-Pixel Histogramming TDC for Time-Resolved Multispectral Imaging. IEEE J. Solid-State Circuits 2019, 54, 1705–1719. [Google Scholar] [CrossRef]\n\nGersbach, M.; Trimananda, R.; Maruyama, Y.; Fishburn, M.; Stoppa, D.; Richardson, J.; Walker, R.; Henderson, R.K.; Charbon, E. High frame-rate TCSPC-FLIM using a novel SPAD-based image sensor. In Detectors and Imaging Devices: Infrared, Focal Plane, Single Photon; SPIE: Bellingham, WA, USA, 2010. [Google Scholar]\n\nLin, Y.; Mos, P.; Ardelean, A.; Bruschini, C.; Charbon, E. Coupling a Recurrent Neural Network to SPAD TCSPC Systems for Real-time Fluorescence Lifetime Imaging. Sci. Rep. 2024, 14, 3286. [Google Scholar] [CrossRef] [PubMed]\n\nSuhling, K.; Hirvonen, L.M.; Levitt, J.A.; Chung, P.-H.; Tregidgo, C.; Le Marois, A.; Rusakov, D.A.; Zheng, K.; Ameer-Beg, S.; Poland, S.; et al. Fluorescence lifetime imaging (FLIM): Basic concepts and some recent developments. Med. Photon. 2015, 27, 3–40. [Google Scholar] [CrossRef]\n\nKufcsák, A.; Erdogan, A.; Walker, R.; Ehrlich, K.; Tanner, M.; Megia-Fernandez, A.; Scholefield, E.; Emanuel, P.; Dhaliwal, K.; Bradley, M.; et al. Time-resolved spectroscopy at 19,000 lines per second using a CMOS SPAD line array enables advanced biophotonics applications. Opt. Express 2017, 25, 11103. [Google Scholar] [CrossRef]\n\nHirvonen, L.M.; Suhling, K. Wide-field TCSPC: Methods and applications. Meas. Sci. Technol. 2016, 28, 012003. [Google Scholar] [CrossRef]\n\nBruschini, C.; Homulle, H.; Antolovic, I.M.; Burri, S.; Charbon, E. Single-photon avalanche diode imagers in biophotonics: Review and outlook. Light. Sci. Appl. 2019, 8, 87. [Google Scholar] [CrossRef] [PubMed]\n\nUsai, A.; Finlayson, N.; Gregory, C.D.; Campbell, C.; Henderson, R.K. Separating fluorescence from Raman spectra using a CMOS SPAD TCSPC line sensor for biomedical applications. In Proceedings of the Optical Biopsy XVII: Toward Real-Time Spectroscopic Imaging and Diagnosis, San Francisco, CA, USA, 5–6 February 2019. [Google Scholar]\n\nMeier, K.; Ryan, D.; Thompson, D.; Newell, R.; Sandoval, R.; Werner, J.H. Quantum ghost imaging for non-destructive plant imaging using highly non-degenerate spontaneous parametric downconversion. In Proceedings of the Quantum Sensing, Imaging, and Precision Metrology, San Francisco, CA, USA, 28 January–2 February 2023. [Google Scholar]\n\nPitsch, C.; Walter, D.; Gasparini, L.; Bürsing, H.; Eichhorn, M. 3D quantum ghost imaging. Appl. Opt. 2023, 62, 6275. [Google Scholar] [CrossRef] [PubMed]\n\nMarkovic, B.; Tamborini, D.; Villa, F.; Tisa, S.; Tosi, A.; Zappa, F. 10 ps resolution, 160 ns full scale range and less than 1.5% differential non-linearity time-to-digital converter module for high performance timing measurements. Rev. Sci. Instrum. 2012, 83, 074703. [Google Scholar] [CrossRef] [PubMed]\n\nNolet, F.; Dubois, F.; Roy, N.; Parent, S.; Lemaire, W.; Massie-Godon, A.; Charlebois, S.A.; Fontaine, R.; Pratte, J.-F. Digital SiPM channel integrated in CMOS 65 nm with 17.5 ps FWHM single photon timing resolution. Nucl. Instrum. Methods Phys. Res. Sect. A Accel. Spectrometers Detect. Assoc. Equip. 2018, 912, 29–32. [Google Scholar] [CrossRef]\n\nHenzler, S. Time-To-Digital Converters, 1st ed.; Springer: Dordrecht, The Netherlands, 2010. [Google Scholar]\n\nTancock, S.; Arabul, E.; Dahnoun, N. A Review of New Time-to-Digital Conversion Techniques. IEEE Trans. Instrum. Meas. 2019, 68, 3406–3417. [Google Scholar] [CrossRef]\n\nNemallapudi, M.; Gundacker, S.; Lecoq, P.; Auffray, E. Single photon time resolution of state of the art SiPMs. J. Instrum. 2016, 11, P10016. [Google Scholar] [CrossRef]\n\nHenderson, R.K.; Johnston, N.; Della Rocca, F.M.; Chen, H.; Li, D.D.-U.; Hungerford, G.; Hirsch, R.; Mcloskey, D.; Yip, P.; Birch, D.J.S. A 192 × 128 Time Correlated SPAD Image Sensor in 40-nm CMOS Technology. IEEE J. Solid-State Circuits 2019, 54, 1907–1916. [Google Scholar] [CrossRef]\n\nNolet, F.; Lemaire, W.; Dubois, F.; Roy, N.; Carrier, S.; Samson, A.; Charlebois, S.A.; Fontaine, R.; Pratte, J.-F. A 256 Pixelated SPAD readout ASIC with in-Pixel TDC and embedded digital signal processing for uniformity and skew correction. Nucl. Instrum. Methods Phys. Res. Sect. A Accel. Spectrometers Detect. Assoc. Equip. 2019, 949, 162891. [Google Scholar] [CrossRef]\n\nPelka, R.; Kalisz, J.; Szplet, R. Nonlinearity correction of the integrated time-to-digital converter with direct coding. IEEE Trans. Instrum. Meas. 1997, 46, 449–453. [Google Scholar] [CrossRef]\n\nZarghami, M.; Gasparini, L.; Parmesan, L.; Moreno-Garcia, M.; Stefanov, A.; Bessire, B.; Unternahrer, M.; Perenzoni, M. A 32 × 32-Pixel CMOS Imager for Quantum Optics with Per-SPAD TDC, 19.48% Fill-Factor in a 44.64 μm Pitch Reaching 1 MHz Observation Rate. IEEE J. Solid-State Circuits 2020, 55, 2819–2830. [Google Scholar] [CrossRef]\n\nPitsch, C.; Walter, D.; Grosse, S. Supplementary document for Quantum ghost imaging using asynchronous detection. Appl. Opt. 2021, 60, F66–F70. [Google Scholar] [CrossRef]\n\nXu, H.; Pancheri, L.; Betta, G.-F.D.; Stoppa, D. Design and characterization of a p+/n-well SPAD array in 150 nm CMOS process. Opt. Express 2017, 25, 12765. [Google Scholar] [CrossRef]\n\nStoppa, D.; Borghetti, F.; Richardson, J.; Walker, R.; Grant, L.; Henderson, R.K.; Gersbach, M.; Charbon, E. A 32 × 32-pixel array with in-pixel photon counting and arrival time measurement in the analog domain. In Proceedings of the 2009 Proceedings of ESSCIRC, Athens, Greece, 14–18 September 2009. [Google Scholar]\n\nChen, H.; Li, D.D.-U. Multichannel, Low Nonlinearity Time-to-Digital Converters Based on 20 and 28 nm FPGAs. IEEE Trans. Ind. Electron. 2018, 66, 3265–3274. [Google Scholar] [CrossRef]\n\nRaisanen-Ruotsalainen, E.; Rahkonen, T.; Kostamovaara, J. An integrated time-to-digital converter with 30-ps single-shot precision. IEEE J. Solid-State Circuits 2000, 35, 1507–1510. [Google Scholar] [CrossRef]\n\nVilla, F.; Lussana, R.; Bronzi, D.; Tisa, S.; Tosi, A.; Zappa, F.; Mora, A.D.; Contini, D.; Durini, D.; Weyers, S.; et al. CMOS Imager with 1024 SPADs and TDCs for Single-Photon Timing and 3-D Time-of-Flight. IEEE J. Sel. Top. Quantum Electron. 2014, 20, 364–373. [Google Scholar] [CrossRef]\n\nRoy, N.; Nolet, F.; Dubois, F.; Mercier, M.-O.; Fontaine, R.; Pratte, J.-F. Low Power and Small Area, 6.9 ps RMS Time-to-Digital Converter for 3-D Digital SiPM. IEEE Trans. Radiat. Plasma Med. Sci. 2017, 1, 486–494. [Google Scholar] [CrossRef]\n\nRichardson, J.; Walker, R.; Grant, L.; Stoppa, D.; Borghetti, F.; Charbon, E.; Gersbach, M.; Henderson, R.K. A 32 × 32 50 ps resolution 10 bit time to digital converter array in 130 nm CMOS for time correlated imaging. In Proceedings of the 2009 IEEE Custom Integrated Circuits Conference, San Jose, CA, USA, 13–16 September 2009. [Google Scholar]\n\nGasparini, L.; Garcia, M.M.; Zarghami, M.; Stefanov, A.; Eckmann, B.; Perenzoni, M. A reconfigurable 224 × 272-pixel single-photon image sensor for photon timestamping, counting and binary imaging at 30.0 µm pitch in 110 nm CIS technology. In Proceedings of the ESSCIRC 2022—IEEE 48th European Solid State Circuits Conference (ESSCIRC), Milan, Italy, 19–22 September 2022. [Google Scholar]\n\nKuzucu, O.; Wong, F.N.C.; Kurimura, S.; Tovstonog, S. Joint Temporal Density Measurements for Two-Photon State Characterization. Phys. Rev. Lett. 2008, 101, 153602. [Google Scholar] [CrossRef] [PubMed]\n\nMorris, P.A.; Aspden, R.S.; Bell, J.E.C.; Boyd, R.W.; Padgett, M.J. Imaging with a small number of photons. Nat. Commun. 2015, 6, 5913. [Google Scholar] [CrossRef] [PubMed]\n\nIDQuantique. ID230 Product Page. Available online: https://www.idquantique.com/quantum-sensing/products/id230/ (accessed on 26 February 2024).\n\nPicoQuant. TimeHarp260 Product Website. Available online: https://www.picoquant.com/products/category/tcspc-and-time-tagging-modules/timeharp-260-tcspc-and-mcs-board-with-pcie-interface (accessed on 26 February 2024).\n\nFigure 1. A simplified layout of the power distribution network in a pixel array (left), w, with pixel zoom-in (center, top), and an RC model of a pixel (center, bottom). The resulting network leads to a non-uniform IR drop which reaches a maximum at the center of the array (right).\n\nFigure 2. Concept of skew caused by the propagation of the timing signal from the periphery of the array to the pixels.\n\nFigure 3. Pictorial representation of the distribution of control signals across the array and associated skew across the array. The worst-case skew depends on the architecture of the driving logic. Here, four common architectures are shown: (a) a basic row driver, (b) an equalized, row-level buffer tree, (c) left and right drivers, and (d) an array-level buffer tree. On the right, a pixel zoom-in (top) is shown, highlighting the loads of control and readout nets along with the associated RC model (bottom).\n\nFigure 4. The measurement setup to determine the pixel-dependent temporal drift of a SPAD imager [25]. The setup is based on previously published setups for asynchronous quantum ghost imaging [16]. The emission spot on the camera should illuminate the complete detector aperture in order to perform a coincidence analysis over the whole chip. This should also be verified for the idler detector, especially in case of fiber coupling.\n\nFigure 5. Drift in the coincidence peak over measurement time for selected pixels. (a) Coincidence evaluation for groups of TDC values of single pixel (Column 1, Row 11): 16 TDC values were grouped together to ensure enough data for good fit function. Dependence of peak position on TDC value is clearly visible and results in broadening of the peak shown in Figure 6a. (b) Evolution of mean of Gaussian fit over TDC values for selected pixels. The drift was estimated by a second-degree polynomial function. To avoid inaccuracies in the fit, only TDC values with enough data were evaluated. Because of this, pixel 23 is only evaluated until the TDC value reaches 160. Also shown is the global reference value used to create the lookup table for the correction.\n\nFigure 6. A coincidence evaluation of the Michelson measurement of [16] with different corrections. (a) A coincidence peak with the linear correction of the TDC values, as published in [16]. The peak is about 2 ns wide, with an FWHM of about 700 ps. (b) The coincidence peak with the proposed drift correction, yielding a full peak width of about 700 ps and an FWHM of about 300 ps.\n\nFigure 7. A coincidence evaluation of the free space measurement of [16] with different corrections. (a) The coincidence peak with a coarse linear correction of the TDC values detailed in [25] (not shown in [16]). The peak is about 3 ns wide with an FWHM of about 700 ps and a considerable “tail”. (b) A coincidence peak showing the proposed drift correction, yielding a full peak width of about 700 ps and an FWHM of about 300 ps.\n\nDisclaimer/Publisher’s Note: The statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of MDPI and/or the editor(s). MDPI and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content.\n\n© 2024 by the authors. Licensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (https://creativecommons.org/licenses/by/4.0/).\n\nShare and Cite\n\nMDPI and ACS Style\n\nPitsch, C.; Walter, D.; Gasparini, L.; Bürsing, H.; Eichhorn, M. A Method to Correct the Temporal Drift of Single-Photon Detectors Based on Asynchronous Quantum Ghost Imaging. Sensors 2024, 24, 2578. https://doi.org/10.3390/s24082578\n\nAMA Style\n\nPitsch C, Walter D, Gasparini L, Bürsing H, Eichhorn M. A Method to Correct the Temporal Drift of Single-Photon Detectors Based on Asynchronous Quantum Ghost Imaging. Sensors. 2024; 24(8):2578. https://doi.org/10.3390/s24082578\n\nChicago/Turabian Style\n\nPitsch, Carsten, Dominik Walter, Leonardo Gasparini, Helge Bürsing, and Marc Eichhorn. 2024. \"A Method to Correct the Temporal Drift of Single-Photon Detectors Based on Asynchronous Quantum Ghost Imaging\" Sensors 24, no. 8: 2578. https://doi.org/10.3390/s24082578\n\nNote that from the first issue of 2016, this journal uses article numbers instead of page numbers. See further details here.\n\nArticle Metrics\n\nNo\n\nNo\n\nArticle Access Statistics\n\nFor more information on the journal statistics, click here.\n\nMultiple requests from the same IP address are counted as one view."
    }
}