{
    "id": "dbpedia_1933_0",
    "rank": 29,
    "data": {
        "url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7733873/",
        "read_more_link": "",
        "language": "en",
        "title": "Parallel Factor Analysis Enables Quantification and Identification of Highly Convolved Data-Independent-Acquired Protein Spectra",
        "top_image": "https://www.ncbi.nlm.nih.gov/corehtml/pmc/pmcgifs/pmc-card-share.jpg?_=0",
        "meta_img": "https://www.ncbi.nlm.nih.gov/corehtml/pmc/pmcgifs/pmc-card-share.jpg?_=0",
        "images": [
            "https://www.ncbi.nlm.nih.gov/coreutils/uswds/img/favicons/favicon-57.png",
            "https://www.ncbi.nlm.nih.gov/coreutils/uswds/img/icon-dot-gov.svg",
            "https://www.ncbi.nlm.nih.gov/coreutils/uswds/img/icon-https.svg",
            "https://www.ncbi.nlm.nih.gov/coreutils/nwds/img/logos/AgencyLogo.svg",
            "https://www.ncbi.nlm.nih.gov/corehtml/pmc/pmcgifs/logo-patterns.png",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7733873/bin/fx1.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7733873/bin/gr1.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7733873/bin/gr2.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7733873/bin/gr3.jpg"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "Filip Buric",
            "Jan Zrimec",
            "Aleksej Zelezniak"
        ],
        "publish_date": "2020-12-11T00:00:00",
        "summary": "",
        "meta_description": "High-throughput data-independent acquisition (DIA) is the method of choice for quantitative proteomics, combining the best practices of targeted and shotgun approaches. The resultant DIA spectra are, however, highly convolved and with no direct precursor-fragment ...",
        "meta_lang": "en",
        "meta_favicon": "https://www.ncbi.nlm.nih.gov/coreutils/nwds/img/favicons/favicon.ico",
        "meta_site_name": "PubMed Central (PMC)",
        "canonical_link": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7733873/",
        "text": "CANDIA: A GPU-Accelerated Software Pipeline for Deconvolving DIA Data\n\nWe developed the CANDIA pipeline, capable of recovering spectral features in unsupervised fashion and computationally feasible time ( A), by leveraging the power of the modern tensor algebra frameworks PyTorch35 and Tensorflow,36 which take advantage of the parallelism and throughput of floating point operations in GPUs, as well as the distributed “big data” computing framework Apache Spark.37 In brief, CANDIA partitions all provided DIA scans into a collection of small, independent tensors (including both MS1 and MS2 data), corresponding to precursor isolation windows and time intervals (Experimental Procedures P1). It then performs multiple decompositions of each of these tensors in parallel, accounting for a range of possible numbers of components in each tensor ( A and Experimental Procedures P2). As the observed intensities in DIA liquid chromatography-tandem MS scans result from linear combinations of individual fragmented peptide spectra, their elution profiles, and their relative abundance across all samples, each PARAFAC component ideally represents an analyte as a triplet of its m/z spectrum, retention time (RT) peak, and relative sample contribution ( B). The decomposition results are then refined by selecting the best models based on the quality of reconstructed signals, i.e., the unimodality of the elution profile (Experimental Procedures P3 and Note S1). A critical step in constructing a PARAFAC model is deciding a priori the number of components F, complicated by the fact that PARAFAC models do not “nest,” i.e., a model for F + 1 is not simply a model for F with an extra component.30 Deciding the value automatically is generally an open problem,38 and the various diagnostics and procedures used to this end39 often require human verification, which is not feasible for data-rich proteomics workflows, with hundreds of thousands of models that need to be examined. Our approach therefore exhaustively constructs all possible models within the configured range, then uses the shape of the resulting elution profiles and accounts for noise to automatically select valid models, resulting in optimal precursor identifications. The recovered m/z spectra ( C) can be directly searched using standard tool sets such as Crux,40 TPP,33 and MS-GF+34 to (1) produce PSMs ( D), (2) build spectral libraries (Experimental Procedures P4), (3) be used for de novo sequencing, or (4) be used directly as linearly independent features for machine-learning applications.\n\nPrecise Protein Identification and Quantification with CANDIA\n\nWe first evaluated whether CANDIA-deconvolved spectra were identifiable by conventional peptide search engines. First, we tested our approach on a Saccharomyces cerevisiae lysate dataset,2 referred to here as yeast replicates, which consisted of nine consecutive injections acquired in SWATH mode on a conventional Sciex 5600 QqTOF instrument with microflow setup. To identify the precursors, CANDIA solved a total of 176,175 PARAFAC models (29 swaths × 75 1-min windows × 81 models) on a GPU-equipped workstation. As a benchmark for comparison, we used DIA-Umpire,18 a widely used tool for building spectral libraries directly from DIA data, and considered results from Crux (Comet coupled with Percolator) and MS-GF+ search engines separately, to assess their performance. While Crux identified a total of 2,014 proteins using the DIA-Umpire pseudo-spectra produced for each yeast replicate, in contrast only 684 proteins (1,553 peptides) were identified on the output from CANDIA. However, when considering only the proteins that appear in at least eight of the technical replicates, 583 proteins were found at 1% false discovery rate (FDR) using DIA-Umpire in conjunction with Crux ( A). The same pattern emerged for MS-GF+, only with far fewer identifications prevalent across the majority of replicates (see Table S1). PARAFAC decomposition, in contrast, captures the same analytes across all input samples, thus the commonality of high-confidence protein IDs across technical replicates is inherent to the method. Overall 53% overlap, consisting of 439 common proteins, was detected between CANDIA and DIA-Umpire coupled with Crux (considering only proteins identified in at least eight samples), with 245 proteins unique to CANDIA ( A). The peptide quantifications ( B) based on the reconstructed spectral library are precise (median coefficient of variation [CV] = 9.3% for the yeast replicates dataset) and reproducible (mean Pearson's r = 0.99 and p < 1 × 10−16 between the replicates).\n\nThe inconsistencies in peptide quantifications are often attributed to DDA approaches,6 due to their stochastic nature of peptide selection, which is dependent on instrument performance. Although DIA methods typically produce far more complete data matrices,5 the consistency of identification may be highly dependent on the inference correction procedures and the way FDR is estimated from DIA data. To exemplify this further, we built a library based on in silico digestion of a yeast proteome, whereby we randomly shuffled 30% of amino acids in each peptide sequence. Despite the fact that only peptides that did not exist in the original organism were considered, we quantified 2,691 and 642 proteins using the conventional library-based search tools Skyline41 and DIA-NN,10 respectively, at 1% FDR (Experimental Procedures P5). With the same search, Spectronaut11 did not yield any identification. This is on average 185 times above the expected number of false discoveries (Figure S1). All of these identifications were attributed solely to the unique fragments arising from the mutated precursors, which would otherwise not be present in the original yeast spectral library and were extracted within predicted RT of the corresponding tool. Indeed, the score distributions of these sets of peptides suggest that the current decoy generation strategies do not provide a realistic model of the null hypothesis, which states that real peptide features are not different from the shuffled ones (Figure S2). In contrast, quantification with these tools using a library constructed from CANDIA output spectra only yielded identifications with one tool, and only 22 times higher than the expected number of false positives at 1% FDR. This indicates the validity of identifications when using PARAFAC-recovered spectra. To account for any confusion introduced to the inference algorithms of these software packages by providing them with completely spurious data, we also performed a sample-entrapment analysis42 using a collection of Archaea proteomes as the entrapment partition. While generally robust to the false positives from the entrapment partition, the three software packages still yielded results from the Archaea proteomes, with the CANDIA library overall reducing false positives (Figure S3).\n\nWe next evaluated whether CANDIA could resolve spectra in a complex background such as the LFQbench HYE110 dataset,43 containing two mixtures with different ratios of human, Escherichia coli, and S. cerevisiae, the latter two of which are present in quantities close to the limit of detection (5%) alternatively in the two mixtures. As, typically, the number of detected and quantified proteins is highly dependent on the particular tool and FDR estimation method, one would expect to find differences between available tools43 and CANDIA, given that the latter works by searching against deconvolved spectra rather than by matching against scans using a library. Nevertheless, running Crux and MS-GF+ with an FDR threshold of 1% on CANDIA output spectra yielded a total of 3,024 proteins, comparable with the average 3,857 obtained by the other methods in the benchmark study,43 albeit at an overall lower rate of peptide identification (5,908 peptides with a median ratio of peptides to protein of 4) (Figure S4). Out of these proteins, 1,508 were unique to CANDIA ( C), which is 16 times higher than the median number of unique proteins of the other methods. We noticed that 601 proteins not identified with CANDIA were instead found using all methods that, in essence, use the same target-decoy fragment mass search algorithm for FDR estimation.44 Analogously to the yeast example above, we built an in silico library of randomized peptide sequences, which resulted in a library with no peptides present in the non-randomized protein sequences of any of the three target organisms, as well as a sample-entrapment database using Archaea proteomes as the entrapment partition. For the randomized database, results were different between the tools, with up to 1,499 false protein identities found (Figure S5), 65 times higher than the expected number of false positives (23). In the sample-entrapment analysis, using the CANDIA library consistently reduced the number of entrapment proteins identified up to 100% (Figure S6). Given this underestimation of the false-positive rate made by the conventional tools, a considerable amount of the identifications at 1% FDR with tools other than CANDIA were thus put into the question. The quantification based on the CANDIA library, built using conventional methods10,43 with an FDR threshold of 1%, resulted in precise ratios between the two mixtures A and B in the dataset ( D), showing precise quantification using a spectral library constructed directly from the decomposed spectra.\n\nDIA Spectra Are a Molecular “Dark Matter”\n\nAmong the advantages of DIA is that acquired data represent a digital snapshot of all ions obtained from a sample.7 While the idea is appealing, current library-based methods retrieve only a minor fraction of analytes present in a sample, leaving the majority of acquired DIA spectra unused. To demonstrate this, we calculated the overlap between m/z values of a DIA scan from the HYE110 dataset43 and the corresponding published library. Allowing for a 5-min RT and a 50-ppm m/z tolerance, the spectral library matched 80.77% of all spectra in this scan. However, summing over the corresponding signal intensities, the library covered only 2.2% of total ion current (TIC) recorded in the scan ( A), showing that the majority of matched m/z points comprise baseline signals. Indeed, by filtering out all scan intensities below 1, the covered percentage of DIA spectra dropped to 3.46%. Thus, the remaining analyte signals, i.e., unlabeled features, are missed by current conventional tools that rely on targeted quantifications. On the contrary, the PARAFAC decomposition method considers virtually all m/z space (Experimental Procedures P2) in a DIA scan and discards unsystematic noise by leveraging the variability between scans to produce deconvolved spectra.30 Thus, a reconstructed scan obtained by recombining PARAFAC output modes (Experimental Procedures P6) covered 72% of the same HYE110 scan TIC ( A), which is 33 times higher than what is covered by the spectral library and corresponds to more than twice (4.2%) the annotated spectral signal. Analogous results were obtained from S. cerevisiae lysate and its corresponding spectral library built using fractionation,2 whereby the reconstructed PARAFAC pseudo-scan accounted for 12-fold more TIC than the corresponding library (Figure S7).\n\nExtracting the realistic number of analytes, however, is dependent on the choice of the correct number of components.30 The challenge is to identify the number of components that would best match the number of precursors in the samples. Finding the optimal number of components, however, is an NP-complete problem.45 Thus, to minimize the risk of overfitting due to an overestimated number of components, we developed an effective empirical approach that functions under the assumption that every analyte has to elute as a single chromatographic peak, our so-called unimodality criterion (Experimental Procedures P3). Indeed, choosing the number of PARAFAC components with most unimodal elution profiles resulted in the optimal number of significant (FDR < 1%) precursor identifications and, importantly, this approach better captured the densest region of the scans (in terms of TIC), giving more confidence in the results ( B). We included all models with maximum unimodality (i.e., the entire feasible set) to account for the uncertainty in peptide-spectrum matching,46 as it was observed that in denser scan regions (in terms of TIC) there are more models with maximum unimodality and, moreover, these recapitulate several of the same components (see Note S1). This is corroborated by theory, as models around the correct number of components will often not differ much in terms of loadings.30 A large increase in number of components (with decreasing unimodality fraction) did not result in more peptide identifications; rather, it resulted in about half of the amount yielded by the optimal set. This is not surprising, as beyond the correct value, more components will start modeling noise or a single analyte may be captured by more non-physical components.30 As an intuitive example, C compares a pair of good and bad models for the yeast replicates dataset by showing the time modes (elution profiles) of each component in a single slice (single swath and time window), as output by PARAFAC. Examples of components from both these models are shown in Figure S8. As demonstrated, the good model captures proper elution curves, whereas non-optimal models comprise a significant number of fragmented or very narrow single-point curves, representing noise or split components that do not reflect any analytes. For the yeast lysate dataset, as the median of the unimodality fraction across the best models was 87% ( D), we attributed the remaining 13% of components to captured noise and elution curves clipped at the edge of the data slices, which were not counted by the peak detection routine (see Table S2).\n\nAs empirical evidence of the quality of CANDIA results, the total number of identified proteins for the yeast lysate dataset is comparable with library-based methods ( A and 2C), and the median number of recovered precursors per protein is eight, which is similar to what is typically expected from these approaches43 (Figure S9). Accounting for imperfect deconvolutions, the majority (median across datasets = 85%) of recovered spectra (i.e., components) were not mapped to peptide space, and this remaining set of PARAFAC components is overall uncorrelated with the set of identified components (mean Pearson's r = −7 × 10–4) ( E). This was assessed by decomposing the dataset from Vowinckel et al.,2 consisting of 30 yeast lysate samples from a study of the target of rapamycin (TOR) pathway, and calculating the correlation between identified and unidentified unimodal sample modes (the sample mode of a component holds the contribution of that component to each sample, i.e., analyte abundance in sample), keeping only the most complex feasible model per slice. For this dataset, the average unimodal fraction was 90% and, by considering only these non-noisy components, we showed that unidentified components contain non-redundant information that could be leveraged by, for example, machine-learning approaches.47,48\n\nLastly, to extract information from the set of unidentified spectra using existing methods, we queried them for post-translational modifications (PTMs) using MS-GF+ and, moreover, performed de novo sequencing using the state-of-the-art machine-learning-based approach DeepNovo,49 as well as the established tool Novor50 (Experimental Procedures P7). We identified in total 186 PTMs in the non-enriched microflow yeast SWATH runs (Tables S3), which was twice more than using DIA-Umpire. Moreover, the latter exhibited very low prevalence of identifications, with only 8.2% appearing in at most two replicates (Figure S10). De novo sequencing benefits from deconvolved input.51 Consequently, DeepNovo and Novor respectively yielded 4 and 24 times more high-confidence (over 80% sequence correctness probability, see Experimental Procedures P7) de novo sequences from CANDIA output, compared with running on DIA-Umpire output (Note S2).\n\nP1. Preprocessing\n\nDIA scans were partitioned and combined to form independent tensors for the decomposition stage. To determine the size of these partitions or “slices,” we used the MS1 precursor isolation windows or “swaths” to cut the scans along the m/z axis, and a reasonable time window to cut the RT axis, depending on the chromatography. Partitioning according to swaths is a natural approach, as precursor-product spectra within one swath are independent of those in other swaths. For the yeast replicates and TOR study datasets the time window was chosen as 1 min, whereas for the HYE110 dataset, 5-min windows were taken. This choice balanced the number of expected elutants, due to differences in gradients (e.g., 20 min versus 40 min) and hence, the range of possible models, against the resulting number of slices. This RT partitioning is similar to the approach taken by iPLS,64 although here it primarily serves to reduce model memory requirements and, secondarily, model complexity. We saw that results are fairly robust to different window sizes (see Table S2), although too-narrow windows will increase the number of clipped (partial) elution peaks while too-large windows increase the complexity of the models, leading to a slight drop in quality of the final results. Future improvement of the approach ought to include a less arbitrary choice.\n\nTo facilitate processing, we converted the scan files to tabular format and partitioned them in parallel using the pyteomics package65 and distributed computing framework Apache Spark. Each such slice thus contained the same (m/z, RT) partition for all input scan files, which were then “stacked,” resulting in a (m/z, RT, sample) tensor structure, encoded as a NumPy66 array. Technically, each MS1 survey scan and its respective MS2 spectra were aligned along the time axis, as they ought to form a single variable, i.e., the same column in the resulting matrix. The preprocessing step resulted in a collection of independent tensors that span the entire m/z and RT range of each sample. For more details, see Note S3."
    }
}