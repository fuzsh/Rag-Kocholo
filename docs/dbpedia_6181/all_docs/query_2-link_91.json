{
    "id": "dbpedia_6181_2",
    "rank": 91,
    "data": {
        "url": "https://www.digitalocean.com/community/tutorials/how-to-move-an-nginx-web-root-to-a-new-location-on-ubuntu-20-04",
        "read_more_link": "",
        "language": "en",
        "title": "How To Move an Nginx Web Root to a New Location on Ubuntu 20.04",
        "top_image": "https://www.digitalocean.com/_next/static/media/intro-to-cloud.d49bc5f7.jpeg",
        "meta_img": "https://www.digitalocean.com/_next/static/media/intro-to-cloud.d49bc5f7.jpeg",
        "images": [
            "https://www.gravatar.com/avatar/56a1a63779e1c0815ad0d8db85f9355e88957654cc863d598e44712c776dac84?default=retro 1x, https://www.gravatar.com/avatar/56a1a63779e1c0815ad0d8db85f9355e88957654cc863d598e44712c776dac84?default=retro 2x",
            "https://www.gravatar.com/avatar/0b590d3604c7e311369e38b4184576c4653a06288d6e326aea75031677e393f9?default=retro 1x, https://www.gravatar.com/avatar/0b590d3604c7e311369e38b4184576c4653a06288d6e326aea75031677e393f9?default=retro 2x",
            "https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2Fintro-to-cloud.d49bc5f7.jpeg&width=828 1x, https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2Fintro-to-cloud.d49bc5f7.jpeg&width=1920 2x",
            "https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2Fdefault-avatar.14b0d31d.jpeg&width=64 1x, https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2Fdefault-avatar.14b0d31d.jpeg&width=128 2x",
            "https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2Fdefault-avatar.14b0d31d.jpeg&width=64 1x, https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2Fdefault-avatar.14b0d31d.jpeg&width=128 2x",
            "https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2Fcreativecommons.c0a877f1.png&width=128 1x, https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2Fcreativecommons.c0a877f1.png&width=256 2x",
            "https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2FnewsLetter.c1eb26e3.jpeg&width=750 1x, https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2FnewsLetter.c1eb26e3.jpeg&width=1920 2x",
            "https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2FhollieHub4Good.90285377.jpeg&width=750 1x, https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2FhollieHub4Good.90285377.jpeg&width=1920 2x",
            "https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2Fwrite4DO.6a167f0c.jpeg&width=750 1x, https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2Fwrite4DO.6a167f0c.jpeg&width=1920 2x",
            "https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2Fconsole-static.1b14cc64.svg&width=640 1x, https://www.digitalocean.com/api/static-content/v1/images?src=%2F_next%2Fstatic%2Fmedia%2Fconsole-static.1b14cc64.svg&width=1080 2x"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "On Ubuntu, by default, the Nginx web server stores its documents in /var/www/html, which is typically located on the root filesystem with the rest of the oâ¦",
        "meta_lang": "en",
        "meta_favicon": "/_next/static/media/apple-touch-icon.d7edaa01.png",
        "meta_site_name": "",
        "canonical_link": "https://www.digitalocean.com/community/tutorials/how-to-move-an-nginx-web-root-to-a-new-location-on-ubuntu-20-04",
        "text": "Introduction\n\nOn Ubuntu, the Nginx web server stores its documents in /var/www/html, which is typically located on the root filesystem with the rest of the operating system. Sometimes, though, itâs helpful to move the document root to another location, such as a separate mounted filesystem. For example, if you serve multiple websites from the same Nginx instance, putting each siteâs document root on its own volume allows you to scale in response to the needs of a specific site or client.\n\nIn this guide, you will move an Nginx document root to a new location.\n\nPrerequisites\n\nTo complete this guide, you will need:\n\nAn Ubuntu 20.04 server and a non-root user with sudo privileges. You can learn more about how to set up a user with these privileges in our Initial Server Setup with Ubuntu 20.04 guide.\n\nNginx installed, following How To Install Nginx on Ubuntu 20.04.\n\nA TLS/SSL certificate configured for your server. You have three options:\n\nYou can get a free certificate from Letâs Encrypt by following How to Secure Nginx with Letâs Encrypt on Ubuntu 20.04.\n\nYou can also generate and configure a self-signed certificate by following How to Create a Self-signed SSL Certificate for Nginx in Ubuntu 20.04.\n\nYou can buy one from another provider and configure Nginx to use it by following Steps 3 and 4 of How to Create a Self-signed SSL Certificate for Nginx in Ubuntu 20.04.\n\nWe will use the domain name your_domain in this tutorial, but you should substitute this with your own domain name.\n\nA new location for your document root. In this tutorial, we will use the /mnt/volume-nyc3-01 directory for our new location. If you are using Block Storage on DigitalOcean, this guide will show you how to create and attach your volume. Your new document root location is configurable based on your needs, however. If you are moving your document root to a different storage device, you will want to select a location under the deviceâs mount point.\n\nStep 1 â Copying Files to the New Location\n\nOn a fresh installation of Nginx, the document root is located at /var/www/html. By following the prerequisite guides, however, you created a new document root, /var/www/your_domain/html. You may have additional document roots as well. In this step, we will establish the location of our document roots and copy the relevant files to their new location.\n\nYou can search for the location of your document roots using grep. Letâs search in the /etc/nginx/sites-enabled directory to limit our focus to active sites. The -R flag ensures that grep will print both the line with the root directive and the full filename in its output:\n\ngrep -R \"root\" /etc/nginx/sites-enabled\n\nIf you followed the prerequisite tutorials on a fresh server, the result will look like this:\n\nOutput\n\n/etc/nginx/sites-enabled/your_domain: root /var/www/your_domain/html; /etc/nginx/sites-enabled/default: root /var/www/html; /etc/nginx/sites-enabled/default: # deny access to .htaccess files, if Apache's document root /etc/nginx/sites-enabled/default:# root /var/www/your_domain;\n\nIf you have pre-existing setups, your results may differ from whatâs shown here. In either case, you can use the feedback from grep to make sure youâre moving the desired files and updating the appropriate configuration files.\n\nNow that youâve confirmed the location of your document root, you can copy the files to their new location with rsync. Using the -a flag preserves the permissions and other directory properties, while -v provides verbose output so you can follow the progress of the sync:\n\nsudo rsync -av /var/www/your_domain/html /mnt/volume-nyc3-01\n\nYou will see output like the following:\n\nOutput\n\nsending incremental file list created directory /mnt/volume-nyc3-01 html/ html/index.html sent 318 bytes received 39 bytes 714.00 bytes/sec total size is 176 speedup is 0.49\n\nWith our files in place, letâs move on to modifying our Nginx configuration to reflect these changes.\n\nStep 2 â Updating the Configuration Files\n\nNginx makes use of both global and site-specific configuration files. For background about the hierarchy of configuration files, take a look at âHow To Configure The Nginx Web Server On a Virtual Private Serverâ. We will modify the server block file for our your_domain project: /etc/nginx/sites-enabled/your_domain.\n\nStart by opening /etc/nginx/sites-enabled/your_domain in an editor:\n\nsudo nano /etc/nginx/sites-enabled/your_domain\n\nFind the line that begins with root and update it with the new root location. In our case this will be /mnt/volume-nyc3-01/html:\n\n/etc/nginx/sites-enabled/your_domain\n\nserver { root /mnt/volume-nyc3-01/html; index index.html index.htm index.nginx-debian.html; . . . } . . .\n\nKeep an eye out for any other places that you see the original document root path outputted by grep in Step 1, including in aliases or rewrites. You will also want to update these to reflect the new document root location.\n\nWhen youâve made all of the necessary changes, save and close the file.\n\nStep 3 â Restarting Nginx\n\nOnce youâve finished making the configuration changes, you can restart Nginx and test the results.\n\nFirst, make sure the syntax is correct:\n\nsudo nginx -t\n\nIf everything is in order, it should return:\n\nOutput\n\nnginx: the configuration file /etc/nginx/nginx.conf syntax is ok nginx: configuration file /etc/nginx/nginx.conf test is successful\n\nIf the test fails, track down and fix the problems.\n\nOnce the test passes, restart Nginx:\n\nsudo systemctl restart nginx\n\nWhen the server has restarted, visit your affected sites and ensure theyâre working as expected. Once youâre comfortable that everything is in order, donât forget to remove the original copy of the data:\n\nsudo rm -Rf /var/www/your_domain/html\n\nYou have now successfully moved your Nginx document root to a new location.\n\nConclusion\n\nIn this tutorial, we covered how to change the Nginx document root to a new location. This can help you with basic web server administration, like effectively managing multiple sites on a single server. It also allows you to take advantage of alternative storage devices such as network block storage, which can be helpful in scaling a web site as its needs change."
    }
}