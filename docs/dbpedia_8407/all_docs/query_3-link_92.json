{
    "id": "dbpedia_8407_3",
    "rank": 92,
    "data": {
        "url": "https://www.nature.com/articles/s41597-023-02282-0",
        "read_more_link": "",
        "language": "en",
        "title": "Population, land use and economic exposure estimates for Europe at 100 m resolution from 1870 to 2020",
        "top_image": "https://media.springernature.com/m685/springer-static/image/art%3A10.1038%2Fs41597-023-02282-0/MediaObjects/41597_2023_2282_Fig1_HTML.png",
        "meta_img": "https://media.springernature.com/m685/springer-static/image/art%3A10.1038%2Fs41597-023-02282-0/MediaObjects/41597_2023_2282_Fig1_HTML.png",
        "images": [
            "https://pubads.g.doubleclick.net/gampad/ad?iu=/285/sdata.nature.com/article&sz=728x90&c=352465410&t=pos%3Dtop%26type%3Darticle%26artid%3Ds41597-023-02282-0%26doi%3D10.1038/s41597-023-02282-0%26subjmeta%3D159,2808,4111,689,704,706%26kwrd%3DEconomics,Geography,Natural+hazards",
            "https://media.springernature.com/full/nature-cms/uploads/product/sdata/header-87021870c315c48063927b82055c12bc.svg",
            "https://media.springernature.com/w215h120/springer-static/image/art%3A10.1038%2Fs41597-022-01209-5/MediaObjects/41597_2022_1209_Fig1_HTML.png",
            "https://media.springernature.com/w215h120/springer-static/image/art%3A10.1038%2Fs41597-023-02323-8/MediaObjects/41597_2023_2323_Fig1_HTML.png",
            "https://media.springernature.com/w215h120/springer-static/image/art%3A10.1038%2Fs41597-022-01675-x/MediaObjects/41597_2022_1675_Fig1_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41597-023-02282-0/MediaObjects/41597_2023_2282_Fig1_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41597-023-02282-0/MediaObjects/41597_2023_2282_Fig2_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41597-023-02282-0/MediaObjects/41597_2023_2282_Fig3_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41597-023-02282-0/MediaObjects/41597_2023_2282_Fig4_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41597-023-02282-0/MediaObjects/41597_2023_2282_Fig5_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41597-023-02282-0/MediaObjects/41597_2023_2282_Fig6_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41597-023-02282-0/MediaObjects/41597_2023_2282_Fig7_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41597-023-02282-0/MediaObjects/41597_2023_2282_Fig8_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41597-023-02282-0/MediaObjects/41597_2023_2282_Fig9_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs41597-023-02282-0/MediaObjects/41597_2023_2282_Fig10_HTML.png",
            "https://pubads.g.doubleclick.net/gampad/ad?iu=/285/sdata.nature.com/article&sz=300x250&c=-2136773093&t=pos%3Dright%26type%3Darticle%26artid%3Ds41597-023-02282-0%26doi%3D10.1038/s41597-023-02282-0%26subjmeta%3D159,2808,4111,689,704,706%26kwrd%3DEconomics,Geography,Natural+hazards",
            "https://www.nature.com/static/images/logos/sn-logo-white-ea63208b81.svg",
            "https://www.nature.com/static/images/logos/nature-briefing-logo-n150-white-d81c9da3ec.svg",
            "https://verify.nature.com/verify/nature.png",
            "https://www.nature.com/77un4tpd/article/s41597-023-02282-0"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": "2023-06-08T00:00:00",
        "summary": "",
        "meta_description": "Understanding the influence of climate change on past extreme weather impacts is a vital research task. However, the effects of climate change are obscured in the observed impact data series due to the rapid evolution of the social and economic circumstances in which the events occurred. The HANZE v2.0 (Historical Analysis of Natural HaZards in Europe) dataset presented in this study quantifies the evolution of key socioeconomic drivers in Europe since 1870, namely land use, population, economic activity and assets. It consists of algorithms to reallocate baseline (2011) land use and population for any given year based on a large collection of historical subnational- and national-level statistics, and then disaggregate data on production and tangible assets by economic sector into a high-resolution grid. Raster datasets generated by the model enable reconstructing exposure within the footprint of any extreme event both at the time of occurrence and anytime between 1870 and 2020. This allows the separation of the effects of climate change from the effects of exposure change.",
        "meta_lang": "en",
        "meta_favicon": "/static/images/favicons/nature/apple-touch-icon-f39cb19454.png",
        "meta_site_name": "Nature",
        "canonical_link": "https://www.nature.com/articles/s41597-023-02282-0",
        "text": "Overview\n\nHANZE v2.0 is a dataset of historical exposure generated through operations on a large number of input raster data. A summary of the workflow to compute the dataset is presented in Fig. 1. The starting point is a set of high-resolution rasters with data on population and land cover/use for a specific benchmark year. Those “baseline” datasets were created from 100-m resolution data, except population, which was disaggregated from a 1-km resolution (see subsection ‘Baseline datasets’). The model modifies the baseline raster datasets by redistributing land cover/use and population until they match the total population and area of different land-use classes defined per subnational administrative unit for each timestep. For each such unit, we collected aggregate socioeconomic statistics (‘Input socioeconomic data’). Various land-use types (urban, industrial, agriculture etc.) are modelled using different methods and several auxiliary static raster datasets (‘Population and land-use model’). Based on land-use changes, the soil sealing dataset is modified. Finally, the model disaggregates statistical data on gross domestic product (GDP) and fixed asset stock into a 100-m grid, based on the distribution of population and different land-use types (‘Economic data disaggregation’). The model is applied using data covering 42 countries and territories over the period 1870–2020 (see Supplementary Fig. S1).\n\nBaseline datasets\n\nFour baseline datasets are a set of raster layers covering the study area, closely aligned in the temporal dimension, converted from their native resolutions to a 100 m grid and adjusted to a single land mask based on Corine Land Cover (Table 2).\n\nLand cover/use, soil sealing degree\n\nThe baseline land cover/use is taken from Corine Land Cover (CLC) 2012, version 20u1 (https://land.copernicus.eu/pan-european/corine-land-cover/clc-2012), with open sea and some transitional waters removed. The CLC 2012 dataset was created, in general, by manual classification of land cover patches from satellite imagery collected during 2011–2012. The inventory consists of 44 classes and the minimum size of areal phenomena captured is 25 hectares. For linear features (roads, railways, rivers etc.), a minimum width of 100 m is used. The CLC dataset doesn’t cover Andorra, hence a compilation of land use data from other sources was carried over from HANZE v1.0 for Andorra (see section 2.1 in Paprotny et al.32).\n\nIn many places natural land cover was replaced by artificial impervious surfaces. This impermeable cover has a significant impact on hydrological properties of a given area and, consequently, on flood frequency and intensity. It is also an important predictor of asset distribution. The baseline soil sealing dataset in our model is the Imperviousness Density 2012 dataset from Copernicus Land Monitoring Service (https://land.copernicus.eu/pan-european/high-resolution-layers/imperviousness/status-maps/2012). It was created by algorithmic classification of high-resolution satellite images with a calibrated normalised difference vegetation index (NDVI). The native resolution of the dataset is 20 m, but we aggregated it to 100 m for consistency with the land cover dataset.\n\nPopulation\n\nThe baseline population dataset is based on the GEOSTAT population grid for the year 2011, version 2.0.1 (https://ec.europa.eu/eurostat/web/gisco/geodata/reference-data/population-distribution-demography/geostat). This dataset has a 1 km resolution and is based on the results of the 2011 round of European population censuses. 95% of the population in the dataset is the actual enumerated and georeferenced during the census, with the remaining population disaggregated from detailed subnational census returns by the European Commission Joint Research Centre. As in HANZE v1.0, we disaggregate this dataset further to a 100 m grid by combining methods “M1” and “M3” described in Batista e Silva et al.37. “M1” denotes the ‘limiting variable method’ used in cartography for creating dasymetric maps of population density. Briefly, it ranks land use classes according t their average population density, then redistributes population above a land use-specific threshold from less-dense to more-dense classes. The procedure is an iterative algorithm applied separately for each 1 km grid cell. This procedure is as follows:\n\nFirstly, uniform population density is assigned for each land use class in a 1 km grid cell:\n\n$${Y}_{LG}^{0}={Y}_{G}=\\frac{{X}_{G}}{{S}_{G}}$$\n\n(1)\n\nwhere \\({Y}_{LG}^{0}\\) is the population density for land use \\(L\\in \\{1,\\ldots ,n\\}\\) in grid cell G at step 0, YG is the population density in the grid cell, i.e. population number XG divided by area SG.\n\nA population density threshold TL is defined for each one of n land use classes.\n\nLand use classes are ranked and the subindex L is renumbered from lowest to highest population density, i.e. L = 1 denotes the least densely population land use class in the grid cell\n\nProceeding in order starting with L = 1, in step L the density attributed to class L in the previous step is modified if it is above the threshold, i.e. if \\({Y}_{LG}^{L-1} > {T}_{L}\\). That creates a surplus population \\({U}_{LG}^{L}\\):\n\n$${U}_{LG}^{L}={S}_{LG}\\times \\left({Y}_{LG}^{L-1}-{T}_{L}\\right)$$\n\n(2)\n\nSurplus is then redistributed among the remaining land use classes M, hence:\n\n$${Y}_{LG}^{L}={T}_{L}$$\n\n(3)\n\n$${Y}_{MG}^{L}={Y}_{MG}^{L-1}+\\frac{{U}_{LG}^{L}}{\\sum {S}_{MG}},M > L$$\n\n(4)\n\nIf after completing all iterations there is still surplus population, i.e. if \\({X}_{G} > \\sum {T}_{L}{S}_{LG}\\), it is redistributed proportionally to the threshold:\n\n$${Y}_{LG}=\\frac{{T}_{L}{X}_{G}}{\\sum {T}_{L}{S}_{LG}}$$\n\n(5)\n\nThe crucial aspect of this method is defining the thresholds TL. Here, we use thresholds as suggested by Eicher and Brewer38, i.e. the 70th percentile of the population density of grid cells for which only one land use class was reported in our baseline land use dataset. Such “pure” cells constituted around 5% of all population grid cells. Gallego et al.39 have shown that a different definition of thresholds works slightly better for Europe; however, the authors used population data by communes, which are not used here, and which their method would require in combination with gridded data. The final thresholds TL are shown in Table 3. For artificial surfaces other than urban fabric, the CLC classes were merged for the threshold calculation, as very few, if any, “pure” cells could be found for each of those classes. Also, for all areas covered by wetlands, water, sand, glaciers, bare rocks or burnt vegetation the threshold was set at 0, as those terrains are in principle uninhabitable.\n\nAs an additional limitation, only those land use classes in a given cell were used, which contained any man-made structures of particular kind. Three remote-sensing gridded datasets (100 m resolution) where used here; if no land use class in a cell possessed any structures from the first dataset, the second was used, then third if necessary, as follows:\n\n1.\n\nBuildings;\n\n2.\n\nImpervious surfaces;\n\n3.\n\nRoads and streets.\n\nBuildings and streets were obtained from European Settlement Map 2012 Release 2017 (https://land.copernicus.eu/pan-european/GHSL/european-settlement-map/esm-2012-release-2017-urban-green) and impervious surfaces from Imperviousness Density 2012. If no structures were present in the 1 km cell (as they were not detected in the satellite images), all land use classes were utilized.\n\nThe result of the calculation, however, is only the population per land use L in each 1 km grid cell G. Hence, the population had to be disaggregated further, and for that we used an approach similar to method M3. This method redistributes the population proportionally to the density of man-made structures. This variable has a range from 0%, which indicates completely natural surface, and 100%, which indicates land completely sealed by an artificial surface. The three datasets were used, primarily buildings from the European Settlement Map (ESM) 2012. If no buildings were indicated in a 1 km cell, imperviousness was used instead. In case no soil sealing was detected, roads and streets from ESM 2012 are used. This can happen mainly because ESM 2012 combined remote sensing data with multiple other sources (e.g. OpenStreetMap, European Union’s Urban Atlas and Tom Tom’s Tele Atlas), while Imperviousness Density 2012 is entirely a remote-sensing based product.\n\nESM and Imperviousness datasets have very high native resolutions (2.5 and 20 m, respectively). The version aggregated to 100-meter resolution was used for the disaggregation, while for computing the dependency between surface density and population was determined using data further resampled to a 1 km grid. In the process, average population density in grid cells with given artificial surface density could be calculated. The resulting dependencies can be approximated as power functions (Supplementary Fig. S2). Very few cells had very high average % of surface covered by structures, hence the functions were computed from values ranging from 1% to 16% (roads and streets), 64% (buildings) and 84% (impervious surfaces). Hence, the population Xg in 100-meter grid cell g is equal to:\n\n$${X}_{g}=\\frac{{Z}_{g}}{\\sum {Z}_{g}}{Y}_{LG}{S}_{LG}$$\n\n(6)\n\nwhere Zg is the population of grid cell g obtained from the power function divided by maximum population:\n\n$${Z}_{g}=\\frac{B{V}_{g}^{A}}{8000}$$\n\n(7)\n\nwhere Vg is the imperviousness in grid cell g. The maximum population was defined as 8000 as all three datasets reached peak population density around this value. The parameters A and B are indicated in Table 4.\n\nThe population Xg is rounded, as population numbers need to be integers. Consequently, the population was added or subtracted by iteratively reducing population numbers in 100-meter cells starting with cells in which the smallest change in unrounded value would change the rounded value. In some cases, more than one 100-meter cell had equal values and the 1-km population couldn’t be matched. Then, population was added or subtracted by iteratively reducing population numbers by 1 at a time starting with 100-meter cells with the highest population. If again there were cases of multiple cells of equal values, 100-meter cells with higher % of area covered by structures were used. If no data was available or the % values were the same, the population is added or subtracted randomly within the equal cells.\n\nExample results of disaggregating the population for a single GEOSTAT grid cell is presented in Fig. 2.\n\nAdministrative boundaries\n\nThe HANZE v2.0 model redistributes population, land cover/use and economic variables separately for each subnational administrative unit (hereafter, “regions”). Administrative boundaries change frequently within countries over time. Rather than changing the definitions of regions at each timestep of the model, we adjust historical statistical data to a single benchmark classification. European Union’s classification of subnational units, the Nomenclature of Territorial Units for Statistics (NUTS), version 2010, is used in HANZE v2.0. The most detailed level of the classification, NUTS level 3 is applied. For this study we prepared a new, high-resolution vector dataset of NUTS regions due to the low precision and non-permissive licence of the semi-official NUTS map available through Eurostat (https://ec.europa.eu/eurostat/web/gisco/geodata/reference-data/administrative-units-statistical-units). We compiled the new dataset using only openly-available data from national geospatial agencies and OpenStreetMap40 (Table 5), with manual corrections of interregional boundaries made where necessary for alignment with NUTS 2010 classification. delineation of the coast in the original source datasets was adjusted to align it to the baseline CLC dataset. Further, as Kosovo and Bosnia and Herzegovina are not currently covered by NUTS, we artificially coded their administrative divisions in a manner consistent with the NUTS system. Finally, the vector dataset was converted into a 100 m raster grid. Our study’s domain contains 1422 regions in total. As noted, the input historical statistics that drive the model were recomputed where necessary to match our high-resolution map of NUTS regions.\n\nInput socioeconomic data\n\nThe input database of historical socioeconomic statistical data was created by revising the data from HANZE v1.0. It contains data on the main socioeconomic drivers of exposure at regional level. The variables of the database are listed in Table 6. Further it contains fixed asset stock relative to GDP in six sectors, defined at country level. The database was compiled from 375 different sources (compared with 271 in HANZE v1.0): websites and publications of national statistical institutes and international agencies, working papers of national banks and economic research institutes, and academic research papers, dating from 1872 to present. Detailed information on the source of every single data point in the database, and transformations made to adjust data to NUTS version 2010 are described within the Excel datasets (see ‘Data Records’). The data was compiled every decade from 1870 to 1950, every 5 years until 2000 and annually until 2020. Compared to HANZE v1.0, the main changes are: improvement in the quality of data through inclusion of more data sources (Supplementary Fig. S3); addition of new countries (Albania, Bosnia and Herzegovina, Kosovo, Montenegro, North Macedonia and Serbia); addition of consumer durables (goods used by households for several years) as a category of fixed assets through integration of data and methods from Paprotny et al.41,42; addition of forest land cover data for the whole study area.\n\nPopulation and land-use model\n\nThe general approach, as noted in the introduction, is to modify the baseline population and land cover/use raster dataset for every timestep. This is done sequentially for different CLC classes and population groups (regional, urban, rural), so that a class that is modified in a given step doesn’t alter those that were modelled beforehand. The modelling steps are as follows:\n\n1.\n\nSpecial cases (Dutch polders)\n\n2.\n\nSub-regional population redistribution\n\n3.\n\nUrban fabric and urban population redistribution\n\n4.\n\nAirports and reservoirs\n\n5.\n\nRural population redistribution\n\n6.\n\nIndustrial or commercial units\n\n7.\n\nRoad/railway sites\n\n8.\n\nConstruction sites\n\n9.\n\nOther artificial land\n\n10.\n\nCroplands and pastures\n\n11.\n\nBurnt areas\n\n12.\n\nNatural areas\n\n13.\n\nSoil sealing degree adjustment\n\nA summary of the modelling approach, and the rationale is explained, per land cover/use class from the CLC dataset, in Supplementary Table 1. It also highlights that artificial land use, though constitutes 5% of total land area, contains about 90% of population and fixed asset value, therefore the reconstruction of past exposure is largely limited to those areas. Detailed information is provided in the following subsections, as referenced in the numbered list above. It should be noted that the methodology is a refinement of methods largely used already in Paprotny et al.32.\n\nSpecial case (Dutch polders)\n\nThe model includes one special case, due to its influence on exposure distribution in the Netherlands. The Zuiderzeewerken was a large-scale land-reclamation and flood-protection project, which resulted in the construction of large dikes and polders in the Zuiderzee between the 1920s and 1970s (Supplementary Fig. S4). Zuiderzee was closed in 1932 by a large dike, turned into a lake and further split in 1975 into IJsselmeer and Markermeer. Cities, infrastructure and farmland were created on the reclaimed land, mainly in the province of Flevoland. It has a population of more than 400,000 today, but before 1942 it consisted only of the small island town of Urk and the uninhabited island of Schokland (the province itself was only established in 1986). Therefore, all artificially-created land is removed from the land cover/use raster and turned into inland water (CLC 512) for years before the year of completion of individual Dutch polders. The population is also removed and not considered in the population and land-use redistribution for those years, hence this modelling step is done before all others.\n\nSub-regional population redistribution\n\nSubstantial redistribution of population within European countries occurred in modern times. Here, we model sub-regional (i.e. below NUTS3 level) population change for 1870–2020 based on empirical observations from a dataset of population change between 1961 and 2011 at the level of local administrative units (LAUs). We created the dataset for this study by merging tabular and spatial data produced in various years that is available through Eurostat43 and national statistical institutes (https://www.stat.gov.mk/OblastOpsto_en.aspx?id=2, https://www.stat.gov.rs/en-us/oblasti/stanovnistvo/, https://ec.europa.eu/eurostat/web/gisco/geodata/reference-data/administrative-units-statistical-units/communes). Details on how the data were created and their visualisation is provided in Supplementary Text S1. Population trends for around 109,000 LAUs indicate:\n\nDeclining population in urban cores that are the most centrally located and densely populated parts of cities\n\nRapid growth of suburban zones around urban cores\n\nDeclining population of rural areas\n\nThe first two changes are largely driven by the change in number of persons per household. Even when the population of a city is stagnant, smaller families in each dwelling result in an increased demand for housing. Those extra dwellings had to be constructed mostly outside the urban cores, where the supply of housing is largely fixed. It has been shown44,45,46 that this trend has been present in major European cities since the early 19th century, flattening the population density curve in relation to the distance from the city centres. At the same time, migration from rural to urban areas has reduced population in rural areas and exacerbated the growth of suburbs.\n\nHere, we model the rate of change of population within each NUTS3 region, where total population is defined by historical statistics, using the empirical relationship between population density and historical rates of change. To capture the uncertainty of the correlation, we use copulas that correlate population density from LAU data with population growth are applied (Fig. 3). A copula is, loosely, a joint distribution on the unit hypercube with uniform (0,1) margins. There are many types of copulas47, and we chose the optimal parametric copulas for this analysis by comparing different copulas using the “Blanket Test” based on Cramèr–von Mises statistic discussed by Genest et al.48. Due to the very different patterns of population change and high- and low-density LAUs, we use two copulas:\n\na Gaussian copula using data from LAUs with population density below 1500 persons per km2 that correlates population density from LAU data with population growth (Spearman’s r = 0.69)\n\na Frank copula using data from LAUs with a population density above 1500 persons per km2 that correlates “agglomeration density” with population growth (Spearman’s r = −0.36).\n\nThe “agglomeration density” per LAU is the average of the kernel density computed with the 1 km GEOSTAT population grid and a 10-km radius. Therefore, it indicates the size of the agglomeration that a high-density LAU is part of. This “agglomeration density” is a better predictor of population change than population density of individual LAUs. Only LAUs from NUTS3 regions with at least 10 LAUs were included to quantify the copulas to avoid using large, heterogenous LAUs. The threshold of 1500 persons per km2 for copula selection gave the best results in validation. Coincidentally, but unsurprisingly, it is also the threshold used to define high-density population clusters by Eurostat49, and in turn to classify LAUs as urban.\n\nThe LAUs from the Eurostat dataset applied here do not have complete coverage, have lower geometric accuracy than our NUTS3 vector dataset, and the size of LAUs varies substantially between countries. Therefore, a set of “virtual” LAUs (hereafter, “VLAUs”) was constructed. Every VLAU consists of an urban patch from Corine Land Cover 2012 and its nearest neighbourhood (Supplementary Fig. S5). Disaggregated population in 100 m resolution was then assigned to each VLAU to compute population density. For each timestep in the model, the copulas are sampled 10,000 times to obtain an estimate of annual population growth (geometric average of 50-year growth rate). The population of a VLAU in year t and 2011 is then:\n\n$${P}_{t,VLAU}={P}_{2011,VLAU}{(1+A)}^{2011-t}$$\n\n(8)\n\nwhere A is the annual growth rate (in %) from the copula model. To avoid unrealistic changes, mainly for areas with very low population density, population growth is capped: −2.257% <A< 1.6464%, which corresponds to a 10-fold decline or 25-fold increase between 1870 and 2011. The analysis is done separately for each NUTS region, covering VLAUs or their parts located within a given region. After the population of all VLAUs was computed for a given NUTS region, the difference between the combined population of VLAUs and the population of the NUTS region in a given year as defined in the historical statistics is corrected by the same factor (relative to population) for every VLAU. The computation is done separately for urban and rural areas, i.e. those covered by urban fabric and all others, respectively. The share of urban population in each NUTS3 region is determined by the historical statistics.\n\nUrban fabric and urban population redistribution\n\nThe population redistributed at sub-regional level is further adjusted spatially, separately for urban and rural areas. Assuming fixed supply of housing in already built-up areas, the population change in urban areas and expansion of those areas (i.e. urban fabric, or CLC classes 111 and 112) is driven by change in the total number of urban households. As the population has grown but the average number of persons per household has declined throughout Europe since the 19th century, the demand for housing increased substantially. The movement of population to the edges of cities (suburbanization) is accompanied by the reduction of population density in the urban “cores” where a similar number of households contains a declining population stock. This process of flattening population distribution as a logarithmic function of distance from urban cores was quantified by Clark44 and many subsequent studies45,46.\n\nBy taking the total urban population U and average number of persons per household H (household size) from our historical statistics we can compute the total number of urban households Nt = Ht/Ut in year t for every region. We simulate how the increase in Nt has caused urban fabric to expand through construction of new housing and related infrastructure in previously undeveloped areas. In rare cases, within recent years, there has been a decline in urban households over time. This so far has led to dwellings becoming vacant rather than a contraction of the area of the urban fabric.\n\nThe modelling operates by modifying, for a given timestep t, the population per urban fabric grid cell P2011 defined in the baseline population grid. This is done separately and independently for each VLAU, where the total baseline urban population is \\({U}_{2011}=\\sum {P}_{2011}\\). The aim of this modelling step is to generate a new population grid, where \\(\\sum {P}_{2011}\\) matches Ut, which in turn is the total urban population of a VLAU in timestep t. Ut is defined beforehand for each VLAU, as it is a proportional adjustment to the total population of all VLAUs in a given NUTS3 region, calculated already in section S2.2, to the total urban population of a NUTS3 region defined in the historical statistics. We therefore know the expected urban population in a VLAU and have to modify the population grid to reproduce the historical changes in the size of the urban population and change of their distribution within the cities. Changes in household size are taken from historical statistics at NUTS3 level. The procedure is done stepwise:\n\n1.\n\nIn every urban fabric grid cell in a VLAU, the grid-cell population P in year t is modified relative to the 2011 baseline to account for change in household size:\n\n$${P}_{t}={P}_{2011}\\frac{{H}_{t}}{{H}_{2011}}$$\n\n(9)\n\nwhere H is the average household size, determined for each NUTS3 region;\n\n2.\n\nAll grid cells in a region are ranked by distance from urban centres (explained further in the text), where the highest-ranked cells are the closest to any urban centre.\n\n3.\n\nSurplus population St is calculated:\n\n$${S}_{t}={U}_{2011}\\frac{{H}_{t}}{{H}_{2011}}-{U}_{t}$$\n\n(10)\n\nwhere \\({U}_{t}=\\sum {P}_{t}\\) is the total urban population in the VLAU. The modelling ends here if St = 0, but that is almost never the case. St is usually positive or negative, and indicates how many persons, after adjusting the population grid to the household size of historical level Ht, have to be removed or added to the grid in order to match the historical total population Ut. Depending on whether a year before or after the baseline is modelled, four combinations of St and t could be discerned, as indicated in Table 7.\n\nIn the two cases A and B, i.e. St > 0, t < 2011 and St < 0, t > 2011, the number of households, and therefore extent of urban areas, expanded over time. For timesteps before 2011 this means that some of the urban fabric has to be removed from the baseline land cover/use raster dataset (case A), while for timesteps after 2011 more urban fabric has to be added (case B). The changes in grid-cell population P will depend on the distance from urban centres d. The distance from urban centres used here is a weighted average of different measures of population centres (“combined distance”) in order to capture the multiple levels of hierarchy existing in urban networks. Five different datasets were tested and, based on a calibration process explained in the Supplementary Text S2 (the same as in Paprotny et al.32), four of those datasets were selected for the combined distance from urban centres. The datasets and their weights are as follows:\n\nArbitrary centres of large agglomerations (more than 300,000 persons in 2018) and capital cities from United Nation’s 2018 Revision of World Urbanization Prospects (https://population.un.org/wup/), with a weight of 1.0\n\nCentroids of high-density population clusters44, with a weight of 1.5\n\nCentroids of cities included in the Urban Atlas 201844, with a weight of 2.0\n\nCentroids of Corine Land Cover 2012 urban patches, with a weight of 0.5.\n\nThe combined distance is computed per each grid cell. Then, the modelling continues depending on the case:\n\nCase A: urban grid cells are iteratively removed going backwards from the base year 2011 starting with the lowest-ranked (i = 1), and their population is reduced by proportion D:\n\n$${P}_{t,i}={P}_{t,0}D$$\n\n(11)\n\nProportion D is based on the logarithm of distance from urban centres d in hectometres:\n\n$$D=\\left(1-\\frac{ln\\left(d\\right)}{ln\\left(\\arg \\;{\\rm{\\max }}\\left\\{d\\right\\}\\right)}\\right)$$\n\n(12)\n\nAt each iteration the surplus is reduced by the amount of population redistributed:\n\n$${S}_{t,i}={S}_{t,i-1}-{P}_{t,0}(1-D)$$\n\n(13)\n\nThe calculation continues until St,i = 0. However, if at any iteration there is more population in grid cell(s) than remaining surplus, i.e.:\n\n$$\\sum {P}_{t,0}(1-D)={S}_{t,i-1}$$\n\n(14)\n\nthe population is reduced by the available amount, split proportionally to grid cell population if there are more cells with the same rank:\n\n$${P}_{t,i}={P}_{t,0}\\left(1-\\frac{{S}_{t,i-1}}{\\sum {P}_{t,0}}\\right)$$\n\n(15)\n\nCase B: cells where urban expansion most likely took place are identified using the land-use transition model described in step 10, starting with cells with the highest probability of transition. If more cells were given the same likelihood of transition to urban fabric than necessary to assign the additional population, the cells within that group were ranked according to distance from the urban centre. The population in the highest-ranked cells, i.e. iteration i = 1, is set to the maximum population per grid cell in the VLAU, reduced by proportion D from Eq. 12:\n\n$${P}_{t,i}=\\arg \\;{\\rm{\\max }}\\left\\{{P}_{t,0}\\right\\}D$$\n\n(16)\n\nAt each iteration the surplus is increased by the amount of population redistributed:\n\n$${S}_{t,i}={S}_{t,i-1}+{P}_{t,i}-{P}_{t,0}$$\n\n(17)\n\nThe calculation continues until St,i = 0. However, if at any iteration there is more population to be redistributed than the available surplus, i.e.:\n\n$$\\sum {P}_{t,i}-{P}_{t,0} > -{S}_{t,i-1}$$\n\n(18)\n\nthe surplus is distributed equally between all cells that were modified until this iteration (denoted n):\n\n$${P}_{t,i}^{{\\prime} }={P}_{t,i}\\left(1-\\frac{{S}_{t,n-1}}{\\sum {P}_{t,i}}\\right),i=\\left\\{1,\\ldots ,n\\right\\}$$\n\n(19)\n\nIf there are no available empty grid cells in the VLAU, the population of all urban grid cells is increased proportionally in the same way as in Eq. 19.\n\nCase C and D: in those cases, the number of households declined over time, as some dwellings became vacant. The urban area remained unchanged, as urban fabric is not removed bar from very extreme cases. Before 2011, the population in all urban grid cells was added to the grid (case C), while after 2011, removed (case D). The population was increased/decreased proportionally to the population in a given grid cell in 2011 (as in Eq. 19).\n\nModelling the redistribution of population in urban areas is intertwined with change in urban fabric area. In cases A and B, the urban area changes as a result of the growth in urban household number, in contrast to cases C and D, where the urban fabric is kept unchanged. As urban fabric is closely related with high population density, urban fabric grid cells are only removed from (case A) or added to (case B) the baseline dataset if the changes to population density is large enough. Consequently, urban fabric is removed in timesteps before baseline year 2011 only if the population in a grid cell was reduced to less than 9 persons. For timesteps after 2011, only an increase of population to more than 81 per 100 m grid cell resulted in transition to an urban fabric class. Both thresholds were obtained by calibrating the model to match the magnitude of change observed in the CLC inventories (2000–2018). Between 2000 and 2012, urban fabric expanded by almost 1.88 million ha, while between 2012 and 2018 only by 98,676 ha, according to the CLC data. By setting the population thresholds through calibration, the model correctly represents the effect of urban population change on land-use type. As shown in the results, the calibration was effectively applicable back to the year 1900.\n\nAirports and reservoirs\n\nAirports and reservoirs are large elements of infrastructure that first appeared within this study’s timeframe. As the period of construction of those is usually well known and their number relatively small, they are removed or added to the baseline raster dataset based on the year of construction. We identified 1598 airports and 1121 large reservoirs (Fig. 4) in the study area by combining CLC datasets (CLC classes 124 and 512) with global databases of those objects (https://www.globaldamwatch.org/grand and https://ourairports.com/data/) and supplemented by web-based research of their history. Though HANZE v1.0 also included such data, due to the addition of new countries, the use of a revised CLC dataset and updates to the global airport and reservoir databases, we recompiled the data on airports and reservoirs from scratch. An airport or reservoirs that is removed from the baseline dataset enables other land-use types to fill the resulting empty space. An addition of such an object after 2011 removes any population that was present there in 2011.\n\nRural population redistribution\n\nRural population is recalculated separately for each VLAU, by adjusting the grid cell baseline population proportionally to its value, so that it equals the expected population in that area. For years before the baseline, areas from which urban fabric was removed are still considered urban for the purpose of this calculation. For years after the baseline, rural population in areas that transitioned to urban fabric is no longer considered rural, hence the adjustment is made only to remaining rural cells in the VLAU.\n\nAs the population is always recorded as integers, a discrepancy might arise from adjusting the population in grid cells and then rounding it. Therefore, the adjusted population in grid cells is first rounded using “floor” function, and then the grid cells with the highest remainders from dividing the unrounded values by 1 are rounded using “ceiling” function. The number of highest remainders is determined by the difference between the expected population in the VLAU and the total population of cells adjusted and rounded using “floor” function.\n\nIndustrial or commercial units\n\nThe area covered by large industrial/commercial facilities (CLC class 121) was assumed to change proportionately to GDP generated in a NUTS3 region by industry and services. Industrial grid cells located furthest from the centroids of industrial land use patches are removed first when going back in time. For timesteps after the baseline year, industrial grid cells closest to the centroids are added first. Industrial land use is only allowed to spread into uninhabited cells of some CLC classes: construction sites (133), agricultural (211–244) and certain natural areas (311–324 and 333). However, growth in GDP from industry and services is only partially driven by expansion of facilities, as the productivity of capital and labour tends to increase. Indeed, CLC 121 class has grown between 2000 and 2018 (based on CLC 2012 and CLC-Changes) by 16% in the study area, but GDP from industry and services increased by 32%. Therefore, the change in GDP from industry/services is scaled by an elasticity of 0.45, so that modelled changes between 2000–2018 in the study area have the same magnitude as observed in the CLC inventory. The industrial area A in region r and year t is as follows:\n\n$${A}_{r,t}={A}_{r,2011}{\\left(\\frac{{G}_{r,t}}{{G}_{r,2011}}\\right)}^{\\varepsilon }$$\n\n(20)\n\nwhere ε is the elasticity and Gr is the regional GDP from industry/services according to the historical statistics at NUTS3 level.\n\nRoad and railway sites\n\nThe area covered by roads and railways (CLC class 122) before 2000 was assumed to change proportionately to the length of motorways and railways. Historical data on the length of this type of infrastructure was included in the input database. As infrastructure was built firstly in large urban and industrial zones, infrastructure grid cells (CLC class 122) located furthest from the urban centres are removed first when going back in time until the total area per region matches the value in the database. Conversely, grid cells closest to the urban centres are filled with infrastructure for timesteps after the baseline year. Infrastructure is allowed to spread only to particular CLC classes: construction sites (133), agricultural (211–244) and certain natural (311–324 and 333). However, construction sites were prioritised over other CLC classes; all ‘construction’ grid cells have to be used up before other CLC classes can be considered. The reason is that, apart from urban fabric or industrial sites already considered in previous steps, road and railway sites are the most frequent outcomes of construction activity. We found this pattern in the transitions of land-use in subsequent CLC inventories (2000–2018): almost half of the area of construction sites in the CLC inventory that transitioned to class other urban fabric or industrial sites (considered in previous steps) transitioned to infrastructure by the time of the next 6-year inventory.\n\nConstruction sites\n\nConstruction sites (CLC class 131) are by definition a temporary land use, typically for only a few years. The CLC inventory shows that 76–81% of construction sites transition to another land use during the 6-year periods between CLC datasets (2000–2006, 2006–2012, 2012–2018). Therefore, for years 2005–2011, their area was assumed constant, while for years 1870–2004 all construction sites were removed from the dataset. After 2011 they were allowed to transition into urban fabric, industrial sites, roads, railways, and airports (CLC 111–122 and 124), but otherwise kept unchanged.\n\nOther artificial land\n\nGreen urban areas, sport and leisure facilities (CLC classes 141 and 142) are closely related to other artificial surfaces. Almost two-thirds of those CLC patches border either urban fabric, industrial sites, road/railway sites, or airports in the CLC 2012 inventory. Therefore, those patches of CLC classes 141 and 142 which bordered CLC classes 111–122 and 124 in the baseline dataset are removed if in a given timestep, if they do not border CLC classes 111–122 and 124 anymore due to application of previous modelling steps. Ports, mineral extraction, and dump sites (CLC classes 123, 131 and 132) are large elements of infrastructure like airports and reservoirs, but they are too numerous (almost 15,000 objects) and their history less traceable to apply the same approach as for airports. Therefore, they were kept constant at every time step and they did not interact with other land use classes, except in relation to polder (step 1) or reservoir (step 4) construction.\n\nAgricultural land\n\nThe general concept of modelling changes of agricultural land was taken from HYDE50 dataset, i.e. local suitability for agriculture determines where this land-use class expands (most-suitable of available land first) and contracts (least-suitable falls into disuse first). Evolution in agricultural areas and increase in urban fabric after the baseline year was computed using a model utilizing a Bayesian Network (BN) that combines probability theory and graph theory in order to build and operate a joint distribution. The BN is trained with the CLC-Changes dataset, which records 1.2 million transitions involving patches of land larger than 5 ha, and CLC 2012 identifying land-use types that didn’t transition between 2000 and 2018. The CLC-Changes and CLC 2012 inventory were sampled to obtain 513,915 cases of transition and an equal number of land-use patches being stable between 2000 and 2018. For each location, information from different raster datasets were extracted as predictors of land-use changes: elevation and slope from EU-DEM51 dataset (https://ec.europa.eu/eurostat/web/gisco/geodata/reference-data/elevation/eu-dem/eu-dem-laea, agricultural suitability from Global Agro-Ecological Zoning (GAEZ) version 4 database (https://gaez-data-portal-hqfao.hub.arcgis.com/) and population dataset from steps 2 and 3. The sampling procedure and a list of all tested predictors is described in the Supplementary Text S3.\n\nAs the land use information is categorical, a discrete BN was used. Land-use classes were collected into 5 bins (urban fabric, other artificial, croplands, pastures, natural). The bin with natural land excludes non-utilizable land cover types (CLC 331–332, 334–335, 421–523), which are not allowed to interact with either artificial or agricultural land use. The BN model was constructed iteratively, starting with a simple three-node network, where the “old” land-use class is the parent of the “new” land-use class, and a single predictor variable is the parent of both land-use nodes. More complex BNs with more predictors were respectively validated against a disjunct subset of samples of transitions and non-transitions not used for training (see Supplementary Text S3 for sampling procedure and ‘Technical Validation’ for the final validation results). Iteratively, the best predictors, number of predictors and numbers of bins (into which continuous variables were discretized) were selected. Three predictors were chosen, all of which are parents of the two land-use nodes (Fig. 5):\n\nPopulation density per VLAU – 9 bins;\n\nSuitability index for wheat: output density (potential production divided by total grid cell area) for wheat under rainfed conditions and high input level – 5 bins;\n\nSuitability index for grass: agro-climatic potential yield for grass with an available water content of 200 mm/m (under irrigation conditions) and high input level – 10 bins.\n\nThe two agricultural suitability indices are from the GAEZ database, based on 1971–2000 climate. As the BN is quantified with a conditional probability table (CPT), this configuration results in the CPT having 11,250 cells. Therefore, no more variables were added to avoid too few data points quantifying cells of the CPT.\n\nFigure 6 shows an example of application of the Bayesian Network. In this case, we know the present-day land use (croplands) and that in some earlier timestep the total area of croplands in a NUTS3 region was lower than at present. Therefore, we want to know the probability that land-use was different from croplands across the grid cells located in the region. Figure 6a shows an area that was most likely a cropland before as well, due to relatively high population density and good suitability for agriculture. The area in Fig. 6b has lower suitability, which indicates a much higher probability that the area was used for other purposes than cropland. Consequently, the area in Fig. 6b will be ranked higher than area in Fig. 6a when selecting which grid cells of croplands will be removed from the raster dataset in order to match the total cropland area with historical statistical data.\n\nThe trained BN is used to generate probabilities of land-use transitions in nine cases, as follows:\n\nfrom non-urban to urban after the baseline year;\n\nfrom non-cropland to cropland after the baseline year;\n\nfrom non-pasture to pasture after the baseline year;\n\nfrom cropland to non-cropland after the baseline year;\n\nfrom pasture to non-pasture after the baseline year;\n\nfrom non-cropland to cropland before the baseline year;\n\nfrom non-pasture to pasture before the baseline year;\n\nfrom cropland to non-cropland before the baseline year;\n\nfrom pasture to non-pasture before the baseline year.\n\nAs noted in section 2.4.3, the BN handles the case of non-urban to urban transition after 2011. When the housing needs of the population result in expansion of cities, areas with the highest probability of transition from non-urban to urban land-use are build-up first. The BN is used in the same way for the remaining eight cases related to agriculture, i.e. they determine in which agricultural areas to add or remove so that the total area of croplands and pastures in the land cover/use raster dataset for a given time step matches the values obtained from historical statistics per NUTS3 region. This is done iteratively starting with patches of land with the highest probability of transition between given classes (e.g. non-pasture to pasture). Cropland redistribution is modelled first, then pasture is redistributed in the second step. Land still occupied by croplands after the first step cannot transition to pasture. However, land emptied by redistribution of croplands in the first step can transition to pasture in the second step.\n\nWe need to model transitions backward in time for timesteps before 2011. We partially remove urban fabric or roads/railways sites in case they occupied less land in the past and create an empty space, which croplands can occupy. Forward in time, it is a cropland to non-cropland transition. The probability of transition that is used to determine which cells to fill with croplands is the probability that a non-cropland cell was a cropland before. The same applies to pastures, with the condition that they cannot occupy cells already assigned to cropland. Transition of artificial surfaces still remaining at this step of the model to agricultural land-use is not allowed.\n\nIn the iterative land-use redistribution process, the number of grid cells with equal probability of transition might exceed the number of cells that need to be converted to match the total area in the historical statistics. This often happens as the predictors (GAEZ dataset and population density by VLAU) have relatively coarse resolution together with a small number of bins in which the data is divided. In order to derive exact 100-m grid cells from patches of land of equal probability, another predictor of agricultural suitability was added. Slope of the terrain is an important predictor, also used in the two agricultural suitability indices from FAO. It is available in the target (100 m) resolution as a continuous quantity from the EU-DEM elevation dataset. Lower slope indicates better suitability for agricultural activity, therefore 100 m cells of equal probability of transition are ranked according to the slope from lowest to highest. The appropriate number of highest-ranked cells is added/removed so that the total area of croplands or pastures exactly matches the total area in the historical statistics.\n\nNatural areas\n\nNatural areas contain less than 1% of population and fixed assets, therefore limited modelling is done for those classes. Areas where vegetation has burned down (typically forests) are by definition a temporary land use. Burnt areas are very short-lived: almost none of the land cover patches in this class (CLC 334) in 2012 were present in either 2006 or 2018 CLC inventories. For years 2007–2017, burnt area was assumed constant, while for years 1870–2006 and 2018–2020 all burnt areas were removed from the dataset. As almost all burnt areas are formerly or subsequently CLC classes 311–324, this modelling step is done after redistributing agricultural areas. Still, there is no exposure in burnt areas, and very little exposure in preceding land-use, except for rare cases.\n\nNatural areas are what remains after modelling artificial, agricultural and burnt areas as well as reservoirs and special cases. Natural areas would cover the entire continent without human activity. Therefore, if land becomes unoccupied as a result of the modelling, it is assigned the same natural land cover that is typical in its nearest neighbourhood. Typical natural vegetated land cover (classes CLC 311–324 and 411–422) is defined as the most frequently occurring one within the VLAU. The calculation is done separately for forests (CLC 311–313) and other natural land (CLC 321–324 and 411–422), and the more frequent of the two groups is used. If there is no natural cover in the VLAU, the dominant vegetated land cover of the applicable NUTS3 region is used. If no vegetated land cover was located in the NUTS3 region, the unoccupied land was assumed to be covered by transitional woodland-shrub (CLC 324), as it is the most common non-forest natural land in the study area.\n\nAfter the first allocation, the total area of forests is compared with the historical data in the NUTS3 database. If there is too much forest area in a given NUTS3 region, the land that was allocated to forest in this step is iteratively converted into the most frequent non-forest class, starting with the most-densely populated VLAU. Conversely, if there is not enough forest land, cells that were allocated to non-forest vegetation in this step are iteratively converted into the most frequent forest class, starting with the least-densely populated VLAU.\n\nAll other natural land, without vegetation and usually prohibitive to construction or agriculture, i.e. beaches, dunes, sands (CLC 331), bare rocks (CLC 332), glaciers and perpetual snow (CLC 335), intertidal flats (CLC 423), and water (CLC 511–523), were kept constant throughout. Patches of those types of land cover are removed from the dataset only in connection to reservoir (step 4) or polder construction (step 1).\n\nSoil sealing degree adjustment\n\nChanges in soil sealing are entirely based on land-use transitions, therefore this step is carried out after land-use modelling, but before economic data disaggregation. Soil sealing in the baseline raster dataset is increased to the average value for a given CLC class (Table 8) when non-artificial land transitions to artificial, unless it is already higher than that value. For the backward in time calculation for timesteps before 2011, wherever land that is currently artificial is changed to agricultural, the degree of soil sealing is reduced alongside to 1%. Similarly, it is reduced to 0% in cases when agricultural or artificial land is changed to natural land.\n\nEconomic data disaggregation\n\nThe disaggregation of economic data follows dasymetric mapping methods, similar to applied in European52 or global53 studies, including HANZE v1.0. Several revisions to the latter were introduced (Table 9). Regional GDP is split partially proportionally to population and partially according to land-use (with soil sealing where appropriate). In this way, both labour (part of the total population) and capital (connected to land-use) input to GDP is represented. Labour share of GDP in advanced countries is about 60% and has been relatively stable over time54. Hence, 60% of GDP is disaggregated according to population and the remaining 40% using land use. Fixed assets in absolute terms per region are computed by multiplying regional GDP, or a sector thereof, by the respective wealth-to-GDP ratio for each sector, as defined by variables “Fixed assets” (Table 6). Housing and consumer durables are distributed according to total population, as they are most closely related to population distribution. Other assets, related to economic activities, are distributed to appropriate land use classes, proportionally to the degree of soil sealing. Finally, infrastructure is distributed to urban and industrial land (CLC classes 111–121) proportionally to the area covered by roads and streets, and to roads/railways, ports, and airports (CLC classes 122–124) proportionally to the degree of soil sealing.\n\nThere are also additional assumptions on disaggregation of GDP and wealth for two sectors. Agricultural sector encompasses farming, fishing and forestry, while the industrial sector includes mining, manufacturing, and utilities. A detailed breakdown of those subsectors is not available at regional level for GDP, or at all for fixed assets, except for a small number of countries. Hence the regional GDP and wealth from forestry and mining was estimated by computing “efficiency indices” at national level. The forestry index was compiled by computing GDP from agriculture (without forestry) at national level per ha of agricultural land from CLC and GDP from forestry per ha of forest land. Those values were computed for the year 2000 for all countries and presented as efficiency of the forest economy relative to other agriculture in %. This ratio was used to compute the relative share of forestry in regional GDP in any given year based on land cover/use modelled for that year:\n\n$${G}_{f,r,t}={G}_{af,r,t}\\frac{{A}_{f,r,t}{E}_{f,c}}{\\left({A}_{a,r,t}+{A}_{f,r,t}{E}_{f,c}\\right)}$$\n\n(21)\n\nwhere G is GDP, A is area covered by land cover/use in a particular sector, Ec is the efficiency index for country c. The forest sector is denoted by f, agricultural sector (without forestry) by a, NUTS3 region by r and timestep by t. Agricultural GDP without forestry is therefore:\n\n$${G}_{a,r,t}={G}_{af,r,t}-{G}_{f,r,t}$$\n\n(22)"
    }
}