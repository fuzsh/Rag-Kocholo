{
    "id": "dbpedia_8307_0",
    "rank": 46,
    "data": {
        "url": "http://www.sthda.com/english/wiki/beautiful-dendrogram-visualizations-in-r-5-must-known-methods-unsupervised-machine-learning",
        "read_more_link": "",
        "language": "en",
        "title": "Beautiful dendrogram visualizations in R: 5+ must known methods",
        "top_image": "http://www.sthda.com/english/logo_200px_fb_sharing.png",
        "meta_img": "http://www.sthda.com/english/logo_200px_fb_sharing.png",
        "images": [
            "http://www.sthda.com/english/images/stats/countries/fr.png",
            "http://www.sthda.com/english/images/stats/countries/uk.png",
            "http://i.creativecommons.org/l/by-nc-sa/3.0/fr/88x31.png",
            "http://www.sthda.com/english/wiki/wiki_mini.png",
            "http://www.sthda.com/english/wiki/wiki_mini.png",
            "http://www.sthda.com/english/wiki/wiki_mini.png",
            "http://www.sthda.com/english/wiki/wiki_mini.png",
            "http://www.sthda.com/english/wiki/wiki_mini.png",
            "http://www.sthda.com/english/upload/r-graphics-essentials-cookbook-200.png",
            "http://www.sthda.com/english/upload/practical-guide-to-cluster-analysis-in-r.jpg",
            "http://www.sthda.com/english/sthda-upload/images/principal-component-methods-cover-200px.png",
            "http://www.sthda.com/sthda/RDoc/images/3d-graphic-cover.png",
            "http://www.sthda.com/english/web/web_mini.png",
            "http://www.sthda.com/english/web/web_mini.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-plot-hierarchical-clustoring-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-plot-hierarchical-clustoring-2.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-plot-dendrogram-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-plot-dendrogram-2.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-plot-dendrogram-3.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-prolt-dendrogram-customize-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-prolt-dendrogram-customize-2.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-prolt-dendrogram-customize-3.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-phylogenetic-trees-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-phylogenetic-trees-2.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-phylogenetic-trees-3.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-phylogenetic-trees-4.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-phylogenetic-trees-5.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-phylogenetic-trees-6.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-phylogenetic-trees-7.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-ggdendrogram-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-ggdendrogram-2.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-ggplot2-dendrogram-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-simple-dendrogram-dendextend-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-change-labels-dendrogram-dendextend-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-change-labels-dendrogram-dendextend-2.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-change-labels-dendrogram-dendextend-3.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-change-dendrogram-nodes-leaves-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-change-dendrogram-nodes-leaves-2.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-change-dendrogram-nodes-leaves-3.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-color-branches-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-color-branches-2.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-dendrogram-add-rectangle-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-dendrogram-add-rectangle-2.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-annotating-items-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-ggplot2-dendrogram-2-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-dendrogram-ggplot2-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-dendrogram-ggplot2-2.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-dendrogram-ggplot2-3.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-dendrogram-ggplot2-4.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-pvclust-1.png",
            "http://www.sthda.com/sthda/RDoc/figure/clustering/dendrogram-visualization-pvclust-2.png",
            "http://www.sthda.com/english/upload/machine-learning-essentials-frontcover-200px.png",
            "http://www.sthda.com/english/upload/practical-guide-to-cluster-analysis-in-r.jpg",
            "http://www.sthda.com/english/sthda-upload/images/principal-component-methods-cover-200px.png",
            "http://www.sthda.com/english/upload/r-graphics-essentials-cookbook-100.png",
            "http://www.sthda.com/english/upload/network-analysis-and-visualization-in-r-200px.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "Statistical tools for data analysis and visualization",
        "meta_lang": "en",
        "meta_favicon": "/english/logo.png",
        "meta_site_name": "",
        "canonical_link": null,
        "text": "Home\n\nExplorer\n\nBeautiful dendrogram visualizations in R: 5+ must known methods - Unsupervised Machine Learning\n\nA variety of functions exists in R for visualizing and customizing dendrogram. The aim of this article is to describe 5+ methods for drawing a beautiful dendrogram using R software.\n\nWe start by computing hierarchical clustering using the data set USArrests:\n\n# Load data data(USArrests) # Compute distances and hierarchical clustering dd <- dist(scale(USArrests), method = \"euclidean\") hc <- hclust(dd, method = \"ward.D2\")\n\n1 plot.hclust(): R base function\n\nAs you already know, the standard R function plot.hclust() can be used to draw a dendrogram from the results of hierarchical clustering analyses (computed using hclust() function).\n\nA simplified format is:\n\nplot(x, labels = NULL, hang = 0.1, main = \"Cluster dendrogram\", sub = NULL, xlab = NULL, ylab = \"Height\", ...)\n\nx: an object of the type produced by hclust()\n\nlabels: A character vector of labels for the leaves of the tree. The default value is row names. if labels = FALSE, no labels are drawn.\n\nhang: The fraction of the plot height by which labels should hang below the rest of the plot. A negative value will cause the labels to hang down from 0.\n\nmain, sub, xlab, ylab: character strings for title.\n\n# Default plot plot(hc)\n\n# Put the labels at the same height: hang = -1 plot(hc, hang = -1, cex = 0.6)\n\n3 Phylogenetic trees\n\nThe package ape (Analyses of Phylogenetics and Evolution) can be used to produce a more sophisticated dendrogram.\n\nThe function plot.phylo() can be used for plotting a dendrogram. A simplified format is:\n\nplot(x, type = \"phylogram\", show.tip.label = TRUE, edge.color = \"black\", edge.width = 1, edge.lty = 1, tip.color = \"black\")\n\nx: an object of class “phylo”\n\ntype: the type of phylogeny to be drawn. Possible values are: “phylogram” (the default), “cladogram”, “fan”, “unrooted” and “radial”\n\nshow.tip.label: if true labels are shown\n\nedge.color, edge.width, edge.lty: line color, width and type to be used for edge\n\ntip.color: color used for labels\n\n# install.packages(\"ape\") library(\"ape\") # Default plot plot(as.phylo(hc), cex = 0.6, label.offset = 0.5)\n\n# Cladogram plot(as.phylo(hc), type = \"cladogram\", cex = 0.6, label.offset = 0.5)\n\n# Unrooted plot(as.phylo(hc), type = \"unrooted\", cex = 0.6, no.margin = TRUE)\n\n# Fan plot(as.phylo(hc), type = \"fan\")\n\n# Radial plot(as.phylo(hc), type = \"radial\")\n\n# Cut the dendrogram into 4 clusters colors = c(\"red\", \"blue\", \"green\", \"black\") clus4 = cutree(hc, 4) plot(as.phylo(hc), type = \"fan\", tip.color = colors[clus4], label.offset = 1, cex = 0.7)\n\n# Change the appearance # change edge and label (tip) plot(as.phylo(hc), type = \"cladogram\", cex = 0.6, edge.color = \"steelblue\", edge.width = 2, edge.lty = 2, tip.color = \"steelblue\")\n\n4 ggdendro package : ggplot2 and dendrogram\n\nThe R package ggdendro can be used to extract the plot data from dendrogram and for drawing a dendrogram using ggplot2.\n\n4.1 Installation and loading\n\nggdendro can be installed as follow:\n\ninstall.packages(\"ggdendro\")\n\nggdendro requires the package ggplot2. Make sure that ggplot2 is installed and loaded before using ggdendro.\n\nLoad ggdendro as follow:\n\nlibrary(\"ggplot2\") library(\"ggdendro\")\n\n4.2 Visualize dendrogram using ggdendrogram() function\n\nThe function ggdendrogram() creates dendrogram plot using ggplot2.\n\n# Visualization using the default theme named theme_dendro() ggdendrogram(hc)\n\n# Rotate the plot and remove default theme ggdendrogram(hc, rotate = TRUE, theme_dendro = FALSE)\n\n4.3 Extract dendrogram plot data\n\nThe function dendro_data() can be used for extracting the data. It returns a list of data frames which can be extracted using the functions below:\n\nsegment(): To extract the data for dendrogram line segments\n\nlabel(): To extract the labels\n\n# Build dendrogram object from hclust results dend <- as.dendrogram(hc) # Extract the data (for rectangular lines) # Type can be \"rectangle\" or \"triangle\" dend_data <- dendro_data(dend, type = \"rectangle\") # What contains dend_data names(dend_data)\n\n## [1] \"segments\" \"labels\" \"leaf_labels\" \"class\"\n\n# Extract data for line segments head(dend_data$segments)\n\n## x y xend yend ## 1 19.771484 13.516242 8.867188 13.516242 ## 2 8.867188 13.516242 8.867188 6.461866 ## 3 8.867188 6.461866 4.125000 6.461866 ## 4 4.125000 6.461866 4.125000 2.714554 ## 5 4.125000 2.714554 2.500000 2.714554 ## 6 2.500000 2.714554 2.500000 1.091092\n\n# Extract data for labels head(dend_data$labels)\n\n## x y label ## 1 1 0 Alabama ## 2 2 0 Louisiana ## 3 3 0 Georgia ## 4 4 0 Tennessee ## 5 5 0 North Carolina ## 6 6 0 Mississippi\n\ndend_data can be used to draw a customized dendrogram using ggplot2:\n\n# Plot line segments and add labels p <- ggplot(dend_data$segments) + geom_segment(aes(x = x, y = y, xend = xend, yend = yend))+ geom_text(data = dend_data$labels, aes(x, y, label = label), hjust = 1, angle = 90, size = 3)+ ylim(-3, 15) print(p)\n\n5 dendextend package: Extending R’s dendrogram functionality\n\nThe package dendextend contains many functions for changing the appearance of a dendrogram and for comparing dendrograms.\n\nIn this section we’ll use the chaining operator (%>%) to simplify our code.\n\n5.1 Chaining\n\nThe chaining operator (%>%) turns x %>% f(y) into f(x, y) so you can use it to rewrite multiple operations such that they can be read from left-to-right, top-to-bottom. For instance, the results of the two R codes below are equivalent.\n\nStandard R code for creating a dendrogram:\n\ndata <- scale(USArrests) dist.res <- dist(data) hc <- hclust(dist.res, method = \"ward.D2\") dend <- as.dendrogram(hc) plot(dend)\n\nR code for creating a dendrogram using chaining operator:\n\ndend <- USArrests[1:5,] %>% # data scale %>% # Scale the data dist %>% # calculate a distance matrix, hclust(method = \"ward.D2\") %>% # Hierarchical clustering as.dendrogram # Turn the object into a dendrogram. plot(dend)\n\n5.2 Installation and loading\n\nInstall the stable version as follow:\n\ninstall.packages('dendextend')\n\nLoading:\n\nlibrary(dendextend)\n\n5.3 How to change a dendrogram\n\nThe function set() can be used to change the parameters with dendextend.\n\nThe format is:\n\nset(object, what, value)\n\nobject: a dendrogram object\n\nwhat: a character indicating what is the property of the tree that should be set/updated\n\nvalue: a vector with the value to set in the tree (the type of the value depends on the “what”).\n\nPossible values for the argument what include:\n\nValue for the argument what Description labels set the labels labels_colors and labels_cex Set the color and the size of labels, respectively leaves_pch, leaves_cex and leaves_col set the point type, size and color for leaves, respectively nodes_pch, nodes_cex and nodes_col set the point type, size and color for nodes, respectively hang_leaves hang the leaves branches_k_color color the branches branches_col, branches_lwd , branches_lty Set the color, the line width and the line type of branches, respectively by_labels_branches_col, by_labels_branches_lwd and by_labels_branches_lty Set the color, the line width and the line type of branches with specific labels, respectively clear_branches and clear_leaves Clear branches and leaves, respectively\n\n5.4 Create a simple dendrogram\n\n# Create a dendrogram and plot it dend <- USArrests[1:5,] %>% scale %>% dist %>% hclust %>% as.dendrogram dend %>% plot\n\n# Get the labels of the tree labels(dend)\n\n## [1] \"Alaska\" \"Arizona\" \"California\" \"Alabama\" \"Arkansas\"\n\n5.5 Change labels\n\nThis section describes how to change label names as well as the color and the size for labels.\n\n# Change the labels, and then plot: dend %>% set(\"labels\", c(\"a\", \"b\", \"c\", \"d\", \"e\")) %>% plot\n\n# Change color and size for labels dend %>% set(\"labels_col\", c(\"green\", \"blue\")) %>% # change color set(\"labels_cex\", 2) %>% # Change size plot(main = \"Change the color \\nand size\") # plot\n\n# Color labels by specifying the number of cluster (k) dend %>% set(\"labels_col\", value = c(\"green\", \"blue\"), k=2) %>% plot(main = \"Color labels \\nper cluster\") abline(h = 2, lty = 2)\n\nIn the R code above, the value of color vectors are too short. Hence, it’s recycled.\n\n5.6 Change the points of a dendrogram nodes/leaves\n\n# Change the type, the color and the size of node points # +++++++++++++++++++++++++++++ dend %>% set(\"nodes_pch\", 19) %>% # node point type set(\"nodes_cex\", 2) %>% # node point size set(\"nodes_col\", \"blue\") %>% # node point color plot(main = \"Node points\")\n\n# Change the type, the color and the size of leave points # +++++++++++++++++++++++++++++ dend %>% set(\"leaves_pch\", 19) %>% # node point type set(\"leaves_cex\", 2) %>% # node point size set(\"leaves_col\", \"blue\") %>% # node point color plot(main = \"Leaves points\")\n\n# Specify different point types and colors for each leave dend %>% set(\"leaves_pch\", c(17, 18, 19)) %>% # node point type set(\"leaves_cex\", 2) %>% # node point size set(\"leaves_col\", c(\"blue\", \"red\", \"green\")) %>% #node point color plot(main = \"Leaves points\")\n\n5.7 Change the color of branches\n\nThe color for branches can be controlled using k-means clustering:\n\n# Default colors dend %>% set(\"branches_k_color\", k = 2) %>% plot(main = \"Default colors\") # Customized colors dend %>% set(\"branches_k_color\", value = c(\"red\", \"blue\"), k = 2) %>% plot(main = \"Customized colors\")\n\nIt’s also possible to use the function color_branches().\n\n5.8 Adding colored rectangles\n\nClusters can be highlighted by adding colored rectangles. This is done using the rect.dendrogram() function (modeled based on the rect.hclust() function). One advantage of rect.dendrogram over rect.hclust, is that it also works on horizontally plotted trees:\n\n# Vertical plot dend %>% set(\"branches_k_color\", k = 3) %>% plot dend %>% rect.dendrogram(k=3, border = 8, lty = 5, lwd = 2) # Horizontal plot dend %>% set(\"branches_k_color\", k = 3) %>% plot(horiz = TRUE) dend %>% rect.dendrogram(k = 3, horiz = TRUE, border = 8, lty = 5, lwd = 2)\n\n5.9 Adding colored bars\n\nThis is useful for annotating the items in the clusters:\n\ngrp <- c(1,1,1, 2,2) k_3 <- cutree(dend,k = 3, order_clusters_as_data = FALSE) # The FALSE above makes sure we get the clusters in the order of the # dendrogram, and not in that of the original data. It is like: # cutree(dend, k = 3)[order.dendrogram(dend)] the_bars <- cbind(grp, k_3) dend %>% set(\"labels\", \"\") %>% plot colored_bars(colors = the_bars, dend = dend)\n\n5.10 ggplot2 integration\n\nThe following 2 steps are used:\n\nTransform a dendrogram into a ggdend object using as.ggdend() function\n\nMake the plot using the function ggplot()\n\ndend <- iris[1:30,-5] %>% scale %>% dist %>% hclust %>% as.dendrogram %>% set(\"branches_k_color\", k=3) %>% set(\"branches_lwd\", 1.2) %>% set(\"labels_colors\") %>% set(\"labels_cex\", c(.9,1.2)) %>% set(\"leaves_pch\", 19) %>% set(\"leaves_col\", c(\"blue\", \"red\")) # plot the dend in usual \"base\" plotting engine: plot(dend)\n\nProduce the same plot in ggplot2 using the function:\n\nlibrary(ggplot2) # Rectangle dendrogram using ggplot2 ggd1 <- as.ggdend(dend) ggplot(ggd1)\n\n# Change the theme to the default ggplot2 theme ggplot(ggd1, horiz = TRUE, theme = NULL)\n\n# Theme minimal ggplot(ggd1, theme = theme_minimal())\n\n# Create a radial plot and remove labels ggplot(ggd1, labels = FALSE) + scale_y_reverse(expand = c(0.2, 0)) + coord_polar(theta=\"x\")\n\n5.11 pvclust and dendextend\n\nThe package dendextend can be used to enhance many packages including pvclust. Recall that, pvclust is for calculating p-values for hierarchical clustering.\n\npvclust can be used as follow:\n\nlibrary(pvclust) data(lung) # 916 genes for 73 subjects set.seed(1234) result <- pvclust(lung[1:100, 1:10], method.dist=\"cor\", method.hclust=\"average\", nboot=10)\n\n## Bootstrap (r = 0.5)... Done. ## Bootstrap (r = 0.6)... Done. ## Bootstrap (r = 0.7)... Done. ## Bootstrap (r = 0.8)... Done. ## Bootstrap (r = 0.9)... Done. ## Bootstrap (r = 1.0)... Done. ## Bootstrap (r = 1.1)... Done. ## Bootstrap (r = 1.2)... Done. ## Bootstrap (r = 1.3)... Done. ## Bootstrap (r = 1.4)... Done.\n\n# Default plot of the result plot(result) pvrect(result)\n\n# pvclust and dendextend result %>% as.dendrogram %>% set(\"branches_k_color\", k = 2, value = c(\"purple\", \"orange\")) %>% plot result %>% text result %>% pvrect\n\n6 Infos\n\nThis analysis has been performed using R software (ver. 3.2.1)\n\nEnjoyed this article? I’d be very grateful if you’d help it spread by emailing it to a friend, or sharing it on Twitter, Facebook or Linked In.\n\nShow me some love with the like buttons below... Thank you and please don't forget to share and comment below!!\n\nAvez vous aimé cet article? Je vous serais très reconnaissant si vous aidiez à sa diffusion en l'envoyant par courriel à un ami ou en le partageant sur Twitter, Facebook ou Linked In.\n\nMontrez-moi un peu d'amour avec les like ci-dessous ... Merci et n'oubliez pas, s'il vous plaît, de partager et de commenter ci-dessous!\n\nRecommended for You!\n\nRecommended for you\n\nThis section contains best data science and self-development resources to help you on your path.\n\nWant to Learn More on R Programming and Data Science?\n\nFollow us by Email\n\nby FeedBurner\n\nOn Social Networks:\n\nGet involved :\n\nClick to follow us on Facebook and Google+ :\n\nComment this article by clicking on \"Discussion\" button (top-right position of this page)\n\nThis page has been seen 515657 times"
    }
}