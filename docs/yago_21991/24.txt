Mozart's The Magic Flute, the last opera he lived to complete, has some of his most sublime and sublimely comic music. Technically, it's more of a musical comedy, what in German is called a Singspiel, a play with songs and spoken dialogue. I was excited to learn that it was filmed by Kenneth Branagh, whose Shakespeare movies I really admire. Mozart's mixture of fairy tale and high morality presents a great opportunity for a filmmaker; in 1975, Ingmar Bergman released a version for Swedish television that has become a beloved classic.

Branagh's film was shown at festivals in 2006, then played in Europe. It's now finally been screened here briefly in theaters and is available on American DVD. Why has it taken so long to get here? Now that I've seen it, I think I know.

The Magic Flute tells the story of Pamina, the beautiful daughter of the Queen of the Night. Pamina has been abducted by the high priest Sarastro, and the queen persuades the brave Tamino to find her. But Sarastro is actually the good guy, rescuing Pamina from the clutches of her evil mother. The most appealing character is the queen's earthy bird-catcher, Papageno, who joins Tamino on his quest.

The main problem with the film is that Branagh updates the setting to a World War I battlefield. It's clever to turn the bird-catcher into a soldier who uses birds to test for poison gas. But the tone is all wrong. This grimly literalistic relocation conflicts with both the fantasy elements of the music and with Mozart's profound spirituality. It's bizarre to have the Queen of the Night singing her flamboyant coloratura entrance aria standing on a tank.

There's one marvelous moment when the screen fills with a creepy image of singing sandbags warning about fate. But the best parts of the film take place away from the battlefield, as when Papageno, desperate to find a girlfriend, rushes toward a pair of luscious, disembodied red lips. And the scene between Papageno and Papagena, the girl of his dreams, has real charm.

It's a good young cast, except for Amy Carson in the role of Pamina. Carson makes a very pretty, almost pre-Raphaelite heroine. But this is one of the most radiantly beautiful soprano roles ever written, and Carson's singing voice is pinched and so often off pitch, it's painful. On the other hand, the best-known singer in the film, the celebrated bass Rene Pape, a famous Sarastro, sings this role magnificently, with the profoundest dignity and warmth.

It doesn't matter that in this movie Pape plays a doctor in a field hospital rather than a high priest. His noble performance, James Conlon's vibrant conducting and the superb Chamber Orchestra of Europe are the main reasons for Mozart lovers to put themselves through this disappointing effort.