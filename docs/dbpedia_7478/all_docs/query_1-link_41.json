{
    "id": "dbpedia_7478_1",
    "rank": 41,
    "data": {
        "url": "https://stackoverflow.com/questions/29513226/wusa-silent-install-error",
        "read_more_link": "",
        "language": "en",
        "title": "wusa silent install error",
        "top_image": "https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded",
        "meta_img": "https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded",
        "images": [
            "https://www.gravatar.com/avatar/9b76d15c4ee46b7aaf6a17f53f5e0897?s=64&d=identicon&r=PG",
            "https://i.sstatic.net/UKIMP.jpg?s=64",
            "https://stackoverflow.com/posts/29513226/ivc/a849?prg=f0e92a56-52e1-4b0f-a24d-f0902ee357a5"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": "2015-04-08T11:22:42",
        "summary": "",
        "meta_description": "I am trying to automate updating Powershell on Windows 7 using Windows6.1-KB2506143-x64.msu, and having a heck of a time. The following code works fine in a standalone ps1 file. And it works in my ...",
        "meta_lang": "en",
        "meta_favicon": "https://cdn.sstatic.net/Sites/stackoverflow/Img/favicon.ico?v=ec617d715196",
        "meta_site_name": "Stack Overflow",
        "canonical_link": "https://stackoverflow.com/questions/29513226/wusa-silent-install-error",
        "text": "I am trying to automate updating Powershell on Windows 7 using Windows6.1-KB2506143-x64.msu, and having a heck of a time. The following code works fine in a standalone ps1 file. And it works in my main ps1 file. But when run from a module it fails with exit code -2145124341. This is in PS v2, where negative exit codes are handled wrong, so that number is perhaps useless, and FWIW I have a good 40 other installers of various types that work from this module. However, this is my first attempt at automating msu files, so maybe there is a known interaction here that I haven't discovered yet? There's thousands of lines of code between the root ps1 file where this works and the module where it doesn't, so tracking down what is triggering the error is going to be a beast without some sort of trail to follow at the very least. So, anyone have an idea where I should start?\n\n$filePath = 'wusa.exe' $argumentList = '\"\\\\PX_SERVER\\Rollouts\\Microsoft\\Windows6.1-KB2506143-x64.msu\" /quiet /norestart' $exitCode = (Start-Process -filePath:$filePath -argumentList:$argumentList -wait -errorAction:stop -passThru).exitCode\n\nAlso, running wusa.exe leaves some detritus in the script folder, but only when it is run from the module. Is this an issue with the msu file, or just a bug in wusa? Or does it point at what is causing the issue perhaps? I had hoped to get this update to work to enable some new features, but between not being able to automate and garbage being left behind, I am very close to abandoning that path and juts continuing to target v2. But hopefully someone can point me in the right direction as that is not my preferred solution at all."
    }
}