{
    "id": "dbpedia_7395_1",
    "rank": 46,
    "data": {
        "url": "https://live.paloaltonetworks.com/t5/general-topics/troubleshooting-tools/td-p/41761",
        "read_more_link": "",
        "language": "en",
        "title": "Troubleshooting tools",
        "top_image": "https://live.paloaltonetworks.com/html/@B09EB55777348FEBBB51B90839A41B20/assets/PAN_Logo_White.png",
        "meta_img": "",
        "images": [
            "https://live.paloaltonetworks.com/html/@3ED993240B214CCB84957D8890090F3C/assets/PANW_Red_BW.png",
            "https://live.paloaltonetworks.com/html/@E5AF36E8ADFF42398AB32C75C8A2488A/assets/LC-logo-BW.png",
            "https://live.paloaltonetworks.com/legacyfs/online/a2830_29.png",
            "https://live.paloaltonetworks.com/t5/image/serverpage/image-id/56579i8E5B9245F1F4F7AB/image-dimensions/40x40/image-coordinates/0%2C0%2C400%2C400?v=v2",
            "https://live.paloaltonetworks.com/html/@0C650A98D0B3763596C3944B862C3352/rank_icons/Trophy.png",
            "https://live.paloaltonetworks.com/legacyfs/online/a2830_29.png",
            "https://live.paloaltonetworks.com/legacyfs/online/a12437_shaun.png",
            "https://live.paloaltonetworks.com/i/smilies/16x16_smiley-happy.png",
            "https://live.paloaltonetworks.com/legacyfs/online/a5037_technophile02.png",
            "https://live.paloaltonetworks.com/legacyfs/online/a2830_29.png",
            "https://live.paloaltonetworks.com/legacyfs/online/a7007_tempImage5637755964019264464.png",
            "https://live.paloaltonetworks.com/legacyfs/online/a2830_29.png",
            "https://live.paloaltonetworks.com/skins/images/7DC91DC60B773465C2A05DD98F1C9800/responsive_peak/images/icon_anonymous_message.png",
            "https://live.paloaltonetworks.com/html/@B09EB55777348FEBBB51B90839A41B20/assets/PAN_Logo_White.png",
            "https://live.paloaltonetworks.com/html/assets/Khoros-awards-2022-2.jpg"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "live.paloaltonetworks.com",
            "user-id"
        ],
        "publish_date": "2014-06-25T14:46:12.670000+00:00",
        "summary": "",
        "meta_description": "I am new to firewalls and new to PA so I really need to find some tools and technique to be able to troubleshoot issues on my PA - 41761",
        "meta_lang": "en",
        "meta_favicon": "https://live.paloaltonetworks.com/html/@AF88D457713207EDCC5EEBCB342CACE0/assets/favicon.ico",
        "meta_site_name": "",
        "canonical_link": "https://live.paloaltonetworks.com/t5/general-topics/troubleshooting-tools/td-p/41761",
        "text": "Here is a good list of CLI commands to help you out:\n\nGeneral system health\n\n· show system info –provides the system’s management IP, serial number and code version\n\n· show system statistics – shows the real time throughput on the device\n\n· show system software status – shows whether various system processes are running\n\n· show jobs processed – used to see when commits, downloads, upgrades, etc. are completed\n\n· show jobs all -show any jobs in progress\n\n· show job id <id#> -to show any warning/error in configuration\n\n· clear job id <id#> -to clear a hung job\n\n· show system disk-space- show percent usage of disk partitions\n\n· show system logdb-quota – shows the maximum log file sizes\n\n· debug dataplane internal vif link – show management interface (eth0) counters\n\n· show system state filter cfg.general.max* - To display the System Limits for objects, profiles, and policies\n\nTo monitor CPUs\n\n· show system resources - shows processes running in the management plane similar to “top” command\n\n· show running resource-monitor – used to see the resource utilization in the data plane, such as dataplane CPU utilization\n\n· less mp-log mp-monitor.log – Every 15 minutes the system runs a script to monitor management plane resource usage, output is stored in this file.\n\n· less dp-log dp-monitor.log - Every 15 minutes the system runs a script to monitor dataplane resource usage, output is stored in this file.\n\nGeneral dropped packet troubleshooting\n\n· ping source <IP_addr_src_int> host <IP_addr_host> - allows to ping from the specified FW source interface\n\n· ping host <IP> - ping from the MGT interface\n\n· show session all | match – used to show specific sessions in the session table. You can enter any text after the word match. A good example would be a source or destination IP or an application\n\n· show session all | filter destination <IP> dest- shows all sessions going to a particular dest IP and port <port>- port\n\n· show session all filter type predict – To show any pin-hole applications (e.g.FTP)\n\n· show session id – shows the specifics behind a particular session by entering the ID number after the word “id”\n\n· show counter interface – shows interface counters\n\n· show counter global | match drop – used to troubleshoot dropped packets\n\n· show counter global delta yes | match [source ip|dest ip| drop | error | frag ] – show counter changes since last time ran this command, filter on particular keyword\n\n· show counter global filter packet-filter yes delta yes – show counter changes since last time ran this command, filter on debug filter\n\n· show counter global filter delta yes – show counter changes since last time ran this command\n\nNAT\n\n· show running nat-policy- shows current NAT policy table\n\n· show running ippool- use to see if NAT pool leak\n\n· test nat-policy-match – simulate traffic going through the device, what NAT policy will it match?\n\nRouting\n\n· show routing route – displays the routing table\n\n· test routing fib-lookup virtual-router <VR_name> ip <IP_addr_trying_reach> - finds which route in the routing table will be used to reach the IP address that you are testing\n\nRouting Debug Commands\n\n· debug routing global on debug\n\n· less mp-log routed.log - To view the log\n\n· tail follow yes mp-log routed.log - To view the log in real time\n\nPolicies\n\n· show running security-policy – shows the current policy set\n\n· test security-policy-match from trust to untrust destination <IP>- simulate a packet going through the system, which policy will it match?\n\nPAN Agent\n\n· show user pan-agent statistics – used to see if the agent is connected and operational. Status should be connected OK and you should see numbers under users, groups and IPs.\n\n· show pan-agent user-IDs - used to see if the FW has pulled groups from the PANAgent\n\n· show user ip-user-mapping – used to see IP to username mappings on the FW\n\n· clear user-cache all – clears the user-ID cache\n\n· debug device-server reset pan-agent <name> - reset the firewall’s connection to the specified agent\n\nURL\n\n· request url-filtering upgrade brightcloud- If URL does not show up on dynamic updates page run this command\n\n· test url <url or IP> – used to test the categorization of a URL on the FW\n\n· tail follow yes mp-log pan_bc_download.log – shows the BrightCloud database update logs\n\n· request url-filtering download status – shows the status of the database download (essentially the very last line from the pan_bc_download.log file)\n\n· debug dataplane show url-cache statistics– shows statistics on the URL cache\n\n· show counter global | match url – shows statistics on URL processing\n\n· clear url-cache – used to clear the URL cache- cache contains 100k of the most popular URLs on this network\n\n· show log url direction equal backward- view the URL log, most recent entries first\n\n· To test connectivity to the BrightCloud servers:\n\no ping host service.brightcloud.com\n\no ping host database.brightcloud.com\n\nLog viewing / deleting\n\n· show log [ system | traffic | threat ] direction equal backward – will take you to the end of the specified log\n\n· show log [ system | traffic | threat ] direction equal forward – will take you to beginning of the specified log\n\n· clear log [ traffic | threat | acc ] – clear everything in the specified log\n\n· show log traffic receive_time in ? - pick a timeframe from the list\n\n· sho log traffic app equal gmail - show only gmail traffic in log\n\nIPSec\n\n· To view detailed debug information for IPSec tunneling:\n\n1. debug ike global on debug\n\n2. less mp-log ikemgr.log\n\n3. test vpn ike-sa gateway <gw_name> - initiates traffic to bring up tunnel\n\n4. show vpn ike-sa gateway <gw_name> - to see if phase 1 is up\n\n5. show vpn ipsec-sa tunnel <tunnel name> - to see if phase 2 is up\n\n6. show vpn flow – to see all active tunnels\n\n7. sho vpn flow <name> or tunnel-id <id#> -to see detailed info on the tunnel\n\nHA\n\n· show high-availability state – shows the HA state of the FW you are on\n\n· show high-availability state-synchronization – shows if the FWs are synced\n\n· show high-availability path-monitoring – shows the status of path monitoring\n\n· request high-availability state suspend – this will suspend active box and make the current passive device active\n\n· request high-availability clear-alarm-led – this will clear the HA failover alarm on the unit\n\nVsys\n\n· set system setting target-vsys <vsys #> -to enter a vsys\n\n· set system setting target-vsys none – to exit a vsys\n\nSoftware, Content, and Licenses\n\n· To upgrade the software on the FW:\n\n1. tftp import software from <IP_addr_tftp_server> file <filename>\n\n2. request system software install file <filename>\n\n3. request restart system\n\n· request system software [info | check | download | install ] –manipulate PANOS software from the CLI\n\n· To upgrade the content on the FW:\n\n1. tftp import content from <IP_addr_tftp_server> file <filename>\n\n2. request content upgrade install file <filename>\n\n· request content downgrade install previous –downgrade to the previous content version\n\n· request system private-data-reset- to clear config and logs/reports\n\n· debug swm [ status | list | revert ] – will show possible code to install, or code that was installed. “revert” is used to revert to last running OS version without having to do a factory reset (such as from 4.0 to back to 3.1)\n\n· request license info – shows the license installed on the device\n\n· delete license key ? – use to delete a license file if having issues and want to retrieve new licenses, use question mark to list file names, only delete the files you see fit\n\nConfig diff/force/cli format\n\n· show config diff- compares two versions of the config\n\n· commit force- perform a commit, even if there are errors\n\n· set cli config-output-format set- use to view the config in “set” format from within the configure prompt (#)\n\nMisc\n\n· set deviceconfig setting session tcp-reject-non-syn no – used to ignore SYN when creating sessions; confirm command took effect with show session info\n\n· set deviceconfig setting session offload no –- makes all packets go through CPU, otherwise all fastpath packets just go through EZ chip (turns off session offload to fastpath); confirm command took effect with show session info\n\n· set deviceconfig setting tcp drop-out-of-wnd <yes|no>; confirm command took effect with show running tcp state\n\n· debug dataplane pool statistics - this will show the different dataplane buffers and can be used to see if the system is nearing capacity in certain functionality.\n\n· show system state filter sys.s(x).p(x).phy -command to see physical media\n\n· set cli pager off - To disable the more function\n\n· delete network interface ethernet ethernet1/x- deletes any setting on the interface\n\n· request system private-data-reset- delete private data but keeps software,content installations\n\n· show system files- to see if FW generated any core-files\n\n· grep mp-log * pattern (what your searching for-name)- to search all logs for a specific word\n\n· less dp0-log brdagent.log- to check to see if you have physical errors on interface\n\n· less dp0-log mprelay.log- to check to see if you have physical errors on interface\n\n· show system state filter-pretty sw.comm.s1.*.session-info | match active- to see number of sessions on each data-plane\n\n·https://x.x.x.x/esp/restapi.esp?type=keygen&user=admin&password=admin – To generate a API key\n\nDebug Commands\n\n· debug dataplane packet-diag show setting - to see if any filters or capture are set\n\n· debug dataplane packet-diag set filter on - to turn on filter\n\n· debug dataplane packet-diag set filter match source x.x.x.x destination x.x.x.x destination-port X file test.pcap\n\n· debug dataplane packet-diag set capture stage <receive,drop,firewall,transmit> file <file name>\n\n· debug dataplane packet-diag set caprture on - to turn capture on\n\n· view-pcap follow yes <filter-pcap,debug-pcap> test.pcap yes- this allows you to view the data real time\n\n· view-pcap filter-pcap <file name>\n\nCLEAN UP COMMANDS:\n\n· debug dataplane packet-diag set capture off - to stop capturing data\n\n· debug dataplane packet-diag set filter off- shut off filter\n\n· delete debug-filter test.pcap - to delete the file\n\nDebug Flow Basic\n\n· debug dataplane packet-diag filter on\n\n· debug dataplane packet-diag set filter source x.x.x.x dest y.y.y.y\n\n· debug dataplane packet-diag set log on\n\n· Generate traffic\n\n· less dp0-log pan_packet_diag.log\n\nCLEAN UP COMMANDS:\n\n· debug dataplane packet-diag clear log log\n\n· debug dataplane packet-diag filter off\n\n· debug dataplane packet-diag set log off"
    }
}