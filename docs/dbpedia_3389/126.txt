‘How I Met Your Mother’ season 8 waxes on with its twenty-second episode of the penultimate season “The Bro Mitzvah,” as Barney's surprise bachelor party quickly underwhelms him, while Robin finds herself stuck at dinner with Barney's mother ('American Horror Story's Frances Conroy), before both situations quickly get out of hand.

Last time’s ‘How I Met Your Mother’ episode “Romeward Bound” saw Lily struggling with the Captain’s (‘Twin Peaks’ Kyle MacLachlan) offer to move her and Marshall to Rome for a year, while Barney and Ted fixated on a mysterious MacLaren’s girl who concealed her body with an oversized coat, so what did tonight’s all-new episode bring? Are we any closer to learning how the final years for Ted, Robin, Barney, Marshall and Lily play out?

Read on for your in-depth recap of everything you need to know about ‘How I Met Your Mother’ season 8 episode 22, “The Bro Mitzvah!”

As Future Ted explains that Barney’s life fell apart on the night of his bachelor party, we see Barney and Robin preparing for dinner with his mother six hours earlier. Barney makes a quick errand to drop off the $5000 catering deposit, but once outside gets hooded and thrown into a van by Marshall and Ted for his surprise bachelor party! Barney expresses his admiration at the surprise, noting that three weeks prior he assumed Marshall and Ted were incapable of delivering a party to remember.

Barney calls Robin to explain that he won’t be able to make the dinner, though Loretta Stinson has already arrived at the restaurant too soon to cancel. The trio finally arrive in Atlantic City for the party, but quickly reveal the festivities consist of little more than a dinky hotel room, beer and drinking games. Barney points out that his “Bro rah” list of “Bro Mitzvah” must-haves clearly doesn’t match any of their party plans, particularly as Ted and Marshall reveal Lily, a balloon-contortionist clown, an appearance by the “wrong” ‘Karate Kid’ Ralph Macchio, and a stripper that turns out to be none other than Quinn (Becki Newton)!

Her life having fallen apart after the engagement, Quinn only agrees to strip if Barney waits in the bathroom, while his friends torment him with suggestions that he and Ralph Macchio have quite a bit in common. Alone and depressed, Barney checks in with Robin, who has been forced to endure all manner of awkward sex talk from Barney’s drunken mother. Taken past his breaking point, Barney calls off the party and leads the entire group in a crowded car-ride back to the city.

On the way back, Barney breaks after Ralph Macchio’s continued taunts about his own bachelor party, veering around to engage in some real gambling. Playing his favorite indecipherable Chinese game, Barney quickly loses the $5000 deposit, and shortly thereafter an $80,000 wager. The group once again drives home in defeat, save for Marshall, whom Barney gave up as collateral.

Upon returning to Barney’s building, Ted grows fed up with Barney’s complaints about the party and storms off. Robin appears outside the building and tells Barney off for abandoning her, growing even more incensed by the presence of Quinn. Finally, Robin renounces the engagement and throws her ring at Barney, returning to the moment of defeat we saw at the outset of the episode. Once Robin turns the corner however, she phones Ted and reunites with Quinn to explain their plan had worked perfectly.

Three weeks earlier, the group lamented that no party they could throw would impress Barney, until Robin realized they could check off his “Bro Mitzvah” list by faking him through the worst party of his life. Robin herself recruited Quinn, Barney’s mother and even the Chinese casino ring to play along with the ruse, while Ted and Marshall argued about their part in the plan.

Back in the present, Marshall awkwardly pretends that the Chinese gangsters have chopped off his hand, and the mobsters drag a terrified Barney up to his apartment. Once upstairs, the entire gang surprises him to reveal the deception of the evening, which Barney quickly shakes off the terror of to admit that he loves. Barney points out that they didn’t fulfill the entire “Bro Mitzvah” list however, having gotten the wrong ‘Karate Kid.’ Just then, the previously mute clown removes his makeup and reveals himself as William Zabka, Barney’s true hero of ‘The Karate Kid,’ who agreed to appear at Robin’s insistence!

Even the "zaniest" of 'How I Met Your Mother' episodes can often achieve redemption in a single fell swoop, as we admit that the antepenultimate episode of the season didn't seem the best place for a caper-style episode. And in truth, aspects of "The Bro Mitzvah" strain credulity (would Robin and Loretta really have gone through that entire scene, or was it meant to be Barney's imagination?), but the turn of the the entire bad party having been a setup felt appropriate for the character, and likely represented the only way to keep Barney's bachelor party within reason of sitcom convention. Not to mention, how could you not love the gleeful insanity of William Zabka having been the clown all-along?

We might have liked a stronger setup to the final episodes of the season, particularly one that helped lay groundwork for whatever narrative device continues the series into the ninth year, but "The Bro Mitzvah" had enough fun and genuine surprise to outweigh the somewhat-lacking story progression.

What say you? Did ‘How I Met Your Mother’s latest “The Bro-Mitzvah” take you by surprise? Do you think it made for a solid entry to the penultimate season? Join us next week for an all-new episode recap of ‘How I Met Your Mother’ season 8's penultimate episode “Something Old” on CBS!