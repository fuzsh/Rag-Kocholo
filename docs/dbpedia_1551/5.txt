© The Authors 2024

1 Introduction

Core-collapse supernovae are important for several facets of astrophysics: they play a key role in the chemical (Edmunds 2017; Thielemann et al. 2018) and dynamical evolution (Smith et al. 2018; Bacchini et al. 2023) of galaxies and they are the progenitors of every binary system observed to date by the LIGO-Virgo-KAGRA collaboration (Abbott et al. 2016b,c,a, 2017d,a,b,c, 2019, 2020b,c,a,d, 2021b,a,a, 2023, 2024). To thoroughly understand core-collapse supernovae and their impact in astrophysics, it is essential to systematically examine the varied outcomes that occur in the final stages of the evolution of massive stars.

In the last decade, the efforts of the modeling community have led to several successful supernova explosions in three-dimensional simulations with state-of-the-art microphysics (Melson et al. 2015a,b; Roberts et al. 2016; Summa et al. 2018; Vartanyan et al. 2019, 2022; Burrows et al. 2019, 2020). Despite recent advances, there are still several open questions and challenges left to tackle in the core-collapse field. The ultimate goal is to simulate a star from the onset of iron-core collapse, through shock revival, until the shock breaks out of the star and self-consistently predicting every aspect of the observables. Reaching this goal will require an improved understanding of the stellar progenitors (Arnett & Meakin 2011; Couch & Ott 2015; Cristini et al. 2017; Jones et al. 2017; Müller et al. 2016), understanding the importance of neutrino oscillations (Izaguirre et al. 2017; Chakraborty et al. 2016; Capozzi et al. 2019; Johns et al. 2020; Chakraborty & Chakraborty 2020; Bhattacharyya & Dasgupta 2021; Capozzi et al. 2020, 2022; Martin et al. 2021; Johns 2023; Xiong et al. 2023a,b; Richers & Sen 2022; Dedin Neto et al. 2023; Liu et al. 2023; Cornelius et al. 2024; Shalgar & Tamborra 2024; Ehring et al. 2023; Akaho et al. 2024), accurate microphysics (Sumiyoshi et al. 2005; Hempel et al. 2012; Fischer et al. 2014; Oertel et al. 2017; da Silva Schneider et al. 2020; Pascal et al. 2022; Suleiman et al. 2023), understanding the impact of rotation and magnetic fields (Kotake et al. 2011; Takiwaki & Kotake 2018; Summa et al. 2018; Jardine et al. 2022; Obergaulinger & Aloy 2021; Bugli et al. 2021; Reichert et al. 2023; Bugli et al. 2023; Buellet et al. 2023), and the ability to accurately simulate all the above-mentioned aspects. The input physics underlying core-collapse supernovae are complex and are subject to active research. Consequently, the underpinning of supernova simulations comes with inherent uncertainty.

On the one hand, state-of-the-art simulations are necessary to move the field forward, and the inclusion of ever more detailed physics in numerical simulations is sure to yield interesting results in the future. On the other hand, the most complex simulations are ill-suited for systematically studying the effects of the uncertainties in the input physics due to the high computational cost. First among the computationally expensive parts of core-collapse simulations is the transport of neutrinos from the optically thick regions of the forming neutron star to the outer layers of the core, from where they freestream out of the progenitor. Simplified neutrino transport methods have the potential to reduce the computational cost of numerical simulations significantly, but accurately tracking the radiation fields is important since neutrinos play a crucial role in the dynamics of core-collapse supernovae. Significant work has therefore been invested into improving the neutrino treatment in supernova simulations. Currently, the state-of-the-art consists of approximate solutions of the energy-dependent Boltzmann equation. Common approaches include moment schemes (O’Connor & Couch 2018b; Melson et al. 2015a; Just et al. 2015; Summa et al. 2018; Vartanyan et al. 2018; Kuroda et al. 2018, 2022; Just et al. 2018; Burrows et al. 2020; Wang & Burrows 2024), flux limited diffusion (Bruenn et al. 2020; Rahman et al. 2019, 2022), fast multi-group transport (Müller & Janka 2015), an improved leakage-equilibration-absorption scheme (Ardevol-Pulpillo et al. 2019), and the isotropic diffusion source approximation (Takiwaki et al. 2014; Pan et al. 2016; Kotake et al. 2018; Matsumoto et al. 2022). Monte Carlo methods (Abdikamalov et al. 2012; Richers et al. 2017; Kato et al. 2020) and solving the full Boltzmann equation (Liebendörfer et al. 2004; Nagakura et al. 2014, 2018, 2019; Iwakami et al. 2020; Harada et al. 2020; Akaho et al. 2021, 2023) has been attempted. However, due to the numerical cost and complexity, neither full Boltz-mann methods nor Monte Carlo methods have been widely adopted in simulations (see Mezzacappa et al. 2020 for a detailed review). Energy-integrated, or gray, schemes are often employed in simulations of binary neutron star mergers (Foucart et al. 2015, 2016; Fujibayashi et al. 2020, 2023; Radice et al. 2022; Hayashi et al. 2022; Zappa et al. 2023; Kiuchi et al. 2023, 2024; Curtis et al. 2024; Radice & Bernuzzi 2023; Schianchi et al. 2024; Foucart 2023). While gray transport methods were used for core-collapse supernovae in the past (Burrows et al. 2000; Fryer & Warren 2004; Scheck et al. 2006), they have largely been abandoned in the continuous effort to improve the neutrino treatment since it was seen as key to solving the supernova problem (producing successful explosions in numerical simulations).

Gray transport is significantly less computationally expensive than energy-dependent neutrino transport, which is an advantage if one wants to perform systematic studies. In this work we develop a gray moment scheme, based on methods commonly used in the binary merger literature (Foucart et al. 2015, 2016), and compare our results to fully energy-dependent neutrino transport. By comparing our gray scheme to a more sophisticated method, we were able to improve several aspects of the original gray transport and achieve good overall agreement between the two approaches. We started by implementing the energy-integrated neutrino transport suggested by Foucart et al. (2015, 2016) into FLASH. We then tested its accuracy, and suggest specific changes based on our test results.

This paper is organized as follows. We first briefly describe the current version of FLASH in Sect. 2. In Sect. 3, we summarize the neutrino transport problem and the method described by Foucart et al. (2016). We present numerical tests of our implementation of the neutrino transport scheme from Foucart et al. (2016) in Sect. 4. In Sect. 5, we present the changes we propose to the original transport scheme. Toward the end of Sect. 5 we present the same tests we initially performed for the scheme Foucart et al. (2016) for our modified method. We then describe the results from several two-dimensional (2D) test simulations in Sect. 6. In Sect. 7, we present the gravitational waves (GWs) and neutrino signals from a simulation utilizing our gray scheme and compare the results to signals from a corresponding simulation with energy-dependent transport. In Sect. 8, we discuss the performance of the gray transport, compared to the energy-dependent transport. Finally, in Sect. 9 we summarize our findings and present our conclusions.

2 FLASH

Our work builds upon the energy-dependent two-moment M1 neutrino transport (Cardall et al. 2013; Shibata et al. 2011) implemented in the FLASH code (O’Connor & Couch 2018b,a). We utilized a modified version of the FLASH framework (version 4; Fryxell et al. 2000), was specifically adapted for core-collapse simulations (Couch 2013; Couch & O’Connor 2014; O’Connor & Couch 2018a). FLASH implements adaptive mesh refinement, solves the Newtonian hydrodynamic equations using a modified general relativistic effective potential (case A in Marek et al. 2006), and evolves three neutrino species: electron neutrinos, electron anti-neutrinos, and a third species collecting all the heavy-lepton neutrinos into one species. Neutrino opacities were generated with the neutrino opacity library NuLib (O’Connor 2015; Sullivan et al. 2016). Heavy-lepton neutrinos are mainly produced in the proto-neutron star (PNS) through pair-production processes, whose rates depend on the distribution function of both neutrinos and anti-neutrinos. Since FLASH evolves a single species for the heavy-lepton neutrinos, the neutrino pair-process reactions are calculated in an approximate way following Burrows et al. (2006). An effective neutrino emission is calculated assuming isotropic emission, no final state blocking, and integrating over the energy of the anti-neutrino. The effective absorption is calculated through Kirchhoff’s law from the effective emissivity. We refer to O’Connor (2015) for details regarding the opacity calculations.

3 Neutrino transport

In the limit of massless neutrinos, the neutrino transport is described by the Boltzmann equation (Lindquist 1966), (1)

Here f = f(xα, pα) is the distribution function of the neutrinos, with xα = (t, xi) and pα representing the four-position and the four-momentum of the neutrinos, respectively. are the Christoffel symbols. The term on the right-hand side of Eq. (1) represents the scattering, absorption and emission of neutrinos (collectively referred to as collision processes). Note the subscript v represents the different neutrino species, in this work we evolve three neutrino species: electron neutrinos (ve), electron anti-neutrinos , and a third species (vx) representing the heavy-lepton neutrinos.

The complete transport problem spans a seven-dimensional phase space, which makes the problem prohibitively expensive to solve numerically. To circumvent this issue, we employ the truncated-moment formalism approximation (Thorne 1980). This formalism simplifies the problem by only evolving the lowest order moments of the Boltzmann equation. The problem is further simplified by integrating over energy and evolving the energy-integrated, or gray, moments.

3.1 Evolution equations

We summarize the method proposed by Foucart et al. (2016), but we refer to the original work for additional details and to O’Connor & Couch (2018a) for details on the M1 neutrino transport implemented in FLASH. Unlike Foucart et al. (2016), we operate within the Newtonian framework. Therefore, our formulation differs slightly from that of Foucart et al. (2016). In Sect. 5, we describe the changes we made to the original scheme by Foucart et al. (2016), but for clarity and to provide a summary of our starting point, we describe the original method below.

By evolving the number density of the neutrinos, in addition to the energy and momentum densities, it is possible to get a local estimate of the average energy of the neutrinos, which facilitates an approximation of the spectral shape of the neutrino spectrum (Foucart et al. 2016).

The evolution equations for the energy density (E), momentum density (Fi), and number density (N) are in the laboratory frame, (2) (3) (4)

Here η represents the energy-integrated emissivity, ηN is the energy-integrated number emissivity, and κN is the energy-averaged number absorption. κH denotes the sum of the energy-averaged absorption (κa) and energy-averaged scattering opacities (κs), κH = κa + κs. The energy-averaged opacities are detailed in Sect. 3.3. The fluid velocity is represented by υi, W is the Lorentz factor, the gravitational potential is denoted with Φ, and the lapse is α = exp(Φ). The terms J and Hµ denote the energy density and momentum density in the fluid rest frame, respectively, and are related to the laboratory variables as follows: (5) (6) (7)

In the above equations, Pij are the second-order moments of the multi-pole expansion, which in the two-moment approach is determined by an analytic closure relation (O’Connor & Couch 2018a).

In Eq. (4), is the number momentum density that we assume takes the form of (8)

where 〈ε〉 is the average neutrino energy and 〈εF〉 is the average energy of the neutrino flux (see Sect. 3.4).

3.2 Neutrino spectrum

The gray scheme of Foucart et al. (2016) is underpinned by the assumption that the neutrinos follow a Fermi-Dirac distribution (9)

where ε represents the neutrino energy, µν is the chemical potential of the neutrinos and is the Tν the neutrino temperature. With the corresponding blackbody intensity (10)

Accurate knowledge of the neutrino temperature is necessary for accurately describing the neutrino spectrum. One approach is to assume that the neutrino temperature is equal to the fluid temperature, but this can lead to errors in regimes where the neutrinos are not in equilibrium with the fluid.

By evolving the number density it is possible to get a better estimate of the neutrino temperature through the average energy of the neutrinos (Foucart et al. 2016), given by (11)

For a blackbody spectrum, the average neutrino energy can be expressed in terms of the neutrino temperature and the ratio of the third-, and second-order Fermi integrals (12)

where ην = µν/T (not to be confused with the emissivity or number emissivity, η or ηN). The Fermi integrals are defined as follows1: (13)

We can then find the neutrino temperature by combining equations Eqs. (11) and (12). In our implementation of the gray scheme, we follow Foucart et al. (2015) and chose the following expression for the chemical potential (14)

where is the chemical potential of the neutrinos assuming equilibrium with the fluid and τ is the optical depth of the neutrinos.

3.3 Neutrino opacities

The energy-integrated neutrino-matter source terms in Eqs. (2)– (4) play an important role in numerical simulations. However, the best choice for these quantities is not immediately obvious. The energy-integrated emissivity, which represents the total amount of neutrinos emitted by the fluid, can be defined as (15)

In the above equation, ρ, Ye, and T represents the density, electron fraction, and temperature of the fluid, respectively. The energy-averaged opacities provide a more complex problem, because the energy average should be weighed by the neutrino spectrum. In other words, in Eqs. (2), and (3), (16)

and (17)

Here Hr is the radial component of the momentum density, which we use because our comparison of the energy-averaged opacities is based on 1D simulations. Consequently, even under the blackbody assumption, it is necessary to know the properties of the radiation field in order to perform the averaging. One approach is to assume that the neutrinos are in equilibrium with the fluid, which means that J ∝ Bν, and define (18)

The equilibrium assumption is denoted by the superscript “eq”. Assuming that the neutrinos are in equilibrium with the fluid works well in the optically thick regions, but less so in the semi-transparent and optically thin regions where the neutrino temperature can significantly differ from the fluid temperature. To account for the difference between the neutrino and fluid temperature, Foucart et al. (2016) proposed to weigh the opacities with the square of the ratio of the two temperatures and set (19)

The correction factor is based on the fact that the opacities typically go as energy squared, in other words, κ ~ ε2. Defining the opacities in terms of Eq. (19) ensures that (20)

in the optically thick regions where the fluid is in equilibrium with the fluid (Tν = T) and consequently guarantees detailed balance.

For the number emissivity and number absorption Foucart et al. (2016) chose (21)

with κa from Eq. (19) and (22)

This definition ensures that neutrinos are in thermal equilibrium with the fluid when the optical depth (due to absorption) is high.

The energy-dependent emissivity, absorption opacity, and scattering opacity used to obtain their gray counterparts were calculated using NuLib (O’Connor 2015; Sullivan et al. 2016). A Python script to generate energy-integrated NuLib tables is available in the NuLib git repository2.

3.4 Neutrino flux energy

To evaluate the number-density flux for the closure of Eq. (4), it is necessary to estimate the flux-weighted average energy in Eq. (8). The flux-weighted average energy is more or less equal to the average energy of the neutrinos in optically thin regions. However, the flux-weighted average energy and the average energy can differ significantly in optically thick regions. The neutrino opacities increase rapidly with energy, and the optical depth is, therefore, lower for low-energy neutrinos. The effect of this energy dependence in the optical depth is that low-energy neutrinos can escape while high-energy neutrinos remain trapped. In other words, the average energy of the neutrino flux can be significantly lower than the average neutrino energy. In regions with high absorption opacity, neutrinos remain in equilibrium with the fluid, and the exact value of flux-weighted average energy is relatively unimportant. On the other hand, the average energy of the neutrino flux in Eq. (8) plays an important role in regions where the scattering opacity is high and the absorption opacity is low (Foucart et al. 2016).

Due to the nature of a gray scheme, an energy-dependent scattering effect can not be fully captured with our approach, but simply ignoring it leads to a severe overestimate of the neutrino energy and underestimates the neutrino number diffusion rate. To obtain an estimate for the flux-weighted average energy Foucart et al. (2016) started from the fact that in the purely diffusive limit, assuming that the opacities go as ε2, one expects (Rosswog & Liebendoerfer 2003) (23)

Based on the expected flux-weighted average energy, Foucart et al. (2016) introduced two new scalars and wrote down a simple equation for modeling the ratio of the flux-weighted average energy and the average neutrino energy: (24)

Here sC represents the fraction of neutrinos that have passed through a significant optical depth. sF is a scalar that allows the average energy of the neutrino flux to be reduced in regions where sC << 1. To ensure that sC goes toward zero in the optically thick region, where the neutrinos are in equilibrium with the fluid, and toward sF in the optically thin regions, where the neutrinos are streaming, one possible choice is (25)

In Eq. (25), s0C is the value at the beginning of the time step and 𝓕 is an estimate for the neutrino number flux. The scalar sF can be defined as follows (26)

The optical depth can be estimated based on the flux factor and a free parameter β as follows: (27)

The approximate neutrino number flux was set to (28)

4 Comparison of Foucart et al. (2016) to energy-dependent transport

To evaluate the accuracy of the original gray scheme, we performed a set of tests in one dimension (1D). The tests were all performed with β = 6 (in Eq. (27)). The choice of β = 6 was based on the recommendations of Foucart et al. (2016) and initial tests which indicated that this value lead to reasonable results. We started by considering the post-bounce evolution of a 30 solar-mass progenitor (Sukhbold et al. 2018) using the SFHo equation of state (EOS; Steiner et al. 2013). The progenitor is first evolved until 20 ms post bounce, using energy-dependent neutrino transport. From that point on, the fluid velocity is set to zero, and the rest of the fluid properties are assumed to be constant in time. Under these conditions, the system settles into a steady state. The results of the hydrostatic simulations are summarized in Table 1, where the first line represents the results from the simulation with fully energy-dependent neutrino transport, the second line shows the results when using the prescription of Foucart et al. (2016), and the last row shows the results of our improved gray transport (which we return to below). The original gray transport shows relatively good agreement with the energy-dependent neutrino transport. The average energies of all neutrino species agree to within ~20% in the two methods. The luminosities of the electron-type neutrinos agree within ~10%, the electron anti-neutrino luminosities agree to ~20%, and the heavy-lepton neutrino luminosities differ by almost 40%. The luminosities in the simulation using the original gray scheme are systematically smaller than those from the simulation with the energy-dependent transport.

O’Connor et al. (2018) compared results from several core-collapse supernova simulation codes. The initial conditions and input physics were carefully controlled to be as equal as possible across all the codes. Comparing 1D simulations of the first 500ms post bounce of a 20 solar mass progenitor, O’Connor et al. (2018) reported good agreement in key diagnostic quantities for all the codes. In Figs. 1–3 we compare our result for the same 20 solar mass progenitor with the results of O’Connor et al. (2018). The results presented in O’Connor et al. (2018) are represented by semitransparent colored lines. The solid purple line shows the results from the simulation with our implementation of the gray transport from Foucart et al. (2016). The luminosities in the simulation with the transport from Foucart et al. (2016) are initially significantly lower than the other simulations but agree better at later times (see Fig. 1). For the electron neutrinos and electron anti-neutrinos, the luminosities remain consistently lower in our test simulation than in the rest of the simulations. The luminosity of the heavy-lepton neutrinos eventually overtakes the luminosities reported in O’Connor et al. (2018) and remains high toward the end of the simulation. The transport of Foucart et al. (2016) leads to average neutrino energies for the electron neutrinos and electron anti-neutrinos that are within ~20% of the values in the rest of the simulations (see the left panel of Fig. 2). Additionally, we see that the average energy of the heavy-lepton neutrinos is ~60% larger compared to the typical value seen in the other simulations (see the right panel of Fig. 2). From Fig. 3, we see that both the PNS radius and the shock radius are significantly larger in the gray simulations compared to the values from the other simulations. The scheme proposed by Foucart et al. (2016) leads to a PNS which is typically 10 km to 20 km larger and a shock radius that is more than 30 km larger than what we expect based on the results of O’Connor et al. (2018).

The 1D tests illustrate that the scheme by Foucart et al. (2016) produces reasonable results, but differs significantly from the energy-dependent transport in terms of PNS properties, shock evolution, and neutrino emission. Consequently, we observe qualitative differences in the dynamical evolution of the 1D simulations with energy-dependent transport and our implementation of the original gray neutrino transport.

5 Improved gray neutrino transport

5.1 Updated neutrino opacities

The choice of energy-averaged neutrino opacities is a natural place to start when investigating the root cause of the discrepancies we observed in our tests. There are two apparent potential issues with the opacities defined by Eq. (19). The accuracy of extrapolating the opacities based on the temperature ratio will decrease as the difference between the neutrino temperature and the fluid temperature increases. Furthermore, Eq. (18) does not account for the fact that the term κH in the evolution equations should be averaged with the neutrino momentum density (see Eq. (17)).

Since the neutrino transport and the hydrodynamics of any given simulations are inherently nonlinear, it can be challenging to construct comparisons that isolate a single component in dynamical simulations. We, therefore, based our initial evaluation of the accuracy of the correction applied to the opacities on the hydrostatic 1D simulations. The properties of the neutrino field, in terms of the neutrino temperature, enters into Eq. (19). Consequently, a direct comparison between simulations with energy-dependent and gray neutrino transport is complicated, since any change to the neutrino opacities leads to a change in the system’s steady state.

To isolate the test of the averaging procedure we performed the following evaluation: Using the spectral properties of the radiation fields in the simulation with energy-dependent neutrino transport, we computed (29)

and (30)

which we compared to the corresponding opacities calculated from Eq. (19). We obtained the neutrino temperature in Eq. (19) from the energy-dependent simulation by fitting the neutrino spectrum to a blackbody function. The fitting procedure inevitably induces errors in the neutrino temperature, but it is more consistent than comparing two different steady states.

In Figs. 4 and 5, we show the opacity values for κa and κH, respectively. In both figures, the red lines represent the calculations with the full neutrino spectrum (as per Eqs. (29) and (30)), and the green lines indicate the results from the equilibrium assumption (following Eq. (19)). The solid blue lines represent the new way of calculating the opacities we developed in this work, which we return to later in this section. The figures show κa and κH for the three different neutrino species as a function of radius. The top panel represents the electron neutrinos, the middle the electron anti-neutrinos, and the bottom panel shows the heavy-lepton neutrino species. The opacities for the heavy-lepton neutrinos refer to effective opacities where the pair-production processes have been included in a simplified manner (see Sect. 2).

At low radii, when the density is high and the neutrinos are trapped, we find good agreement between the average absorption opacities calculated directly from the neutrino spectrum (red curves) and gray opacities with the correction from Foucart et al. (2016; green curves). We see discrepancies as the density drops and the neutrinos start to decouple. The difference between the absorption for the heavy-lepton neutrinos is particularly large, see bottom panel of Fig. 4. In Fig. 5, the green line representing the blackbody assumption consistently yields higher values of κH than the red line based on the full neutrino spectrum.

The correction factor in Eq. (19) is an extrapolation away from equilibrium between the fluid and neutrinos. The anchor point is calculated assuming that the neutrino temperature is equal to the fluid temperature. This approach is reasonable as long as the neutrino temperature is close to the fluid temperature, but we expect a decrease in accuracy once the neutrinos decouple from the fluid. To improve the precision of the opacities, we used an interpolation method with pre-computed values of the opacities defined as follows (31)

We chose a set of 12 linearly spaced neutrino temperatures from 0.1 MeV to l6 MeV. The neutrino opacities for each of the 12 neutrino temperatures were tabulated and stored in a four-dimensional table. We linearly interpolated from the tabulated values during the simulations. Thus in effect, the neutrino-interaction table remains the same size as in the energy-dependent simulations. Neutrino temperatures in the core can far exceed 16 MeV, but at that point the neutrinos are trapped and in equilibrium with the fluid. We found that reverting to Eq. (19) for the opacities when Tv > 16 MeV was beneficial from a numerical standpoint.

The interpolation method show a notable improvement over Eq. (19) for heavy-lepton neutrinos. On the other hand, for electron neutrinos and electron anti-neutrinos, the results are qualitatively similar to the approach prescribed by Foucart et al. (2016). We also find that the interpolation approach solves an issue we had noticed in our implementation of the original gray scheme. We found an artificial increase in the Ye of the material in front of the shock. The increase in Ye was due to the large difference in temperature between the neutrinos and the fluid ahead of the shock, which caused an overestimation of the absorption rates ahead of the shock. Interpolating, instead of extrapolating, the opacities removed the unphysical increase in Ye in the in-falling material.

After implementing the interpolation for the neutrino opacities, a different problem became apparent. Reducing the absorption opacity of the heavy-lepton neutrinos moves the neutri-nosphere deeper into the PNS, increasing the average energy of the emitted neutrinos. After decoupling, in terms of absorption, the heavy-lepton neutrinos still have to transverse a region of significant scattering opacities. The higher average energy increases the scattering and prolongs the time it takes the heavy-lepton neutrinos to escape the optically semi-thick region in the outer layers of the PNS, which in turn leads to larger PNS radii.

Since the opacities decrease rapidly with energy, the average energy of the flux is lower in the optically thick regions (low-energy neutrinos escape while high-energy neutrinos remain trapped). Consequently, averaging with Hr instead of J leads to smaller energy-averaged opacities. The effect of this is demonstrated in Fig. 5. In the PNS, the energy-averaged opacities are roughly reduced by a factor of 0.6–0.8 when averaging with Hr rather than with J, compare the red and green lines3. Since we do not have information regarding the energy dependence of the momentum flux in our energy-integrated scheme, we multiply κH with 0.6 in the core to mimic this effect.

Implementing the correction to κH led to improved agreement between the PNS and neutrino properties of the gray scheme and the full energy-dependent neutrino transport. However, the gray models overestimated the heating rate. We account for this by simply multiplying the opacities by 0.95 in the post-shock layer. We rely on the flux factor to transition between the two regimes. Since the flux factor lies between 0 and 1, it is convenient to define κα and κH as follows: (32)

and (33)

Here κa(TV) and κH(Tv) refers to the interpolated values of the κa and κH, respectively. We note that the factor of 0.6 does not appear in absorption opacity, which shows up in the term W[η − κaJ] in the evolution equations, the correction factor should go to one in the optically thick limit to ensure detailed balance. The exact choice of the functional form of is somewhat arbitrary and several other good choices are likely to exist. We tested a few different variations before settling on the Eq. (32) and Eq. (33).

The opacities defined in Eqs. (32) and (33), represented by the blue lines in Figs. 4 and 5, respectively. For the heavy-lepton neutrinos, we see good agreement between . The absorption opacities for the electron neutrinos and electron anti-neutrinos agree relatively well between all three methods, but is slightly closer to . For κH, we see that agrees better with the value from the energy-dependent calculation than . However, there is still a some discrepancy between , for all neutrino species.

Our tests showed that getting better results for κH is possible by choosing a different function and different coefficients in Eq. (33). However, the results shown in Figs. 4 and 5 are for one hydrostatic simulation. We found that tuning the scheme to fit one specific case led to worse results in other tests. In the end, Eqs. (32) and (33) were chosen to produce the best overall agreement in all our tests (see Sects. 5.3, and 6).

5.2 Updated flux-weighted average neutrino energy

To improve the machinery described in Sect. 3.4, we begin with the initial assumption of the ratio of the average neutrino energy and the flux-weighted average neutrino energy given in Eq. (23). The assumption is valid in the diffusion limit, if the opacities go as energy squared. In the free-streaming limit we would expect the energy of the flux to be the same as the average energy of the neutrino field. In reality, the radiation is neither purely diffusive nor purely free-emission, which means that (34)

Results from the energy-dependent transport indicate that the flux-weighted average energy matches well with (35)

especially for the heavy-lepton neutrinos (in the region with high scattering opacity) for which the second term in Eq. (8) is particularly important. We, therefore, change the order of the Fermi integrals in Eqs. (24) and (28) to better match the results from the energy-dependent transport. The updated expressions are (36)

and (37)

The scalar sC represents the fraction of neutrinos that have gone through a significant optical depth since being emitted. This ratio reaches values close to one well before the emitted neutrinos have escaped the PNS. Since sC = 1 implies that 〈εF〉 = 〈ε〉 (see Eq. (24)), the energy correction is effectively turned off once sC reaches values close to unity. The fact that sC becomes one before the neutrinos have escaped the scattering region leads to an underestimate of the reduction of the average energy of the flux. We, therefore, set (38)

The only difference between Eqs. (38) and (25) is the term N(1 + τ) in the denominator, which serves to take into account how much optical depth the neutrinos have yet to travel through. Effectively, our choice of sC goes to one much slower than Eq. (25). Furthermore, we found that the estimate of the optical depth suggested by Foucart et al. (2016) underestimates the optical depth. We, therefore, calculate τ as follows (39)

where represents the angular average of at any given radius. We use to calculate the optical depth since we are attempting to estimate the average energy of the neutrino flux. Directly calculating τ is advantageous since it completely does away with the β parameter of Foucart et al. (2016), a parameter that influences the original scheme’s results. Foucart et al. (2016) reported a 5–10% variation in the neutrino luminosites and average energies for reasonable values of β (∈ (0, 8]). We found a similar dependence on the β parameter, as Foucart et al. (2016), in our implementation of their scheme. While calculating the optical depth directly improves the result of our gray scheme, relying on the approximate value from Eq. (27) is not detrimental to the accuracy of the transport. Furthermore, Eq. (39) assumes that τ is well represented by a spherically symmetric radial profile. Core-collapse supernovae are fairly close to spherical, but the implicit assumption the Eq. (39) is likely not appropriate for binary mergers.

The accuracy of our gray scheme depends on the two free parameters we introduced in Eqs. (32) and (33). Consequently, it is important to chose appropriate values for the two parameters. In our tests, we found that the parameter that appears in the first term of Eq. (33) should lie between 0.5 and 0.8, changes of 0.2 results in noticeably different PNS properties. The second parameter is important for the outcome of the supernova simulations, explosion versus non-explosion, and is sensitive to changes on the order of 5%.

5.3 Numerical tests

After implementing the changes detailed above, we performed the same 1D tests we initially used to test the scheme of Foucart et al. (2016). The last line in Table 1 represents the results of our updated scheme. Except for the average energy of the heavy-lepton neutrinos, we find agreement with the energy-dependent scheme within 5–10%. The average energy of the heavy-lepton neutrinos agrees within 30%. Since we cannot capture the effects of inelastic scattering and struggle to model the full impact of scattering screens, we do not expect to be able to reproduce the average energy of the heavy-lepton neutrinos well with a gray scheme.

The black curves in Figs. 1–3 show the results using the updated gray scheme. The new gray scheme generally leads to better agreement with the other simulations in all quantities except the average energy of the heavy-lepton neutrinos. The average shock radius is still larger than the typical value seen in the original simulations, but the PNS radius agrees well with the results reported in O’Connor et al. (2018). Getting the properties of the PNS right is important for predicting the GWs emitted by core-collapse supernovae (Müller et al. 2013; Sotani & Takiwaki 2016; Sotani et al. 2017, 2021; Andresen et al. 2019; Morozova et al. 2018; Westernacher-Schneider et al. 2019; Eggenberger Andersen et al. 2021; Vartanyan et al. 2022; Mori et al. 2023).

6 Two-dimensional tests

We extended our testing of the gray scheme by conducting 2D axisymmetric core-collapse supernova simulations, using both the fully energy-dependent neutrino transport and the gray transport. The energy-dependent transport was carried out using 12 energy groups, inelastic scattering, and energy-bin coupling effects. The simulations are grouped into two sets. The first set is composed of five progenitors with ZAMS masses of 11, 12, 13, 14, and 15 solar masses (Sukhbold et al. 2018). We simulated the post-bounce evolution of each progenitor three times, one for each neutrino transport method. We used the SFHo EOS, and the finest grid resolution was 488 m. The progenitors were evolved until 20 ms after bounce in 1D with energy-dependent neutrino transport. The 2D simulations were initiated from the post bounce 1D profiles. The simulations are labeled with an “s” followed by the progenitor ZAMS mass. For each progenitor, the average shock radius and the PNS radius in the corresponding simulations are shown in Fig. 6.

The second set of simulations is based on a single progenitor with a ZAMS mass of 20 solar masses (Woosley & Heger 2007). We conducted the simulations using five different versions of the SRO EOS (Schneider et al. 2017, 2019). The five EOS used are chosen from a larger set (of 96) that span a parameter space allowed by terrestrial experiments and astrophysical observations. Specifically, the five different versions of the EOS lead to different simulation outcomes in energy-dependent simulations, which enables us to check if our gray scheme reproduces this result and to test different regimes. The finest grid resolution was 325 m. The energy-dependent simulations from the second set have already been published in Eggenberger Andersen et al. (2021); we refer to their work for a detailed analysis of the simulations. For each EOS, the average shock radius and the PNS radius in the corresponding simulations are shown in Fig. 7. We observe a notable offset in the initial PNS radius of the simulations with gray transport compared to the energy-dependent transport simulations. The offset is related to the fact that the original simulations were evolved through bounce in 2D, while the gray simulations were mapped from a spherically symmetric profile 20 ms after bounce. It is necessary to start the gray simulations post bounce, because energy dependent effects play an important role during the collapse phase. The absence of prompt convection, caused by evolving the model through bounce in 1D, influences the structure of the PNS and leads to a smaller initial PNS radius than when evolving the collapse phase in 2D. The difference is transient, and the excellent agreement of the shock radii at early times demonstrates that this effect is relatively unimportant for the further dynamic evolution of the system.

In general, we find remarkably good qualitative agreement between simulations using our gray transport and simulations using energy-dependent neutrino transport for a wide range of progenitor and for several different EOSs (see Figs. 6 and 7). We present a side-by-side comparison of the simulations from the first set in Fig. 6. We plot the average shock radius and the PNS radius (we define the PNS surface as the radius where the density drops below 1011 g cm−3) for each progenitor. The left column displays the shock radius, while the right column shows the PNS radius. Each row of Fig. 6 corresponds to a different progenitor. The blue solid line represents the gray scheme implemented in this work, the green dashed-dotted line represents the method by Foucart et al. (2016), and the red dashed line represents the simulations utilizing energy-dependent transport.

From the right-hand side panels of Fig. 6, we see that the PNS radii are systematically larger in the simulation using the prescription of Foucart et al. (2016). Consistent with the results from our 1D tests, the modifications we suggest lead to improved agreement between the energy-dependent and energy-integrated transport in terms of the PNS radii. However, the gray transport still leads to larger PNS radii at late times than the energy-dependent transport. For the s11 progenitor, at 400 ms after bounce the PNS radius is ~33 km, ~35.5 km, and ~38 km in the simulations using energy-dependent transport, our gray implementation, and the gray transport according to Foucart et al. (2016), respectively. For the s14 progenitor, again at 400 ms post bounce, we find a PNS radius of ~34 km using energy-dependent transport, ~36.5 km using our gray transport and ~39 km using the original gray transport. The rest of the progenitors show similar trends. As in 1D, the reduced PNS radii we observe after implementing our changes result from the reduced scattering opacities for heavy-lepton neutrinos. Consequently, the heavy-lepton neutrinos are emitted deeper in the PNS. Therefore, the updated gray transport leads to larger average energies for the heavy-lepton neutrinos than the original implementation.

In terms of explodability and time of shock-revival, we find good qualitative agreement between the energy-dependent transport and our gray transport. The gray scheme is more conducive to shock revival, and shock expansion tends to set in sooner in simulations using the gray transport than in simulations using energy-dependent transport. The situation is notably reversed for the original gray scheme; the original gray transport tends to lead to later shock revival than the energy-dependent transport.

We show the heating rate as a function of time for models s11, s12, s13, s14, and s15 in Fig. 8. The total heating rate is defined as the volume integral of the change in the specific internal energy due to neutrino-fluid interactions, in regions where the change is positive. The spatial integral is limited to regions where the density is less than 3 × 1010 g cm−3 and the entropy is greater than 6 kB per baryon (kB denotes Boltzmann constant). In Fig. 8, blue curves indicate results from simulations with our gray scheme, green curves show the results from simulations using the neutrino transport of Foucart et al. (2016), and red curves correspond to results from simulations with energy-dependent neutrino transport. Two trends are immediately visible in Fig. 8: 1) the neutrino transport of Foucart et al. (2016) leads to lower heating rates than the fully energy-dependent transport, 2) our gray scheme injects too much energy into the fluid at early times, the heating rates are to high, with the notable exception of model s12. The shock radii of all three simulations of the s12 progenitor follow a very similar trajectory prior to 200 ms post bounce, see the second panel from the top in the left column of Fig. 6. The large heating rates at early times, and the larger heating rate in general, is a likely reason for the differences in explodability we observe between our gray transport and the energy-dependent transport. Especially since the evolution of the gray s12 simulation, where this excessive early-time heating is absent, agrees so well with its energy-dependent counterpart.

In our work, we have focused on achieving the best possible agreement in the properties of the neutrino radiation, the properties of the PNS, and the evolution of the shock. The aforementioned quantities are better tracers for the global behavior of the simulations than the total heating rate. The heating rate does not account for cooling or where the heating occurs. Nevertheless, the high heating rates of the gray scheme indicate that our scheme could be improved in the future.

We compare the simulations from the second set in Fig. 7. We plot the average shock radius and the PNS radius for each realization of the post-bounce evolution of the s20 progenitor. The left column displays the shock radius, while the right column shows the PNS radius. Each row of Fig. 7 corresponds to a distinct EOS. We follow the labeling scheme on Eggenberger Andersen et al. (2021; see Table 2 for an overview of the naming convection we used for the simulations), where the progenitor name is followed by the value chosen for the effective mass of neutrons at nuclear saturation density, for symmetric nuclear matter, in the EOS. A second number following the effective mass represents the value chosen for the isoscalar incompressibility modulus (in units of MeV per baryon), if no number is given then the isoscalar is set to the baseline value of 230 MeV. The solid blue line represents the gray scheme implemented in this work, the green dashed-dotted line represents the method by Foucart et al. (201 ), and the red dashed line represents the simulations utilizing energy-dependent transport.

Similar to the simulations in the first set, for the second set of simulations based on the s20 progenitor, we find that the original gray scheme consistently results in larger PNS radii than the energy-dependent transport. Furthermore, we see that the updated gray transport again leads to larger PNS radii than the energy-dependent transport, from approximately ~200 ms post bounce.

For the s20_0.55 models we observe good agreement in the shock evolution for all three transport methods, and none of the simulations explode within the first 800 ms post bounce (see top right panel of Fig. 7). The s20_0.95 models produce successful explosions and we observe the same trend we did in the first set of simulations; the original scheme by Foucart et al. (201 ) leads to later shock revival and our gray scheme leads to earlier explosions compared to the energy-dependent transport. However, shock revival sets in within 50 ms in the simulation using our gray transport and the simulation with energy-dependent transport. After an initial period of expansion, the shock begins to retreat around 100 ms post bounce in the simulation with energy-dependent transport (bottom right panel of Fig. 7). This period of shock retraction is observed to a lesser degree in the model with the original gray transport. It is absent in the simulation that incorporates the modified gray scheme. Similar behavior can be seen in the s20_0.75_200 simulations.

The s20_0.75 simulations are interesting, Eggenberger Andersen et al. (2021) found very similar shock evolution for all values of the incompressibility modulus, but our gray transport produces qualitatively different behavior for all three models. On the other hand, the transport of Foucart et al. (201 ) yields better agreement across the three EOS variations. The 2D tests show that the gray transport shifts the outcome toward explosion for progenitors in the boundary region between explodability and non-explodability. Consequently, our findings warrant caution in using gray transport to predict the outcome of individual progenitors precisely. However, our gray transport successfully reproduces the main dependence of explodability on the EOS parameters reported in Schneider et al. (2019); Yasin et al. (2020); Eggenberger Andersen et al. (2021), namely that increasing the effective mass facilitates shock revival.

7 Gravitational waves and neutrino emission

In this section, we present the neutrino luminosity, average energy, and GW signal for the energy-dependent and gray simulations based on the s12 progenitor. We do not show results for the gray implementation of Foucart et al. (201 ). Our decision to concentrate on s12 is based on two reasons. First, a detailed examination of all the simulations would result in an overly long and extensive analysis. Second, and more crucially, we have verified that the s12 simulations are representative of the totality of simulations performed in this work.

The GW signals are extracted from the hydrodynamic simulations by post-processing the output data using the quadrupole formula. In the transverse-traceless gauge, the GW tensor can be expressed in terms of two independent components, h+ and h×, but only one component is nonzero in axisymmetric simulations. Far away from the source, at a distance D, in the slow-motion limit, and assuming an observer located in the equatorial plane of the simulations, we have (40)

Here is the c the speed of light and G is Newton’s constant. denotes the second-order time derivatives of the zz-component of the quadrupole moment and is given by (41)

In this form, one of the time derivatives of the original definition has been eliminated to avoid numerical problems associated with second-order derivatives (Oohara et al. 1997; Finn 1989; Blanchet et al. 1990). In Eq. (41), vz is the Cartesian velocity, z is the Cartesian coordinate, and ρ is the local fluid density. We calculate the second time derivative numerically using numpy.gradient (Harris et al. 2020).

We compute spectrograms by applying short-time Fourier transforms (STFT) to h+. The STFT is computed with a scipy.signal.stft using a Blackman window (Virtanen et al. 2020). We normalize the STFT and take the logarithm before plotting. The normalization is chosen so that the logarithmic value lies in the (−∞,0] range and is the same for every spectrogram we show. Before applying the STFT, we filter the signals using high-pass and low-pass filters, removing any part of the signal below 25 Hz and above 5000 Hz.

In Fig. 9, we present the GW amplitude and spectrograms for the two simulations. The top row displays the GW amplitude, while the bottom row shows the spectrograms. The left column of each row corresponds to the results from the energy-dependent neutrino transport simulation, and the right column showcases the findings from the gray neutrino transport simulation.

The time-dependent signals of both models (top row of Fig. 9) exhibit the stochastic variations typically associated with core-collapse supernova GWs. However, the typical amplitudes are ~15 cm in both simulations. The strong burst of GW emission visible in the simulation with energy-dependent transport around 50 ms post bounce is associated with prompt convection and is absent in the simulation with gray transport because it was initiated from a 1D profile post bounce. At first glance, the spectrograms from both models are very similar. However, there is a small shift toward lower frequencies in the simulation employing gray neutrino transport, compared to the simulation with energy-dependent transport. This frequency shift is consistent with the differences in PNS properties observed in simulations that utilize different neutrino transport methods. The gray transport leads to a less compact PNS at late times than the energy-dependent transport. It is, therefore, expected that the central frequency of the GW signal will be lower (Murphy et al. 2009; Mueller et al. 2013; Sotani & Takiwaki 2016; Andresen et al. 2017; Andresen 2017; Sotani et al. 2017, 2019, 2021; Torres-Forné et al. 2018, 2019b,a; Morozova et al. 2018; Radice et al. 2019; Eggenberger Andersen et al. 2021; Mezzacappa et al. 2023; Wolfe et al. 2023; Rodriguez et al. 2023). Additionally, the power gap is observed in both models. Interestingly, the location of the power gap (Morozova et al. 2018; Eggenberger Andersen et al. 2021) is shifted toward lower frequencies in the gray transport simulation.

Figure 10 shows the neutrino luminosities and average neutrino energies from the two simulations of the s12 progenitor. The top panel of the figure shows the luminosities, while the bottom panel shows the average energies. The neutrino luminosity and average neutrino energies are extracted at a radius of 500 km, we apply a Savitzky-Golay filter (Virtanen et al. 2020) to smooth the curves before plotting. In both panels, the red lines represent the results obtained from the simulation that employed energy-dependent neutrino transport. The blue lines correspond to the results from the gray neutrino transport simulation. Solid lines indicate electron neutrinos, dashed lines represent electron anti-neutrinos, and dotted-dashed lines correspond to heavy-lepton neutrinos.

For the electron neutrinos and electron anti-neutrinos, there is excellent agreement between the simulations in terms of both average energies and luminosities (the luminosity curves trace each other very well with only a small off-set, see the first panel of Fig. 10). However, the gray neutrino transport induces notable differences for the heavy-lepton neutrinos compared to the energy-dependent transport. Initially, the gray transport produces approximately 10 MeV higher energies, with around 30% lower luminosities than those observed in the energy-dependent transport simulation. At late times, the luminosity agreement improves to about 15–20%.

The ~ 10 MeV offset in average-energy of the neutrinos heavy-lepton, between the simulations with gray and energy-integrated transport, is present for all our models. Furthermore, all of our gray 2D models show the same 15–30% reduction in the heavy-lepton neutrino luminosity, compared to the simulations with energy-dependent transport, as the s12 models discussed in this section. For the s12 models, the energy-dependent and gray transport produces similar average energies and luminosities for the electron neutrinos and anti-neutrinos. The good agreement observed for the s12 models carries over to all our 2D models.

In Sect. 5.3, we speculated that the differences in the average energy of the heavy-lepton neutrinos were, at least in part, caused by the inclusion of inelastic scattering in the energy-dependent transport. To test the effects of inelastic scattering, we redid the energy-dependent s12 simulation without inelastic scattering. We see marginal differences. The largest is the aforementioned impact on the average energy where we saw an increase in the average energy of the heavy-lepton neutrinos of approximately 5 MeV. We also observed a slightly smaller PNS, and a smaller average shock radius. The luminosities of the heavy-lepton neutrinos increased by 5–10% when inelastic scattering was not included, the luminosity of the two other species stayed more or less the same. The model without inelastic scattering follows the same general evolution as the one with, but is over all less energetic than the simulation with inelastic scattering. The gray simulation matches the simulation without inelastic scattering better than the one with inelastic scattering.

The differences we observe in the neutrino emission are consistent with the results in 1D test simulations, see Sect. 5. Furthermore, we found that the differences in the neutrino emission in the 2D simulations using the original scheme and the energy-dependent transport were the same as in 1D (see Sect. 5). The original scheme proposed by Foucart et al. (2016) results in larger PNS radii compared to energy-dependent transport schemes. Consequently, by the end of the simulation, this leads to a reduction in the central frequency of the gravitational wave emission by approximately 300 Hz.

8 Performance

To evaluate the performance of the scheme, we conducted two separate 2D simulations. Each simulation was run for a total of 1000 time steps, with the initial resolution of the finest refinement level set at 325 m. In our tests, we found that the gray neutrino transport speeds up the overall code execution by a factor of four compared to the energy-dependent transport. When looking specifically at the neutrino transport, the speed increase is even more significant, surpassing a factor of five. The radiation transport takes approximately three times longer than the hydro-dynamic calculation. For comparison, in the energy-dependent scheme, a radiation step is ~15 times more expensive than a hydrodynamic step.

9 Summary and conclusion

In this work, we performed a comprehensive comparison of the energy-integrated neutrino transport scheme of Foucart et al. (2016) with fully energy-dependent neutrino transport. We found that the method outlined by Foucart et al. (2016) yields reasonable shock evolutions in our tests, but PNS radii that are 15–20% larger compared to those obtained in corresponding simulations using energy-dependent neutrino transport. We also found, in 2D test simulations, that our implementation of the original gray transport reduced the explodability of the models compared to the energy-dependent simulations.

Based on results from numerical tests, we implemented several modifications to the original gray scheme. We implemented the following changes to the approach proposed by Foucart et al. (2016):

1.

We updated the definition of energy-averaged neutrino opacities. Foucart et al. (2016) computed the scattering and absorption opacities by first calculating the opacities under the assumption that the neutrinos are in equilibrium with the fluid and then extrapolating away from equilibrium using the ratio (Tν/T)2. We assumed that the neutrinos obey a black-body spectrum (which was also assumed by Foucart et al. 2016), and computed the opacities for a set of predefined neutrino temperatures to create an interpolation grid in Tν. After interpolating the opacities, we applied a set of correction factors. These correction factors, in short, amount to multiplying the opacities with 0.95 in the gain layer and reducing the opacities that appear in the evolution equations as (κa + κs)Hi with 0.6 in optically thick regions.

2.

We adjusted the procedure for estimating the average energy of the neutrino flux. Specifically, we changed the order of the Fermi integrals in the equations, modeling the ratio of the average energy of the neutrino flux to the average neutrino energy. For consistency, we also changed the updated order of the Fermi integrals that appear in the estimate for the neutrino number flux. We modified the scalar sC by introducing an Nτ term in the denominator. We directly computed the optical depth, eliminating reliance on the β parameter.

Intuitively, it is reasonable that computing the opacities from a grid of values is more accurate than extrapolating from a single point. While interpolating led to improvements across all neutrino species, the largest improvement was in the accuracy of the heavy-lepton neutrino opacities. Furthermore, in our initial implementation of the original gray transport we found an artificial increase in the Ye of the material ahead of the shock. The source of this build-up was the extrapolation of the absorption opacity in a regime where the fluid temperature was very low (<1 MeV) and the neutrino temperature was high. Interpolating the opacities, instead of extrapolating, fixed this problem. Our approach reproduces the results of the energy-dependent transport fairly well; in addition, simulations utilizing the gray scheme are around four times faster than those using the energy-dependent neutrino transport.

Interpolating the opacities was not enough to achieve good agreement with the opacities calculated by averaging with the energy-density spectrum from simulations with energy-dependent transport. In the evolution equations there are terms which are proportional to (κs + κa)Hi, which means that the opacities in these terms should be averaged with the neutrino momentum density instead of the neutrino energy density. Effectively, this reduces the opacities in the optically thick regions. We found that multiplying the opacities with 0.6 in the thick regions mimicked this effect reasonably well. We found that these corrections were essential for the heavy-lepton neutrinos. Additionally, we observed that the energy-averaged opacities lead to overheating in the gain layer, which we solved by reducing the opacities by 5% in this region.

The methodology of Foucart et al. (2016) for tracking the average energy of the neutrino flux presupposes that the average energy of neutrinos traveling through an optically thick screen will be reduced from . Empirically, we found that the energy reduction is closer to . Consequently, we changed the order of the Fermi integrals involved in tracking the momentum-weighted average energy. As for the previous point, we found that this has the most significant effect on the propagation of heavy-lepton neutrinos.

Tracking the flux-weighted average energy entails calculating the optical depth of the neutrinos. Foucart et al. (2016) suggests an estimate that we found to underestimate the actual value calculated directly in our simulations. We therefore chose to calculate the optical depth directly. Relative to the other improvements, the effect of this correction is small and can likely be left out if calculating the optical depth is numerically challenging.

The changes detailed above were developed in an iterative procedure, where we implemented changes and tested their impact by performing 1D and 2D tests. After arriving at our final set of changes to the original transport, we performed several 2D test simulations of our gray scheme. Overall, we found that for a range of progenitors and for different EOSs the gray neutrino transport successfully reproduces key quantities from the more intricate energy-dependent transport. We find good qualitative and reasonable quantitative agreement between simulations with our gray transport and simulations with multi-group M1 transport. However, the gray scheme is slightly more conducive to shock revival, and we conclude that it will likely push simulations residing in the boundary region between successful and failed supernovae over the edge toward explosion.

We performed two sets of 2D test simulations. In the first set we tested the accuracy of the gray transport over a range of progenitors, spanning ZAMS masses from 11 to 15 solar masses, and used the SFHo EOS for every simulation. We found good qualitative and quantitative agreement for the evolution of the PNS and the shock radius for all models, except for one progenitor in which shock expansion was set approximately 100 ms earlier in the gray simulation. The scheme by Foucart et al. (2016) resulted in significantly delayed explosions, compared to the energy-dependent transport simulations, for two out of the five progenitors. The original scheme also consistently led to PNS radii that were ~10 km too large.

In the second set of 2D simulations, we kept the progenitor constant and studied the effects of varying the EOS. Recomputing the simulations performed by Eggenberger Andersen et al. (2021) with our gray scheme showed that it is slightly more conducive to explosions than the energy-dependent simulations. The particular model used for the comparison with Eggenberger Andersen et al. (2021) has been used by several authors that have reported successful and unsuccessful explosions (Melson et al. 2015a). A likely conclusion is that the gray scheme favors explosions in cases close to the boundary between failed and successful supernova explosions. Again, we found that the original gray transport hampers shock revival and leads to extended PNSs.

One motivation for implementing a gray scheme into FLASH is the ability to produce a larger and more diverse set of predictions for the multi-messenger signals from core-collapse supernovae than currently available in the literature. We verified that our gray transport produces GW and neutrino signals that agree well with those of the energy-dependent transport. In Sect. 7 we compared the predicted GW and neutrino signals for one particular model using the gray transport with the corresponding model with energy-dependent transport. The GW signals agreed well, but we observed a small shift toward lower frequencies in the gray model, which we attributed to the larger PNS radius observed in the gray model (a tendency that is systematic to the gray models). Furthermore, we found relatively good agreement in the neutrino emission of the two models. The largest discrepancy was in the average energy and luminosity of the heavy-lepton neutrinos, which, considering the limitations of a gray scheme, was expected.

Since we implemented the gray transport into a version of FLASH, which already has an energy-dependent M1 scheme, we were able to assess the consequences of every aspect of the gray transport. Such a detailed comparison is critical to understanding the limitations of commonly used gray schemes. The standard choice for the neutrino opacities can be improved to achieve better agreement with the energy-dependent neutrino transport. The corrections we suggest were empirically determined, but constructed to respect the expected behavior in the optically thick and thin limits. Other choices for the neutrino opacities will likely work as well as our suggested corrections. Regardless of which choice one makes, our recommendation is to validate any given prescription for the energy-averaged opacities, because strong nonlinear feedback couples the entire problem.

Acknowledgements

We thank Francois Foucart and Federico Schianchi for interesting discussions during the development of this work. The computations were enabled by resources provided by the National Academic Infrastructure for Supercomputing in Sweden (NAISS) and the Swedish National Infrastructure for Computing (SNIC) at NSC partially funded by the Swedish Research Council through grant agreements no. 2022-06725 and no. 2018-05973. This work is supported by the Swedish Research Council (project no. 2020-00452). SMC is supported by the US Department of Energy, Office of Science, Office of Nuclear Physics, Early Career Research Program under Award Number DE-SC0015904. Software. FLASH (Fryxell et al. 2000), NuLib (O’Connor 2015), Matplotlib (Hunter 2007), NumPy (Harris et al. 2020), SciPy (Virtanen et al. 2020), yt (Turk et al. 2011).

References

All Tables

All Figures