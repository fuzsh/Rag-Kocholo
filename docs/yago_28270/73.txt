Guy Ritchie, an auteur best known for cheeky British gangster films and big-budget Disney adaptations, seems—on the face of it—to be an unlikely director to make The Covenant. The film, in theaters April 21, is a sober military thriller that excoriates Joe Biden’s decision to pull out of Afghanistan in 2021 and, in the process, to strand the thousands of local interpreters who had risked their lives to aid the American cause.

Nonetheless, a closer inspection reveals it to be another of his portraits of brotherhood forged and strengthened under fire, this time cast in a familiar Hollywood mold that does much to energize its politicized take-down of our recent dereliction of moral duty.

The polar opposite of Ritchie’s lighthearted espionage lark Operation Fortune: Ruse de Guerre, The Covenant (which, to hammer home its authorship, is officially presented as Guy Ritchie’s The Covenant) lets its action do its preaching, with only opening and closing textual notes providing real-world context for its dramatic story.

Set in March 2018 in Afghanistan, it concerns United States Master Sergeant John Kinley (Jake Gyllenhaal), the leader of a team responsible for locating and eliminating IED factories and other munitions stockpiles. Ritchie introduces these characters in snapshots embellished by on-screen title cards, and though that device is a tad clunky, it works better when used to define the acronyms (such as QRF, for Quick Reaction Force) bandied about by these hardened military vets.

Kinley’s squad suffers a fatal blow at the start of The Covenant, thereby compelling them to hire a new translator for subsequent missions. The man who gets that job is Ahmed (Dar Salim), a hard-nosed Afghan with a reputation for doing things his way. Kinley can tell from the start that Ahmed is capable and difficult, and that’s proven when, on their first outing together, he follows his instincts by offering a suspect additional money to talk—a line of attack that Kinley had expressly forbidden.

Nonetheless, since his tactic produces results, there’s not much for Kinley to do but swallow his pride and keep a wary eye on his recruit, whom Salim embodies with a self-possessed gravity and sense of purpose that makes him appear less like Kinley’s underling than someone closer to his equal.

Ahmed is a bit of a wild card, and yet he demonstrates his value when—after Kinley receives a tip about two possible IED sites—he correctly deduces that their other translator is trying to lead them into an ambush. Having joined the Americans in the wake of his son’s murder at the hands of the Taliban, Ahmed is an individual who means business, which aligns him with Kinley, a husband (to Emily Beecham’s wife) and father whose determination and seriousness is so extreme that even his stabs at humor feel like challenges.

They’re put to the test when, at the second potential IED location, they find themselves in a furious firefight against Taliban forces, who swarm in from every corner of the dusty area, killing all of Kinley’s men and forcing the duo to take to the desert—in a vehicle, and then on foot—to escape death.

This two-against-many scenario is reasonably conventional by mainstream war-cinema standards, although it’s given a twist when Kinley is injured during an ensuing skirmish and Ahmed chooses to put his own life on the line in order to get Kinley safely back to Bagram Air Base. In this middle section, The Covenant delivers a harrowing journey through enemy territory, where virtually no one can be trusted and detection means immediate execution.

Ritchie generates significant tension from these passages, employing slow-motion (his favorite flourish) to accentuate moments of pain and crisis, and drone shots (almost to excess) to afford aerial overviews of battlegrounds’ layouts and, additionally, to contextualize his protagonists as tiny figures making their way through a vast, unforgiving landscape.

The hook of The Covenant is that Ahmed, through efforts that are heroic in the extreme, succeeds in his endeavor, avoiding capture and returning a terribly injured Kinley to his American compatriots by dragging him on a makeshift stretcher, pushing him in a rickety cart, and rolling him up in rugs in order to secretly transport him via truck. When Kinley awakens in a stateside hospital, however, he’s shocked and incensed to learn that Ahmed has been left to fend for himself in Afghanistan, denied the Special Immigration Visas that were promised to him, his wife and their newborn son.

On the run because he has a Taliban bounty on his head, Ahmed has been abandoned—something that inspires such guilt, grief, and rage in Kinley that it’s a foregone conclusion he’ll quit trying to deal with useless bureaucrats to extricate his translator and just do it himself, with or without the help of his commanding officer Vokes (Johnny Lee Miller) or private security contractor Parker (Antony Starr).

“I want you to honor the deal,” seethes Kinley to Vokes, articulating not only the code by which he (and all soldiers) lives, but the film’s viewpoint when it comes to America’s obligation to its foreign comrades. The Covenant is at once patriotic and critical of the U.S.’s conduct in Afghanistan, its straightforward template designed to both elicit admiration for its protagonists—and excitement from their harrowing exploits—and disgust over the fact that, in real life, so many translators were forsaken when we withdrew from the country (according to a coda, more than 300 were executed and thousands remain in hiding).

As portrayed by Ritchie, Ivan Atkinson and Marn Davies’ script, Kinley and Ahmed’s deeds are of a heightened blockbuster-movie variety, and Gyllenhaal and Salim sell their respective characters’ intensity, conviction and virtuousness. Moreover, the proceedings bestow the two leads with equivalent time in the (lionizing) spotlight, all while hitting the sweet spot between fantasy and reality, with the former providing an illuminating window onto the latter.

The Covenant might have been a heavy-handed polemic were it not for Ritchie couching things in fictional terms and putting a premium on suspenseful genre-y set pieces, be it encounters at Taliban checkpoints, firefights at remote mines, or car chases through scraggly mountains. The result is an old-school action film elevated by Gyllenhaal’s rousing movie-star turn and Salim’s impressive breakthrough performance—as well as a censure of U.S. policy that stingingly hits its mark.