{
    "id": "dbpedia_8292_0",
    "rank": 70,
    "data": {
        "url": "https://www.linuxbabe.com/linux-server/use-clonezilla-back-up-migrate-vps",
        "read_more_link": "",
        "language": "en",
        "title": "How to Use Clonezilla to Back Up and Migrate VPS",
        "top_image": "https://www.linuxbabe.com/wp-content/uploads/2021/03/Use-Clonezilla-to-Back-Up-and-Migrate-VPS.jpg",
        "meta_img": "https://www.linuxbabe.com/wp-content/uploads/2021/03/Use-Clonezilla-to-Back-Up-and-Migrate-VPS.jpg",
        "images": [
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/Use-Clonezilla-to-Back-Up-and-Migrate-VPS.jpg",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/Booting-Up-Your-VPS-from-ISO-Image.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/04/ubuntu-server-live.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/04/ubuntu-server-live-configure-network.png",
            "https://www.linuxbabe.com/wp-content/uploads/2022/12/ubuntu-live-ISO-virtual-terminal.webp",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-bootable-usb.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-linux.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-uefi.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-device-image.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-image-directory-ssh-server.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-mount-sshfs.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-SSH-port.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-SSH-username.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-SSH-image-directory.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-ssh-password.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-beginner-mode.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-savedisk.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-ubuntu.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-open-source-clone-system.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-compress-image.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-advanced-extra-parameters.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-check-the-image-is-restorable.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-encrypt-disk-image.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-savedisk-to-image.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-command-line.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-encryption-passphrase.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-unattended-mode.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-device-image.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-image-directory-ssh-server.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-restore-disk-mode.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/clonezilla-vda-to-sda.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/04/clonezilla-migrate-vps.png",
            "https://www.linuxbabe.com/wp-content/uploads/2021/03/Unable-to-find-target-partition-sda1.png",
            "https://secure.gravatar.com/avatar/438d7fbbf5725855aaf315aaad507284?s=30&d=https%3A%2F%2Fwww.linuxbabe.com%2Fwp-content%2Fuploads%2F2018%2F06%2Flinuxbabe-comment-avatar-120x120.png&r=g",
            "https://secure.gravatar.com/avatar/5404c8885c96cd13df922588e1b5bd87?s=30&d=https%3A%2F%2Fwww.linuxbabe.com%2Fwp-content%2Fuploads%2F2018%2F06%2Flinuxbabe-comment-avatar-120x120.png&r=g",
            "https://www.linuxbabe.com/wp-content/uploads/2020/09/linux-system-security-course-lpic-2-pluralsight.jpg",
            "https://www.linuxbabe.com/wp-content/uploads/2019/11/pcloud-2TB-lifetime-263x219.jpg",
            "https://www.linuxbabe.com/wp-content/uploads/2021/08/kamatera-VPS.png",
            "https://analytics.linuxbabe.com/matomo.php?idsite=1&rec=1"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "Guoan Xiao (Admin)"
        ],
        "publish_date": "2022-12-22T09:33:28+00:00",
        "summary": "",
        "meta_description": "In a previous tutorial, I explain the process of backing up your hard drive with Clonezilla, which is a free open-source disk imaging and cloning tool. Clonezilla can also be used to back up and migrate your Linux VPS (Virtual Private Server). The Importance of Backing Up Your VPS On March 10 2021, a fire…",
        "meta_lang": "en",
        "meta_favicon": "https://www.linuxbabe.com/wp-content/uploads/2021/08/cropped-linuxbabe-logo-32x32.png",
        "meta_site_name": "LinuxBabe",
        "canonical_link": "https://www.linuxbabe.com/linux-server/use-clonezilla-back-up-migrate-vps",
        "text": "In a previous tutorial, I explain the process of backing up your hard drive with Clonezilla, which is a free open-source disk imaging and cloning tool. Clonezilla can also be used to back up and migrate your Linux VPS (Virtual Private Server).\n\nThe Importance of Backing Up Your VPS\n\nOn March 10 2021, a fire completely destroyed OVH’s Strasbourg data center, causing millions of websites offline. Users who don’t have disaster recovery plan have no way to recover their data. If you back up your VPS with Clonzilla, you can easily restore it after an incident like this. You can use Clonzilla to create an image backup of your VPS. You can also migrate it to another VPS hosting provider if you like to.\n\nClonezilla Features\n\nYou can create an image of the current disk or partition (disk imaging), and restore the image to disk at any time.\n\nAllows you to clone directly between two disks (disk cloning), without creating a disk image.\n\nThe disk image can be encrypted with ecryptfs, and saved to or read from local disk, SSH server, Samba server, NFS server, WebDAV server or AWS S3 storage.\n\nThe disk image can be compressed with GZIP or ZSTD algorithm.\n\nSupports lots of file systems like ext4, XFS, Btrfs, F2FS, FAT32, NTFS, HFS+, UFS.\n\nSupports MBR and GPT partition table.\n\nSupports BIOS and UEFI firmware.\n\nClonezilla Server Edition allows you to do massive system deployment over the network.\n\nUnattended mode: Almost all steps can be done via commands and options.\n\nPrerequisites\n\nTo use Clonezilla to back up or migrate VPS, your hosting provider needs to allow you to boot VPS from a recovery ISO or custom ISO image. The following is a list of supported hosting providers/hosting platform.\n\nDigitalOcean\n\nVultr\n\nProxmox\n\nStep 1: Booting Up Your VPS from ISO Image\n\nClonezilla can create an image of the current disk on your VPS, preserving every transaction. The downside is that you need to shut down the VPS and do it from a live or recovery ISO. This is because Clonezilla currently doesn’t support online imaging/cloning. The partition to be imaged or cloned has to be unmounted.\n\nClonezilla is included in the repository of Debian, Ubuntu and Arch Linux. In this tutorial, I will use Ubuntu server as the live ISO. If your hosting provider supports custom ISO image, then you can use the Clonezilla Live ISO, so you can start using Clonezilla right away, without having to find and install missing software components for Clonezilla.\n\nGo to your VPS control panel. Attach Ubuntu ISO image to your VPS, then establish a VNC connection to your VPS. You can get VNC login info from your hosting provider. Many hosting companies also allow you to use a web-based console to access your server. Next, shut down your VPS and boot it up from the Ubuntu ISO image. (If you don’t know how to do this, ask your hosting provider.)\n\nNote: It’s recommended to use the Ubuntu server live ISO, instead of Ubuntu desktop ISO, because Ubuntu desktop consumes lots of RAM. If your server has only 1GB RAM, you will run out of RAM when using Ubuntu desktop.\n\nNormally you have to press a key like ESC or F12 in the VNC window to bring up the boot menu, which allows you to select which device your VPS will boot from. Select optical disk drive so your VPS will boot the Ubuntu ISO image. Note: The default firmware for KVM virtual machines is called SeaBIOS.\n\nAfter the Ubuntu live installer is running, choose your language and keyboard layout.\n\nThen configure the network connection.\n\nDon’t continue the installation, but send the Ctrl+Alt+F2 key combination to your VPS, so you will switch to a virtual terminal.\n\nTry to ping 8.8.8.8 to see if your VPS is connected to the Internet.\n\nping 8.8.8.8\n\nNow your VPS is connected to the Internet, install Clonezilla with:\n\nsudo apt-add-repository universe sudo apt update sudo apt install clonezilla net-tools sshfs ecryptfs-utils binutils e2fsprogs screen\n\nStep 2: Back Up Your VPS with Clonezilla\n\nBefore backing up the VPS, I recommend using the GNU Screen utility, so if you lost network connection, you can still re-connect to your previous SSH session. To use GNU Screen, simply run in the following command.\n\nscreen\n\nYou will see an introduction text, press Enter and you will be able to use the command line as usual. Next, run the following command to start Clonezilla.\n\nsudo clonezilla\n\nIf you use the Clonezilla Live ISO image, you have the option to choose a language.\n\nAnd you can change the keyboard layout. (I use the default US keyboard.)\n\nThen, it asks you if you want to use the Clonezilla wizard (which is easy for beginners) or use the command-line interface). Choose the first option to start the Clonezilla wizard.\n\nNext, select a mode. This tutorial selects the first mode.\n\ndevice-image: create an image of the current disk or partition\n\ndevice-device: clone directly between two disks, without creating a disk image.\n\nAfter that, choose where the Cloned image will be saved. You have many options: local device, SSH server, Samba server, WebDAV Server, AWS S3 server, etc. This tutorial selects SSH server, so the disk image will be transferred to another server over SSH connection.\n\nNext, enter the IP address or hostname of the SSH server where you want the disk image to be stored.\n\nChoose SSH port.\n\nEnter the SSH username.\n\nEnter the directory where you want the disk image to be stored. Make sure the directory exists on the SSH server.\n\nEnter SSH password.\n\nNext, choose between beginner and expert mode. If you are a Clonezilla beginner, then choose the beginner mode.\n\nIn the next screen, you can choose to save an entire disk as an image or save a specific partition as an image. This tutorial chooses the first one (savedisk).\n\nThen give the image a name.\n\nAnd choose which disk you want to make a backup of.\n\nNext, choose which compression algorithm you want to use to compress the image.\n\nAfter that, choose if you want to check the disk file system before backing it up. The file system check is very fast, so I recommend checking the file system.\n\nAnd choose if you want to check the image is restorable.\n\nIn the next screen, you have the option to encrypt the image, which is useful if you save the image on a network location, so I choose to encrypt the image.\n\nAnd choose which action to take when everything is finished.\n\nNow Clonezilla kindly gives you the equivalent command-line, so you can enter this one-liner next time you make a backup without going through all the questions again. Press Enter to continue.\n\nThen enter a passphrase to encrypt the disk image. You will need to enter it twice.\n\nPress y to start saving your disk to an image.\n\nOnce Clonezilla finishes its job, you can reboot your VPS. If the process failed, you can check the /var/log/partclone.log file.\n\nMigrate to a New VPS Hosting Provider\n\nIf you want to migrate to a new VPS hosting provider, then create a new VPS instance at the new hosting provider. The disk size of the new VPS must be equal to or larger than the disk size of the old VPS. Next, you can restore the Clonezilla image to your new VPS. The restoration process is very similar to creating a backup. I won’t explain every step but show a few key steps.\n\nFirst, you need to follow the same procedure described in step 1 to boot up the new VPS from an Ubuntu ISO, connect to the Internet, and install Clonezilla.\n\nThen, Use fdisk to create a disk layout same as the old VPS:\n\nsame partition table\n\nsame file system\n\nsame sector number\n\nYou can run the following command on the old VPS to print the disk layout.\n\nsudo fdisk -l /dev/sda\n\nTo create disk partitions on the new VPS, run:\n\nsudo fdisk /dev/sda\n\nFollow these instructions.\n\nYou need to delete existing partitions by pressing o or g. o will create MBR partition table. g will create GPT partition table.\n\nType n to create a new partition.\n\nType p to select primary partition.\n\nType 1 to create /dev/sda1.\n\nPress Enter to choose the default first sector\n\nUse the same last sector location as your old VPS for /dev/sda1.\n\nType n again to create the second partition.\n\nOnce the partitions are created, press w to apply the changes.\n\nNext, start Clonezilla.\n\nsudo clonezilla\n\nChoose your language, keyboard layout and start the Clonezilla wizard, choose the device-image mode to restore the image to disk.\n\nThen select where the image will be read from. I stored the image on a remote SSH server, so this time I also make Clonezilla read the image from the remote SSH server.\n\nIf you choose to read Clonezilla image from a network location, then follow the instructions to set up network connection and authentication (username and password).\n\nAfter that, you should be able to choose the restoredisk mode to restore an image to local disk.\n\nAnd follow the rest of the instructions.\n\nWhen restoring the image to disk, Clonezilla will convert the device name of the disk partitions if they are different (for example, vda to sda).\n\nRestoration complete.\n\nBefore restarting your VPS, you can run the following command to get the MAC address of the main network interface, which you might need when configuring network connection.\n\nip addr\n\nNow you can reboot the new VPS from disk drive. If your OS is not bootable, you may need to update /etc/fstab file. Copy the content of /etc/fstab file from the old VPS.\n\nChange Network Connection for the New VPS\n\nAfter the image is restored on the new VPS, boot up the new VPS without the live operating system. Since the cloned disk contains network settings for the old VPS, you need to log in via VNC console and update the network configuration for the new VPS.\n\nIf you use CentOS/RHEL, you can update network configuration with:\n\nsudo nmtui\n\nFor the changes to take effect, you need to deactivate the existing connection and activate it again.\n\nIf you use Ubuntu, the network configuration can be edited under the /etc/netplan/ directory. Note that you need to change the MAC address. Once you finish editing netplan file, run the following command to apply your changes.\n\nsudo netplan apply\n\nNow your new VPS should be able to connect to the Internet.\n\nTroubleshooting\n\nUnable to find target partition sda1\n\nIf you see the following error when restoring the Clonezilla image to your new VPS, it’s likely that your Ubuntu live system doesn’t have the command required by Clonezilla to create disk partitions (unsupported command). You can use the fdisk command as described above to create disk partitions before using Clonezilla to restore the image on your new VPS.\n\nWrapping Up"
    }
}