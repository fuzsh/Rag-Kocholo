{
    "id": "dbpedia_8292_0",
    "rank": 31,
    "data": {
        "url": "http://clonezilla-sysresccd.hellug.gr/reloc-img.html",
        "read_more_link": "",
        "language": "en",
        "title": "Documentation: Restoring to a different location",
        "top_image": "",
        "meta_img": "",
        "images": [
            "http://clonezilla-sysresccd.hellug.gr/images/chain.png",
            "http://clonezilla-sysresccd.hellug.gr/images/print_it.png",
            "http://clonezilla-sysresccd.hellug.gr/images/rss-orange-11.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "",
        "meta_lang": "",
        "meta_favicon": "favicon.ico",
        "meta_site_name": "",
        "canonical_link": null,
        "text": "Intro [^]\n\nIn the past restoring to a different location was not supported by Clonezilla Live at all. Because of that, a script called reloc-img was added to Clonezilla-SysRescCD, which would help the user perform this task.\n\nRecent versions of Clonezilla Live partly support restoring to a different location, so the reloc-img script is obsolete, and has been removed. Clonezilla Live now supports:\n\nRelocation of a disk image (restoring a whole disk)\n\nRelocation of a partition image (restoring a partition)\n\nClonezilla Live does not support:\n\nRelocation of a single partition contained into a disk image.\n\nImagine you have a disk backup image named hda-2009-02-02. The image contains three partitions, hda1 (operating system), hda2 (user data) and hda3 (other data).\n\nYou want to restore your other data partition (hda3), to a different system (partition sdb2) but there is no way to restore (extract) a single partition from a disk image - you can only restore the whole disk.\n\nIn order to address this situation, two new scripts have been written for Clonezilla-SysRescCD: imginfo and imgconvert\n\nScript imginfo [^]\n\nThe script will be used to print info about existing image files.\n\nIts help screen is:\n\n# imginfo -h\n\nClonezilla Live Image Information\n\nimginfo v. 0.1 - (C) 2009 S. Georgaras <sng@hellug.gr>\n\nUsage: imginfo <options> <directory>\n\nAvailable options:\n\ns Search in sub-directories too\n\ni [name] Pring info for image [name]\n\nv Print version info and exit\n\nh Print this screen and exit\n\nScript imgconvert [^]\n\nThe script will be used to convert an existing disk image file to a new partition image file.\n\nimgconvert can create two type of images:\n\nTemporary image\n\nThis type of image is created by linking the data files of the existing disk image to the new partition image. This means that the original image must be present for the new image to be used. This is the default image type created by imgconvert.\n\nPermanent image\n\nThis type of image is created by copying the data files from the existing disk image to the new partition image. This means that the original image is not needed in order to use the new one. Permenant image files are created using the command line parameter -p.\n\nIts help screen is:\n\n# imgconvert -h\n\nClonezilla Live Image Conversion\n\nimgconvert v. 0.1 - (C) 2009 S. Georgaras <sng@hellug.gr>\n\nUsage: imgconvert <options> [image] [partition] <new partition>\n\nParameters are:\n\n[image] Disk image to be converted to partition image\n\n[partition] Partition name to convert. It must be a valid device name\n\nAvailable options:\n\no [image] Save new imag as [image]\n\np Save new partition instead of making a link to the old one\n\nv Print version info and exit\n\nh Print this screen and exit\n\nUsing the scripts [^]\n\nRestoring to a partition [^]\n\nAfter booting into Clonezilla Live, I select\n\nEnter_shell Enter command line prompt\n\nwhen the menu is displayed and then I press 2 to exit to the shell.\n\nAt this point I will mount my images partition (in this example /dev/sdc4), and use script imginfo to get info about my image files.\n\n$ sudo su -\n\n# mount /dev/sdc4 /home/partimag\n\n# cd /home/partimag\n\n# imginfo\n\nImage files found in: /home/partimag\n\nImage: usb250-img, disk: sda, size: 259MB, parts: 1\n\npart: sda4, size: 247.00MB, type: FAT16\n\nImage: sys-bck, disk: hda, size: 320.0GB, parts: 3\n\npart: hda1, size: 22.36GB, type: Linux\n\npart: hda2, size: 39.06GB, type: Linux\n\npart: hda3, size: 233.87GB, type: Linux\n\nAs you can see there are two disk images under /home/partimag: usb250-img and sys-bck.\n\nsys-bck is a backup of my old system, which had three partitions. What I need to do now is \"copy\" the hda3 partition to my current system, by transfering its data to partition sdb2.\n\nThe way to proceed is:\n\nCreate a new partition image (containing hda3's data) based on the existing disk image file, by executing the command:\n\n# imgconvert sys-bck hda3 sdb2\n\nClonezilla Live Image Conversion\n\nimgconvert v. 0.1 - (C) 2009 S. Georgaras\n\nDetermining input image\n\nInput image: \"/home/partimag/sys-bck\"\n\nValidating image... ok\n\nDetermining input partition\n\nInput partition: \"hda3\"\n\nValidating input partition... ok\n\nDetermining output image\n\nOutput image: \"/home/partimag/sys-bck-cnv\"\n\nValidating output image... ok\n\nChecking permissions... ok\n\nDetermining output partition\n\nOutput partition: \"sda2\"\n\nValidating output partition... ok\n\nCreating output image: /home/partimag/sys-bck-cnv\n\nLinking files... done\n\nFixing info files... done\n\nThis command will create a temporary partition image file (automatically named sys-bck-cnv), which contains sdb2 only, as you can see by executing:\n\n# imginfo -i sys-bck-cnv\n\nImage: sys-bck-cnv, part: sdb2, size: 233.87GB, type: Linux\n\nRestart Clonezilla Live by pressing Control-D twice.\n\nRestore the new image file into sdb2, by selecting\n\nScreen 1: Start_Clonezilla Start Clonezilla\n\nScreen 2: device-image disk/partition to/from image\n\nScreen 3: skip use existing /home/partimag\n\nScreen 4: Beginer / Expert\n\nScreen 5: restoreparts Restore_an_image_to_local_partition\n\nand continue as usual to restore the partition.\n\nConverting image files [^]\n\n# imgconvert -p -o other_data sys-bck hda3 sdb2\n\nClonezilla Live Image Conversion\n\nimgconvert v. 0.1 - (C) 2009 S. Georgaras\n\nDetermining input image\n\nInput image: \"/home/partimag/sys-bck\"\n\nValidating image... ok\n\nDetermining input partition\n\nInput partition: \"hda3\"\n\nValidating input partition... ok\n\nDetermining output image\n\nOutput image: \"/home/partimag/other_data\"\n\nValidating output image... ok\n\nChecking permissions... ok\n\nDetermining output partition\n\nOutput partition: \"sda2\"\n\nValidating output partition... ok\n\nCreating output image: /home/partimag/other_data\n\nCopying files... done\n\nFixing info files... done\n\n# imginfo -i other_data\n\nImage: other_data, part: sdb2, size: 233.87GB, type: Linux\n\n# ls -la sys-bck\n\ntotal 1111972\n\ndrwxr-xr-x 2 root root 4096 2007-11-22 03:21 .\n\ndrwxr-xr-x. 34 root root 4096 2009-04-06 21:28 ..\n\n-rw-r--r-- 1 root root 4 2007-11-20 20:33 disk\n\n-rw-r--r-- 1 root root 1081716736 2007-11-20 20:32 hda1.aa\n\n-rw-r--r-- 1 root root 45453312 2007-11-20 20:33 hda2.aa\n\n-rw-r--r-- 1 root root 10317824 2007-11-20 20:33 hda3.aa\n\n-rw-r--r-- 1 root root 37 2007-11-21 18:56 hda-chs.sf\n\n-rw-r--r-- 1 root root 37 2007-11-21 18:50 hda-chs.sf.orig\n\n-rw-r--r-- 1 root root 512 2007-11-20 20:31 hda-mbr\n\n-rw-r--r-- 1 root root 259 2007-11-21 18:59 hda-pt.sf\n\n-rw-r--r-- 1 root root 259 2007-11-21 18:50 hda-pt.sf.orig\n\n-rw-r--r-- 1 root root 15 2007-11-20 20:33 parts\n\n-rw-r--r-- 1 root root 17 2007-11-20 20:33 swappt-hda4.info\n\n#\n\n#\n\n# ls -la other_data\n\ntotal 24\n\ndrwxr-xr-x 2 root root 4096 2009-04-06 21:27 .\n\ndrwxr-xr-x. 35 root root 4096 2009-04-06 21:27 ..\n\n-rw-r--r-- 1 root root 5 2009-04-06 21:27 parts\n\n-rw-r--r-- 1 root root 10317824 2009-04-06 21:27 sdb2.aa\n\n-rw-r--r-- 1 root root 37 2009-04-06 21:27 sdb-chs.sf\n\n-rw-r--r-- 1 root root 106 2009-04-06 21:27 sdb-pt.sf\n\nBooting a restored Linux system [^]\n\nA Linux system that has been restored to a new disk/partition, is usually not ready to be booted right after the restoration procedure is finished.\n\nThere are two more steps that you may have to take:\n\nFix /etc/fstab\n\nReinstall GRUB.\n\nI will assume GRUB is your boot manager, as it is the usual case nowadays.\n\nFor this example I will assume that you have restored a Linux system (that used to be in sdb), to a new disk (hda), and that it contains three partitions, / (the root partition), /home (user's partition) and a swap partition. You must be really careful here, as the name of the new disk depends on the system to be booted. If it uses one of the newest Linux kernels (using the libata disk driver), ALL your disks will be recognised as SCSI. More info: \"Identifying devices in Linux\" section \"SCSI disks when there are none!!!\".\n\nThis is what we have:\n\nroot partition home partition swap partition\n\nOld system /dev/sdb1 /dev/sdb2 /dev/sdb3\n\nNew system /dev/hda1 /dev/hda2 /dev/hda3\n\nFixing /etc/fstab [^]\n\nSince we are still in Clonezilla Live, right after the restore procedure has finished, we will use it to mount our restored root partition, and edit its /etc/fstab. We issue the commands:\n\nmkdir /new-root\n\nmount /dev/hda1 /new-root\n\nvi /new-root/etc/fstab\n\nThe contents of /etc/fstab could be something like\n\n/dev/sdb1 / reiserfs acl,user_xattr 1 1\n\n/dev/sdb2 /home reiserfs defaults 1 2\n\n/dev/sdb3 swap swap defaults 0 0\n\nand we have to change ti to\n\n/dev/hda1 / reiserfs acl,user_xattr 1 1\n\n/dev/hda2 /home reiserfs defaults 1 2\n\n/dev/hda3 swap swap defaults 0 0\n\nFinally, we unmount the partition, and we are ready to reboot\n\numount /new-root\n\nreboot\n\nReinstalling GRUB [^]\n\nWhen Clonezilla-SysRescCD menu appears, we select Tools > Super Grub Disk\n\nThen we select Super Grub Disk > Super Grub Disk (WITH HELP) > English Super Grub Disk > Gnu/Linux > Fix Boot of Gnu/Linux (GRUB). From this entry we will be able to reinstall GRUB to our hard disk."
    }
}