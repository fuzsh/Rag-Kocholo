{
    "id": "dbpedia_186_1",
    "rank": 90,
    "data": {
        "url": "https://www.statalist.org/forums/forum/general-stata-discussion/general/1464671-numerating-one-variable-based-on-the-sorted-order-of-another-variable%3Fp%3D1464695",
        "read_more_link": "",
        "language": "en",
        "title": "Numerating one variable based on the sorted",
        "top_image": "",
        "meta_img": "",
        "images": [
            "https://www.statalist.org/forums/forum/general-stata-discussion/general/images/statalist-forums-logo3.png",
            "https://www.statalist.org/forums/forum/general-stata-discussion/general/core/images/default/default_avatar_medium.png",
            "https://www.statalist.org/forums/forum/general-stata-discussion/general/core/image.php?userid=182&thumb=1&dateline=1396363608",
            "https://www.statalist.org/forums/forum/general-stata-discussion/general/core/images/default/default_avatar_medium.png",
            "https://www.statalist.org/forums/forum/general-stata-discussion/general/core/image.php?userid=6&thumb=1&dateline=1395161889",
            "https://www.statalist.org/forums/forum/general-stata-discussion/general/core/images/default/default_avatar_medium.png",
            "https://www.statalist.org/forums/forum/general-stata-discussion/general/core/image.php?userid=6&thumb=1&dateline=1395161889",
            "https://www.statalist.org/forums/forum/general-stata-discussion/general/core/images/default/default_avatar_medium.png",
            "https://www.statalist.org/forums/forum/general-stata-discussion/general/core/image.php?userid=6&thumb=1&dateline=1395161889",
            "https://www.statalist.org/forums/forum/general-stata-discussion/general/core/images/default/default_avatar_medium.png",
            "https://www.statalist.org/img/stata-footer-icon.png",
            "https://www.statalist.org/img/standardized-fb-icon-rnav.png",
            "https://www.statalist.org/img/standardized-tw-icon-rnav.png",
            "https://www.statalist.org/img/standardized-in-icon-rnav.png",
            "https://www.statalist.org/img/standardized-youtube-icon-rnav.png",
            "https://www.statalist.org/img/standardized-blog-icon-rnav.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": "2018-10-04T17:35:45",
        "summary": "",
        "meta_description": "Hi,  I am working on a dataset almost includes 5000 observation, and I would like to create a new variable based on the sorted-order of another variable.  To",
        "meta_lang": "en",
        "meta_favicon": "images/favicon.ico",
        "meta_site_name": "",
        "canonical_link": "https://www.statalist.org/forums/forum/general-stata-discussion/general/1464671-numerating-one-variable-based-on-the-sorted-order-of-another-variable",
        "text": "Hi,\n\nI am working on a dataset almost includes 5000 observation, and I would like to create a new variable based on the sorted-order of another variable.\n\nTo put it simply, it is a list of political leaders in each year, thus it is listed as the following:\n\nvar1 var2 var3\n\nUSA Donald Trump 2017\n\nUSA Donald Trump 2018\n\nSince there are some people who left the office and elected again, after sorting the data based on year (var3 in the example), var2 is listed as following:\n\nA - A - A - B - B - A - A - C -C.\n\nNow I have to assign them spell number, and it becomes tricky for person A, who left the office to B and retook it. What I would like to see as result in my new variable is 1 - 1 - 1 - 1 - 1- 2 - 2 - 1 - 1 , as person A serves for second time. If he would stay in the office for 5 years continuously, all would be 1 but we have to assign a new number for the new spell.\n\nIn this case, what would you suggest me in assigning spell numbers?\n\nThough I couldn't explain well what I would to do, I hope it will be enough for you.\n\nThanks,\n\nCem\n\nCode:\n\n* Example generated by -dataex-. To install: ssc install dataex clear input str1 leader float year str1 country \"a\" 2000 \"X\" \"a\" 2001 \"X\" \"a\" 2002 \"X\" \"b\" 2003 \"X\" \"b\" 2004 \"X\" \"a\" 2005 \"X\" \"a\" 2006 \"X\" \"c\" 2007 \"X\" \"c\" 2008 \"X\" \"a\" 2000 \"Y\" \"a\" 2001 \"Y\" \"c\" 2002 \"Y\" \"b\" 2003 \"Y\" \"b\" 2004 \"Y\" \"b\" 2005 \"Y\" \"a\" 2006 \"Y\" \"c\" 2007 \"Y\" \"c\" 2008 \"Y\" end by country leader (year), sort: gen spell = sum(year != year[_n-1] + 1) sort country year leader\n\nIn the future, when showing data examples, please use the -dataex- command to do so, as I have done here. If you are running version 15.1 or a fully updated version 14.2, it is already part of your official Stata installation. If not, run -ssc install dataex- to get it. Either way, run -help dataex- to read the simple instructions for using it. -dataex- will save you time; it is easier and quicker than typing out tables. It includes complete information about aspects of the data that are often critical to answering your question but cannot be seen from tabular displays or screenshots. It also makes it possible for those who want to help you to create a faithful representation of your example to try out their code, which in turn makes it more likely that their answer will actually work in your data.\n\nWhen asking for help with code, always show example data. When showing example data, always use -dataex-.\n\nDear Clyde,\n\nThank you for your help and suggestion for sharing data example. Since I did not mention that there are more than one row per year in some cases (I can't drop them as we should keep them to notice their start date), your suggestion with \"sum(year != year[_n-1] + 1\" did not work properly, and I could not adapt to our case neither. As you suggested, I am sharing the data example by using dataex in below.\n\n* Example generated by -dataex-. To install: ssc install dataex\n\nclear\n\ninput int country_id str10 historical_date str11 country_name str52 v3exnamhog\n\n36 \"1788-12-31\" \"Afghanistan\" \"Payinda Khan Mohammadzai\"\n\n36 \"1789-12-31\" \"Afghanistan\" \"Payinda Khan Mohammadzai\"\n\n36 \"1790-12-31\" \"Afghanistan\" \"Payinda Khan Mohammadzai\"\n\n36 \"1791-12-31\" \"Afghanistan\" \"Payinda Khan Mohammadzai\"\n\n36 \"1792-12-31\" \"Afghanistan\" \"Payinda Khan Mohammadzai\"\n\n36 \"1793-01-01\" \"Afghanistan\" \"Wafadar Khan\"\n\n36 \"1793-12-31\" \"Afghanistan\" \"Wafadar Khan\"\n\n36 \"1794-12-31\" \"Afghanistan\" \"Wafadar Khan\"\n\n36 \"1795-12-31\" \"Afghanistan\" \"Wafadar Khan\"\n\n36 \"1796-12-31\" \"Afghanistan\" \"Wafadar Khan\"\n\n36 \"1797-12-31\" \"Afghanistan\" \"Wafadar Khan\"\n\n36 \"1798-12-31\" \"Afghanistan\" \"Wafadar Khan\"\n\n36 \"1799-12-31\" \"Afghanistan\" \"Wafadar Khan\"\n\n36 \"1800-12-31\" \"Afghanistan\" \"Wafadar Khan\"\n\n36 \"1803-01-01\" \"Afghanistan\" \"Shir Mohammad Khan\"\n\n36 \"1803-12-31\" \"Afghanistan\" \"Shir Mohammad Khan\"\n\n36 \"1804-12-31\" \"Afghanistan\" \"Shir Mohammad Khan\"\n\n36 \"1805-12-31\" \"Afghanistan\" \"Shir Mohammad Khan\"\n\n36 \"1806-12-31\" \"Afghanistan\" \"Shir Mohammad Khan\"\n\n36 \"1807-12-31\" \"Afghanistan\" \"Shir Mohammad Khan\"\n\n36 \"1808-01-01\" \"Afghanistan\" \"Nawab Mohammad Usman Khan\"\n\n36 \"1808-12-31\" \"Afghanistan\" \"Nawab Mohammad Usman Khan\"\n\n36 \"1809-01-01\" \"Afghanistan\" \"Fateh Khan\"\n\n36 \"1809-12-31\" \"Afghanistan\" \"Fateh Khan\"\n\n36 \"1810-12-31\" \"Afghanistan\" \"Fateh Khan\"\n\n36 \"1811-12-31\" \"Afghanistan\" \"Fateh Khan\"\n\n36 \"1812-12-31\" \"Afghanistan\" \"Fateh Khan\"\n\n36 \"1813-12-31\" \"Afghanistan\" \"Fateh Khan\"\n\n36 \"1814-12-31\" \"Afghanistan\" \"Fateh Khan\"\n\n36 \"1815-12-31\" \"Afghanistan\" \"Fateh Khan\"\n\n36 \"1816-12-31\" \"Afghanistan\" \"Fateh Khan\"\n\n36 \"1817-12-31\" \"Afghanistan\" \"Fateh Khan\"\n\n36 \"1818-01-01\" \"Afghanistan\" \"Mohammad Azim Khan\"\n\n36 \"1818-12-31\" \"Afghanistan\" \"Mohammad Azim Khan\"\n\n36 \"1819-12-31\" \"Afghanistan\" \"Mohammad Azim Khan\"\n\n36 \"1820-12-31\" \"Afghanistan\" \"Mohammad Azim Khan\"\n\n36 \"1821-12-31\" \"Afghanistan\" \"Mohammad Azim Khan\"\n\nThank you all in advance,\n\nCem\n\nThank you, Nick. What you did help me to create id number for each leader, but does not reflect the spell number per person. In the given example, all spell numbers should be numerated as 1 since no person go back and forth. However, if any of the five leader comes back to the office after Mohammad Azim Khan, then spell number will be 2 for the leader who will be listed on line 38.\n\nBtw, there is not more than one person in the role at the same time, thus we don't need to consider that."
    }
}