{
    "id": "dbpedia_1871_2",
    "rank": 55,
    "data": {
        "url": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10221789/",
        "read_more_link": "",
        "language": "en",
        "title": "A Return to the Sextant—Maritime Navigation Using Celestial Bodies and the Horizon",
        "top_image": "https://www.ncbi.nlm.nih.gov/corehtml/pmc/pmcgifs/pmc-card-share.jpg?_=0",
        "meta_img": "https://www.ncbi.nlm.nih.gov/corehtml/pmc/pmcgifs/pmc-card-share.jpg?_=0",
        "images": [
            "https://www.ncbi.nlm.nih.gov/coreutils/uswds/img/favicons/favicon-57.png",
            "https://www.ncbi.nlm.nih.gov/coreutils/uswds/img/icon-dot-gov.svg",
            "https://www.ncbi.nlm.nih.gov/coreutils/uswds/img/icon-https.svg",
            "https://www.ncbi.nlm.nih.gov/coreutils/nwds/img/logos/AgencyLogo.svg",
            "https://www.ncbi.nlm.nih.gov/corehtml/pmc/pmcgifs/logo-sensors.png",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10221789/bin/sensors-23-04869-g001.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10221789/bin/sensors-23-04869-g002.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10221789/bin/sensors-23-04869-g003.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10221789/bin/sensors-23-04869-g004.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10221789/bin/sensors-23-04869-g005.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10221789/bin/sensors-23-04869-g006.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10221789/bin/sensors-23-04869-g007.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10221789/bin/sensors-23-04869-g008.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10221789/bin/sensors-23-04869-g009.jpg",
            "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10221789/bin/sensors-23-04869-g010.jpg"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "Daniele Mortari"
        ],
        "publish_date": "2023-05-27T00:00:00",
        "summary": "",
        "meta_description": "Satellite navigation over recent decades has become the default and, in some cases, sole source of positioning for maritime vessels. The classic sextant has been all but forgotten by a significant number of ship navigators. However, recent risks to RF-derived ...",
        "meta_lang": "en",
        "meta_favicon": "https://www.ncbi.nlm.nih.gov/coreutils/nwds/img/favicons/favicon.ico",
        "meta_site_name": "PubMed Central (PMC)",
        "canonical_link": "https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10221789/",
        "text": "Sensors (Basel). 2023 May; 23(10): 4869.\n\nPMCID: PMC10221789\n\nPMID: 37430782\n\nA Return to the Sextant—Maritime Navigation Using Celestial Bodies and the Horizon\n\n, Methodology1 and , Methodology, Supervision2,*\n\nJoshua J. R. Critchley-Marrows\n\n1School of Aerospace, Mechanical and Mechatronic Engineering, University of Sydney, Sydney, NSW 2006, Australia; ua.ude.yendys@sworram-yelhctirc.auhsoj\n\nFind articles by Joshua J. R. Critchley-Marrows\n\nDaniele Mortari\n\n2Aerospace Engineering, Texas A&M University, College Station, TX 77843-3141, USA\n\nFind articles by Daniele Mortari\n\nAntonio M. Pascoal, Academic Editor\n\n1School of Aerospace, Mechanical and Mechatronic Engineering, University of Sydney, Sydney, NSW 2006, Australia; ua.ude.yendys@sworram-yelhctirc.auhsoj\n\n2Aerospace Engineering, Texas A&M University, College Station, TX 77843-3141, USA\n\nCopyright © 2023 by the authors.\n\nLicensee MDPI, Basel, Switzerland. This article is an open access article distributed under the terms and conditions of the Creative Commons Attribution (CC BY) license (https://creativecommons.org/licenses/by/4.0/).\n\nAbstract\n\nSatellite navigation over recent decades has become the default and, in some cases, sole source of positioning for maritime vessels. The classic sextant has been all but forgotten by a significant number of ship navigators. However, recent risks to RF-derived positioning by jamming and spoofing have resurfaced the need to train sailors again in the art. Innovations in space optical navigation have long been perfecting the art of using celestial bodies and horizons to determine a space vessel’s attitude and position. This paper explores their application to the much older ship navigation problem. Models are introduced that utilize the stars and horizon to derive latitude and longitude. When assuming good star visibility conditions on the ocean, the accuracy delivered is at the 100 m level. This can meet requirements for ship navigation in coastal and oceanic voyages.\n\nKeywords: celestial navigation, alternative PNT, maritime\n\n1. Introduction\n\nThe sextant could be argued to be one of the most influential inventions of the second millennium. Invented by John Bird in 1759, and consisting of an optical telescope and some measuring tools, the user could calculate the angle from the star or Sun in relation to the Earth’s horizon. Alongside knowledge of the time, a geographical position could be derived within a few kilometres, allowing humans to travel, explore, transport, and supply the globe with far greater confidence and efficiency.\n\nIn the last decades, this indispensable tool has been rejected for satellite-based navigation systems. The first of these systems was TRANSIT, a constellation of approximately five satellites that transmitted Radio Frequency (RF) communication signals to provide a position reference to US Naval missiles and vessels via measuring the Doppler change.\n\nThe system’s success led to a modernisation that became known as Global Positioning System (GPS), a constellation of 32 satellites in Medium Earth Orbit (MEO) that regularly transmit their current location as an open service to users across the globe. Unfortunately, even though it is easily adaptable, they are also easily penetrable through jamming and spoofing attacks by altering the data so that a receiver device appears in a different location.\n\nThe maritime sector in particular has been subject to some of the most extreme jamming and spoofing attacks of recent years. One such series of events was exposed in a study by the Centre for Advanced Defence Studies [1]. Focusing on GPS spoofing attacks in Russia and Syria, cases were reported in the Black Sea and Syria, where cargo ships reported their position several miles outside of Moscow. Similar events have also been reported in the Port of Shanghai, China [2], as well as around the Red Sea [3].\n\nIn response to these technological attacks, as well as other sources of disruption to GNSSs, the International Authority of Lighthouse Authorities derived a suggested list of minimum maritime user requirements for each phase of voyage [4]. The suggested performances suitable for the use of the new generation of sextants are during the ocean and coastal phases of the voyage, where accuracies of less than 100 m are required. This is within an absolute frame, so dead reckoning-based systems would not be feasible.\n\nAlternatives to navigation in the maritime domain have been treated by various authors [5,6,7,8,9,10]. Solutions consider the use of the new communication signals from Very High Frequency (VHF) Data Exchange and Automatic Identification Systems for ranging as well as radar-based and autonomous sextants.\n\nIn contrast to most celestial navigation cases considered in the literature [10,11,12,13], which all use modern interpretations of the sextant first developed in antiquity, this paper treats the problem from a spacecraft navigation perspective. The ocean, in the absence of currents, tides, waves, etc., follows the geoid surface. The geoid altitude’s deviation from the ellipsoidal representation of the Earth is in the range of ±100 m, while the local direction normal to the geoid differs from the normal to the ellipsoid up to several arc-secs. This normal deviation difference is, in general, provided in terms of two angles, the north–south deviation and the east–west deviation. The difference is minimal compared to the ellipsoid’s major and minor axes.\n\nThis paper first introduces a mathematical foundation to the horizon problem and then adapts it to various estimation formulations to achieve the best accuracy for the various geometries encountered. The foundation is based on models created for the case of a spacecraft in orbit, but powerful simplifications may be made to improve performance in the maritime domain. The approach is justified by a simple but valid model to portray the oceanic environment, which generally follows the ellipsoid.\n\nThe paper might be treated as a sequel to [14], which considers the terrestrial celestial navigation problem using a pair of two orthogonal inclinometers instead of a horizon sensor. Even though the horizon is less available than the Earth’s gravity, it is not affected by the motion of the ship, which may even occur while stationary by the roll of ocean waves.\n\n2. Horizon Models and Interpretations\n\nThis section provides an introduction to the interpretation of the ocean horizon using the conventions presented in [15,16,17]. These are presented in the context of the marine environment.\n\n2.1. Earth’s Shape Description\n\nAs is well known, the Earth’s shape is not a sphere but more closely resembles an oblate spheroid. The oblate spheroid is commonly described by the World Geodetic System (WGS). Since its development in 1984 by the National Geospatial-Intelligence Agency, using predecessor models from the initial WGS 60 through to WGS 72, the geodetic description has continued to be refined using the latest results in geodetic positioning measurements, land gravity surveys, altimetry data records, and satellite observations. The model presented and considered in this work is the description as of 2014 [18].\n\nThe mathematical description of the ellipsoid is a three-dimensional surface in which all cross-sections create either a circle or an ellipse on the plane. The ellipsoid is characterized by three principal axes, each with a radius dimension given by a, b, and c. Convention treats a>b>c. A point on the surface (X,Y,Z) is expressed by\n\nX2a2+Y2b2+Z2c2=1.\n\n(1)\n\nThis expression might also be given in matrix form:\n\nX,Y,Za−2000b−2000c−2XYZ=ppTAppp=1,\n\n(2)\n\nwhere pp=X,Y,ZT and subscript p indicates it is in the ellipsoid or planetary reference frame.\n\nIn the case of Earth, the shape is an axial-symmetric ellipsoid, and so the two principal dimensions are a=b. The planetary frame is fixed to the planet and can be made coincident with the Earth Centered, Earth Fixed (ECEF) reference frame. The ellipsoid of the Earth is illustrated in .\n\nTaking things a step further, the Earth’s shape is better modelled by the geoid. The geoid is the gravitational potential level that the ocean would conform to in absence of an external force. This may otherwise be labelled as the mean sea level.\n\nThe geoid surface is described by the Earth Gravitational Model (EGM), which is a formulation managed by the National Geological Survey in the United States. The EGM represents the gravitational potential due to the Earth’s mass alone (ignoring all rotation effects) by the use of spherical harmonics. The gravitational potential is expressed as\n\nV=μr1+∑n=2Narn∑m=0nP¯nm(sinθ)(C¯mncosmλ+S¯mnsinmλ),\n\n(3)\n\nwhere μ is the geocentric gravitational constant, r is the distance from the Earth’s centre of mass, a is the semi-major axis of the WGS-84 ellipsoid, C¯nm and S¯nm are fully normalized gravitational coefficients with degree n and order m, λ is the longitude, θ is the geocentric latitude, and P¯nm is the fully normalized associate Legendre function of the second kind.\n\n2.2. Optical System Perspective of the Ellipsoid\n\nFor an optical system observing the planet at a position r, the projected surface image is a conic section [15], either a hyperbola or an ellipse. The general quadratic equation describes all conic sections:\n\nAx2+Bxy+Cy2+Dx+Fy+G=0,\n\n(4)\n\nwhere B2−4AC⋚0 give an ellipse, a parabola, and a hyperbola, respectively.\n\nThe image plane depth would be typically represented by an optical system with focal length f, and so a vector similar to pp might be defined as s=x,y,fT. In matrix form,\n\nsTCs=0,\n\n(5)\n\nwhere\n\nC=122Af2Bf2DfBf22Cf2FvfDfFf2G.\n\n(6)\n\nGiven that the planetary surface is being viewed by a camera in the body frame, it might be helpful to transform the ellipsoid treated in Section 2.1 to the camera frame using an orthogonal transformation matrix, Tpb, where the subscript implies a transformation from body frame “b” to planetary frame “p”. Equation (2) may then be rewritten as\n\npbTTpbTApTpbpb=pbTAbpb=1,\n\n(7)\n\nwhere the transformation has been applied in the form pp=Tpbpb and Ab=TpbTApTpb.\n\nThe relation of the image plane position sb and planetary surface point pb is driven by the displacement of the body to the surface centre, rb. This relation is simply\n\npb=dsb+rb,\n\n(8)\n\nwhere sb is assumed to be of unit vector length and d is then the distance from the vehicle to the surface point. Substituting into Equation (7) produces\n\n1=(dsb+rb)TA(dsb+rb)=rbTAbrb+2drbTAbsb+d2sbTAbsb.\n\n(9)\n\nThis expression takes the form of a quadratic equation which may be solved for d,\n\nd=−rbTAbsbsbTAbsb.\n\n(10)\n\nSubstituting back into Equation (9),\n\nsbT(AbrbrbTAb)sb=sbT[(rbTAbrb−1)Ab]sb,\n\nand rearranging,\n\nsbTMbsb=0,\n\n(11)\n\nwhere,\n\nMb=AbrbrbTAb−(rbTAbrb−1)Ab.\n\n(12)\n\nThe matrix Mb describes the perspective of the ellipsoid in the body frame of the optical sensor. This matrix contains some interesting properties that may be manipulated to identify the conic section shape visible to the sensor. It should be noted that this does not represent the projection on an image plane, which is dependent on the pointing direction.\n\n2.3. Ellipsoid Shape and Horizon Dip\n\nTo further explore the shape observed in the image plane, considering if the sensor is not pointing directly at the ellipsoid, consider again Equation (11). Expanding out, this may be expressed as\n\n0=m11x2+2m12xy+m22y2+2m13fx+2m23fy+m33f2,\n\n(13)\n\nwhere mij is the matrix term on row i and column j. This expression is the quadratic equation for Cartesian coordinates x and y. Depending on the coefficients, the expression may represent a circle, ellipse, parabola, or hyperbola. The hyperbolic expression is reflective of cases when the sensor is close to the surface, as is the case for a maritime vessel.\n\nThe approximate “dip” in the horizon caused by the Earth’s surface curvature is dependent on the distance to the surface and the view field size. Considering the Earth’s surface is captured using a camera sensor, the horizon dip may be expressed in camera pixels, and so another dependent is the sensor resolution.\n\nTo calculate this accurately, a chord line to the curve is drawn across the image boundaries. The distance from which the line and curve are greatest is the horizon dip. This fit is illustrated for an image of resolution 1024×1024 px in .\n\nSimulating for various altitudes and calculating the maximum difference between the chord to the curve, the horizon dip is presented in . This highlights that for low altitudes, the dip in the horizon is indistinguishable from the sensor noise, which might be a few pixels in magnitude for each sensed horizon position. This noise may also be indistinguishable from slight changes to the horizon’s surface with the geoid.\n\nTo justify the negligible noise caused by the geoid’s variation to the ellipsoid, consider the angular difference in the horizon from the zenith to the horizon pointing vector, i.e., between r and s. Using Pythagoras, considering a triangle constructed by a line pointing from the Earth’s origin to the ship and another line pointing to the perpendicular of s, the angle might be expressed by\n\nsinα=RM2(RM+δ)2.\n\n(14)\n\nwhere RM is the meridional radius for the ellipsoid, defined by\n\nRM=a(1−e2)(1−e2sin2ϕ)3/2.\n\n(15)\n\nIf there is a variation in the meridional radius caused by the geoid, then using linear error propagation, it may be expressed as an equivalent error in the angle by\n\nσα=∂α∂RMσRM=2RMδ(RM+δ)(RM+δ)4−RM4σRM.\n\n(16)\n\nConsidering the geoid variation range does not exceed ±100 m, this is equivalent to the standard deviation of angle change in α by 0.0041 arc-secs and thus would be negligible for most standard camera optics.\n\n2.4. Measuring Stars on the Earth’s Surface\n\nMeasuring stars on Earth has been a common problem for the navigator since ancient history when early civilizations such as the Polynesians used the night sky to navigate across land and sea. The celestial map has since been treated as a tool for both determining position and attitude. In this work, the orientation determination properties of stars and their constellations will be treated and adopted. Known as star tracking, in the form of a star tracker sensor, the orientation matrix measured is utilized alongside the horizon to determine a position and is the topic of Section 3.\n\nStar tracker orientation determination for space applications has been well studied for the last 60 years since Apollo, and many models exist to estimate sensor pointing from a sequence of star measurements [19,20,21,22,23]. State-of-the-art systems can deliver attitude accuracies at 1 arc-sec, especially when combined with a gyroscope [20]. However, this might be more difficult on Earth-bound ships.\n\nThe key challenge for the star tracker on Earth is the effects if the atmosphere, both in terms of optical effects caused by the varying compositional layers of the atmosphere and visibility due to cloud cover and ambient light. The atmospheric deflection makes the star appear closer to the zenith. This effect increases towards the horizon, with a maximum shift close to 34 arc-min at this extremity [24]. The other effect is astronomical seeing, where varying winds and air currents across different atmospheric layers distort the known refraction. However, this noise is only approximately 1 arc-sec [25].\n\nThe effect of atmospheric deflection has been a problem treated and solved in the 19th century by Gauss, using three measured stars, with known right ascension and declination in the celestial sphere, and time [26]. Since star identification has been solved by pattern recognition alone [19], the defection effect may then be corrected with absolute precision under a standard atmosphere. The considered noise of deflection may then be 1 arc-sec by astronomical seeing. In addition, atmospheric deflection is a known function of the star elevation over the local horizon, and the local horizon can always be computed by two orthogonal inclinometers, as suggested in Ref. [14].\n\nSky visibility is more challenging and highly unpredictable. Optical filters have been installed and tested on cameras to permit better daytime operations, targeting the shortwave infrared [27,28]. Stars were measured on a balloon-borne platform, delivering below sub-arc-second performances. Cloud cover leads to nearly no operation of the star tracker, and poor visibility cause by low-lying clouds can also disrupt the horizon. It is considered that the proposed techniques in this work cannot operate in those conditions. However, the suggested technique of using two inclinometers in association may help [14].\n\nOn the ground, star trackers have been both evaluated and tested on Earth in previous work of the authors [29,30,31]. Both have demonstrated arc-second precision. The estimated accuracy of the star tracker is simulated at approximately σ=10 arc-sec, as has been demonstrated is obtainable from previous testing. This figure is a conservative estimate and considers the lower-end spectrum of sensors that employ commercial-off-the-shelf components [23].\n\n3. Least-Squares Formulations\n\nThe surface descriptions treated previously may be manipulated to provide an estimate of the sensor position based on a series of measured horizon points. Four models are introduced. The first is a simple Non-Linear Least Squares (NLLS) approach to the ellipsoid description introduced through Equation (11) proposed in [16] for a three-dimensional position, the second is based on the Christian–Robinson method [16], and the last two take advantage of a usually known surface height and near linear horizon surface.\n\nIn each model, the transformation matrix Tpb must also be estimated. This is derived by star measurements, which provide knowledge of the difference between the inertial celestial frame and the sensor body frame, creating a transformation matrix Tib. Using time knowledge and well-known models of the Earth’s rotation and nutation, the frame transformation from inertial to fixed planetary Tpi is also known. Thus, the required transformation matrix is calculated by Tpb=Tpb(q)=TpiTib, where q is the quaternion description.\n\n3.1. Position by Nonlinear Least-Squares\n\nThe nonlinear least-squares solution is obtained using the treatment of Equation (11) maintained in the implicit state. To avoid formulations of higher-order tensors, this can be treated in the planetary frame. Rewriting in this frame, we obtain\n\n(Tpb(q)s)TMpTpb(q)s=0,\n\n(17)\n\nwhere\n\nMp=AprprpTAp−(rpTAprp−1)Ap.\n\nFor the rest of this article, all parameters will be considered in the planetary frame unless explicitly stated, where horizon measurements, s, have been transformed by the estimated attitude by the star tracker.\n\nFirst, considering the state vector derivatives, it might be helpful to write out Equation (11) as\n\nsTArrTAs−sT(rTAr−1)As=0.\n\nFor the derivative of the position vector, we may then consider each term. The first term is treated as\n\nsTArrTAs=(ATs)TrrTAs=wTrrTw\n\nwhere w=As=ATs=w1,w2,w3T. Taking the derivative in terms of r obtains\n\n∂∂r(sTArrTAs)=2rTwwT=2rTAs(As)T.\n\nSimilarly, expanding the second term,\n\nsT(rTAr−1)As=sT(rTAr)As−sTAs=(rTAr)sTAs−sTAs,\n\nand taking the derivative in terms of r,\n\n∂∂r[(rTAr)sTAs−sTAs]=2rAsTAs,\n\nusing again the knowledge that A=AT. Combining the two terms produces\n\n∂∂r(sTMs)=2rTAs(As)T−2rAsTAs.\n\n(18)\n\nThe nonlinear least-squares technique is an iterative solution, which, for the implicit model function h=sTMs=0, is given by\n\nxk+1=xk−(HTH)−1HTh,\n\n(19)\n\nwhere the state estimate is x=r and k is the iteration number. This technique is dependent on a good initial guess of the solution to achieve a correct convergence, given this solution is not optimal by its highly nonlinear nature.\n\n3.2. Christian-Robinson Method\n\nThe Christian–Robinson technique is considered one of the most successful techniques for optical navigation in spacecraft, providing a much stronger performance compared to traditional ellipse-fitting methodologies [15]. The method returns to Equation (11), rewritten here for convenience:\n\nsiTMsi=siTArrTAsi−siT(rTAr−1)Asi=0.\n\n(20)\n\nThe solution harnesses the transformation of this expression into Cholesky factorization space, which is given by\n\nr¯=Urands¯i=Usi,\n\n(21)\n\nwhere\n\nA=UTU.\n\n(22)\n\nThus, we can rewrite the factorization as\n\ns¯iTI3×3r¯r¯TI3×3s¯i−s¯iT(r¯TI3×3r¯−1)I3×3s¯i=s¯iTr¯r¯Ts¯i−s¯iT(r¯Tr¯−1)s¯i=0,\n\n(23)\n\nwhere the variables of r¯ and s¯i are now in Cholesky space. The shape matrix in this space has been replaced with an identity matrix I3×3, and so the observed body is no longer an ellipsoid, but a much simpler unit-sphere.\n\nGiven the transformed geometry, the angle between the horizon line-of-sight direction vectors s¯i and the relative position vector r¯ are the same, and so,\n\ns¯iTr¯=−r¯cosθ¯,\n\n(24)\n\nwhere it is assumed s¯i has been normalized to a unit vector and r¯ is the magnitude of the transformed position vector, i.e., r¯=||r¯||. Define a new quantity\n\nn=−1r¯cosθ¯r¯,\n\n(25)\n\nwhich permits the expression to be rewritten as\n\ns¯iTn=1.\n\n(26)\n\nThe new quantity n is essentially a pointing vector to the unit-sphere from the transformed observer position.\n\nThe problem has now been reduced to a simple linear least-squares problem. Given a set of m horizon points, the problem may be expressed using\n\nHn=1m×1,\n\n(27)\n\nwhere\n\nH=s¯1T⋮s¯mT.\n\n(28)\n\nReference [15] recommends that this problem be solved by total least-squares, which involves the Singular Value Decomposition (SVD) of H1m×1, and n is calculated by the eigenvector corresponding to the maximum eigenvalue, with n=V1:3,4V4,4.\n\nSolving for n and working backward allows for a solution to r, the position of the sensor, and the desired state output. This may be simply calculated from\n\nr=−(nTn−1)−1/2U−1n.\n\n(29)\n\n3.3. Near Linear Horizon\n\nGiven the analysis presented in Section 2.3, when a sensor is near the surface, there is a very small dip from the horizon over the image field of view. This function may nearly be treated as a straight line.\n\nThe vectors pointing towards the horizon, s, may be approximated as very nearly perpendicular to the gravitational field vector, g. This model is illustrated in . The object is slightly elevated above the surface at a height δ.\n\nUsing this approximation, alongside the approximate gravity vector in a geocentric model, where\n\ng=cosλcosϕ,sinλcosϕ,sinϕT,\n\n(30)\n\nthe position of the user in terms of latitude and longitude may be known from only the horizon measurements and a known pointing attitude. Recalling that first the body measurements of the horizon need to be transformed to the planetary frame, the final model expression is\n\nh(λ,ϕ,s)=sTcosλcosϕsinλcosϕsinϕ=0.\n\n(31)\n\nThis model is in an implicit form, and so may be solved by the implicit form of a nonlinear least-squares, first described in Section 3.1.\n\nThe Jacobian is formulated by\n\nH=∂h∂λ,∂h∂ϕi,\n\n(32)\n\nwhere\n\n∂h∂λ=(Tpbs)T−sinλcosϕcosλcosϕ0∂h∂ϕ=(Tpbs)T−cosλsinϕ−sinλsinϕcosϕ.\n\nNote that this function has made the assumption that the two vectors are perpendicular. As δ and/or field of view increases, s becomes much less perpendicular but at a small angle θ. This angle was also encountered in Section 3.2 through the transform Cholesky factorization space. The angle is dependent on the ellipsoid being observed. For this simplistic case in the geocentric frame, the angle is not dependent on the position, as all radii are the same. The correction is derived from Equation (14) for a standard Earth radius R,\n\nh=δ(δ+2R)δ+R,\n\n(33)\n\nwhich is applied to Equation (31).\n\n3.4. Geodetic Horizon\n\nSection 3.3 does not account for ellipsoidal shape in the direction of latitude. This is not representative and so should not be discarded lightly, even though the dip is barely noticeable as considered in Section 2.3.\n\nTo account for the curved horizon shape close to the surface, the ellipsoidal model of the Earth should be adopted, as in previous models described in Section 3.1. However, the advantages of using a near-linear horizon should also be considered.\n\nRecalling that the description of an ellipsoidal point on the Earth’s surface p is given by pTAp=1, then for a sensor on the surface, p=||p||r^=ρr^, where r^ is a unit vector in the direction of the sensor position, it may be written as\n\npTAp=ρ2r^TAr^=1.\n\n(34)\n\nConsider now that the sensor is elevated from the surface by a height δ, so r=(ρ+δ)r^. The ellipsoidal body matrix is then written as\n\nM=ρ+δ2Ar^r^TA−ρ+δ2r^TAr^−1A=1(r^TAr^)1/2+δ2Ar^r^TA−1(r^TAr^)1/2+δ2r^TAr^−1A=χ(r^)M˜(r^)+A,\n\nwhere\n\nχ(r^)=1r^TAr^+2δ(r^TAr^)1/2+δ2M˜(r^)=Ar^r^TA−r^TAr^A.\n\nAs in the near-linear horizon model of Section 3.3, the position vector may be described using the geocentric longitude and latitude, as was considered for the gravity vector:\n\nr=rr^=(ρ+δ)cosλcosϕ,sinλcosϕ,sinϕT.\n\n(35)\n\nThe latitude and longitude will be the desired state vectors, and the problem may be formulated with an NLLS approach. The model may be written as\n\nh(λ,ϕ,s)=sTMs=χ(r^)sTM˜(r^)s+sTAs=0.\n\n(36)\n\nTo determine the Jacobian, the chain rule may be adopted for the state vector, letting the row for the k-th become\n\nH=∂h∂λ,∂h∂ϕk=∂h∂r^·∂r^∂λ,∂h∂r^·∂r^∂ϕk.\n\n(37)\n\nThe solution for the implicit NLLS is calculated by Equation (19).\n\nEvaluating for ∂h∂r^ leads to use of the product rule\n\n∂h∂r^=∂χ∂r^sTM˜(r^)s+χ(r^)∂∂r^(sTM˜(r^)s).\n\n(38)\n\nThe derivative of sTM˜(r^)s was calculated in Section 3.1, but the r is replaced by r^. The derivative of χ(r^) is expressed as\n\n∂χ∂r^=−2(r^TAr^)2r^TA−2δ(r^TAr^)3/2r^TA.\n\n(39)\n\nThe derivative of r^ has already been calculated in the form of Equation (32), where the leading terms to the vector may be removed.\n\n4. Simulation Methodology and Performance\n\nTo demonstrate the performance of each approach and the importance of using the known sensor altitude and consideration of the geodetic horizon, a series of Monte Carlo simulations are performed for a theoretic vessel at various positions on the Earth’s surface. This section describes the model parameters, noise treatment, and estimated performance of the techniques described.\n\n4.1. Model Parameters\n\nA theoretical optical-based sensor is considered. The parameters of the sensor are presented in . The sensor is placed on a ship with the horizon pointing directly toward the line.\n\nTable 1\n\nParameterValueField of view40∘Sensor resolution2048 × 2048 px\n\nPlaced orthogonal to the optical sensor at the zenith is a star tracker. The star tracker is introduced in Section 2.4 and is assumed to have a theoretical performance of σ=10 arc-sec. The orientation is illustrated in .\n\nThe model is simulated for several scenarios of a sensor placed on the Earth’s ellipsoid. Each treats a different shape of the horizon curve, placed at different latitudes. The solution should have no dependence on the longitude. The position of the vessel on the ellipsoid is illustrated in .\n\n4.2. Noise Model\n\nA measured position of the horizon is represented by the sub-pixel coordinates of the point (α,γ). The sensor frame unit vector is related to the sub-pixel coordinates by\n\nα=−fsxsz,γ=−fsysz,\n\n(40)\n\nwhere f is the focal length. The focal length is related to the sensor resolution β and field of view FOV by the relation\n\nf=β2tan(FOV/2).\n\n(41)\n\nThe reverse relation uses the unit vector normalization condition |s|=1. So, the s unit vector may be calculated by\n\ns=1α2+γ2+f2−α−γf.\n\n(42)\n\nA common covariance model for star trackers is adopted [32,33] using the measured image coordinates (α,γ). The horizon points may be treated similarly to star points, approximating the distribution to a Gaussian. The covariance is expressed by\n\nR=σ21+α2+β2(1+α2)2(αγ)2(αγ)2(1+γ2)2.\n\n(43)\n\nThis can then be introduced to each measured horizon position. It is assumed that there are no camera distortion effects.\n\n4.3. Model Performance\n\nThe four models described in Section 3 are compared and contrasted. The implementation will follow the sequence illustrated in .\n\nAs introduced, three different latitudes are considered. The results are presented initially for the latitude of 0∘ and 45∘, which present the best and worst possible horizon distribution shapes for the sensor. The results are then treated for a latitude of 70∘, also including a complete probability distribution.\n\nThe probability distribution is presented considering the horizontal, east, and north directions, with an error difference established from the position truth. The results are illustrated in , and , with the placement of each figure highlighted in . The performance statistics are presented in , with the mean and Standard Deviation (STD) presented.\n\nTable 2\n\nNumberTechniqueSectionPlacement1Position by nonlinear least-squares Section 3.1 Top-Left2Christian–Robinson Method Section 3.2 Top-Right3Near Linear Horizon Section 3.3 Bottom-Left4Geodetic Horizon Section 3.4 Bottom-Right\n\nTable 3\n\nTechnique NumberLatitude [deg]Horizontal [km]East [km]North [km]1035.78 (0.02)35.78 (0.02)−0.01 (0.37)209.00 (6.79)0.17 (11.24)−0.04 (0.86)300.22 (0.15)−0.05 (0.15)0.07 (0.25)400.20 (0.15)0.00 (0.02)−0.01 (0.25)14530.49 (0.07)13.51 (0.035)−27.34 (0.24)24538.24 (0.04)20.69 (0.31)−32.16 (0.16)34521.30 (0.11)−0.08 (0.20)21.29 (0.11)4450.24 (0.12)−0.00 (0.20)0.14 (0.11)17041.19 (0.08)34.19 (0.11)22.97 (0.20)27011.47 (2.11)9.52 1.75)6.39 (1.18)37010.97 (0.14)4.09 (0.07)−10.18 (0.13)4700.27 (0.06)−0.19 (0.07)−0.13 (0.13)\n\nThe presented results highlight two key features. The first is the benefit that knowledge of the sensor height holds to a horizon fit solution, where the desired state only consists of latitude and longitude. Sensor height knowledge provides implied information about the depth of the observable horizon, aiding the solution. Techniques 1 and 2 each attempt to solve for three unknowns.\n\nThe second is the assumption of ellipsoidal curvature in the solution. Techniques that treat the horizon as a hyperbola or ellipse without prior knowledge of height cannot accurately determine curvature, as only a small arc is observed of the conic. Technique 3, even though the sensor height is known, does not include realistic information on the observed horizon curvature. It is thus not suitable for implementation.\n\nThis leads to be the best solution being the technique of geodetic horizon, Technique 4, introduced in Section 3.4. The factor improvement in performance is about 100 m compared to the other three techniques.\n\nThere is a bias present in the solution caused by the limitations and assumptions of each model. This bias is based on the observed geometry, dependent on the current location and its local environment, so it cannot be predicted and corrected.\n\nThe performance derived demonstrates a marked improvement from the traditional sextant, with the method of geodetic horizon achieving a 1-sigma precision in the hectometre scale. It was also justified that geoid deviation, otherwise described as gravitational anomalies, holds little impact on this solution.\n\n5. Conclusions\n\nIn this work, performances are demonstrated that exceed the traditional approaches of a sextant, delivering an accuracy and precision under 100 m in the horizontal plane. However, Global Navigation Satellite System (GNSS) remains the most accurate form of navigation reference for a ship, and so this technique may act as an alternative or back-up solution or as a sanity-check method to validate the GPS’s estimation.\n\nThe best approach considers a geodetic-based horizon. Solutions less than this geometric approximation deliver a much poorer performance. A bias remains in the solution, caused by unknowns of the local horizon’s geodetic curvature.\n\nAdditional knowledge of the oceanic environment should also be accounted for, such as waves and currents. Isolation of the wave modal frequency may assist in ensuring minimal errors derived by these external influences. This may be accomplished by introducing inclinometers as part of the sensor suite.\n\nIt should also be considered that the proposed technique may not operate under cloud cover, and so alternative techniques would be required to navigate and, in absence of reliable GPS signals, continue to navigate in open-loop as a short-term solution. Integration of a pair of inclinometers may assist in such conditions. Dead-reckoning may also be applied in such environments, combined with a filter-like technique, such as a Kalman filter. The sensor suite may then be introduced to real-time operations for many marine environments.\n\nThe authors also seek to further verify these algorithms employing real ocean and star images off the coast. The Sydney coastline has been chosen for this and will be a topic of further work. The ambition is to develop and test an integrated sensor suite of the star tracker, horizon sensor, and two inclinometers for deployment on a ship.\n\nAcknowledgments\n\nThe authors wish to thank both the University of Sydney and Texas A&M University for supporting this collaboration, where the main author visited the US for six months on a research placement.\n\nFunding Statement\n\nThis research received no external funding.\n\nAuthor Contributions\n\nMethodology and analysis, J.J.R.C.-M.; methodology and supervision, D.M. All authors have read and agreed to the published version of the manuscript.\n\nInstitutional Review Board Statement\n\nNot applicable.\n\nInformed Consent Statement\n\nNot applicable.\n\nConflicts of Interest\n\nThe authors declare no conflict of interest.\n\nFootnotes\n\nDisclaimer/Publisher’s Note: The statements, opinions and data contained in all publications are solely those of the individual author(s) and contributor(s) and not of MDPI and/or the editor(s). MDPI and/or the editor(s) disclaim responsibility for any injury to people or property resulting from any ideas, methods, instructions or products referred to in the content.\n\nReferences\n\n1. Centre for Advanced Defence Studies Above Us Only Stars. 2019. [(accessed on 11 January 2022)]. Available online: https://www.c4reports.org/aboveusonlystars\n\n2. Goward D. GPS Disrupted for Maritime in Mediterranean. GPS World. 2018. [(accessed on 12 February 2022)]. Available online: https://www.gpsworld.com/gps-disrupted-for-maritime-in-mediterranean-red-sea/\n\n3. Harris M. Ghost Ships, Crop Circles, and Soft Gold: A GPS Mystery in Shanghai. MIT Technology Review. 2019. [(accessed on 12 February 2022)]. Available online: https://www.technologyreview.com/2019/11/15/131940/ghost-ships-crop-circles-and-soft-gold-a-gps-mystery-in-shanghai/\n\n4. International Association of Lighthouse Authorities (IALA) R-129 GNSS Vulnerability and Mitigation Measures. IALA; Saint Germain en Laye, France: 2008. [Google Scholar]\n\n5. Williams P. MarRINav—Maritime Context and Requirements. General Lighthouse Authority. 2019. [(accessed on 9 April 2021)]. Available online: https://marrinav.com/marrinav-report/\n\n6. Owens A.J., Richardson T., Critchley-Marrows J. The Feasibility of a VDE-SAT Ranging Service as an Augmentation to GNSS for Maritime Applications; Proceedings of the 34th International Technical Meeting of the Satellite Division of The Institute of Navigation (ION GNSS+ 2021); St. Louis, MO, USA. 20–24 September 2021. [Google Scholar]\n\n7. Wirsing M., Dammann A., Raulefs R. Designing a Ranging Signal for use with VDE R-Mode; Proceedings of the 2020 IEEE/ION Position, Location and Navigation Symposium (PLANS); Portland, OR, USA. 20–23 April 2020. [Google Scholar]\n\n8. Huang Y., Brennan P.V., Patrick D., Weller I., Roberts P., Hughes K. FMCW-based MIMO imaging radar for maritime navigation. Prog. Electromagn. Res. 2011;115:327–342. doi: 10.2528/PIER11021509. [CrossRef] [Google Scholar]\n\n9. Mun S., Lee K. IOP Conference Series: Materials Science and Engineering. IOP Publishing Ltd.; Ulsan, Republic of Korea: 2020. Emergency ship positioning and distribution system for radio disturbance. [Google Scholar]\n\n10. Li C.H., Chen Z.L., Liu X.J., Chen B., Zheng Y., Tong S., Wang R.P. Adaptively robust filtering algorithm for maritime celestial navigation. J. Navig. 2022;75:200–212. doi: 10.1017/S0373463321000758. [CrossRef] [Google Scholar]\n\n11. Tsou M.-C. Genetic algorithm for solving celestial navigation fix problems. Pol. Marit. Res. 2012;19:53–59. doi: 10.2478/v10012-012-0031-5. [CrossRef] [Google Scholar]\n\n12. Vulfovich B., Fogilev V. New ideas for celestial navigation in the third millennium. J. Navig. 2010;63:373–378. doi: 10.1017/S0373463309990348. [CrossRef] [Google Scholar]\n\n13. Critchley-Marrows J.J.R., Wu X., Cairns I.H. Stellar Navigation on the Moon-A Compliment, Support and Back-up to Lunar Navigation; Proceedings of the 2022 International Technical Meeting of The Institute of Navigation; Long Beach, CA, USA. 25–27 January 2022. [Google Scholar]\n\n14. Mortari D., Gardner A. High Accurate Mathematical Tools to Estimate the Gravity Direction Using Two Non-Orthogonal Inclinometers. Sensors. 2021;21:5727. doi: 10.3390/s21175727. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n15. Christian J.A. A Tutorial on Horizon-Based Optical Navigation and Attitude Determination with Space Imaging Systems. IEEE Access. 2021;9:19819–19853. doi: 10.1109/ACCESS.2021.3051914. [CrossRef] [Google Scholar]\n\n16. Christian J.A., Robinson S.B. Noniterative Horizon-Based Optical Navigation by Cholesky Factorization. J. Guid. Control Dyn. 2016;39:2755–2763. doi: 10.2514/1.G000539. [CrossRef] [Google Scholar]\n\n17. Critchley-Marrows J., Mortari D. Vision-based navigation in low Earth orbit—Using the stars and horizon as an alternative PNT. Adv. Space Res. 2023;71:4802–4813. doi: 10.1016/j.asr.2023.01.047. [CrossRef] [Google Scholar]\n\n18. National Imagery and Mapping Agency . Department of Defense World Geodetic System Definition—Its Relationships with Local Geodetic Systems (1984) 3rd ed. National Imagery and Mapping Agency; Bethesda, MD, USA: 1997. NIMA tr8350.2. [Google Scholar]\n\n19. Liebe C.C. Accuracy Performance of Star Trackers—A Tutorial. IEEE Trans. Aerosp. Electron. Syst. 2002;38:587–599. doi: 10.1109/TAES.2002.1008988. [CrossRef] [Google Scholar]\n\n20. Markley F.L., Crassidis J.L. Fundamentals of Spacecraft Atiitude Determination and Control. Springer Science and Business Media; New York, NY, USA: 2014. Filtering for Attitude Estimation and Calibration; pp. 235–285. [Google Scholar]\n\n21. Zanetti R., Majji M., Bishop R., Mortari D. Norm-Constrained Kalman Filtering. J. Guid. Control Dyn. 2009;32:1458–1465. doi: 10.2514/1.43119. [CrossRef] [Google Scholar]\n\n22. Mortari D. Second Estimator of the Optimal Quaternion. J. Guid. Control Dyn. 2000;23:885–888. doi: 10.2514/2.4618. [CrossRef] [Google Scholar]\n\n23. Critchley-Marrows J., Wu X. Investigation into Star Tracker Algorithms using Smartphones with Application to High-Precision Pointing CubeSats. Trans. Jpn. Soc. Aeronaut. Space Sci. Aerosp. Technol. Jpn. 2019;17:327–332. doi: 10.2322/tastj.17.327. [CrossRef] [Google Scholar]\n\n24. Thomas M.E., Joseph R.I. Astronomical refraction. Johns Hopkins APL Tech. Dig. 1996;17:279–284. [Google Scholar]\n\n25. Vernin J., Munoz-Tunon C. Measuring Astronomical Seeing: The DA/IAC DIMM. Publ. Astron. Soc. Pac. 1995;107:265–272. doi: 10.1086/133549. [CrossRef] [Google Scholar]\n\n26. Goodwin H.B. Problems in Navigation and Nautical Astronomy. G. Philip & Son; London, UK: 1896. Gauss’ Three-Altitude Problem; pp. 327–329. [Google Scholar]\n\n27. Wang W., Wei X., Li J., Du J., Zhang G. Optical Parameters Optimization for All-Time Star Sensor. Sensors. 2019;19:2960. doi: 10.3390/s19132960. [PMC free article] [PubMed] [CrossRef] [Google Scholar]\n\n28. Young E.F., Mellon R., Percival J.W., Jaehnig K.P., Fox J., Lachenmeier T., Oglevie B., Bingenheimer M. Sub-arcsecond performance of the ST5000 star tracker on a balloon-borne platform; Proceedings of the IEEE Aerospace Conference; Big Sky, MT, USA. 3–10 March 2012. [Google Scholar]\n\n29. Samaan M.A., Mortari D., Junkins J.L. Compass star tracker for GPS-like applications. IEEE Trans. Aerosp. Electron. Syst. 2008;44:1629–1634. doi: 10.1109/TAES.2008.4667738. [CrossRef] [Google Scholar]\n\n30. Woodbury D.P., Parish J.J., Parish A.S., Swanzy M., Denton R., Mortari D., Junkins J.L. Stellar positioning system (Part II): Improving accuracy during implementation. Navigation. 2010;57:13–24. doi: 10.1002/j.2161-4296.2010.tb01764.x. [CrossRef] [Google Scholar]\n\n31. Jarvis B., Guinane J., Wu X., Critchley-Marrows J. Development of a Low-Cost Testing Methodology for Star Trackers; Proceedings of the 19th Australian Space Research Conference; Adelaide, Australia. 30 September–2 October 2019. [Google Scholar]\n\n32. Cheng Y., Crassidis J.L., Markley F.L. Attitude Estimation for Large Field-of-View Sensors; Proceedings of the Malcolm D. Shuster Astronautics Symposium; New York, NY, USA. 12–15 June 2005. [Google Scholar]\n\n33. Shuster M.D. Kalman Filtering of Spacecraft Attitude and the QUEST Model. J. Astronaut. Sci. 1990;38:377–393. [Google Scholar]\n\nArticles from Sensors (Basel, Switzerland) are provided here courtesy of Multidisciplinary Digital Publishing Institute (MDPI)"
    }
}