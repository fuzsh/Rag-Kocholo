{
    "id": "dbpedia_5408_0",
    "rank": 41,
    "data": {
        "url": "https://arxiv.org/html/2407.18095v1",
        "read_more_link": "",
        "language": "en",
        "title": "Detection of mode-intrinsic quantum entanglement",
        "top_image": "",
        "meta_img": "",
        "images": [
            "https://arxiv.org/html/x1.png",
            "https://arxiv.org/html/x2.png",
            "https://arxiv.org/html/x3.png",
            "https://arxiv.org/html/x4.png",
            "https://arxiv.org/html/x5.png",
            "https://arxiv.org/html/x6.png",
            "https://arxiv.org/html/x7.png",
            "https://arxiv.org/html/x8.png",
            "https://arxiv.org/html/x9.png",
            "https://arxiv.org/html/x10.png",
            "https://arxiv.org/html/x11.png",
            "https://arxiv.org/html/x12.png",
            "https://arxiv.org/html/x13.png",
            "https://arxiv.org/html/x14.png",
            "https://arxiv.org/html/x15.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "",
        "meta_lang": "en",
        "meta_favicon": "",
        "meta_site_name": "",
        "canonical_link": null,
        "text": "Carlos E. Lopetegui Mathieu Isoard Nicolas Treps Mattia Walschaers\n\nAbstract\n\nQuantum correlations are at the core of the power of quantum information and are necessary to reach a quantum computational advantage. In the context of continuous-variable quantum systems, another necessary ressource for quantum advantages is non-Gaussianity. In this work, we propose a witness, based on previously known relations between metrological power and quantum correlations, to detect a strong form of entanglement that only non-Gaussian states possess and that cannot be undone by passive optical operations, i.e., entanglement in all mode bases. The strength of our witness is two-fold: it only requires measurements in one basis to check entanglement in any arbitrary mode basis; it can be made applicable experimentally using homodyne measurements and without requiring a full tomography of the state.\n\nI Introduction\n\nMajor efforts are being conducted worldwide to harness the power of quantum mechanics for technological applications. The use of these systems for performing computations beyond the capabilities of classical processors stands as one of the most encouraging perspectives. A wide variety of physical platforms are being considered for this purpose Steffen et al. (2011); Acharya et al. (2023); Henriet et al. (2020); Evered et al. (2023); Kielpinski et al. (2002); Gouzien et al. (2023); Author Bartolucci et al. (2023); Bourassa et al. (2021), among which optical systems prove to be a promising framework given its potential for scalability Larsen et al. (2019); Asavanant et al. (2019).\n\nThe full power of optical quantum technologies is attained when we can coherently control the collective state of many modes. These collective states manifest entanglement, a unique feature of quantum systems that has challenged the common conceptions of physicists over the last century Einstein et al. (1935); SchrÃ¶dinger (1935); Horodecki et al. (2009). Entanglement and quantum correlations in general, reflect in measurement statistics that are not consistent with classical correlations. Mathematically this implies that they cannot be explained using a local hidden variable model Bell (1964). In the context of quantum information processing and quantum computing entanglement has revealed to be an essential resource AcÃ­n et al. (2018); Jozsa and Linden (2003). However, in continuous variables (CV) systems, entanglement is not enough if the state is fully Gaussian, or if its associated Wigner function â€“ which describes all the statistical properties of the quantum state â€“ is positive. Indeed, it has been shown that negativity in the Wigner function is a necessary resource for realizing sampling protocols that cannot be efficiently simulated with classical resources Mari and Eisert (2012). This result significantly boosted the already ongoing efforts aimed at producing non-Gaussian states Ra et al. (2020); Endo et al. (2023); Neergaard-Nielsen et al. (2006); Wakui et al. (2007), with remarkable results achieved in microwave cavities and superconducting circuits in the production of exotic non-Gaussian states Kudra et al. (2022); Touzard et al. (2018).\n\nYet, recent results have pointed out that not any kind of quantum entanglement (even if the state is Wigner negative) is sufficient to render computations with CV quantum systems hard to simulate with a classical device. In particular, in Ref. Chabaud and Walschaers (2023) it was shown that in a certain family of sampling protocols a strong form of quantum entanglement is required: not passive separability, i.e., the fact that entanglement cannot be undone with optical passive transformations (beamsplitters and phase shifters). This kind of entanglement was previously introduced in Sperling et al. (2019), from a different perspective. They refer to it as mode-independent quantum entanglement and point out its potential usefulness for communication protocols. We refer to this kind of quantum correlations as mode-intrinsic entanglement . Finding and characterizing non-Gaussian states that exhibit this refined quantum feature and that can be produced in the lab are thus important steps in the domain of CV quantum information.\n\nMany witnesses and criteria have been derived for detecting entanglement in Gaussian states Simon (2000); Duan et al. (2000); Giovannetti et al. (2003); van Loock and Furusawa (2003); Abiuso et al. (2021). All of them rely in some way in the knowledge of the covariance matrix. Once measured in one basis, such a matrix can be obtained in any mode basis by means of an orthogonal transformation. For this reason these methods are quite versatile for studying entanglement in every mode basis. However, Williamsonâ€™s decomposition Williamson (1936); Braunstein (2005) implies that there always exists a basis in which the covariance matrix is consistent with a separable Gaussian state, independently of the nature of the quantum state itself. Therefore, these methods are not suitable for demonstrating mode-intrinsic entanglement. Furthermore, it shows that mode-intrinsic entanglement is inherently a non-Gaussian feature.\n\nOver the years many protocols have been proposed to detect entanglement in non-Gaussian states. If one has access to the density matrix of a given state it is possible to use the positive partial transpose (PPT) criterion Peres (1996) to detect quantum correlations. However, the reconstruction of the density matrix requires a full tomography of the state Lvovsky and Raymer (2009), a very demanding and time-consuming experimental task. Efforts to circumvent this issue have lead to the introduction of different methods to witness quantum correlations Shchukin and Vogel (2005); RodÃ³ et al. (2008); Walborn et al. (2011); Saboia et al. (2011); Gessner et al. (2016); Yadin et al. (2021); GÃ¤rttner et al. (2023); Gao et al. (2024); Valido et al. (2014).\n\nAmong those there is a subset Gessner et al. (2016); Yadin et al. (2021) that rely on connections to quantum metrology Giovannetti et al. (2011); PezzÃ¨ et al. (2018); TÃ³th and Apellaniz (2014). These witnesses are based on the Fisher Information Liu et al. (2019), a quantity that reflects the highest sensitivity with which we can estimate a parameter of interest using measurements of an observable. These methods rely on the idea that quantum correlations can lead to metrological sensitivities that could not be achieved with only classical correlations. CV-specialized protocols based on these witnesses Lopetegui et al. (2022); Barral et al. (2023) have been shown to succeed in detecting quantum correlations in relevant non-Gaussian states where usual Gaussian criteria fail. This suggests that non-Gaussian entanglement is not only crucial in the framework of quantum computation but can also potentially offer advantages in sensing applications. This idea relates naturally to recent results Lupu-Gladstein et al. (2022) that link the negativity of some quasiprobability distributions to enhancements in quantum phase estimation in quantum optics.\n\nAll the methods we have mentioned so far to detect entanglement in non-Gaussian states are developed to detect entanglement once we have fixed a mode basis of interest. On the other hand, to study entanglement in every mode basis, a method that retains the versatility of the Gaussian protocols, but potentially succeeds where the former fails, is necessary. In this paper, we propose such a protocol based on metrological witnesses. We show that our protocol works for relevant non-Gaussian states that can be produced with state-of-the-art experiments, namely photon subtracted states Ra et al. (2020); Endo et al. (2023). Likewise, our witness also demonstrates effectiveness in multimode systems such as (non-Gaussian) cluster states â€“ that can be obtained by de-gaussifying readily available large CV cluster states Larsen et al. (2019); Asavanant et al. (2019); Ra et al. (2020), which have been widely studied for their scalability in the pursuit of large-scale quantum computing. While sensitive to losses, the mode-intrinsic-entanglement witness that we suggest here can be applied experimentally through homodyne detection and the estimation of the corresponding classical Fisher information â€“ using the Hellinger distance as proposed in Ref. Barral et al. (2023); it thus avoids full tomography of the state, making metrological witnesses a very efficient tool in the detection of mode-intrinsic entanglement and non-Gaussian features. Moreover, it proves useful for the less specific task of studying the entanglement properties of a given state beyond the basis in which measurements are performed, with higher accuracy than Gaussian methods.\n\nThe paper is organized as follows: in Sec. II we introduce the metrological entanglement witness derived in Ref. Gessner et al. (2016) and extend it to the detection of mode-intrinsic entanglement in Sec. III. Then, in Sec. IV, we apply our witness to experimentally relevant multimode states, namely photon subtracted states. In the last section (Sec. V), we consider a lower bound of the mode-intrinsic entanglement witness derived in the previous sections; we show that this witness is experimentally accessible through homodyne measurements; in particular, we test this lower bound witness on a two-photon subtracted state using simulated experimental data.\n\nII Metrology based entanglement witnesses\n\nIn this section we introduce metrological witnesses of entanglement in which the protocol that we present is based Gessner et al. (2016). These witnesses rely on the analysis of a specific metrological task. We consider two parties, Alice and Bob, who share a state Ï^^ğœŒ\\hat{\\rho}over^ start_ARG italic_Ï end_ARG.\n\nThey are interested in jointly estimating a parameter Îºğœ…\\kappaitalic_Îº that they encode through a unitary transformation induced by the sum of local generators H^=H^A+H^B^ğ»subscript^ğ»ğ´subscript^ğ»ğµ\\hat{H}=\\hat{H}_{A}+\\hat{H}_{B}over^ start_ARG italic_H end_ARG = over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT + over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT (see Fig.1). In this case, the density matrix of the state transforms as Ï^Îº=expâ¡(âˆ’iâ¢Îºâ¢H^)â¢Ï^â¢expâ¡(iâ¢Îºâ¢H^)subscript^ğœŒğœ…ğ‘–ğœ…^ğ»^ğœŒğ‘–ğœ…^ğ»\\hat{\\rho}_{\\kappa}=\\exp(-i\\kappa\\hat{H})\\,\\hat{\\rho}\\,\\exp(i\\kappa\\hat{H})over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT italic_Îº end_POSTSUBSCRIPT = roman_exp ( - italic_i italic_Îº over^ start_ARG italic_H end_ARG ) over^ start_ARG italic_Ï end_ARG roman_exp ( italic_i italic_Îº over^ start_ARG italic_H end_ARG ). The sensitivity with which they can estimate the parameter, given that they can measure some (possibly non local) observables M^Aâ¢(B)subscript^ğ‘€ğ´ğµ\\hat{M}_{A(B)}over^ start_ARG italic_M end_ARG start_POSTSUBSCRIPT italic_A ( italic_B ) end_POSTSUBSCRIPT, is upper bounded by the Fisher information associated to the probability distribution of outcomes of these observables.\n\nThe Fisher information is given by\n\nFâ¢(pâ¢(MA,MB|Îº))=âˆ«MA,MBğ‘‘MAâ¢ğ‘‘MB(âˆ‚â„’â¢(pâ¢(MA,MB|Îº))âˆ‚Îº)2Ã—pâ¢(MA,MB|Îº),ğ¹ğ‘subscriptğ‘€ğ´conditionalsubscriptğ‘€ğµğœ…subscriptsubscriptğ‘€ğ´subscriptğ‘€ğµdifferential-dsubscriptğ‘€ğ´differential-dsubscriptğ‘€ğµsuperscriptâ„’ğ‘subscriptğ‘€ğ´conditionalsubscriptğ‘€ğµğœ…ğœ…2ğ‘subscriptğ‘€ğ´conditionalsubscriptğ‘€ğµğœ…\\begin{split}F(p(M_{A},M_{B}|\\kappa))=\\int_{M_{A},M_{B}}\\!\\!\\!\\!\\!\\!dM_{A}\\,dM% _{B}&\\left(\\frac{\\partial\\mathcal{L}(p(M_{A},M_{B}|\\kappa))}{\\partial\\kappa}% \\right)^{2}\\\\ &\\times p(M_{A},M_{B}|\\kappa),\\end{split}start_ROW start_CELL italic_F ( italic_p ( italic_M start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT | italic_Îº ) ) = âˆ« start_POSTSUBSCRIPT italic_M start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_d italic_M start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT italic_d italic_M start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT end_CELL start_CELL ( divide start_ARG âˆ‚ caligraphic_L ( italic_p ( italic_M start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT | italic_Îº ) ) end_ARG start_ARG âˆ‚ italic_Îº end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL Ã— italic_p ( italic_M start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT | italic_Îº ) , end_CELL end_ROW (1)\n\nwhere â„’â¢(pâ¢(MA,MB|Îº))=logâ¡(pâ¢(MA,MB|Îº))â„’ğ‘subscriptğ‘€ğ´conditionalsubscriptğ‘€ğµğœ…ğ‘subscriptğ‘€ğ´conditionalsubscriptğ‘€ğµğœ…\\mathcal{L}(p(M_{A},M_{B}|\\kappa))=\\log(p(M_{A},M_{B}|\\kappa))caligraphic_L ( italic_p ( italic_M start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT | italic_Îº ) ) = roman_log ( italic_p ( italic_M start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT | italic_Îº ) ), stands for the logarithmic likelihood, and pâ¢(MA,MB|Îº)=Trâ¢(Ï^Îºâ¢Î ^Aâ¢B)ğ‘subscriptğ‘€ğ´conditionalsubscriptğ‘€ğµğœ…Trsubscript^ğœŒğœ…subscript^Î ğ´ğµp(M_{A},M_{B}|\\kappa)={\\rm Tr}\\left(\\hat{\\rho}_{\\kappa}\\,\\hat{\\Pi}_{AB}\\right)italic_p ( italic_M start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT | italic_Îº ) = roman_Tr ( over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT italic_Îº end_POSTSUBSCRIPT over^ start_ARG roman_Î  end_ARG start_POSTSUBSCRIPT italic_A italic_B end_POSTSUBSCRIPT ) is the joint probability distribution conditioned by the parameter Îºğœ…\\kappaitalic_Îº, where Î ^Aâ¢B=|MA,MBâŸ©â¢âŸ¨MA,MB|subscript^Î ğ´ğµketsubscriptğ‘€ğ´subscriptğ‘€ğµbrasubscriptğ‘€ğ´subscriptğ‘€ğµ\\hat{\\Pi}_{AB}=|M_{A},M_{B}\\rangle\\langle M_{A},M_{B}|over^ start_ARG roman_Î  end_ARG start_POSTSUBSCRIPT italic_A italic_B end_POSTSUBSCRIPT = | italic_M start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT âŸ© âŸ¨ italic_M start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT | is the projector into the outcomes (MA,MB)subscriptğ‘€ğ´subscriptğ‘€ğµ(M_{A},M_{B})( italic_M start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , italic_M start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ) of M^AâŠ—M^Btensor-productsubscript^ğ‘€ğ´subscript^ğ‘€ğµ\\hat{M}_{A}\\otimes\\hat{M}_{B}over^ start_ARG italic_M end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT âŠ— over^ start_ARG italic_M end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT. The ultimate sensitivity achievable in the estimation of Îºğœ…\\kappaitalic_Îº is given by the quantum Fisher information (QFI) of the state, defined as the maximum Fisher information, optimized over all possible measurements, i.e.,\n\nFQâ¢(Ï^,H^)=maxM^A,M^Bâ¡Fâ¢[Trâ¢(Ï^Îºâ¢Î ^Aâ¢B)].subscriptğ¹ğ‘„^ğœŒ^ğ»subscriptsubscript^ğ‘€ğ´subscript^ğ‘€ğµğ¹delimited-[]Trsubscript^ğœŒğœ…subscript^Î ğ´ğµF_{Q}(\\hat{\\rho},\\hat{H})=\\max_{\\hat{M}_{A},\\hat{M}_{B}}F\\left[{\\rm Tr}\\left(% \\hat{\\rho}_{\\kappa}\\,\\hat{\\Pi}_{AB}\\right)\\right].italic_F start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï end_ARG , over^ start_ARG italic_H end_ARG ) = roman_max start_POSTSUBSCRIPT over^ start_ARG italic_M end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , over^ start_ARG italic_M end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT end_POSTSUBSCRIPT italic_F [ roman_Tr ( over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT italic_Îº end_POSTSUBSCRIPT over^ start_ARG roman_Î  end_ARG start_POSTSUBSCRIPT italic_A italic_B end_POSTSUBSCRIPT ) ] . (2)\n\nIt can be shown that for pure states\n\nFQâ¢(|ÏˆâŸ©â¢âŸ¨Ïˆ|,H^)=4â¢Varâ¢(|ÏˆâŸ©â¢âŸ¨Ïˆ|,H^),subscriptğ¹ğ‘„ketğœ“brağœ“^ğ»4Varketğœ“brağœ“^ğ»F_{Q}\\left(|\\psi\\rangle\\langle\\psi|,\\,\\hat{H}\\right)=4\\text{Var}\\left(|\\psi% \\rangle\\langle\\psi|,\\hat{H}\\right),italic_F start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( | italic_Ïˆ âŸ© âŸ¨ italic_Ïˆ | , over^ start_ARG italic_H end_ARG ) = 4 Var ( | italic_Ïˆ âŸ© âŸ¨ italic_Ïˆ | , over^ start_ARG italic_H end_ARG ) , (3)\n\nwhere Varâ¢(|ÏˆâŸ©â¢âŸ¨Ïˆ|,H^)Varketğœ“brağœ“^ğ»\\text{Var}\\left(|\\psi\\rangle\\langle\\psi|,\\hat{H}\\right)Var ( | italic_Ïˆ âŸ© âŸ¨ italic_Ïˆ | , over^ start_ARG italic_H end_ARG ) is the variance of the generator H^^ğ»\\hat{H}over^ start_ARG italic_H end_ARG in the state |ÏˆâŸ©ketğœ“|\\psi\\rangle| italic_Ïˆ âŸ©. In the case of mixed states there is also an analytical expression for the quantum Fisher information, but for the moment it suffices to say that FQâ¢(Ï^,H^)â‰¤4â¢Varâ¢(Ï^,H^)subscriptğ¹ğ‘„^ğœŒ^ğ»4Var^ğœŒ^ğ»F_{Q}(\\hat{\\rho},\\hat{H})\\leq 4\\text{Var}(\\hat{\\rho},\\hat{H})italic_F start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï end_ARG , over^ start_ARG italic_H end_ARG ) â‰¤ 4 Var ( over^ start_ARG italic_Ï end_ARG , over^ start_ARG italic_H end_ARG ). Another useful property for our purpose is the aditivity of the QFI, namely\n\nFQâ¢(Ï^AâŠ—Ï^B,H^A+H^B)=FQâ¢(Ï^A,H^A)+FQâ¢(Ï^B,H^B),subscriptğ¹ğ‘„tensor-productsubscript^ğœŒğ´subscript^ğœŒğµsubscript^ğ»ğ´subscript^ğ»ğµsubscriptğ¹ğ‘„subscript^ğœŒğ´subscript^ğ»ğ´subscriptğ¹ğ‘„subscript^ğœŒğµsubscript^ğ»ğµF_{Q}(\\hat{\\rho}_{A}\\otimes\\hat{\\rho}_{B},\\hat{H}_{A}+\\hat{H}_{B})=F_{Q}(\\hat{% \\rho}_{A},\\hat{H}_{A})+F_{Q}(\\hat{\\rho}_{B},\\hat{H}_{B}),italic_F start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT âŠ— over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT , over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT + over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ) = italic_F start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT ) + italic_F start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT , over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ) , (4)\n\nwhere Ï^Aâ¢(B)=TrBâ¢(A)â¢(Ï^)subscript^ğœŒğ´ğµsubscriptTrğµğ´^ğœŒ\\hat{\\rho}_{A(B)}={\\rm Tr}_{B(A)}(\\hat{\\rho})over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT italic_A ( italic_B ) end_POSTSUBSCRIPT = roman_Tr start_POSTSUBSCRIPT italic_B ( italic_A ) end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï end_ARG ) is the reduced density matrix. Combining these two properties and the convexity of the quantum Fisher information, one can show that that if Alice and Bob share a separable state Ï^^ğœŒ\\hat{\\rho}over^ start_ARG italic_Ï end_ARG it leads to the inequality Gessner et al. (2016)\n\nFQâ¢(Ï^,H^=H^A+H^B)â‰¤4â¢(Varâ¢(Ï^A,H^A)+Varâ¢(Ï^B,H^B)).subscriptğ¹ğ‘„^ğœŒ^ğ»subscript^ğ»ğ´subscript^ğ»ğµ4Varsubscript^ğœŒğ´subscript^ğ»ğ´Varsubscript^ğœŒğµsubscript^ğ»ğµF_{Q}(\\hat{\\rho},\\hat{H}=\\hat{H}_{A}+\\hat{H}_{B})\\leq 4\\left(\\text{Var}(\\hat{% \\rho}_{A},\\hat{H}_{A})+\\text{Var}(\\hat{\\rho}_{B},\\hat{H}_{B})\\right).italic_F start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï end_ARG , over^ start_ARG italic_H end_ARG = over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT + over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ) â‰¤ 4 ( Var ( over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT ) + Var ( over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT , over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ) ) . (5)\n\nThis inequality can only be violated by entangled states and can be thus used as a witness. In practical terms this implies that if they share an entangled state they better join forces than trying to estimate independently the parameter. One would be tempted to say that this implies that entanglement offers a metrological advantage in this setup; yet the situation is a bit more subtle than that, because we are comparing the estimation they can do jointly with respect to what they can estimate with their noisy reduced states. However, this does not imply that there is no better pure single mode state they could independently use and get each a better Fisher information.\n\nThe full power of this kind of inequalities can be exploited when we optimize over a set of allowed choices of generators. For any H^Aâ¢(B)subscript^ğ»ğ´ğµ\\hat{H}_{A(B)}over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_A ( italic_B ) end_POSTSUBSCRIPT, the violation of the metrological inequality provides a sufficient condition for entanglement. Yet, if a violation is not attained it might easily be that there is a different choice of generators that produces one. If Alice and Bob each have access to a set of local generators ğ’œAâ¢(B)={H^Aâ¢(B)(1),â€¦,H^Aâ¢(B)(NAâ¢(B))}subscriptğ’œğ´ğµsuperscriptsubscript^ğ»ğ´ğµ1â€¦superscriptsubscript^ğ»ğ´ğµsubscriptğ‘ğ´ğµ\\mathcal{A}_{A(B)}=\\{\\hat{H}_{A(B)}^{(1)},...,\\hat{H}_{A(B)}^{(N_{A(B)})}\\}caligraphic_A start_POSTSUBSCRIPT italic_A ( italic_B ) end_POSTSUBSCRIPT = { over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_A ( italic_B ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT , â€¦ , over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_A ( italic_B ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_N start_POSTSUBSCRIPT italic_A ( italic_B ) end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT }, where NAâ¢(B)subscriptğ‘ğ´ğµN_{A(B)}italic_N start_POSTSUBSCRIPT italic_A ( italic_B ) end_POSTSUBSCRIPT is the number of generators in each set, they can choose to implement generators given by H^Aâ¢(B)=ğœAâ¢(B)Tâ¢ğ’œAâ¢(B)subscript^ğ»ğ´ğµsuperscriptsubscriptğœğ´ğµğ‘‡subscriptğ’œğ´ğµ\\hat{H}_{A(B)}=\\mathbf{c}_{A(B)}^{T}\\mathcal{A}_{A(B)}over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_A ( italic_B ) end_POSTSUBSCRIPT = bold_c start_POSTSUBSCRIPT italic_A ( italic_B ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_A ( italic_B ) end_POSTSUBSCRIPT. We group ğœAâ¢(B)subscriptğœğ´ğµ\\mathbf{c}_{A(B)}bold_c start_POSTSUBSCRIPT italic_A ( italic_B ) end_POSTSUBSCRIPT in a single vector ğœ={ğœA,ğœB}ğœsubscriptğœğ´subscriptğœğµ\\mathbf{c}=\\{\\mathbf{c}_{A},\\mathbf{c}_{B}\\}bold_c = { bold_c start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , bold_c start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT }, and similarly ğ’œ={ğ’œA,ğ’œB}ğ’œsubscriptğ’œğ´subscriptğ’œğµ\\mathcal{A}=\\{\\mathcal{A}_{A},\\mathcal{A}_{B}\\}caligraphic_A = { caligraphic_A start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT , caligraphic_A start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT }. This allows to write the Quantum Fisher Information in a matrix form as Gessner et al. (2016)\n\nFQâ¢(Ï^,ğœTâ¢ğ’œ)=ğœTâ¢ğ’¬Ï^ğ’œâ¢ğœ,subscriptğ¹ğ‘„^ğœŒsuperscriptğœğ‘‡ğ’œsuperscriptğœğ‘‡superscriptsubscriptğ’¬^ğœŒğ’œğœF_{Q}(\\hat{\\rho},\\mathbf{c}^{T}\\mathcal{A})=\\mathbf{c}^{T}\\mathcal{Q}_{\\hat{% \\rho}}^{\\mathcal{A}}\\mathbf{c},italic_F start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï end_ARG , bold_c start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT caligraphic_A ) = bold_c start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT bold_c , (6)\n\nwhere ğ’¬Ï^ğ’œsuperscriptsubscriptğ’¬^ğœŒğ’œ\\mathcal{Q}_{\\hat{\\rho}}^{\\mathcal{A}}caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT is the Quantum Fisher Information matrix and its elements are given, provided the spectral decomposition Ï^=âˆ‘kpkâ¢|ÏˆkâŸ©â¢âŸ¨Ïˆk|^ğœŒsubscriptğ‘˜subscriptğ‘ğ‘˜ketsubscriptğœ“ğ‘˜brasubscriptğœ“ğ‘˜\\hat{\\rho}=\\sum_{k}p_{k}|\\psi_{k}\\rangle\\langle\\psi_{k}|over^ start_ARG italic_Ï end_ARG = âˆ‘ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT | italic_Ïˆ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT âŸ© âŸ¨ italic_Ïˆ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT |, by\n\n(ğ’¬Ï^ğ’œ)i,j(m,n)=âˆ‘k,l(pkâˆ’pl)2pk+plâ¢âŸ¨Ïˆk|H^i(m)|ÏˆlâŸ©â¢âŸ¨Ïˆl|H^j(n)|ÏˆkâŸ©,superscriptsubscriptsuperscriptsubscriptğ’¬^ğœŒğ’œğ‘–ğ‘—ğ‘šğ‘›subscriptğ‘˜ğ‘™superscriptsubscriptğ‘ğ‘˜subscriptğ‘ğ‘™2subscriptğ‘ğ‘˜subscriptğ‘ğ‘™quantum-operator-productsubscriptğœ“ğ‘˜superscriptsubscript^ğ»ğ‘–ğ‘šsubscriptğœ“ğ‘™quantum-operator-productsubscriptğœ“ğ‘™superscriptsubscript^ğ»ğ‘—ğ‘›subscriptğœ“ğ‘˜\\left(\\mathcal{Q}_{\\hat{\\rho}}^{\\mathcal{A}}\\right)_{i,j}^{(m,n)}=\\sum_{k,l}% \\frac{(p_{k}-p_{l})^{2}}{p_{k}+p_{l}}\\langle\\psi_{k}|\\hat{H}_{i}^{(m)}|\\psi_{l% }\\rangle\\langle\\psi_{l}|\\hat{H}_{j}^{(n)}|\\psi_{k}\\rangle,( caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_m , italic_n ) end_POSTSUPERSCRIPT = âˆ‘ start_POSTSUBSCRIPT italic_k , italic_l end_POSTSUBSCRIPT divide start_ARG ( italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - italic_p start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT end_ARG start_ARG italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_p start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT end_ARG âŸ¨ italic_Ïˆ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT | over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT | italic_Ïˆ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT âŸ© âŸ¨ italic_Ïˆ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT | over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_n ) end_POSTSUPERSCRIPT | italic_Ïˆ start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT âŸ© , (7)\n\nwhere the sum extends over all pairs k,lğ‘˜ğ‘™k,litalic_k , italic_l such that pk+plâ‰ 0subscriptğ‘ğ‘˜subscriptğ‘ğ‘™0p_{k}+p_{l}\\neq 0italic_p start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_p start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT â‰  0. The state Ï^^ğœŒ\\hat{\\rho}over^ start_ARG italic_Ï end_ARG is typically considered to be the one after the implementation of the evolution. Yet here we consider only small values of the parameters, so that the spectral decomposition considered is that of the probe state, and all higher orders on the value of the parameters are omited.\n\nThe right hand side of inequality (5) on the other hand corresponds to the variance of the generator in the product state of the local reduced states, i.e., Î â¢(Ï^)=Ï^AâŠ—Ï^BÎ ^ğœŒtensor-productsubscript^ğœŒğ´subscript^ğœŒğµ\\Pi(\\hat{\\rho})=\\hat{\\rho}_{A}\\otimes\\hat{\\rho}_{B}roman_Î  ( over^ start_ARG italic_Ï end_ARG ) = over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT âŠ— over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT. This term can be expressed also in a matrix form by means of the covariance matrix of the generators defined by\n\nÎ“i,j(m,n)=Câ¢oâ¢vâ¢(H^i(m),H^j(n))Î â¢(Ï^).superscriptsubscriptÎ“ğ‘–ğ‘—ğ‘šğ‘›ğ¶ğ‘œğ‘£subscriptsuperscriptsubscript^ğ»ğ‘–ğ‘šsuperscriptsubscript^ğ»ğ‘—ğ‘›Î ^ğœŒ\\Gamma_{i,j}^{(m,n)}=Cov(\\hat{H}_{i}^{(m)},\\hat{H}_{j}^{(n)})_{\\Pi(\\hat{\\rho})}.roman_Î“ start_POSTSUBSCRIPT italic_i , italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_m , italic_n ) end_POSTSUPERSCRIPT = italic_C italic_o italic_v ( over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_m ) end_POSTSUPERSCRIPT , over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_n ) end_POSTSUPERSCRIPT ) start_POSTSUBSCRIPT roman_Î  ( over^ start_ARG italic_Ï end_ARG ) end_POSTSUBSCRIPT . (8)\n\nThe variance of the generator for a particular choice of ğœğœ\\mathbf{c}bold_c is given by\n\nVarâ¢(ğœATâ¢ğ’œA)+Varâ¢(ğœBTâ¢ğ’œB)=ğœTâ¢Î“Î â¢(Ï^)ğ’œâ¢ğœ.Varsuperscriptsubscriptğœğ´Tsubscriptğ’œğ´VarsuperscriptsubscriptğœğµTsubscriptğ’œğµsuperscriptğœğ‘‡superscriptsubscriptÎ“Î ^ğœŒğ’œğœ\\text{Var}(\\mathbf{c}_{A}^{\\rm\\scriptscriptstyle T}\\mathcal{A}_{A})+\\text{Var}% (\\mathbf{c}_{B}^{\\rm\\scriptscriptstyle T}\\mathcal{A}_{B})=\\mathbf{c}^{T}\\Gamma% _{\\Pi(\\hat{\\rho})}^{\\mathcal{A}}\\mathbf{c}.Var ( bold_c start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_T end_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT ) + Var ( bold_c start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_T end_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT ) = bold_c start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT roman_Î“ start_POSTSUBSCRIPT roman_Î  ( over^ start_ARG italic_Ï end_ARG ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT bold_c . (9)\n\nCombining (6) and (9) into (5) we get that, for any separable state\n\nğœTâ¢(ğ’¬Ï^ğ’œâˆ’4â¢Î“Î â¢(Ï^)ğ’œ)â¢ğœâ‰¤0,âˆ€ğœ.superscriptğœğ‘‡superscriptsubscriptğ’¬^ğœŒğ’œ4superscriptsubscriptÎ“Î ^ğœŒğ’œğœ0for-allğœ\\mathbf{c}^{T}(\\mathcal{Q}_{\\hat{\\rho}}^{\\mathcal{A}}-4\\Gamma_{\\Pi(\\hat{\\rho})% }^{\\mathcal{A}})\\mathbf{c}\\leq 0,\\qquad\\forall\\mathbf{c}.bold_c start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT - 4 roman_Î“ start_POSTSUBSCRIPT roman_Î  ( over^ start_ARG italic_Ï end_ARG ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT ) bold_c â‰¤ 0 , âˆ€ bold_c . (10)\n\nGiven that this condition is satisfied for all choices of ğœğœ\\mathbf{c}bold_c, it can be rewritten as\n\nÎ»maxâ¢(ğ’¬Ï^ğ’œâˆ’4â¢Î“Î â¢(Ï^)ğ’œ)â‰¤0,subscriptğœ†maxsuperscriptsubscriptğ’¬^ğœŒğ’œ4superscriptsubscriptÎ“Î ^ğœŒğ’œ0\\lambda_{\\rm\\scriptscriptstyle max}\\left(\\mathcal{Q}_{\\hat{\\rho}}^{\\mathcal{A}% }-4\\Gamma_{\\Pi(\\hat{\\rho})}^{\\mathcal{A}}\\right)\\leq 0,italic_Î» start_POSTSUBSCRIPT roman_max end_POSTSUBSCRIPT ( caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT - 4 roman_Î“ start_POSTSUBSCRIPT roman_Î  ( over^ start_ARG italic_Ï end_ARG ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT ) â‰¤ 0 , (11)\n\nwhere Î»maxâ¢(M)subscriptğœ†maxğ‘€\\lambda_{\\rm\\scriptscriptstyle max}(M)italic_Î» start_POSTSUBSCRIPT roman_max end_POSTSUBSCRIPT ( italic_M ) stands for the maximum eigenvalue of Mğ‘€Mitalic_M. This inequality provides us a witness of entanglement\n\nEÏğ’œâ‰¡Î»maxâ¢(ğ’¬Ï^ğ’œâˆ’4â¢Î“Î â¢(Ï^)ğ’œ).superscriptsubscriptğ¸ğœŒğ’œsubscriptğœ†maxsuperscriptsubscriptğ’¬^ğœŒğ’œ4superscriptsubscriptÎ“Î ^ğœŒğ’œE_{\\rho}^{\\mathcal{A}}\\equiv\\lambda_{\\rm\\scriptscriptstyle max}\\left(\\mathcal{% Q}_{\\hat{\\rho}}^{\\mathcal{A}}-4\\Gamma_{\\Pi(\\hat{\\rho})}^{\\mathcal{A}}\\right).italic_E start_POSTSUBSCRIPT italic_Ï end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT â‰¡ italic_Î» start_POSTSUBSCRIPT roman_max end_POSTSUBSCRIPT ( caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT - 4 roman_Î“ start_POSTSUBSCRIPT roman_Î  ( over^ start_ARG italic_Ï end_ARG ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT ) . (12)\n\nIf this witness takes possitive values we can certify the presence of entanglement. Notably, if the set of generators is a complete set and the state is a pure state the latter becomes not just a sufficient but also a necessary condition Gessner et al. (2016).\n\nAll the above results can be straightforwardly generalized to multimode systems and to multipartite entanglement detection. In this case, the mğ‘šmitalic_m parties have access to a set of local generators ğ’œm={H^m(1),â€¦,H^m(Nm)}subscriptğ’œğ‘šsubscriptsuperscript^ğ»1ğ‘šâ€¦subscriptsuperscript^ğ»subscriptğ‘ğ‘šğ‘š\\mathcal{A}_{m}=\\{\\hat{H}^{(1)}_{m},\\ldots,\\hat{H}^{(N_{m})}_{m}\\}caligraphic_A start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT = { over^ start_ARG italic_H end_ARG start_POSTSUPERSCRIPT ( 1 ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_H end_ARG start_POSTSUPERSCRIPT ( italic_N start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT }. The elements of the Quantum Fisher Information matrix and the covariance matrix can be then computed from equations (7) and (8), with Î â¢(Ï^)=Ï^ğ’«1âŠ—â€¦âŠ—Ï^ğ’«pÎ ^ğœŒtensor-productsubscript^ğœŒsubscriptğ’«1â€¦subscript^ğœŒsubscriptğ’«ğ‘\\Pi(\\hat{\\rho})=\\hat{\\rho}_{\\scriptscriptstyle\\mathcal{P}_{1}}\\otimes\\ldots% \\otimes\\hat{\\rho}_{\\scriptscriptstyle\\mathcal{P}_{p}}roman_Î  ( over^ start_ARG italic_Ï end_ARG ) = over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT caligraphic_P start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT end_POSTSUBSCRIPT âŠ— â€¦ âŠ— over^ start_ARG italic_Ï end_ARG start_POSTSUBSCRIPT caligraphic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT end_POSTSUBSCRIPT, where we split the mğ‘šmitalic_m-multimode system into pğ‘pitalic_p partitions ğ’«isubscriptğ’«ğ‘–\\mathcal{P}_{i}caligraphic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT to detect pğ‘pitalic_p-partite entanglement.\n\nIII Witness mode-intrinsic entanglement\n\nA key aspect of non-Gaussian entanglement lies in its robustness against mode basis change. Contrary to Gaussian states whose entanglement can always be destroyed through a passive linear optics transformation, no such transformation can entirely remove the entanglement present in some non-Gaussian states; these states are said to be not passively separable and we call this type of entanglement mode-intrinsic entanglement. To detect such entanglement we propose to use the metrological witness (11) introduced in Sec.II as follows: a state will be mode-intrinsic entangled if in every mode basis EÏğ’œ>0superscriptsubscriptğ¸ğœŒğ’œ0E_{\\rho}^{\\mathcal{A}}>0italic_E start_POSTSUBSCRIPT italic_Ï end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT > 0.\n\nIn the following we focus on mutlimode quantum optical systems Fabre and Treps (2020). In CV quantum optics the natural and fundamental observables are the amplitude and phase quadratures q^ksubscript^ğ‘ğ‘˜\\hat{q}_{k}over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT and p^ksubscript^ğ‘ğ‘˜\\hat{p}_{k}over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT, which are related to creation and annihilation operators of the corresponding bosonic field by\n\na^k=q^k+iâ¢p^k2,a^kâ€ =q^kâˆ’iâ¢p^k2,âˆ€kâˆˆ{1,â€¦,m},formulae-sequencesubscript^ğ‘ğ‘˜subscript^ğ‘ğ‘˜ğ‘–subscript^ğ‘ğ‘˜2formulae-sequencesuperscriptsubscript^ğ‘ğ‘˜â€ subscript^ğ‘ğ‘˜ğ‘–subscript^ğ‘ğ‘˜2for-allğ‘˜1â€¦ğ‘š\\hat{a}_{k}=\\frac{\\hat{q}_{k}+i\\hat{p}_{k}}{2},\\quad\\hat{a}_{k}^{\\dagger}=% \\frac{\\hat{q}_{k}-i\\hat{p}_{k}}{2},\\quad\\forall k\\in\\{1,\\ldots,m\\},over^ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT = divide start_ARG over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT + italic_i over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG , over^ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€  end_POSTSUPERSCRIPT = divide start_ARG over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT - italic_i over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT end_ARG start_ARG 2 end_ARG , âˆ€ italic_k âˆˆ { 1 , â€¦ , italic_m } , (13)\n\nwhere a^ksubscript^ğ‘ğ‘˜\\hat{a}_{k}over^ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT and a^kâ€ subscriptsuperscript^ğ‘â€ ğ‘˜\\hat{a}^{\\dagger}_{k}over^ start_ARG italic_a end_ARG start_POSTSUPERSCRIPT â€  end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT are, respectively, the creation and annihilation operators corresponding to mode ktâ¢hsuperscriptğ‘˜ğ‘¡â„k^{th}italic_k start_POSTSUPERSCRIPT italic_t italic_h end_POSTSUPERSCRIPT out of mğ‘šmitalic_m available modes. Quadrature operators satisfy the canonical commutation relation [q^k,p^l]=2â¢iâ¢Î´k,lsubscript^ğ‘ğ‘˜subscript^ğ‘ğ‘™2ğ‘–subscriptğ›¿ğ‘˜ğ‘™[\\hat{q}_{k},\\hat{p}_{l}]=2i\\,\\delta_{k,l}[ over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT ] = 2 italic_i italic_Î´ start_POSTSUBSCRIPT italic_k , italic_l end_POSTSUBSCRIPT. The statistics of these operators can be recovered experimentally through homodyne measurements Leonhardt and Paul (1995), making them a judicious choice to construct a set of generators that the mğ‘šmitalic_m parties involved in the multimode system can experimentally implement. To that aim, we introduce the following generators of order Nğ‘Nitalic_N\n\nH^iğ’®=ğ’®â¢(q^1k1(i)â¢â€¦â¢q^mkm(i)â¢p^1km+1(i)â¢â€¦â¢p^mk2â¢m(i)),withâ¢âˆ‘j=12â¢mkj(i)=N,formulae-sequencesuperscriptsubscript^ğ»ğ‘–ğ’®ğ’®superscriptsubscript^ğ‘1superscriptsubscriptğ‘˜1ğ‘–â€¦superscriptsubscript^ğ‘ğ‘šsuperscriptsubscriptğ‘˜ğ‘šğ‘–superscriptsubscript^ğ‘1superscriptsubscriptğ‘˜ğ‘š1ğ‘–â€¦superscriptsubscript^ğ‘ğ‘šsuperscriptsubscriptğ‘˜2ğ‘šğ‘–withsuperscriptsubscriptğ‘—12ğ‘šsuperscriptsubscriptğ‘˜ğ‘—ğ‘–ğ‘\\hat{H}_{i}^{\\mathcal{S}}=\\mathcal{S}\\left(\\hat{q}_{1}^{k_{1}^{(i)}}\\ldots\\hat% {q}_{m}^{k_{m}^{(i)}}\\,\\hat{p}_{1}^{k_{m+1}^{(i)}}\\ldots\\hat{p}_{m}^{k_{2m}^{(% i)}}\\right),\\,\\text{with}\\,\\sum_{j=1}^{2m}k_{j}^{(i)}=N,over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_S end_POSTSUPERSCRIPT = caligraphic_S ( over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT â€¦ over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT italic_m + 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT â€¦ over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT 2 italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ) , with âˆ‘ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 italic_m end_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT = italic_N , (14)\n\nwhere ğ’®â¢(H^)ğ’®^ğ»\\mathcal{S}(\\hat{H})caligraphic_S ( over^ start_ARG italic_H end_ARG ) is the symmetrised version of H^^ğ»\\hat{H}over^ start_ARG italic_H end_ARG such that H^iğ’®superscriptsubscript^ğ»ğ‘–ğ’®\\hat{H}_{i}^{\\mathcal{S}}over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_S end_POSTSUPERSCRIPT is Hermitian. As one can see from the above expression, H^iğ’®superscriptsubscript^ğ»ğ‘–ğ’®\\hat{H}_{i}^{\\mathcal{S}}over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_S end_POSTSUPERSCRIPT contains products of Nğ‘Nitalic_N quadrature operators and is entirely described by the combination (k1(i),â€¦,k2â¢m(i))superscriptsubscriptğ‘˜1ğ‘–â€¦superscriptsubscriptğ‘˜2ğ‘šğ‘–(k_{1}^{(i)},\\ldots,k_{2m}^{(i)})( italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , â€¦ , italic_k start_POSTSUBSCRIPT 2 italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ), where each kj(i)superscriptsubscriptğ‘˜ğ‘—ğ‘–k_{j}^{(i)}italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT corresponds to the power of the quadrature operators in the decomposition (14) and whose sum equals Nğ‘Nitalic_N. Likewise, this type of generators can be non-local. Here, locality is defined as follows: local generators only belong to one subsystem, while non-local generators can be shared between multiple subsystems; for instance the quadrature operator p^12superscriptsubscript^ğ‘12\\hat{p}_{1}^{2}over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT is a local generator, while p^1â¢p^2subscript^ğ‘1subscript^ğ‘2\\hat{p}_{1}\\,\\hat{p}_{2}over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT is a non-local generator shared between subsystems 1 and 2. Since the metrological protocol described in the previous section is only based on local generators, it may seem unnecessary to include non-local generators. However, they will play a crucial role to correctly implement the mode basis change as we will see below.\n\nThen, we denote by ğ’œN,m(NL)={H^1ğ’®,â€¦â¢H^â„“â¢(N,m)ğ’®}subscriptsuperscriptğ’œNLğ‘ğ‘šsuperscriptsubscript^ğ»1ğ’®â€¦superscriptsubscript^ğ»â„“ğ‘ğ‘šğ’®\\mathcal{A}^{\\rm\\scriptscriptstyle(NL)}_{\\scriptscriptstyle N,% \\scriptscriptstyle m}=\\{\\hat{H}_{1}^{\\mathcal{S}},\\ldots\\hat{H}_{\\ell(N,m)}^{% \\mathcal{S}}\\}caligraphic_A start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT = { over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_S end_POSTSUPERSCRIPT , â€¦ over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT roman_â„“ ( italic_N , italic_m ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_S end_POSTSUPERSCRIPT } the set of all (local and non-local) symmetrised generators of the form (14) up to order Nğ‘Nitalic_N, in a mğ‘šmitalic_m-mode system. The superscript (NL) stands for non-local and\n\nâ„“â¢(N,m)=âˆ‘k=1N(2â¢m+kâˆ’1k)â„“ğ‘ğ‘šsuperscriptsubscriptğ‘˜1ğ‘matrix2ğ‘šğ‘˜1ğ‘˜\\ell(N,m)=\\sum_{k=1}^{N}\\begin{pmatrix}2m+k-1\\\\ k\\end{pmatrix}roman_â„“ ( italic_N , italic_m ) = âˆ‘ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT ( start_ARG start_ROW start_CELL 2 italic_m + italic_k - 1 end_CELL end_ROW start_ROW start_CELL italic_k end_CELL end_ROW end_ARG ) (15)\n\nis the length of the set. As an illustration, for m=2ğ‘š2m=2italic_m = 2 and N=2ğ‘2N=2italic_N = 2 this set of operators reads\n\nğ’œ2,2(NL)={q^1,p^1,q^2,p^2,q^12,12(q^1p^1+p^1q^1),p^12,q^22,12(q^2p^2+p^2q^2),p^22,q^1q^2,p^1p^2,q^1p^2,p^1q^2}.subscriptsuperscriptğ’œNL22subscript^ğ‘1subscript^ğ‘1subscript^ğ‘2subscript^ğ‘2superscriptsubscript^ğ‘1212subscript^ğ‘1subscript^ğ‘1subscript^ğ‘1subscript^ğ‘1superscriptsubscript^ğ‘12superscriptsubscript^ğ‘2212subscript^ğ‘2subscript^ğ‘2subscript^ğ‘2subscript^ğ‘2superscriptsubscript^ğ‘22subscript^ğ‘1subscript^ğ‘2subscript^ğ‘1subscript^ğ‘2subscript^ğ‘1subscript^ğ‘2subscript^ğ‘1subscript^ğ‘2\\begin{split}\\mathcal{A}^{\\rm\\scriptscriptstyle(NL)}_{2,2}=&\\left\\{\\hat{q}_{1}% ,\\hat{p}_{1},\\hat{q}_{2},\\hat{p}_{2},\\hat{q}_{1}^{2},\\frac{1}{2}(\\hat{q}_{1}% \\hat{p}_{1}+\\hat{p}_{1}\\hat{q}_{1}),\\hat{p}_{1}^{2},\\hat{q}_{2}^{2},\\right.\\\\ &\\left.\\frac{1}{2}(\\hat{q}_{2}\\hat{p}_{2}+\\hat{p}_{2}\\hat{q}_{2}),\\hat{p}_{2}^% {2},\\hat{q}_{1}\\hat{q}_{2},\\hat{p}_{1}\\hat{p}_{2},\\hat{q}_{1}\\hat{p}_{2},\\hat{% p}_{1}\\hat{q}_{2}\\right\\}.\\end{split}start_ROW start_CELL caligraphic_A start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT 2 , 2 end_POSTSUBSCRIPT = end_CELL start_CELL { over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , end_CELL end_ROW start_ROW start_CELL end_CELL start_CELL divide start_ARG 1 end_ARG start_ARG 2 end_ARG ( over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT + over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT , over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT } . end_CELL end_ROW (16)\n\nFollowing the above notation, we also denote by ğ’œN,m(L)subscriptsuperscriptğ’œLğ‘ğ‘š\\mathcal{A}^{\\rm\\scriptscriptstyle(L)}_{\\scriptscriptstyle N,m}caligraphic_A start_POSTSUPERSCRIPT ( roman_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT the set of symmetrised generators of order Nğ‘Nitalic_N containing only local generators, in an mğ‘šmitalic_m-mode system. In the case of the set (16), this amounts to remove the four generators q^1â¢q^2,p^1â¢p^2,q^1â¢p^2subscript^ğ‘1subscript^ğ‘2subscript^ğ‘1subscript^ğ‘2subscript^ğ‘1subscript^ğ‘2\\hat{q}_{1}\\hat{q}_{2},\\hat{p}_{1}\\hat{p}_{2},\\hat{q}_{1}\\hat{p}_{2}over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT and p^1â¢q^2subscript^ğ‘1subscript^ğ‘2\\hat{p}_{1}\\hat{q}_{2}over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT.\n\nNow that we have introduced the set of local and non-local generators ordered by Nğ‘Nitalic_N, we can use them to test mode-intrinsic entanglement of a given quantum state of light. To proceed, we probe entanglement using the metrological witness in every mode bases. It is worth stressing here that it is not necessary to measure the quantum Fisher information matrix ğ’¬Ï^ğ’œsuperscriptsubscriptğ’¬^ğœŒğ’œ\\mathcal{Q}_{\\hat{\\rho}}^{\\mathcal{A}}caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT as well as the covariance matrix of the local reduced state Î“Î â¢(Ï^)ğ’œsuperscriptsubscriptÎ“Î ^ğœŒğ’œ\\Gamma_{\\Pi(\\hat{\\rho})}^{\\mathcal{A}}roman_Î“ start_POSTSUBSCRIPT roman_Î  ( over^ start_ARG italic_Ï end_ARG ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT in all bases. Indeed, once these matrices are computed or measured in one basis, one can calculate them in another basis in post-processing. To illustrate this important point, let us consider the unitary matrix Uâ¢(Ï‘)ğ‘ˆbold-italic-Ï‘U(\\bm{\\vartheta})italic_U ( bold_italic_Ï‘ ) parameterized by some parameters contained in a vector Ï‘bold-italic-Ï‘\\bm{\\vartheta}bold_italic_Ï‘ and which enables to go from one set of generators ğ’œN,m(NL)superscriptsubscriptğ’œğ‘ğ‘šNL\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm\\scriptscriptstyle(NL)}caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT in a given basis to another set of generators (ğ’œN,m(NL))â€²superscriptsuperscriptsubscriptğ’œğ‘ğ‘šNLâ€²(\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm\\scriptscriptstyle(NL)})^{\\prime}( caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT in another basis, i.e., (ğ’œN,m(NL))â€²=Uâ¢(Ï‘)â¢ğ’œN,m(NL)superscriptsuperscriptsubscriptğ’œğ‘ğ‘šNLâ€²ğ‘ˆbold-italic-Ï‘superscriptsubscriptğ’œğ‘ğ‘šNL(\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm\\scriptscriptstyle(NL)})^{\\prime}=U(% \\bm{\\vartheta})\\,\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm\\scriptscriptstyle(% NL)}( caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT = italic_U ( bold_italic_Ï‘ ) caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT. The exact form of Uâ¢(Ï‘)ğ‘ˆbold-italic-Ï‘U(\\bm{\\vartheta})italic_U ( bold_italic_Ï‘ ) will be detailed below after Eq. (21). At the level of the quantum Fisher information matrix the change of basis gives\n\n(ğ’¬Ï^ğ’œN,m(NL))â€²=Uâ¢(Ï‘)â¢ğ’¬Ï^ğ’œN,m(NL)â¢UTâ¢(Ï‘).superscriptsuperscriptsubscriptğ’¬^ğœŒsuperscriptsubscriptğ’œğ‘ğ‘šNLâ€²ğ‘ˆbold-italic-Ï‘superscriptsubscriptğ’¬^ğœŒsuperscriptsubscriptğ’œğ‘ğ‘šNLsuperscriptğ‘ˆğ‘‡bold-italic-Ï‘\\left(\\mathcal{Q}_{\\hat{\\rho}}^{\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm% \\scriptscriptstyle(NL)}}\\right)^{\\prime}=U(\\bm{\\vartheta})\\,\\mathcal{Q}_{\\hat{% \\rho}}^{\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm\\scriptscriptstyle(NL)}}U^{T}% (\\bm{\\vartheta}).( caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT = italic_U ( bold_italic_Ï‘ ) caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT italic_U start_POSTSUPERSCRIPT italic_T end_POSTSUPERSCRIPT ( bold_italic_Ï‘ ) . (17)\n\nTherefore, knowing how the non-local set of generators transforms under a mode basis change allows to find the transformation at the level of the matrix ğ’¬Ï^ğ’œsuperscriptsubscriptğ’¬^ğœŒğ’œ\\mathcal{Q}_{\\hat{\\rho}}^{\\mathcal{A}}caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT (and similarly for Î“Î â¢(Ï^)ğ’œsuperscriptsubscriptÎ“Î ^ğœŒğ’œ\\Gamma_{\\Pi(\\hat{\\rho})}^{\\mathcal{A}}roman_Î“ start_POSTSUBSCRIPT roman_Î  ( over^ start_ARG italic_Ï end_ARG ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT) used in Eq. (10), and thus allows to find the metrological witness in the new basis.\n\nThere are some subtleties though: the basis change must include non-local operators to be correct. Indeed, let us take a simple example to illustrate this important point: the generator p^12superscriptsubscript^ğ‘12\\hat{p}_{1}^{2}over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT for a two-mode subsystem will be mapped onto (cosâ¡Î¸â¢p^1â€²+sinâ¡Î¸â¢p^2â€²)2superscriptğœƒsuperscriptsubscript^ğ‘1â€²ğœƒsuperscriptsubscript^ğ‘2â€²2(\\cos\\theta\\hat{p}_{1}^{\\prime}+\\sin\\theta\\hat{p}_{2}^{\\prime})^{2}( roman_cos italic_Î¸ over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT + roman_sin italic_Î¸ over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT when applying a basis change, and it clearly contains the non-local term p^1â€²â¢p^2â€²superscriptsubscript^ğ‘1â€²superscriptsubscript^ğ‘2â€²\\hat{p}_{1}^{\\prime}\\,\\hat{p}_{2}^{\\prime}over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT. Therefore, we need to keep such a non-local term to ensure that matrix ğ’¬Ï^ğ’œsuperscriptsubscriptğ’¬^ğœŒğ’œ\\mathcal{Q}_{\\hat{\\rho}}^{\\mathcal{A}}caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A end_POSTSUPERSCRIPT in Eq. (17) correctly transforms under the mode basis change Uâ¢(Ï‘)ğ‘ˆbold-italic-Ï‘U(\\bm{\\vartheta})italic_U ( bold_italic_Ï‘ ).\n\nHowever, once each matrix ğ’¬Ï^ğ’œN,m(NL)superscriptsubscriptğ’¬^ğœŒsuperscriptsubscriptğ’œğ‘ğ‘šNL\\mathcal{Q}_{\\hat{\\rho}}^{\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm% \\scriptscriptstyle(NL)}}caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT and Î“Î â¢(Ï^)ğ’œN,m(NL)superscriptsubscriptÎ“Î ^ğœŒsuperscriptsubscriptğ’œğ‘ğ‘šNL\\Gamma_{\\Pi(\\hat{\\rho})}^{\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm% \\scriptscriptstyle(NL)}}roman_Î“ start_POSTSUBSCRIPT roman_Î  ( over^ start_ARG italic_Ï end_ARG ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT in Eq. (10) have been found in the new basis, one should then drop all the rows and columns of these matrices associated to non-local generators. Indeed, the metrological protocol as described in the previous section consists of taking one local generator for each party of the multimode state, thus excluding non-local generators shared between subsystems. Keeping this important point in mind, the overall procedure then reads as follows:\n\n1.\n\nCompute the quantum Fisher information matrix ğ’¬Ï^ğ’œN,m(NL)superscriptsubscriptğ’¬^ğœŒsuperscriptsubscriptğ’œğ‘ğ‘šNL\\mathcal{Q}_{\\hat{\\rho}}^{\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm% \\scriptscriptstyle(NL)}}caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT for the whole set of operators ğ’œN,m(NL)superscriptsubscriptğ’œğ‘ğ‘šNL\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm\\scriptscriptstyle(NL)}caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT. When the state is pure this matrix equals four times the extended covariance matrix Î“Ï^ğ’œN,m(NL)superscriptsubscriptÎ“^ğœŒsuperscriptsubscriptğ’œğ‘ğ‘šNL\\Gamma_{\\hat{\\rho}}^{\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm% \\scriptscriptstyle(NL)}}roman_Î“ start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT (whose definition has been given in Eq. (8) with Î â¢(Ï^)Î ^ğœŒ\\Pi(\\hat{\\rho})roman_Î  ( over^ start_ARG italic_Ï end_ARG ) replaced by Ï^^ğœŒ\\hat{\\rho}over^ start_ARG italic_Ï end_ARG).\n\nThen, compute Î“Ï^ğ’œN,m(NL)superscriptsubscriptÎ“^ğœŒsuperscriptsubscriptğ’œğ‘ğ‘šNL\\Gamma_{\\hat{\\rho}}^{\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm% \\scriptscriptstyle(NL)}}roman_Î“ start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT. Both matrices have dimension â„“â¢(N,m)Ã—â„“â¢(N,m)â„“ğ‘ğ‘šâ„“ğ‘ğ‘š\\ell(N,m)\\times\\ell(N,m)roman_â„“ ( italic_N , italic_m ) Ã— roman_â„“ ( italic_N , italic_m ).\n\n2.\n\nMake the change of basis according to Eq. (17) to obtain (ğ’¬Ï^ğ’œN,m(NL))â€²superscriptsuperscriptsubscriptğ’¬^ğœŒsuperscriptsubscriptğ’œğ‘ğ‘šNLâ€²\\left(\\mathcal{Q}_{\\hat{\\rho}}^{\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm% \\scriptscriptstyle(NL)}}\\right)^{\\prime}( caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT and (Î“Ï^ğ’œN,m(NL))â€²superscriptsuperscriptsubscriptÎ“^ğœŒsuperscriptsubscriptğ’œğ‘ğ‘šNLâ€²\\left(\\Gamma_{\\hat{\\rho}}^{\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm% \\scriptscriptstyle(NL)}}\\right)^{\\prime}( roman_Î“ start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_NL ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT.\n\n3.\n\nRemove the rows and columns related to non-local operators. The final matrices denoted by (ğ’¬Ï^ğ’œN,m(L))â€²superscriptsuperscriptsubscriptğ’¬^ğœŒsuperscriptsubscriptğ’œğ‘ğ‘šLâ€²\\left(\\mathcal{Q}_{\\hat{\\rho}}^{\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm% \\scriptscriptstyle(L)}}\\right)^{\\prime}( caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_L ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT and (Î“Ï^ğ’œN,m(L))â€²superscriptsuperscriptsubscriptÎ“^ğœŒsuperscriptsubscriptğ’œğ‘ğ‘šLâ€²\\left(\\Gamma_{\\hat{\\rho}}^{\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm% \\scriptscriptstyle(L)}}\\right)^{\\prime}( roman_Î“ start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_L ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT will have dimension â„“locâ¢(N,m)Ã—â„“locâ¢(N,m)subscriptâ„“locğ‘ğ‘šsubscriptâ„“locğ‘ğ‘š\\ell_{\\rm\\scriptscriptstyle loc}(N,m)\\times\\ell_{\\rm\\scriptscriptstyle loc}(N,m)roman_â„“ start_POSTSUBSCRIPT roman_loc end_POSTSUBSCRIPT ( italic_N , italic_m ) Ã— roman_â„“ start_POSTSUBSCRIPT roman_loc end_POSTSUBSCRIPT ( italic_N , italic_m ), with â„“locâ¢(N,m)=mâ¢Nâ¢(N+3)/2subscriptâ„“locğ‘ğ‘šğ‘šğ‘ğ‘32\\ell_{\\rm\\scriptscriptstyle loc}(N,m)=m\\,N\\,(N+3)/2roman_â„“ start_POSTSUBSCRIPT roman_loc end_POSTSUBSCRIPT ( italic_N , italic_m ) = italic_m italic_N ( italic_N + 3 ) / 2.\n\n4.\n\nCompute (Î“Î â¢(Ï^)ğ’œN(L))â€²superscriptsuperscriptsubscriptÎ“Î ^ğœŒsuperscriptsubscriptğ’œğ‘Lâ€²\\left(\\Gamma_{\\Pi(\\hat{\\rho})}^{\\mathcal{A}_{\\scriptscriptstyle N}^{\\rm% \\scriptscriptstyle(L)}}\\right)^{\\prime}( roman_Î“ start_POSTSUBSCRIPT roman_Î  ( over^ start_ARG italic_Ï end_ARG ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_L ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT. This computation amounts to keep the elements of (Î“Ï^ğ’œN(L))â€²superscriptsuperscriptsubscriptÎ“^ğœŒsuperscriptsubscriptğ’œğ‘Lâ€²\\left(\\Gamma_{\\hat{\\rho}}^{\\mathcal{A}_{\\scriptscriptstyle N}^{\\rm% \\scriptscriptstyle(L)}}\\right)^{\\prime}( roman_Î“ start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_L ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT which only involve two generators H^iğ’®superscriptsubscript^ğ»ğ‘–ğ’®\\hat{H}_{i}^{\\mathcal{S}}over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_S end_POSTSUPERSCRIPT and H^lğ’®superscriptsubscript^ğ»ğ‘™ğ’®\\hat{H}_{l}^{\\mathcal{S}}over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_S end_POSTSUPERSCRIPT belonging to the same subsystem and put zero elsewhere.\n\n5.\n\nCompute EÏğ’œN,mâ¢(Ï‘)=Î»maxâ¢[(ğ’¬Ï^ğ’œN,m(L))â€²âˆ’4â¢(Î“Î â¢(Ï^)ğ’œN,m(L))â€²]superscriptsubscriptğ¸ğœŒsubscriptğ’œğ‘ğ‘šbold-italic-Ï‘subscriptğœ†maxdelimited-[]superscriptsuperscriptsubscriptğ’¬^ğœŒsuperscriptsubscriptğ’œğ‘ğ‘šLâ€²4superscriptsuperscriptsubscriptÎ“Î ^ğœŒsuperscriptsubscriptğ’œğ‘ğ‘šLâ€²E_{\\rho}^{\\mathcal{A}_{\\scriptscriptstyle N,m}}(\\bm{\\vartheta})=\\lambda_{\\rm% \\scriptscriptstyle max}\\left[\\left(\\mathcal{Q}_{\\hat{\\rho}}^{\\mathcal{A}_{% \\scriptscriptstyle N,m}^{\\rm\\scriptscriptstyle(L)}}\\right)^{\\prime}-4\\,\\left(% \\Gamma_{\\Pi(\\hat{\\rho})}^{\\mathcal{A}_{\\scriptscriptstyle N,m}^{\\rm% \\scriptscriptstyle(L)}}\\right)^{\\prime}\\right]italic_E start_POSTSUBSCRIPT italic_Ï end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( bold_italic_Ï‘ ) = italic_Î» start_POSTSUBSCRIPT roman_max end_POSTSUBSCRIPT [ ( caligraphic_Q start_POSTSUBSCRIPT over^ start_ARG italic_Ï end_ARG end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_L ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT - 4 ( roman_Î“ start_POSTSUBSCRIPT roman_Î  ( over^ start_ARG italic_Ï end_ARG ) end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( roman_L ) end_POSTSUPERSCRIPT end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT ], i.e., the entanglement criterion in the new basis. Then, if\n\nğ’²Qâ¢(Ï^,ğ’œN,m)â‰¡minÏ‘â¢EÏğ’œN,mâ¢(Ï‘)>0,subscriptğ’²ğ‘„^ğœŒsubscriptğ’œğ‘ğ‘šbold-italic-Ï‘minsuperscriptsubscriptğ¸ğœŒsubscriptğ’œğ‘ğ‘šbold-italic-Ï‘0\\mathcal{W}_{Q}(\\hat{\\rho},\\mathcal{A}_{N,m})\\equiv\\underset{\\bm{\\vartheta}}{% \\text{min}}\\,E_{\\rho}^{\\mathcal{A}_{\\scriptscriptstyle N,m}}(\\bm{\\vartheta})>0,caligraphic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï end_ARG , caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT ) â‰¡ underbold_italic_Ï‘ start_ARG min end_ARG italic_E start_POSTSUBSCRIPT italic_Ï end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , italic_m end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( bold_italic_Ï‘ ) > 0 , (18)\n\nthe state will be not passively separable.\n\nTo apply the above procedure we now need to derive the matrix transformation Uâ¢(Ï‘)ğ‘ˆbold-italic-Ï‘U(\\bm{\\vartheta})italic_U ( bold_italic_Ï‘ ). We recall that a generator H^iğ’®superscriptsubscript^ğ»ğ‘–ğ’®\\hat{H}_{i}^{\\mathcal{S}}over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_S end_POSTSUPERSCRIPT of type (14) is described by the combination (k1(i),â€¦,k2â¢m(i))superscriptsubscriptğ‘˜1ğ‘–â€¦superscriptsubscriptğ‘˜2ğ‘šğ‘–(k_{1}^{(i)},\\ldots,k_{2m}^{(i)})( italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT , â€¦ , italic_k start_POSTSUBSCRIPT 2 italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT ), where each kj(i)superscriptsubscriptğ‘˜ğ‘—ğ‘–k_{j}^{(i)}italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT corresponds to the power of each quadrature operator involved in the decomposition (14). The operators in the new basis are obtained from the operators in the old basis as\n\n(H^iğ’®)â€²=âˆ‘lUiâ¢lâ¢(Ï‘)â¢H^lğ’®,âˆ€iâˆˆ{1,â€¦,â„“â¢(N,m)}formulae-sequencesuperscriptsuperscriptsubscript^ğ»ğ‘–ğ’®â€²subscriptğ‘™subscriptğ‘ˆğ‘–ğ‘™bold-italic-Ï‘superscriptsubscript^ğ»ğ‘™ğ’®for-allğ‘–1â€¦â„“ğ‘ğ‘š\\left(\\hat{H}_{i}^{\\mathcal{S}}\\right)^{\\prime}=\\sum_{l}U_{il}(\\bm{\\vartheta})% \\,\\hat{H}_{l}^{\\mathcal{S}},\\quad\\forall i\\in\\{1,\\ldots,\\ell(N,m)\\}( over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_S end_POSTSUPERSCRIPT ) start_POSTSUPERSCRIPT â€² end_POSTSUPERSCRIPT = âˆ‘ start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT italic_U start_POSTSUBSCRIPT italic_i italic_l end_POSTSUBSCRIPT ( bold_italic_Ï‘ ) over^ start_ARG italic_H end_ARG start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_S end_POSTSUPERSCRIPT , âˆ€ italic_i âˆˆ { 1 , â€¦ , roman_â„“ ( italic_N , italic_m ) } (19)\n\nwhere\n\nUiâ¢lâ¢(Ï‘)=1âˆj=12â¢mkj(l)!â¢âˆ‘ÏƒâˆˆSNâˆs=1NOÎ±sâ¢Î²Ïƒâ¢(s)Tâ¢(Ï‘),subscriptğ‘ˆğ‘–ğ‘™bold-italic-Ï‘1superscriptsubscriptproductğ‘—12ğ‘šsuperscriptsubscriptğ‘˜ğ‘—ğ‘™subscriptğœsubscriptğ‘†ğ‘superscriptsubscriptproductğ‘ 1ğ‘superscriptsubscriptğ‘‚subscriptğ›¼ğ‘ subscriptğ›½ğœğ‘ Tbold-italic-Ï‘U_{il}(\\bm{\\vartheta})=\\frac{1}{\\prod_{j=1}^{2m}k_{j}^{(l)}!}\\sum_{\\sigma\\in S% _{N}}\\prod_{s=1}^{N}O_{\\alpha_{s}\\,\\beta_{\\sigma(s)}}^{\\rm\\scriptscriptstyle T% }(\\bm{\\vartheta}),italic_U start_POSTSUBSCRIPT italic_i italic_l end_POSTSUBSCRIPT ( bold_italic_Ï‘ ) = divide start_ARG 1 end_ARG start_ARG âˆ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 italic_m end_POSTSUPERSCRIPT italic_k start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT ! end_ARG âˆ‘ start_POSTSUBSCRIPT italic_Ïƒ âˆˆ italic_S start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUBSCRIPT âˆ start_POSTSUBSCRIPT italic_s = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N end_POSTSUPERSCRIPT italic_O start_POSTSUBSCRIPT italic_Î± start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT italic_Î² start_POSTSUBSCRIPT italic_Ïƒ ( italic_s ) end_POSTSUBSCRIPT end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_T end_POSTSUPERSCRIPT ( bold_italic_Ï‘ ) , (20)\n\nwith\n\nÎ±={1,â€¦â¢1âŸk1(l),â€¦,2â¢m,â€¦,2â¢mâŸk2â¢m(l)},Î²={1,â€¦â¢1âŸk1(i),â€¦,2â¢m,â€¦,2â¢mâŸk2â¢m(i)}.formulae-sequenceğ›¼subscriptâŸ1â€¦1superscriptsubscriptğ‘˜1ğ‘™â€¦subscriptâŸ2ğ‘šâ€¦2ğ‘šsuperscriptsubscriptğ‘˜2ğ‘šğ‘™ğ›½subscriptâŸ1â€¦1superscriptsubscriptğ‘˜1ğ‘–â€¦subscriptâŸ2ğ‘šâ€¦2ğ‘šsuperscriptsubscriptğ‘˜2ğ‘šğ‘–\\begin{split}\\alpha&=\\{\\underbrace{1,\\ldots 1}_{k_{1}^{(l)}},\\ldots,% \\underbrace{2m,\\ldots,2m}_{k_{2m}^{(l)}}\\},\\\\ \\beta&=\\{\\underbrace{1,\\ldots 1}_{k_{1}^{(i)}},\\ldots,\\underbrace{2m,\\ldots,2m% }_{k_{2m}^{(i)}}\\}.\\end{split}start_ROW start_CELL italic_Î± end_CELL start_CELL = { underâŸ start_ARG 1 , â€¦ 1 end_ARG start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , â€¦ , underâŸ start_ARG 2 italic_m , â€¦ , 2 italic_m end_ARG start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 2 italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_l ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT } , end_CELL end_ROW start_ROW start_CELL italic_Î² end_CELL start_CELL = { underâŸ start_ARG 1 , â€¦ 1 end_ARG start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT , â€¦ , underâŸ start_ARG 2 italic_m , â€¦ , 2 italic_m end_ARG start_POSTSUBSCRIPT italic_k start_POSTSUBSCRIPT 2 italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT ( italic_i ) end_POSTSUPERSCRIPT end_POSTSUBSCRIPT } . end_CELL end_ROW (21)\n\nIn expression (20), SNsubscriptğ‘†ğ‘S_{N}italic_S start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT represents the permutation group of degree Nğ‘Nitalic_N and Oâ¢(Ï‘)ğ‘‚bold-italic-Ï‘O(\\bm{\\vartheta})italic_O ( bold_italic_Ï‘ ) is the (linear) mode basis change transformation at the level of ğ’œN=1,m={q^1,â€¦,q^m,p^1,â€¦,p^m}subscriptğ’œğ‘1ğ‘šsubscript^ğ‘1â€¦subscript^ğ‘ğ‘šsubscript^ğ‘1â€¦subscript^ğ‘ğ‘š\\mathcal{A}_{N=1,m}=\\{\\hat{q}_{1},\\ldots,\\hat{q}_{m},\\hat{p}_{1},\\ldots,\\hat{p% }_{m}\\}caligraphic_A start_POSTSUBSCRIPT italic_N = 1 , italic_m end_POSTSUBSCRIPT = { over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , â€¦ , over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT } (note that here there are only local operators). For a given number of modes mğ‘šmitalic_m the most general linear transformation Oğ‘‚Oitalic_O that we are concerned with can be represented in a compact way, using, for example, Clementsâ€™s decomposition Clements et al. (2016), by the combination of mâ¢(mâˆ’1)/2ğ‘šğ‘š12m(m-1)/2italic_m ( italic_m - 1 ) / 2 real beamsplitters and mâ¢(mâˆ’1)/2ğ‘šğ‘š12m(m-1)/2italic_m ( italic_m - 1 ) / 2 local rotations (phase shifts), as represented in Fig.2. The transformation depends on mâ¢(mâˆ’1)ğ‘šğ‘š1m(m-1)italic_m ( italic_m - 1 ) parameters that we gather in the vector Ï‘=(ğœ½,ğ‹)bold-italic-Ï‘ğœ½ğ‹\\bm{\\vartheta}=(\\bm{\\theta},\\bm{\\varphi})bold_italic_Ï‘ = ( bold_italic_Î¸ , bold_italic_Ï† ), where ğœ½ğœ½\\bm{\\theta}bold_italic_Î¸ contains the mâ¢(mâˆ’1)/2ğ‘šğ‘š12m(m-1)/2italic_m ( italic_m - 1 ) / 2 angles of the beamspliters, and ğ‹ğ‹\\bm{\\varphi}bold_italic_Ï† contains the mâ¢(mâˆ’1)/2ğ‘šğ‘š12m(m-1)/2italic_m ( italic_m - 1 ) / 2 phases of the phase shifters. To reproduce the full set of passive transformations and additional set of mğ‘šmitalic_m local phase shifters should be included, nevertheless it is irrelevant for our task, given that these do not alter the entanglement property of the states we consider. More details on how to derive Eq. (20) can be found in Appendix [REF].\n\nTo illustrate the quite complicated expression (20), let us take an example with m=2ğ‘š2m=2italic_m = 2 and N=3ğ‘3N=3italic_N = 3: consider the generator (2,0,1,0)2010(2,0,1,0)( 2 , 0 , 1 , 0 ) [we decide to order the set of generators such that it corresponds to i=3ğ‘–3i=3italic_i = 3] which corresponds to the symmetrised version of q^12â¢p^1superscriptsubscript^ğ‘12subscript^ğ‘1\\hat{q}_{1}^{2}\\,\\hat{p}_{1}over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT. We then apply for simplicity the following transformation\n\nOâ‰¡Râ¢(Î¸)=(cosâ¡Î¸sinâ¡Î¸00âˆ’sinâ¡Î¸cosâ¡Î¸0000cosâ¡Î¸sinâ¡Î¸00âˆ’sinâ¡Î¸cosâ¡Î¸).ğ‘‚ğ‘…ğœƒmatrixğœƒğœƒ00ğœƒğœƒ0000ğœƒğœƒ00ğœƒğœƒO\\equiv R(\\theta)=\\begin{pmatrix}\\cos\\theta&\\sin\\theta&0&0\\\\ -\\sin\\theta&\\cos\\theta&0&0\\\\ 0&0&\\cos\\theta&\\sin\\theta\\\\ 0&0&-\\sin\\theta&\\cos\\theta\\\\ \\end{pmatrix}.italic_O â‰¡ italic_R ( italic_Î¸ ) = ( start_ARG start_ROW start_CELL roman_cos italic_Î¸ end_CELL start_CELL roman_sin italic_Î¸ end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL - roman_sin italic_Î¸ end_CELL start_CELL roman_cos italic_Î¸ end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL roman_cos italic_Î¸ end_CELL start_CELL roman_sin italic_Î¸ end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL - roman_sin italic_Î¸ end_CELL start_CELL roman_cos italic_Î¸ end_CELL end_ROW end_ARG ) . (22)\n\nLet us derive the term U31â¢(Î¸)subscriptğ‘ˆ31ğœƒU_{31}(\\theta)italic_U start_POSTSUBSCRIPT 31 end_POSTSUBSCRIPT ( italic_Î¸ ), where l=1ğ‘™1l=1italic_l = 1 corresponds to the generator (1,1,1,0)1110(1,1,1,0)( 1 , 1 , 1 , 0 ), i.e., the symmetrised version of q^1â¢p^1â¢q^2subscript^ğ‘1subscript^ğ‘1subscript^ğ‘2\\hat{q}_{1}\\,\\hat{p}_{1}\\,\\hat{q}_{2}over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT. In this case the vectors defined in Eq. (21) are Î±=(1,2,3)ğ›¼123\\alpha=(1,2,3)italic_Î± = ( 1 , 2 , 3 ) and Î²=(1,1,3)ğ›½113\\beta=(1,1,3)italic_Î² = ( 1 , 1 , 3 ), such that it leads to\n\nU31â¢(Î¸)=21!â¢O11Tâ¢O21Tâ¢O33T=2â¢cos2â¡Î¸â¢sinâ¡Î¸,subscriptğ‘ˆ31ğœƒ21superscriptsubscriptğ‘‚11Tsuperscriptsubscriptğ‘‚21Tsuperscriptsubscriptğ‘‚33T2superscript2ğœƒğœƒU_{31}(\\theta)=\\frac{2}{1!}O_{11}^{\\rm\\scriptscriptstyle T}\\,O_{21}^{\\rm% \\scriptscriptstyle T}\\,O_{33}^{\\rm\\scriptscriptstyle T}=2\\cos^{2}\\theta\\,\\sin\\theta,italic_U start_POSTSUBSCRIPT 31 end_POSTSUBSCRIPT ( italic_Î¸ ) = divide start_ARG 2 end_ARG start_ARG 1 ! end_ARG italic_O start_POSTSUBSCRIPT 11 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_T end_POSTSUPERSCRIPT italic_O start_POSTSUBSCRIPT 21 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_T end_POSTSUPERSCRIPT italic_O start_POSTSUBSCRIPT 33 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT roman_T end_POSTSUPERSCRIPT = 2 roman_cos start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_Î¸ roman_sin italic_Î¸ ,\n\nsince all other terms are zero (it comes with a factor 2 since we need to sum over all permutations). By computing (cosâ¡Î¸â¢q^1+sinâ¡Î¸â¢q^2)2â¢(cosâ¡Î¸â¢p^1+sinâ¡Î¸â¢p^2)superscriptğœƒsubscript^ğ‘1ğœƒsubscript^ğ‘22ğœƒsubscript^ğ‘1ğœƒsubscript^ğ‘2(\\cos\\theta\\hat{q}_{1}+\\sin\\theta\\hat{q}_{2})^{2}\\,(\\cos\\theta\\hat{p}_{1}+\\sin% \\theta\\hat{p}_{2})( roman_cos italic_Î¸ over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + roman_sin italic_Î¸ over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ( roman_cos italic_Î¸ over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + roman_sin italic_Î¸ over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ), one can indeed check that the coefficient in front of q^1â¢p^1â¢q^2subscript^ğ‘1subscript^ğ‘1subscript^ğ‘2\\hat{q}_{1}\\,\\hat{p}_{1}\\,\\hat{q}_{2}over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT is indeed given by 2â¢cos2â¡Î¸â¢sinâ¡Î¸2superscript2ğœƒğœƒ2\\cos^{2}\\theta\\,\\sin\\theta2 roman_cos start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT italic_Î¸ roman_sin italic_Î¸.\n\nExpression (20) is fully general for any transformation Oğ‘‚Oitalic_O and any number of modes mğ‘šmitalic_m and any set of generators ğ’œNsubscriptğ’œğ‘\\mathcal{A}_{\\scriptscriptstyle N}caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT. However, the computation time increase rapidly when considering high order generators given the factorial scaling with Nğ‘Nitalic_N.\n\nIV Application of the witness to experimentally relevant states\n\nTo explore the capability of the witness derived in the previous section to detect mode intrinsic entanglement for bipartite and multimode systems, we use it on a specific class of non-Gaussian states: photon subtracted states. These states are produced by subtracting one or more photons from a Gaussian state. The removal of photons is a non-Gaussian operation, thus rendering the state non-Gaussian. Therefore, it makes it possible to explore how quantum properties are affected by the non-Gaussianity using a class of states which falls within a well-established theoretical framework Walschaers (2021); Walschaers et al. (2019) and has the advantage to be already produced in the lab with state-of-the-art experiments using different spatial and temporal modes of indistinguishable sources Neergaard-Nielsen et al. (2006); Wakui et al. (2007); Endo et al. (2023), or in temporal-frequency domain Ra et al. (2020).\n\nThe general expression of the resulting states is given by\n\n|ÏˆâŸ©âˆ(âˆi=1NSa^i)â¢O^â¢(âˆj=1MS^â¢(rj,Ï•Â¯j))â¢|ğŸâŸ©,proportional-toketğœ“superscriptsubscriptproductğ‘–1subscriptğ‘ğ‘†subscript^ğ‘ğ‘–^ğ‘‚superscriptsubscriptproductğ‘—1ğ‘€^ğ‘†subscriptğ‘Ÿğ‘—subscriptÂ¯italic-Ï•ğ‘—ket0|\\psi\\rangle\\propto\\left(\\prod_{i=1}^{N_{S}}\\hat{a}_{i}\\right)\\hat{O}\\left(% \\prod_{j=1}^{M}\\hat{S}(r_{j},\\bar{\\phi}_{j})\\right)|\\mathbf{0}\\rangle,| italic_Ïˆ âŸ© âˆ ( âˆ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT end_POSTSUPERSCRIPT over^ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT ) over^ start_ARG italic_O end_ARG ( âˆ start_POSTSUBSCRIPT italic_j = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT over^ start_ARG italic_S end_ARG ( italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , overÂ¯ start_ARG italic_Ï• end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) ) | bold_0 âŸ© , (23)\n\nup to a normalization factor, where NSsubscriptğ‘ğ‘†N_{S}italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT is the number of photons subtracted and Mğ‘€Mitalic_M is the number of modes in the cluster. S^â¢(rj,Ï•Â¯j)^ğ‘†subscriptğ‘Ÿğ‘—subscriptÂ¯italic-Ï•ğ‘—\\hat{S}(r_{j},\\bar{\\phi}_{j})over^ start_ARG italic_S end_ARG ( italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT , overÂ¯ start_ARG italic_Ï• end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) is a single mode squeezing operation that squeezes the quadrature Î¾^Ï•Â¯j=q^jâ¢cosâ¡Ï•Â¯j+p^jâ¢sinâ¡Ï•Â¯jsubscript^ğœ‰subscriptÂ¯italic-Ï•ğ‘—subscript^ğ‘ğ‘—subscriptÂ¯italic-Ï•ğ‘—subscript^ğ‘ğ‘—subscriptÂ¯italic-Ï•ğ‘—\\hat{\\xi}_{\\bar{\\phi}_{j}}=\\hat{q}_{j}\\cos\\bar{\\phi}_{j}+\\hat{p}_{j}\\sin\\bar{% \\phi}_{j}over^ start_ARG italic_Î¾ end_ARG start_POSTSUBSCRIPT overÂ¯ start_ARG italic_Ï• end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT end_POSTSUBSCRIPT = over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT roman_cos overÂ¯ start_ARG italic_Ï• end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT + over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT roman_sin overÂ¯ start_ARG italic_Ï• end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT, of mode jğ‘—jitalic_j, with a squeezing level rjsubscriptğ‘Ÿğ‘—r_{j}italic_r start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT. O^^ğ‘‚\\hat{O}over^ start_ARG italic_O end_ARG is a general passive transformation, and a^isubscript^ğ‘ğ‘–\\hat{a}_{i}over^ start_ARG italic_a end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT are the annihilation operator corresponding to mode iğ‘–iitalic_i. In Fig. 3 we illustrate the case Ns=2subscriptğ‘ğ‘ 2N_{s}=2italic_N start_POSTSUBSCRIPT italic_s end_POSTSUBSCRIPT = 2. We also point out that photon subtractions can happen in a superposition of different modes of the cluster state; this case will only be considered for two-mode states, as in any case it can be casted into the form above by including the mixing operation in the unitary O^^ğ‘‚\\hat{O}over^ start_ARG italic_O end_ARG (see Sec. IV.2).\n\nWe split this section in two subsections: we start with the case of multimode cluster states to show that the witness can be applied and successfully detect mode-intrinsic entanglement. In particular, we apply the metrological witness to three-mode, four-mode and five-mode cluster states. Then we move to two-mode photon subtracted states. In some configurations discussed below this leads to mode-intrinsic entangled states that the witness can detect. For such a two-mode system the unitary transformation Uâ¢(Ï‘)ğ‘ˆbold-italic-Ï‘U(\\bm{\\vartheta})italic_U ( bold_italic_Ï‘ ) to go from one basis to another (as represented in Fig. 2) only depends on two parameters Ï‘=(Î¸,Ï†)bold-italic-Ï‘ğœƒğœ‘\\bm{\\vartheta}=(\\theta,\\varphi)bold_italic_Ï‘ = ( italic_Î¸ , italic_Ï† ). Therefore, one can easily visualize the metrological witness EÏğ’œN,2â¢(Î¸,Ï†)superscriptsubscriptğ¸ğœŒsubscriptğ’œğ‘2ğœƒğœ‘E_{\\rho}^{\\mathcal{A}_{\\scriptscriptstyle N,2}}(\\theta,\\varphi)italic_E start_POSTSUBSCRIPT italic_Ï end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N , 2 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( italic_Î¸ , italic_Ï† ) defined in Eq. (12) in all possible bases in a two-dimensional parameter space. Likewise, as we discuss in Sec. V, the mode-intrinsic entanglement witness for two-mode photon subtracted states could be measured experimentally using the Fisher information matrix, making it a very interesting and promising study case towards the experimental detection of non-Gaussian entanglement.\n\nIV.1 Multimode CV-cluster states\n\nA CV-cluster state is made of a set of modes which are coupled together by applying entangling CZ=expâ¡(iâ¢q^iâŠ—q^j)subscriptğ¶ğ‘tensor-productğ‘–subscript^ğ‘ğ‘–subscript^ğ‘ğ‘—C_{Z}=\\exp(i\\,\\hat{q}_{i}\\otimes\\hat{q}_{j})italic_C start_POSTSUBSCRIPT italic_Z end_POSTSUBSCRIPT = roman_exp ( italic_i over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT âŠ— over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_j end_POSTSUBSCRIPT ) gates. Overall, they form a graph structure (ğ’±,â„°)ğ’±â„°(\\mathcal{V},\\mathcal{E})( caligraphic_V , caligraphic_E ), where ğ’±ğ’±\\mathcal{V}caligraphic_V is the set of nodes, i.e., the set of modes in the multimode state, while â„°â„°\\mathcal{E}caligraphic_E represents the set of edges between the nodes, i.e., the quantum correlations that connect the modes together after applying the CZsubscriptğ¶ğ‘C_{Z}italic_C start_POSTSUBSCRIPT italic_Z end_POSTSUBSCRIPT gates. The graph formed by the cluster state can be described by the so-called adjacency matrix Vğ‘‰Vitalic_V whose coefficients Viâ¢jsubscriptğ‘‰ğ‘–ğ‘—V_{ij}italic_V start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT are 1 if an edge exists between nodes iğ‘–iitalic_i and jğ‘—jitalic_j (in other words if modes iğ‘–iitalic_i and jğ‘—jitalic_j are entangled to each other), 0 otherwise. We show in Fig. 4 the three cluster states that we will consider in this section. As an example we give the adjacency matrix of the three-mode cluster state:\n\nV3âˆ’modes=(010101010).subscriptğ‘‰3modesmatrix010101010V_{\\rm\\scriptscriptstyle 3-modes}=\\begin{pmatrix}0&1&0\\\\ 1&0&1\\\\ 0&1&0\\end{pmatrix}.italic_V start_POSTSUBSCRIPT 3 - roman_modes end_POSTSUBSCRIPT = ( start_ARG start_ROW start_CELL 0 end_CELL start_CELL 1 end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL 1 end_CELL start_CELL 0 end_CELL start_CELL 1 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 1 end_CELL start_CELL 0 end_CELL end_ROW end_ARG ) .\n\nThe red nodes in Fig. 4 indicate in which mode we subtract a photon to create our photon subtracted cluster state.\n\nA cluster state associated with a given adjacency matrix Vğ‘‰Vitalic_V is obtained from a set of single-mode squeezed states by applying a unitary matrix\n\nUV=(ğŸ™+iâ¢V)â¢(V2+ğŸ™)âˆ’1/2â¢ğ’ª,subscriptğ‘ˆğ‘‰1ğ‘–ğ‘‰superscriptsuperscriptğ‘‰2112ğ’ªU_{\\scriptscriptstyle V}=(\\mathds{1}+i\\,V)\\,(V^{2}+\\mathds{1})^{-1/2}\\,% \\mathcal{O},italic_U start_POSTSUBSCRIPT italic_V end_POSTSUBSCRIPT = ( blackboard_1 + italic_i italic_V ) ( italic_V start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT + blackboard_1 ) start_POSTSUPERSCRIPT - 1 / 2 end_POSTSUPERSCRIPT caligraphic_O , (24)\n\nwhere ğŸ™1\\mathds{1}blackboard_1 is the unitary matrix and ğ’ªğ’ª\\mathcal{O}caligraphic_O can be any real orthogonal matrix van Loock et al. (2007); Ferrini et al. (2015); Sansavini and Parigi (2020). The choice of ğ’ªğ’ª\\mathcal{O}caligraphic_O can be optimized to target a specific cluster configuration as discussed in Ref. Ferrini et al. (2015). Indeed, a perfect cluster state where correlations between modes are exactly given by the adjacency matrix can only be obtained in the limit of infinite squeezing. In this case, the variances of certain combinations of quadratures, called nullifiers, are exactly zero; these nullifiers are defined as\n\nÎ´^iâ‰¡p^iâˆ’âˆ‘k=1mViâ¢kâ¢q^k,âˆ€iâˆˆ{1,â€¦,m},formulae-sequencesubscript^ğ›¿ğ‘–subscript^ğ‘ğ‘–superscriptsubscriptğ‘˜1ğ‘šsubscriptğ‘‰ğ‘–ğ‘˜subscript^ğ‘ğ‘˜for-allğ‘–1â€¦ğ‘š\\hat{\\delta}_{i}\\equiv\\hat{p}_{i}-\\sum_{k=1}^{m}V_{ik}\\hat{q}_{k},\\quad\\forall i% \\in\\{1,\\ldots,m\\},over^ start_ARG italic_Î´ end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT â‰¡ over^ start_ARG italic_p end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT - âˆ‘ start_POSTSUBSCRIPT italic_k = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_m end_POSTSUPERSCRIPT italic_V start_POSTSUBSCRIPT italic_i italic_k end_POSTSUBSCRIPT over^ start_ARG italic_q end_ARG start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT , âˆ€ italic_i âˆˆ { 1 , â€¦ , italic_m } , (25)\n\nwhere mğ‘šmitalic_m is the number of modes in the cluster. In the case of finite squeezing, the variances of the nullifiers are not zero but one can minimize them to tend to the limit of the perfect cluster state by optimizing the orthogonal matrix ğ’ªğ’ª\\mathcal{O}caligraphic_O in Eq. (24). We thus follow the procedure described in Ref. Ferrini et al. (2015) using a genetic algorithm to minimize the variances of the nullifiers and obtain the best cluster states given the three graph structures of Fig. 4. In order to consider realistic squeezing parameters we take the ones measured in the 4-mode cluster states of Ref. Medeiros de AraÃºjo et al. (2014): âˆ’77-7- 7 dB, âˆ’66-6- 6 dB, âˆ’44-4- 4 dB, 0 dB. For the other cluster states considered here we use similar squeezing parameters: âˆ’77-7- 7 dB, âˆ’44-4- 4 dB, 0 dB (3-mode cluster state); âˆ’77-7- 7 dB, âˆ’66-6- 6 dB, âˆ’44-4- 4 dB, âˆ’22-2- 2 dB, 0 dB (5-mode cluster state).\n\nBefore we subtract a photon, the cluster states are fully Gaussian. Therefore, we do not expect to witness any mode-intrinsic entanglement since there will always exist a basis where the states are separable. The subtraction of a photon in the first mode (the red nodes in Fig. 4) renders the state non-Gaussian and will affect the modes in its vicinity; we thus anticipate to detect mode-intrinsic entanglement. In the case of a mğ‘šmitalic_m-multimode system we have the freedom to choose how we split it into pğ‘pitalic_p different partitions ğ’«1â¢|â€¦|â¢ğ’«psubscriptğ’«1â€¦subscriptğ’«ğ‘\\mathcal{P}_{1}|\\ldots|\\mathcal{P}_{p}caligraphic_P start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT | â€¦ | caligraphic_P start_POSTSUBSCRIPT italic_p end_POSTSUBSCRIPT and eventually detect pğ‘pitalic_p-partite mode-intrinsic entanglement. It is important to note that, in our case, the labelling of the modes is irrelevant; only the number of modes in each partition matters. Indeed, for any given mode splitting, we can always find a linear passive operation that changes the partitioning while keeping the same number of modes in each partition ğ’«isubscriptğ’«ğ‘–\\mathcal{P}_{i}caligraphic_P start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT (but with different mode labels). Therefore, as the witness covers all possible mode bases, any two mode splittings differing only by a reordering of the mode labels are completely equivalent regarding mode-intrinsic entanglement.\n\nTables 1, 2, 3 gather the values of the mode-intrinsic entanglement witness ğ’²Qâ¢(Ï^,ğ’œN=1,m)subscriptğ’²ğ‘„^ğœŒsubscriptğ’œğ‘1ğ‘š\\mathcal{W}_{Q}(\\hat{\\rho},\\mathcal{A}_{N=1,m})caligraphic_W start_POSTSUBSCRIPT italic_Q end_POSTSUBSCRIPT ( over^ start_ARG italic_Ï end_ARG , caligraphic_A start_POSTSUBSCRIPT italic_N = 1 , italic_m end_POSTSUBSCRIPT ) â€“ using first-order generators only â€“ obtained for the three clusters and for all possible mode splittings (up to a reordering of the mode labels as discussed above). Given the number of parameters that we need to optimize to find the minimum of the entanglement witness EÏğ’œNâ¢(Ï‘)superscriptsubscriptğ¸ğœŒsubscriptğ’œğ‘bold-italic-Ï‘E_{\\rho}^{\\mathcal{A}_{\\scriptscriptstyle N}}(\\bm{\\vartheta})italic_E start_POSTSUBSCRIPT italic_Ï end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( bold_italic_Ï‘ ) (see Fig. 2 where each blue and red block of the unitary transformation adds one degree of freedom), we also use here a genetic algorithm to solve this optimization problem. As we can clearly see from the results, for many mode splittings, the subtraction of the photon renders the cluster states mode-intrinsic entangled. On the other hand, it is very instructive to notice that only in the case where we split the cluster states into a bipartition where one of the subsystems contain mâˆ’1ğ‘š1m-1italic_m - 1 modes, the value of the witness becomes zero. In this case, while we cannot guarantee that the cluster is not entangled in at least one basis since we only use a witness of entanglement, the non-Gaussian correlations can be probably localized in the subsytem containing mâˆ’1ğ‘š1m-1italic_m - 1 modes leaving only Gaussian correlations between both subsystems.\n\nWhile it is difficult to draw any systematic conclusion from the results above given that we only tested the witness in three specific cluster configurations, it shows that the mode-intrinsic entanglement witness with first-order generators is able to detect mode-intrinsic entanglement for experimentally relevant cluster states. It also opens a new toolbox to explore and better understand the entanglement structure of large multimode non-Gaussian states such as those considered in Ref. Walschaers et al. (2023). A deeper exploration of this tool for the study of large clusters is left for future works. In the rest of this paper we rather focus on the study of the smallest version of these systems, i.e., two mode, two photon subtracted states. In this more controlled setting we can fully explore the capabilities and limitations of the method we develop, while also restricting to a scenario with more immediate potential to be tested experimentally.\n\nIV.2 Two-mode photon subtracted states\n\nAs explained above, we now turn our attention to two-mode photon subtracted states defined by\n\n|ÏˆâŸ©=âˆi=1NS(cosâ¡Î˜iâ¢a^1+sinâ¡Î˜iâ¢a^2)â¢S^â¢(r1)â¢S^â¢(r2)â¢|00âŸ©,ketğœ“superscriptsubscriptproductğ‘–1subscriptğ‘ğ‘†subscriptÎ˜ğ‘–subscript^ğ‘1subscriptÎ˜ğ‘–subscript^ğ‘2^ğ‘†subscriptğ‘Ÿ1^ğ‘†subscriptğ‘Ÿ2ket00|\\psi\\rangle=\\prod_{i=1}^{N_{\\scriptscriptstyle S}}(\\cos\\Theta_{i}\\,\\hat{a}_{1% }+\\sin\\Theta_{i}\\,\\hat{a}_{2})\\,\\hat{S}(r_{1})\\,\\hat{S}(r_{2})\\,|00\\rangle,| italic_Ïˆ âŸ© = âˆ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( roman_cos roman_Î˜ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT over^ start_ARG italic_a end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT + roman_sin roman_Î˜ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT over^ start_ARG italic_a end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) over^ start_ARG italic_S end_ARG ( italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) over^ start_ARG italic_S end_ARG ( italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) | 00 âŸ© , (26)\n\nwhere S^â¢(r1)^ğ‘†subscriptğ‘Ÿ1\\hat{S}(r_{1})over^ start_ARG italic_S end_ARG ( italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ) and S^â¢(r2)^ğ‘†subscriptğ‘Ÿ2\\hat{S}(r_{2})over^ start_ARG italic_S end_ARG ( italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ) are single-mode squeezing operators, equivalent to those in equation (23), where we removed the phase dependence Ï•Â¯isubscriptÂ¯italic-Ï•ğ‘–\\bar{\\phi}_{i}overÂ¯ start_ARG italic_Ï• end_ARG start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT and allow risubscriptğ‘Ÿğ‘–r_{i}italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT to be negative. Angles Î˜isubscriptÎ˜ğ‘–\\Theta_{i}roman_Î˜ start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT control mode superposition in which photons are subtracted, which effectively modifies the probability that the subtracted photon came from either mode for each subtraction j=1,â€¦,NSğ‘—1â€¦subscriptğ‘ğ‘†j=1,\\ldots,N_{\\scriptscriptstyle S}italic_j = 1 , â€¦ , italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT. In general we could have considered the subtraction to happen in an already entangled Gaussian state, nevertheless, those can always be brought to the form in equation (26) by the action of some passive unitary. In this subsection we consider two cases: NS=1subscriptğ‘ğ‘†1N_{\\scriptscriptstyle S}=1italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = 1 and NS=2subscriptğ‘ğ‘†2N_{\\scriptscriptstyle S}=2italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = 2. In both cases we consider the single mode squeezed states to be either squeezed in position (ri>0subscriptğ‘Ÿğ‘–0r_{i}>0italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT > 0) or in momentum (ri<0subscriptğ‘Ÿğ‘–0r_{i}<0italic_r start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT < 0). One-photon subtracted states (NS=1subscriptğ‘ğ‘†1N_{\\scriptscriptstyle S}=1italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = 1) are not mode-intrinsic entangled in the two following cases: (i) r1=r2subscriptğ‘Ÿ1subscriptğ‘Ÿ2r_{1}=r_{2}italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT and âˆ€Î˜1for-allsubscriptÎ˜1\\forall\\,\\Theta_{1}âˆ€ roman_Î˜ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT, (ii) Î˜1=nâ¢Ï€/2subscriptÎ˜1ğ‘›ğœ‹2\\Theta_{1}=n\\pi/2roman_Î˜ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_n italic_Ï€ / 2, nâˆˆâ„¤ğ‘›â„¤n\\in\\mathbb{Z}italic_n âˆˆ blackboard_Z and âˆ€r1,r2for-allsubscriptğ‘Ÿ1subscriptğ‘Ÿ2\\forall r_{1},r_{2}âˆ€ italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT; and, similarly, two-photon subtracted (NS=2subscriptğ‘ğ‘†2N_{\\scriptscriptstyle S}=2italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = 2) are not mode-intrinsic entangled for: (i) r1=r2subscriptğ‘Ÿ1subscriptğ‘Ÿ2r_{1}=r_{2}italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT and âˆ€Î˜1for-allsubscriptÎ˜1\\forall\\,\\Theta_{1}âˆ€ roman_Î˜ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT, (ii) Î˜1=nâ¢Ï€/2subscriptÎ˜1ğ‘›ğœ‹2\\Theta_{1}=n\\pi/2roman_Î˜ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_n italic_Ï€ / 2, nâˆˆâ„¤ğ‘›â„¤n\\in\\mathbb{Z}italic_n âˆˆ blackboard_Z and âˆ€r1,r2for-allsubscriptğ‘Ÿ1subscriptğ‘Ÿ2\\forall r_{1},r_{2}âˆ€ italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT (NS=1subscriptğ‘ğ‘†1N_{\\scriptscriptstyle S}=1italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = 1); (i) r1=r2subscriptğ‘Ÿ1subscriptğ‘Ÿ2r_{1}=r_{2}italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT, Î˜1subscriptÎ˜1\\Theta_{1}roman_Î˜ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT and Î˜2subscriptÎ˜2\\Theta_{2}roman_Î˜ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT orthogonal to each other, (ii) Î˜1=nâ¢Ï€/2subscriptÎ˜1ğ‘›ğœ‹2\\Theta_{1}=n\\pi/2roman_Î˜ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_n italic_Ï€ / 2 and Î˜2=mâ¢Ï€/2subscriptÎ˜2ğ‘šğœ‹2\\Theta_{2}=m\\pi/2roman_Î˜ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_m italic_Ï€ / 2 n,mâˆˆâ„¤ğ‘›ğ‘šâ„¤n,m\\in\\mathbb{Z}italic_n , italic_m âˆˆ blackboard_Z and âˆ€r1,r2for-allsubscriptğ‘Ÿ1subscriptğ‘Ÿ2\\forall r_{1},r_{2}âˆ€ italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT. In all other cases one can prove that these states are entangled in all mode bases. To illustrate how the metrological witness (18) can detect mode intrinsic entanglement we now consider two specific examples: NS=1subscriptğ‘ğ‘†1N_{\\scriptscriptstyle S}=1italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = 1, r1=âˆ’r2=0.2subscriptğ‘Ÿ1subscriptğ‘Ÿ20.2r_{1}=-r_{2}=0.2italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = - italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.2, Î˜1=Ï€/4subscriptÎ˜1ğœ‹4\\Theta_{1}=\\pi/4roman_Î˜ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = italic_Ï€ / 4; NS=2subscriptğ‘ğ‘†2N_{\\scriptscriptstyle S}=2italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = 2, r1=âˆ’r2=0.2subscriptğ‘Ÿ1subscriptğ‘Ÿ20.2r_{1}=-r_{2}=0.2italic_r start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = - italic_r start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = 0.2, Î˜1=âˆ’Î˜2=Ï€/4subscriptÎ˜1subscriptÎ˜2ğœ‹4\\Theta_{1}=-\\Theta_{2}=\\pi/4roman_Î˜ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT = - roman_Î˜ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT = italic_Ï€ / 4.\n\nIn the case of a two-mode state, the mode basis change transformation at the level of quadrature operators using Clementâ€™s decomposition can be written as\n\nOâ¢(Î¸,Ï†)=Râ¢(Î¸)â¢Pâ¢hâ¢(Ï†),ğ‘‚ğœƒğœ‘ğ‘…ğœƒğ‘ƒâ„ğœ‘O(\\theta,\\varphi)=R(\\theta)\\,Ph(\\varphi),italic_O ( italic_Î¸ , italic_Ï† ) = italic_R ( italic_Î¸ ) italic_P italic_h ( italic_Ï† ) , (27)\n\nwhere Râ¢(Î¸)ğ‘…ğœƒR(\\theta)italic_R ( italic_Î¸ ) is given in Eq. (22) and\n\nPâ¢hâ¢(Ï†)=(cosâ¡Ï†0sinâ¡Ï†00100âˆ’sinâ¡Ï†0cosâ¡Ï†00001).ğ‘ƒâ„ğœ‘matrixğœ‘0ğœ‘00100ğœ‘0ğœ‘00001Ph(\\varphi)=\\begin{pmatrix}\\cos\\varphi&0&\\sin\\varphi&0\\\\ 0&1&0&0\\\\ -\\sin\\varphi&0&\\cos\\varphi&0\\\\ 0&0&0&1\\\\ \\end{pmatrix}.italic_P italic_h ( italic_Ï† ) = ( start_ARG start_ROW start_CELL roman_cos italic_Ï† end_CELL start_CELL 0 end_CELL start_CELL roman_sin italic_Ï† end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 1 end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL - roman_sin italic_Ï† end_CELL start_CELL 0 end_CELL start_CELL roman_cos italic_Ï† end_CELL start_CELL 0 end_CELL end_ROW start_ROW start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL 0 end_CELL start_CELL 1 end_CELL end_ROW end_ARG ) .\n\nWe can then compute the mode basis transformation Uâ¢(Î¸,Ï†)ğ‘ˆğœƒğœ‘U(\\theta,\\varphi)italic_U ( italic_Î¸ , italic_Ï† ) using Eq. (20) and apply the metrological witness EÏğ’œNâ¢(Î¸,Ï†)superscriptsubscriptğ¸ğœŒsubscriptğ’œğ‘ğœƒğœ‘E_{\\rho}^{\\mathcal{A}_{\\scriptscriptstyle N}}(\\theta,\\varphi)italic_E start_POSTSUBSCRIPT italic_Ï end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( italic_Î¸ , italic_Ï† ) [see Eq. (18)] using first order and second order generators ğ’œN=1(L)subscriptsuperscriptğ’œLğ‘1\\mathcal{A}^{\\scriptscriptstyle\\rm(L)}_{N=1}caligraphic_A start_POSTSUPERSCRIPT ( roman_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT and ğ’œN=2(L)subscriptsuperscriptğ’œLğ‘2\\mathcal{A}^{\\scriptscriptstyle\\rm(L)}_{N=2}caligraphic_A start_POSTSUPERSCRIPT ( roman_L ) end_POSTSUPERSCRIPT start_POSTSUBSCRIPT italic_N = 2 end_POSTSUBSCRIPT, respectively. Notice that we have omitted the subscript m=2ğ‘š2m=2italic_m = 2 from the definition of the set of generators, as from this point on we will only be dealing with two-mode states.\n\nThe results are shown in Fig. 5 for NS=1subscriptğ‘ğ‘†1N_{\\scriptscriptstyle S}=1italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = 1 and Fig. 6 for NS=2subscriptğ‘ğ‘†2N_{\\scriptscriptstyle S}=2italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = 2. In both figures, the top graphs labeled as (a) correspond to the results using generators in the set ğ’œN=1subscriptğ’œğ‘1\\mathcal{A}_{N=1}caligraphic_A start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT, while we used the set ğ’œN=2subscriptğ’œğ‘2\\mathcal{A}_{N=2}caligraphic_A start_POSTSUBSCRIPT italic_N = 2 end_POSTSUBSCRIPT to produce the bottom graphs labeled as (b). The black dots indicate the minimal value of EÏğ’œNâ¢(Î¸,Ï†)superscriptsubscriptğ¸ğœŒsubscriptğ’œğ‘ğœƒğœ‘E_{\\rho}^{\\mathcal{A}_{\\scriptscriptstyle N}}(\\theta,\\varphi)italic_E start_POSTSUBSCRIPT italic_Ï end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( italic_Î¸ , italic_Ï† ) when spanning the parameter space (Î¸,Ï†)ğœƒğœ‘(\\theta,\\varphi)( italic_Î¸ , italic_Ï† ). One sees that for the one-photon subtracted state the metrological witness is able to detect mode intrinsic entanglement both at first order and second order on the generators: the minimal value over the parameter space is always strictly greater than zero, thus demonstrating entanglement in all mode bases. The robustness of the witness against optical losses is adressed below (see in particular Figs. 7 and 8). In the case of the two-photon subtracted state considered here the situation is different; as shown in Fig. 6 (a), first order fails to detect entanglement in all bases: the minimum of EÏğ’œN=1â¢(Î¸,Ï†)superscriptsubscriptğ¸ğœŒsubscriptğ’œğ‘1ğœƒğœ‘E_{\\rho}^{\\mathcal{A}_{\\scriptscriptstyle N=1}}(\\theta,\\varphi)italic_E start_POSTSUBSCRIPT italic_Ï end_POSTSUBSCRIPT start_POSTSUPERSCRIPT caligraphic_A start_POSTSUBSCRIPT italic_N = 1 end_POSTSUBSCRIPT end_POSTSUPERSCRIPT ( italic_Î¸ , italic_Ï† ) reaches zero for a range of values Î¸=0ğœƒ0\\theta=0italic_Î¸ = 0 (âˆ€Ï•)for-allitalic-Ï•(\\forall\\phi)( âˆ€ italic_Ï• ), Î¸=Ï€/2ğœƒğœ‹2\\theta=\\pi/2italic_Î¸ = italic_Ï€ / 2 (âˆ€Ï•)for-allitalic-Ï•(\\forall\\phi)( âˆ€ italic_Ï• ) and Ï•=Ï€/2italic-Ï•ğœ‹2\\phi=\\pi/2italic_Ï• = italic_Ï€ / 2 (âˆ€Î¸)for-allğœƒ(\\forall\\theta)( âˆ€ italic_Î¸ ) (see the black lines at the borders of the figure). Therefore, the first-order protocol cannot be used to assess the mode intrinsic entanglement of the state. On the contrary, as shown in Fig. 6 (b), once we use second order generators, the minimal value when spanning all mode-bases become strictly positive (it equals 0.98 in this precise example), thus meaning that the state is mode-intrinsic entangled. This illustrates the interest to use higher generators and to not restrict the metrological witness to first order generators. More generally one can show that for two photon subtracted states (NS=2subscriptğ‘ğ‘†2N_{\\scriptscriptstyle S}=2italic_N start_POSTSUBSCRIPT italic_S end_POSTSUBSCRIPT = 2) first order always fails when Î˜1subscriptÎ˜1\\Theta_{1}roman_Î˜ start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT and Î˜2subscriptÎ˜2\\Theta_{2}roman_Î˜ start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT are orthogonal to each other.\n\nSo far we did not include optical losses inherent to any experimental setup. We can thus reproduce the previous results and apply the metrological witness to lossy one and two-photon subtracted states. To simulate such losses we apply two single-mode loss channels L^1â¢(Î·)subscript^ğ¿1ğœ‚\\hat{L}_{1}(\\eta)over^ start_ARG italic_L end_ARG start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT ( italic_Î· ) and L^2â¢(Î·)subscript^ğ¿2ğœ‚\\hat{L}_{2}(\\eta)over^ start_ARG italic_L end_ARG start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT ( italic_Î· ) to each mode as described"
    }
}