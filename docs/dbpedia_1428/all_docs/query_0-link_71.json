{
    "id": "dbpedia_1428_0",
    "rank": 71,
    "data": {
        "url": "https://stackoverflow.com/questions/71901632/fatal-error-unsafe-repository-home-repon-is-owned-by-someone-else",
        "read_more_link": "",
        "language": "en",
        "title": "Fatal error \"unsafe repository ('/home/repon' is owned by someone else)\"",
        "top_image": "https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded",
        "meta_img": "https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded",
        "images": [
            "https://www.gravatar.com/avatar/8c68413a839369d73dc9e9013faa0637?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/4449f0d6a4f7bb19b09056a4401a4ed3?s=64&d=identicon&r=PG",
            "https://i.sstatic.net/RIZKi.png?s=64",
            "https://i.sstatic.net/ytYv1.jpg?s=64",
            "https://i.sstatic.net/RIZKi.png?s=64",
            "https://www.gravatar.com/avatar/e1ef95ed5c03e45e355d9fda158c2032?s=64&d=identicon&r=PG",
            "https://i.sstatic.net/ULGoG.png",
            "https://i.sstatic.net/PIsfn.jpg?s=64",
            "https://www.gravatar.com/avatar/187ad051b75b3617c2106d397188ecd8?s=64&d=identicon&r=PG",
            "https://i.sstatic.net/RIZKi.png?s=64",
            "https://www.gravatar.com/avatar/68ecafab42b0b9cb26ca9f1b8df4f18c?s=64&d=identicon&r=PG",
            "https://i.sstatic.net/RIZKi.png?s=64",
            "https://i.sstatic.net/bRubP.jpg?s=64",
            "https://www.gravatar.com/avatar/73d2be94c06cc7e3ea587dd8f2c71c84?s=64&d=identicon&r=PG",
            "https://i.sstatic.net/RIZKi.png?s=64",
            "https://www.gravatar.com/avatar/1b5b1d2ad4268496c930c463a191ca9c?s=64&d=identicon&r=PG&f=y&so-version=2",
            "https://i.sstatic.net/RIZKi.png?s=64",
            "https://www.gravatar.com/avatar/d76f8d74339c20fb921287d3c607d102?s=64&d=identicon&r=PG",
            "https://lh5.googleusercontent.com/-NsKA6E7CJIg/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucnBQsiFAPBN1RY-2hx5-eUfTduXiQ/s96-c/photo.jpg?sz=64",
            "https://i.sstatic.net/RIZKi.png?s=64",
            "https://lh5.googleusercontent.com/-QbDWRUl-J8Y/AAAAAAAAAAI/AAAAAAAAGtI/fMRabZNPdHI/photo.jpg?sz=64",
            "https://www.gravatar.com/avatar/f38ae5c8db89d6e4a997644ad609b7c0?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/5e5a981a78019808b4d628d2177e9ef1?s=64&d=identicon&r=PG&f=y&so-version=2",
            "https://i.sstatic.net/RIZKi.png?s=64",
            "https://i.sstatic.net/3nmRS.png?s=64",
            "https://i.sstatic.net/PIsfn.jpg?s=64",
            "https://www.gravatar.com/avatar/2bda870cd78f496676f6227b88fd667c?s=64&d=identicon&r=PG&f=y&so-version=2",
            "https://www.gravatar.com/avatar/b3ebc14e6aaf17ddf5fe55bb7c5cbac3?s=64&d=identicon&r=PG",
            "https://lh3.googleusercontent.com/a-/AOh14GgfYtqvG4Rk1a5f5NUlMPjmbxHIh73OyBB1fW4rgZ8=k-s64",
            "https://i.sstatic.net/RIZKi.png?s=64",
            "https://www.gravatar.com/avatar/708b8226eb3a21f3abfea46a66a65305?s=64&d=identicon&r=PG&f=y&so-version=2",
            "https://i.sstatic.net/RIZKi.png?s=64",
            "https://www.gravatar.com/avatar/d7c226046f99192b9109d83545d78faf?s=64&d=identicon&r=PG",
            "https://i.sstatic.net/RIZKi.png?s=64",
            "https://www.gravatar.com/avatar/50cc22de587e4927113e98b27ab893cc?s=64&d=identicon&r=PG",
            "https://i.sstatic.net/RIZKi.png?s=64",
            "https://graph.facebook.com/10207123198894846/picture?type=large",
            "https://i.sstatic.net/RIZKi.png?s=64",
            "https://i.sstatic.net/edgHI.jpg?s=64",
            "https://www.gravatar.com/avatar/002452d5c6ea3cf68b1d3262ecbf9577?s=64&d=identicon&r=PG",
            "https://www.gravatar.com/avatar/474e1d160f03f4a94bdd1e7946c33942?s=64&d=identicon&r=PG&f=y&so-version=2",
            "https://www.gravatar.com/avatar/3df4cb3d2068cba7be5faa95021f8017?s=64&d=identicon&r=PG&f=y&so-version=2",
            "https://i.sstatic.net/PIsfn.jpg?s=64",
            "https://www.gravatar.com/avatar/094fb8c957dd153a78c97f44248e8d7d?s=64&d=identicon&r=PG",
            "https://graph.facebook.com/1498463113614120/picture?type=large",
            "https://lh3.googleusercontent.com/a-/AOh14Gg8pPkptMFD3JsoUQdKZowap4meGQqlHs-XXihk=k-s64",
            "https://stackoverflow.com/posts/71901632/ivc/374a?prg=b01322e4-e73d-47f6-802c-916194787326"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": "2022-04-17T11:49:59",
        "summary": "",
        "meta_description": "I found an error log from Apache 2 that is fatal:\nunsafe repository ('/home/repon' is owned by someone else)\n\nIt happens because I have git rev-parse --symbolic-full-name --abbrev-ref HEAD' in PHP ...",
        "meta_lang": "en",
        "meta_favicon": "https://cdn.sstatic.net/Sites/stackoverflow/Img/favicon.ico?v=ec617d715196",
        "meta_site_name": "Stack Overflow",
        "canonical_link": "https://stackoverflow.com/questions/71901632/fatal-error-unsafe-repository-home-repon-is-owned-by-someone-else",
        "text": "This started appearing with the release of the Git 2.35.2 security update which fixes vulnerabilities described here. Credits @Juan-Kabbali\n\nHere are four possible solutions:\n\ntrust the Git directory (do it if you know the directory contents are safe)\n\ngit config --global --add safe.directory /home/repon\n\nThis adds the safe group to file ~/.gitconfig as shown in this example:\n\n[safe] directory = /home/repon\n\nrun the command as the correct user, for example:\n\nsudo -u ubuntu -- git status\n\nNote: This requires user www-data to have permission to execute the Git command as user ubuntu (assuming ubuntu is the repository owner). For this to work, you will need to add a new file inside /etc/sudoers.d/ with the following contents:\n\nwww-data ALL=(ubuntu) NOPASSWD: /usr/bin/git\n\nThis may have security implications, so refer to your security person first.\n\nchange the Git repository owner to www-data\n\nsudo chown -R www-data:www-data /home/repon\n\ndowngrade Git as a temporary solution. For example, in Ubuntu:\n\napt install git-man=1:2.17.0-1ubuntu1 git=1:2.17.0-1ubuntu1\n\nNote: At least on Windows, it appears that all Git repositories on ejectable drives are considered unsafe and changing the ownership does not seem to work.\n\nThis is because of the Git safe update.\n\nTo make Git trust any directory you can run this in PowerShell:\n\ngit config --global --add safe.directory *\n\nIn Bash, you should escape the * to avoid expansion:\n\ngit config --global --add safe.directory '*'\n\nSupport for * was only added in Git 2.36 as mentioned at: Highlights from Git 2.36 and by genonymous in the comments.\n\nIf you just trust one directory, you can run this command\n\ngit config --global --add safe.directory your-directory\n\nFor Windows I had to do the following:\n\nRight click on the Git repository folder on which the error occurs and select Properties\n\nSelect the security tab, and then choose \"Advanced\" (left picture: press \"Erweitert\")\n\nCheck the owner properties (right picture: \"Besitzer\") in the top area of the new opened window and adapt it (right picture: press \"Ändern\"). This must be your working Windows account\n\nPress OK and wait until rights have been set, and then the Git error message should be history\n\nThis solution also works if you move or rename the directory afterwards. In my opinion you should prefer this solution over\n\ngit config --global --add safe.directory <repo-path>\n\nwhich you have to do each time where you perform changes on the directory name. You can also manually adapt the .gitconfig file in\n\nC:\\Users\\<username>\\.gitconfig\n\nonce you added to the safe list.\n\nAlongside Huber Thomas's answer for Windows, I had to use PowerShell or CMD since I had a bunch of files in a source control management folder I'd moved from one location to another. The TAKEOWN command handled this well (if a little slowly).\n\nOpen CMD as yourself (you don't need to be an administrator)\n\nNavigate to the repository folder (or parent if you have multiple)\n\nRun takeown /f . /r /d Y\n\nThis will recursively work through all folders in your current folder and set the ownership to the logged-in user (presumably you).\n\nI may be stating the obvious, but I think it's worth mentioning that running git config --global --add safe.directory /home/repon needs to done for the www-data user.\n\nProblem 1: www-data's HOME directory is /var/www, so having a .gitconfig file there may be a security risk (divulging server paths and configurations).\n\nProblem 2: with Apache/Ubuntu 20.04 (Focal Fossa), the HOME environment variable is not defined by default (/etc/apache2/envvars unsets it), so the configuration is not getting picked-up (git config --global fails with fatal: $HOME not set).\n\nI managed to fix the problem by adding the repository to Git's system configuration, i.e., git config --system --add safe.directory /home/repon.\n\nI had a similar issue - a web application that used Git could not access the repository.\n\nRunning the suggested command (git config --global --add safe.directory /repo/path) didn't work either, because I ran it as 'me', not as the 'www-data' user.\n\nThe solution was in fact really simple - I created the .gitconfig file in the /var/www directory (which is home for www-data user in my case) and put\n\n[safe] directory = /repo/path\n\nthere.\n\nChanging the owner of the top level directory fixed it.\n\nRunning Laravel on a local Ubuntu LAMP stack, my setup includes the command:\n\nsudo chown -R www-data /var/www/dirname\n\nBut with www-data owning the dirname, Git gave the above error. To fix it, I only had to change the owner of the top level dirname, and the .git directory:\n\nsudo chown myUserName /var/www/dirname\n\nsudo chown -R myUserName /var/www/dirname/.git\n\nAdding to the gitconfig worked, but who wants to do that seemingly to every directory?! Craziness!\n\nFor me, the answer is: → Don't use sudo!\n\nFor many cases, using sudo doesn't hurt, and it can be habitual if you are moving between things your user can touch, and things needing more access.\n\nIf my user created a repository and then I used \"sudo git...\", I got the error. I also had the \"sudo git...\" part in an alias, so it wasn't obvious that I was even using it.\n\nIn my case, I could not change the folder ownership, and the git config --global --add safe.directory didn't fix it. The issue turned out to be that the folder was created from console running as administrator (win 10) and git was running with regular user credentials. I just backed up the folder contents, deleted it and recreated it without running as administrator.\n\nI tried all the answers above but was still getting the error. Though the answers and steps were correct it didn't work for me on Windows Subsystem for Linux (WSL) with PyCharm.\n\nSo I put aside the WSL and PyCharm terminal to run the command in my Windows PowerShell. I navigated to the location of the .gitconfig folder which was \\\\wsl$\\Ubuntu-20.04\\home\\user> and then typed .gitconfig to open it any my default text editor which is Visual Studio Code.\n\nI updated the directory path as below without the quotes:\n\ndirectory = %(prefix)///wsl$/Ubuntu-20.04/home/user/project/mysite\n\nYou can equally set the directory to * to mark all folders as safe. After that, I invalidated caches from PyCharm, and voila! no more errors.\n\nHope it helps someone.\n\nThis happens if you have a different user who owned the directory. For example, your Git repository is located in /var/www which is owned by www-data. Now, when you are signed-in/using a non-sudo user account and you go to /var/www to perform Git actions such as\n\ngit branch\n\nyou will get this error, so make sure you have appropriate directory permission. You can change the directory ownership by running chown or add your current user to the group to which the directory owner belongs to.\n\nIf you are on Linux and prefer explicit allowlisting, you may achieve it manually by editing the Git configuration, (e.g., using nano or Vim). Just put the folders allowlist into the [safe] section of the configuration file:\n\nnano ~/.gitconfig\n\nAnd here is a Python script to prepare the allow-list:\n\nfrom glob import glob def println(my_list): print(\"\\n\".join(map(str, my_list))) git_folders_list = sorted(glob(\"~/git/*\", recursive=True)) println([\"directory = \" + d for d in git_folders_list])\n\nI had this problem on Windows with Sublime Text Merge. I was trying to apply some solutions mentioned here, and they didn't work so I said:\n\nif the problem is with the folder I must create a new one, so copy and paste the project folder, delete the old one, rename the copy by the old name and that was it!\n\nI guess this should work on Linux too and when making the copy of the project folder it is created with the correct owner.\n\nAs well as receiving the error/warning messages above, the issue was that the results of the exec() commands were not being furnished BECAUSE of the error warnings....[add 2>&1 to the end to see the errors]\n\nThese steps below fixed it for me: I added a config file to /etc, set it's permissions and added the safe directory to it....\n\ntouch /etc/gitconfig chown www-data:www-data /etc/gitconfig nano /etc/gitconfig\n\nContent of the config file\n\n[safe] directory = /var/www/YOURPATH\n\nThat solved it....the original code could work\n\nI got the same issue as mentioned in the question and below as well:\n\nError: fatal: unsafe repository (repository is owned by someone else) To add an exception for this directory, call:\n\ngit config --global --add safe.directory repo\n\nBut adding a repo as safe directory did not work in ubuntu 18.04\n\nTacking on to this answer with regards to Sourcetree in windows, I had to run takeown as admin from the command line.\n\nI also needed to check the ownership of all the files and folders in my repo folder with DIR /Q to be sure I was changing to ownership to the right user.\n\nI was checking by cloning a remote repo and checking ownership and permissions of that repo vs other repos that I had copied across from a dying PC, and while the security tab in Windows Explorer seemed to show that everything matched up, DIR /Q showed me that the repos I was not able to open had different ownership than the one I had cloned and could access.\n\nAll of the above solutions give me next error:\n\ncould not lock config file */etc/gitconfig: Permission denied\n\nSolved with this solution: https://dirask.com/posts/Git-git-config-error-could-not-lock-config-file-Permission-denied-Kj825D\n\nFollow the next step by step:\n\nOpen Git Bash as administrator\n\nGo to your project directory: cd \"C:\\path\\to\\our\\project\\name\"\n\nExecute command:\n\ngit config --system --unset credential.helper\n\nOn linux run this command with sudo command:\n\nsudo git config --system --unset credential.helper"
    }
}