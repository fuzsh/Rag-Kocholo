{
    "id": "wrong_mix_domain_subsidiary_00148_1",
    "rank": 97,
    "data": {
        "url": "https://bobj-board.org/t/solved-another-outerjoin-sql-ansi-92-problem/29838",
        "read_more_link": "",
        "language": "en",
        "title": "[solved] another outerjoin & SQL ANSI 92 problem",
        "top_image": "https://bobj-board.org/uploads/default/original/3X/1/8/1834427cd1d49338f859eae39e9b48f6a3f2614e.png",
        "meta_img": "https://bobj-board.org/uploads/default/original/3X/1/8/1834427cd1d49338f859eae39e9b48f6a3f2614e.png",
        "images": [
            "https://bobj-board.org/images/emoji/twitter/confused.png?v=9",
            "https://bobj-board.org/images/emoji/twitter/us.png?v=9",
            "https://bobj-board.org/images/emoji/twitter/us.png?v=9",
            "https://bobj-board.org/images/emoji/twitter/frowning.png?v=9",
            "https://bobj-board.org/images/emoji/twitter/us.png?v=9",
            "https://bobj-board.org/images/emoji/twitter/us.png?v=9"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": "2004-06-07T14:16:37+00:00",
        "summary": "",
        "meta_description": "Hi all ! \nIt is all about an outer join problem &amp; SQL ANSI_92 syntax. I looked for messages dealing with this problem, but none has been corresponding (actually, the ones I found were the oppposite of mine …). \nMy proble&hellip;",
        "meta_lang": "en",
        "meta_favicon": "https://bobj-board.org/uploads/default/optimized/3X/c/b/cb664ea0ad94e4a9da3b92894ed52c28e917006a_2_32x32.png",
        "meta_site_name": "BusinessObjects Board",
        "canonical_link": "https://bobj-board.org/t/solved-another-outerjoin-sql-ansi-92-problem/29838",
        "text": "Hi all !\n\nIt is all about an outer join problem & SQL ANSI_92 syntax. I looked for messages dealing with this problem, but none has been corresponding (actually, the ones I found were the oppposite of mine …).\n\nMy problem is that I have complex joins with outer joins melted (one would say “quite ugly” but that’s the ways it is and I have to deal with it to build my universe). Since outer joins are disabled on outerjoins, I have to write it by hand in the join syntax. As a result, when some querries are generated by BO, I have an error because both *= and ANSI syntax are melted.\n\nI cannot modify the sybase prm file because it is likely to be used by another application in my company, but I guess such modifications can be done at universe level using the parameter tab.\n\nI then tried adding:\n\nOUTERJOINS_GENERATION=USUAL (instead of ANSI_92 in the prm file)\n\nLEFT_OUTER=$* (instead of nothing)\n\nRIGHT_OUTER=*$ (instead of nothing)\n\nI did not touch ANSI92=No (in the tab) and EXT_JOIN=YES (in the file)\n\nwhether modifications are made directly in the file on in the parameter tab; the result is still the same. everything looks like the changes have no effect at all …\n\nSo here are my questions :\n\n1/ is it correct that the universe parameter tab will override the prm file settings ?\n\n2/ how can I enable the *= syntax ? Am I missing something ?\n\n3/ is it normal that with a ANSI92=No in the universe paremeters and a OUTERJOINS_GENERATION=ANSI_92 in the prm file, i have SQL ANSI syntax generated ?\n\n4/ subsidiary : is it better to have ANSI syntax and enabling complex outer joins (if possible) ? these are disabled, so if you answered yes, can you tell me how to enable outerjoins on complex joins ?\n\nIf it can help, i’m running sybase v12, BO 6.1 thick client\n\nMany thanks for the help,\n\ndavid\n\nblinitz (BOB member since 2004-04-20)\n\nI might had that everything was going well with BO 5.1 and that this only happened after the universe was migrated to BO 6.1 … (with a 6.1 referential)\n\nblinitz (BOB member since 2004-04-20)\n\nthe problem still remains.\n\nbut I’ve just noticed an other very interesting thing : the ANSI syntax is not used when I have standard joins but it is when I have outer joins\n\nedit : the ANSI SQL Syntax is ONLY used when at least a join involved in the querry has its outer join checkbox checked.\n\nblinitz (BOB member since 2004-04-20)\n\nOK, here it is : sybase prm file :\n\nI guess the positions of the $ and * in LEFT_OUTER and RIGHT_OUTER are good since I found them this way on the BO web site\n\nIn the parameters tab of my universe, I Have :\n\nblinitz (BOB member since 2004-04-20)\n\nI’d try setting ANSI to Yes, setting left and right outer to just $ and OUTERJOINS_GENERATION to FULL_ODBC. I can’t see anything else there that would affect your SQL as you have described it.\n\nRegards,\n\nMark\n\nOK, I got it … it works now.\n\nThanks for your help.\n\nTo solve the problem, I went to the connection parameters’ screen, and turned the SGBDR engine from Sybase Adaptive Server 12 to 11.\n\nThe fact is that I’am currently using Sybase 12.0 with openclient 11.1.\n\nAnd I am about to migrate to Sybase 12.5 & OC12.5.\n\nyet, I still do not understand why there is such a different behaviour; If someone can enlight me, that’s cool !\n\nIf anyone is interrested, I’ll update this when I am under Sybase and OC 12.5.\n\nmany thanks to mark8664\n\ndavid\n\nblinitz (BOB member since 2004-04-20)\n\nA couple of other few elements, please do not hesitate and correct me if I am wrong :\n\nthe reason for all this might be that Sybase v11 was(is) not ANSI whereas Sybase v12 does comply with the ANSI standard. As a result, I think all this mess has nothing to do with openclient. It is just that using the v12 engine within BO enforces querries with outer joins to be writen using the ANSI 92syntax.\n\nWhy only such querries ? I cannot figure out exactly, but maybe for convenience : i personnally find the “not ansi” syntax far more easy to read and understand that the ansi one.\n\nFinnally, how to manage complex outer joins with the Sybase v12 Adaptive Server Engine ?\n\nMost of the time, checkboxes that setup the outerjoins on complex querries are disabled. Yet, you can still check the checkbox before building your complex join. BO will still disable them, but it will still take them into account on your schema (complex outer joins will be visible just as simple outer joins) and when writing the SQL code. (I sum it up there, but I found it on another thread.)\n\nHope this can help anyone in the same trouble as I have been.\n\nAnyway, this works fine but not in a very sexy way …\n\nIs this a bug ? or is there another way to do so ?\n\nThough solved, any advice greatly appreciated\n\nThanks,\n\nDavid\n\nblinitz (BOB member since 2004-04-20)\n\nI have facing this issue with ANSI SQL.\n\nI have two tables. Company and Project.\n\nThere are companies which don’t have any project so I put an outer join b/w company and project.\n\nIf I put a where condition on Project.project number, I was still expecting all the companies to be returned by query but it returned only one row for that particular project number which is incorrect.\n\nIf I make changes to PRM file and put OUTER_JOIN_GENERATION = USUAL, it works fine.\n\nBut problem with USUAL is, If I join (regular join) another table Project_date to project table, the query won’t run. It gives errors saying project is inner member of an outer join which is not possible as it also participates in a regular join (with project_date table).\n\nWhat is the way out here?\n\nmkumar (BOB member since 2002-08-26)\n\nQeury generated with ANSI SQL is:\n\nSELECT company.name, project.project_number, date.year FROM ((company RIGHT OUTER JOIN project ON (project.company_id=company.company_id) ) INNER JOIN date ON (date.date_id=project.project_start_date_id) ) WHERE ( project.project_number = 123 )\n\nHowever the correct query should be\n\nSELECT company.name, project.project_number, date.year FROM ((company RIGHT OUTER JOIN project ON (project.company_id=company.company_id) AND project.project_number = 123) INNER JOIN date ON (date.date_id=project.project_start_date_id) )\n\nWith ANSI, all the conditions on the inner table should be moved to the FROM clause which does not happen when I create conditions in BO.\n\nmkumar (BOB member since 2002-08-26)\n\nIf you change the outer joins into inner joins, does it do everything properly? I realize you want outer joins. I’m just wondering if the misbehavior is due to the outer joins.\n\nKSG (BOB member since 2002-07-17)\n\nYeah, Inner join works fine But I do want outer joins for my query.\n\nIts syntax problem with ANSI. It seems ANSI syntax get executed line by line.\n\nIf I put a where condition outside FROM clause, the where clause gets executed first. OUTER JOIN statement in FROM gets executed next but is nullified because the where condition has already filtered out the data.\n\nmkumar (BOB member since 2002-08-26)\n\nI tried that. If I do an outer join on project to date\n\nI gives me either all the projects or all the dates (depending on whether I do Left or Right outer join) which is again incorrect\n\nmkumar (BOB member since 2002-08-26)\n\nWhich RDBMS?\n\nDo you want all companies, even if they don’t have a project 123?\n\nOr do you usually want all companies, but if you request a specific project, you only want those companies that have a project 123?\n\nKSG (BOB member since 2002-07-17)\n\nWith Sybase and outer joins, I’ve done “isnull” to get around this.\n\nThis is really odd but I create TWO joins, one outer join between project and company (let’s say the project table is aliased to oj_project) and one inner join between project (aliased to ij_project) and company.\n\nThen I define project as “isnull(oj_project.project,ij_project.project)”\n\nWhen using project in a condition, it doesn’t include all the companies that don’t have projects.\n\nWhen not using project in the conditions, it does include all the companies that don’t have projects.\n\nI don’t know WHY but it works so I’m not complaining.\n\nKSG (BOB member since 2002-07-17)"
    }
}