{
    "id": "correct_foundationPlace_00141_2",
    "rank": 54,
    "data": {
        "url": "https://www.trellix.com/blogs/research/scattered-spider-the-modus-operandi/",
        "read_more_link": "",
        "language": "en",
        "title": "Scattered Spider: The Modus Operandi",
        "top_image": "https://www.trellix.com/en-us/img/thumbnails/scattered-spider.jpg",
        "meta_img": "https://www.trellix.com/en-us/img/thumbnails/scattered-spider.jpg",
        "images": [
            "https://www.trellix.com/en-us/assets/logos/Trellix-Logo-Black.svg",
            "https://www.trellix.com/en-us/img/icons/gradient/T0307-grad.svg",
            "https://www.trellix.com/en-us/img/icons/gradient/T0266-grad.svg",
            "https://www.trellix.com/en-us/img/icons/gradient/T0022-grad.svg",
            "https://www.trellix.com/en-us/img/icons/gradient/T0001-grad.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/au.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/br.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/ca.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/ca.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/de.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/es.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/fr.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/hk.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/in.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/it.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/jp.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/kr.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/mx.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/sg.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/gb.svg",
            "https://www.trellix.com/en-us/img/state-flags/circle-flags/us.svg",
            "https://www.trellix.com/en-us/img/cards/platform-icons-card.jpg",
            "https://www.trellix.com/en-us/img/cards/trellix-wise-card.jpg",
            "https://www.trellix.com/en-us/img/cards/trellix-thrive-card.jpg",
            "https://www.trellix.com/en-us/img/cards/bug-report-july-2022-card.jpg",
            "https://www.trellix.com/en-us/img/cards/cyberthreat-report-jun-2024-card.jpg",
            "https://www.trellix.com/en-us/img/cards/weekly-tech-talk-card.jpg",
            "https://www.trellix.com/admin/images/ajax-loading.gif",
            "https://www.trellix.com/en-us/img/events/xpand-live/trellix-xpand-live-2022-horz-wht.svg",
            "https://www.trellix.com/en-us/assets/logos/Trellix-x-white.svg"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "This blog takes a deep dive into the modus operandi of Scattered Spider; the recent events and tools leveraged by the threat actor, vulnerabilities exploited, and their impact.",
        "meta_lang": "en",
        "meta_favicon": "/favicon.ico?v=2",
        "meta_site_name": "",
        "canonical_link": "https://www.trellix.com/blogs/research/scattered-spider-the-modus-operandi/",
        "text": "Executive Summary\n\nScattered Spider, also referred to as UNC3944, Scatter Swine, and Muddled Libra, is a financially motivated threat actor group that has been active since May 2022. Scattered Spider has largely been observed targeting telecommunications and Business Process Outsourcing (BPO) organizations. However, recent activity indicates that this group has started targeting other sectors, including critical infrastructure organizations.\n\nDespite this change in targets, Scattered Spider continues to leverage a variety of social engineering tactics, including Telegram and SMS phishing, SIM swapping, MFA fatigue, and other tactics as part of their attacks. This group has often been observed impersonating IT personnel to convince individuals to share their credentials or grant remote access to their computers, has been linked to several past phishing campaigns and deployments of malicious kernel drivers â€“ including the use of a signed but malicious version of the Windows Intel Ethernet diagnostics driver.\n\nThis blog takes a deep dive into the modus operandi of Scattered Spider; the recent events and tools leveraged by the threat actor, vulnerabilities exploited, and their impact. Additionally, the MITRE ATT&CK Techniques/Sub-Techniques and their mitigations. Finally, the known associated indicators of compromise that can be used to implement detection, prevention, and response strategies.\n\nRecent Events\n\nScattered Spider typically exploits vulnerabilities such as CVE-2015-2291 and utilize tools like STONESTOP and POORTRY to terminate security software and evade detection.1 The group demonstrates a deep understanding of the Azure environment and leverages built-in tools for their attacks.2 Once initial access has been gained, Scattered Spider has been observed conducting reconnaissance of various environments, including Windows, Linux, Google Workspace, Azure Active Directory, Microsoft 365, and AWS, as well as conducting lateral movement and downloading additional tools to exfiltrate VPN and MFA enrollment data in select cases. The group has also been known to establish persistence through legitimate remote access tools such as AnyDesk, LogMeIn, and ConnectWise Control.3\n\nBy January 2023, Scattered Spider was involved in more than half a dozen incidents from mid-2022 where large outsourcing firms serving high-value cryptocurrency institutions and individuals were targeted.4\n\nIn December 2022, Scattered Spider conducted campaigns targeting telecom and BPO organizations.5 The objective of the campaign appeared to be to gain access to mobile carrier networks and, as evidenced in two investigations, perform SIM swapping activity. Initial access was varied: Social engineering using phone calls and text messages to impersonate IT personnel, and either directing victims to a credential harvesting site or directing victims to run commercial Remote Monitoring and Management (RMM) tools. The campaigns were extremely persistent and brazen. Once the adversary was contained or operations are disrupted, they immediately moved to target other organizations within the telecom and BPO sectors.6\n\nIn the same month, their use of attestation signing to sign malware was discovered.7 Microsoft disclosed the steps they took to implement blocking protections and suspend accounts that were used to publish malicious drivers that were certified by its Windows Hardware Developer Program. The problem was initiated after Microsoft was notified of rogue drivers being used in post-exploitation efforts, including deploying ransomware.8\n\nIn August 2022, Twilio identified unauthorized access to information related to 163 Twilio customers, including Okta. Mobile phone numbers and associated SMS messages containing one-time passwords were accessible to Scattered Spider via the Twilio console. The phishing kit used by the threat actor was designed to capture usernames, passwords, and OTP factors and targeted technology companies, telecommunications providers and organizations and individuals linked to cryptocurrency.9\n\nTools\n\nScattered Spider uses POORTRY and STONESTOP to terminate security software and evade detection.10\n\nPOORTRY is a malicious driver used to terminate selected processes on Windows systems, e.g., Endpoint Detection and Response (EDR) agent on an endpoint.11 To evade detection, attackers have signed POORTRY driver with a Microsoft Windows Hardware Compatibility Authenticode signature.12\n\nSTONESTOP is a Windows userland utility that attempts to terminate processes by creating and loading a malicious driver.13 It functions as both a loader/installer for POORTRY, as well as an orchestrator to instruct the driver with what actions to perform.14\n\nIn April 2023, ALPHV (BlackCat) ransomware group used an updated version of POORTRY to compromise the US payments giant NCR, leading to an outage on its Aloha point of sale platform.15, 16\n\nVulnerability Exploits\n\nScattered Spider is known to exploit CVE-2015-2291 which is a vulnerability in the Intel Ethernet diagnostics driver for Windows (iqvw64.sys) that allows local users to cause a denial of service or possibly execute arbitrary code with kernel privileges via a crafted (a) 0x80862013, (b) 0x8086200B, (c) 0x8086200F, or (d) 0x80862007 IOCTL call.17 Scattered Spider exploited CVE-2015-2291 to deploy a malicious kernel driver in the Intel Ethernet diagnostics driver for Windows (iqvw64.sys).18\n\nAdditionally, Scattered Spider has exploited CVE-2021-35464 which is a flaw in the ForgeRock AM server. ForgeRock AM server versions before 7.0 have a Java deserialization vulnerability in the jato.pageSession parameter on multiple pages. The exploitation does not require authentication, and remote code execution can be triggered by sending a single crafted /ccversion/* request to the server. The vulnerability exists due to the usage of Sun ONE Application Framework (JATO) found in versions of Java 8 or earlier.19 Scattered Spider exploited CVE-2021-35464 to run code and elevate their privileges over the Apache Tomcat user on an AWS instance. This was achieved by requesting and assuming the permissions of an instance role using a compromised AWS token.20\n\nImpact\n\nScattered Spider is known for theft of sensitive data and leveraging trusted organizational infrastructure for follow-on attacks on downstream customers.21\n\nTrellix Product Coverage\n\nTrellix Endpoint, Network, and Email Security offers a multi-layered detection strategy for Scattered Spider activities including checks on the IOCs and behavioral analysis to ensure that any potential threat is discovered and stopped from doing harm to our customers. To stay ahead of new and evolving threats, our products continuously monitor and update their threat intelligence databases. That includes the Trellix Multi-Vector Virtual Execution Engine, a new anti-malware core engine, machine-learning behavior classification and AI correlation engines, real-time threat intelligence from the Trellix Global Threat Intelligence (GTI) and Dynamic Threat Intelligence (DTI) Cloud, and defenses across the entire attack lifecycle to keep your organization safer and more resilient.\n\nTrellix Protection\n\nMITRE ATT&CK Techniques/Sub Techniques\n\nMITRE ATT&CK ENTERPRISE\n\nMITRE ATT&CK MOBILE\n\nMitigations\n\nM1051: Update software:\n\nUpdate software regularly by employing patch management for internal enterprise endpoints and servers to mitigate exploitation risk.22\n\nM1017: User training.\n\nTrain users to be aware of access or manipulation attempts by an adversary to reduce the risk of successful spear phishing, social engineering, and other techniques that involve user interaction.23\n\nM1011: User Guidance:\n\nUsers should be instructed to use forms of multifactor authentication not subject to being intercepted by a SIM card swap, where possible. More secure methods include application-based one-time passcodes (such as Google Authenticator), hardware tokens, and biometrics. Additionally, users should be encouraged to be very careful with what applications they grant phone call-based permissions to. Further, users should not change their default call handler to applications they do not recognize.25\n\nM1049: Antivirus/Antimalware\n\nAnti-virus can be used to automatically quarantine suspicious files.26\n\nM1040: Behavior Prevention on Endpoint\n\nImplement security controls on the endpoint, such as a Host Intrusion Prevention System (HIPS), to identify and prevent execution of potentially malicious files (such as those with mismatching file signatures).27\n\nM1045: Code Signing\n\nRequire signed binaries28 and enforce binary and application integrity with digital signature verification to prevent untrusted code from executing.29\n\nM1038: Execution Prevention\n\nUse tools that restrict program execution via application control by attributes other than file name for common operating system utilities that are needed.30 Additionally, consider blocking the execution of known vulnerable drivers that adversaries may exploit to execute code in kernel mode. Validate driver block rules in audit mode to ensure stability prior to production deployment.31\n\nM1021: Restrict Web-Based Content\n\nRestrict use of certain websites, block downloads/attachments, block JavaScript, restrict browser extensions, etc.32\n\nM1022: Restrict File and Directory Permissions\n\nUse file system access controls to protect folders such as C:\\Windows\\System32.33\n\nM1042: Disable or Remove Feature or Program\n\nRemove or deny access to unnecessary and potentially vulnerable software to prevent abuse by adversaries.34\n\nM1048: Application Isolation and Sandboxing\n\nMake it difficult for adversaries to advance their operation through exploitation of undiscovered or unpatched vulnerabilities by using sandboxing. Other types of virtualizations and application micro segmentation may also mitigate the impact of some types of exploitation. Risks of additional exploits and weaknesses in these systems may still exist.35\n\nM1031: Network Intrusion Prevention\n\nUse intrusion detection signatures to block traffic at network boundaries.36\n\nM1032: Multi-factor Authentication\n\nSecurity applications that look for behavior used during exploitation can be used to mitigate some exploitation behavior. Control flow integrity checking is another way to potentially identify and stop a software exploit from occurring.37\n\nM1050: Exploit Protection\n\nUse intrusion detection signatures to block traffic at network boundaries.38\n\nM1019: Threat Intelligence Program\n\nDevelop a robust cyber threat intelligence capability to determine what types and levels of threat may use software exploits and 0-days against a particular organization.39\n\nM1026: Privileged Account Management\n\nLimit permissions so that users and user groups cannot create tokens. This setting should be defined for the local system account only. GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Create a token object.40 Also define who can create a process level token to only the local and network service through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > User Rights Assignment: Replace a process level token. Administrators should log in as a standard user but run their tools with administrator privileges using the built-in access token manipulation command runas.41\n\nM1018: User Account Management\n\nRestrict users and accounts to the least privileges they require. An adversary must already have administrator level access on the local system to make full use of this technique.42\n\n18. M1047: Audit\n\nToolkits like the PowerSploit framework contain PowerUp modules that can be used to explore systems for permission weaknesses in scheduled tasks that could be used to escalate privileges. 43\n\nM1028: Operating System Configuration\n\nConfigure settings for scheduled tasks to force tasks to run under the context of the authenticated account instead of allowing them to run as SYSTEM . The associated Registry key is located at HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\SubmitControl. The setting can be configured through GPO: Computer Configuration > [Policies] > Windows Settings > Security Settings > Local Policies > Security Options: Domain Controller: Allow server operators to schedule tasks, set to disabled.44\n\nM1035: Limit Access to Resource Over Network\n\nPrevent access to file shares, remote access to systems, unnecessary services. Mechanisms to limit access may include use of network concentrators, RDP gateways, etc.45\n\nM1030: Network Segmentation\n\nArchitect sections of the network to isolate critical systems, functions, or resources. Use physical and logical segmentation to prevent access to potentially sensitive systems and information. Use a DMZ to contain any internet-facing services that should not be exposed from the internal network. Configure separate virtual private cloud (VPC) instances to isolate critical cloud systems.46\n\nM1033: Limit Software Installation\n\nBlock users or groups from installing unapproved software.47\n\nM1016: Vulnerability Scanning\n\nVulnerability scanning is used to find potentially exploitable software vulnerabilities to remediate them.48\n\nM0810: Out-of-Band Communications Channel\n\nHave alternative methods to support communication requirements during communication failures and data integrity attacks.49\n\nM1057: Data Loss Prevention\n\nUse a data loss prevention (DLP) strategy to categorize sensitive data, identify data formats indicative of personal identifiable information (PII), and restrict exfiltration of sensitive data.50\n\nIOCs\n\nIPV4\n\nIPV6\n\nCIDR\n\nSHA256\n\nReferences"
    }
}