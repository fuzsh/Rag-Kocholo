It’s hard to tell who’s having a worse time at the moment: Guy Ritchie, whose wife, Madonna, publicly dumped him at the very same time as his latest film has opened in the U.S. like a snail in a tar pit.

Or Joel Silver, the producer of said snail-movie, “Rocknrolla,” who is struggling to avoid the Hollywood rumor mill in the wake of six – count ‘em – consecutive box office failures, not even counting this one.

“Rocknrolla” is meant to be a throwback to Richie’s “Lock, Stock and Two Smoking Barrels” roots, with tough British criminals snarling Cockney into the camera.

But Warner Brothers has put precious little effort into this latest film, slow-going the release into a half-dozen theaters first week and last weekend 22, for a grand box office take after two weeks of $400,000. Little surprise.

After last summer’s big-budget bomb, “Speed Racer,” the studio seems to have finally noticed that Silver, once a star producer of reliable blockbusters, has become a producer of reliable money-pits.

The creatively desperate “Speed Racer,” which cost at least $120 million to produce and was marketed for tens of millions more, took in a grand total of $89 million worldwide. (Including an anemic $44 million domestically). That should have been enough to get Silver called on the carpet.

But others preceded “Speed Racer”: “Fred Claus,” a funny-free comedy starring Vince Vaughn, took in $72 million domestically. “The Brave One,” starring Jodie Foster, managed to take in a grand total of $70 million worldwide.

Before these came “The Invasion,” a disastrous film that cost $80 million and took in just $15 million. Before that “The Reaping,” with a $40 million price tag, and a $25 million take at the box office. “V for Vendetta” was a mistake even Nathalie Portman couldn’t fix. Lastly, there was “Kiss Kiss Bang Bang,” which even at the modest budget of $15 million took in only $4 million.

Once upon a time, Silver knew how to pull in the audience in mega-numbers. This is the guy who helped invent the blockbuster property in the 1980s and 90s, from “Lethal Weapon” to the “Die Hard” franchise. He was in on the phenomenon, “The Matrix.” Silver knew what worked.

No longer. Last month there was an executive shake-up at Silver Pictures. Top executive Navid McIlhargey left to New Regency, and Silver Pictures President Susan Downey (Robert Jr’s wife) just plain left.

Why is Silver still left with a juicy Warner Brothers deal and license to keep making movies? Because Hollywood is a big old boy’s club, and Joel Silver is a big old member of it. Protected by his mogul friends, with whom he shares vacations and cruises and weddings in Venice, Silver continues to keep his deal at Warner Brothers – now in place through 2009 — and plaster his name on big-budget projects, including “The Book of Eli” with Denzel, and a remake of “Logan’s Run.” On his Dark Castle label he has the upcoming “The Hills Run Red,” “The Factory,” and “Whiteout.”

How long can his friends protect him? Hard to say. But I’d bet that Silver’s deal is likely to outlast Guy Ritchie’s marriage.