{
    "id": "correct_subsidiary_00020_1",
    "rank": 30,
    "data": {
        "url": "https://www.thezdi.com/blog/2020/6/16/cve-2020-1181-sharepoint-remote-code-execution-through-web-parts",
        "read_more_link": "",
        "language": "en",
        "title": "1181: SharePoint Remote Code Execution Through Web Parts",
        "top_image": "http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/5ee8dfa25a77d7165cc7fa04/1592407469417/server_rack.jpg?format=1500w",
        "meta_img": "http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/5ee8dfa25a77d7165cc7fa04/1592407469417/server_rack.jpg?format=1500w",
        "images": [
            "https://www.zerodayinitiative.com/images/logo.svg",
            "https://www.zerodayinitiative.com/images/logo.svg",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320275119-DS8WPGDYHFC5QQAV89TF/Picture1.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320307452-8IQQ6JWOEM5WWME7MJ61/Picture2.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320350877-XNYJ0IHP4HKAJGEZEGO3/Picture3.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320492838-CGGO26CPT983UDPE3GGK/Picture4.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320522307-XBBX8UC0X8BC1P3YUM1A/Picture5.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320570623-W91H1P4ZPKV1UTFTY0AN/Picture6.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320702431-Y7KQP6CN2DRXJ6YNVLI3/Picture7.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320731351-299D4QFOHQZ6R88P8UYH/Picture8.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320760993-BT3WYW64VQ04QBXT0D4V/Picture9.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320791283-N5Q9ZMUNE4XC5RKNT8JO/Picture10.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320817761-YU9X8IO4X4G7N9Z5JC2E/Picture11.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320845496-Z4M423BA0C4BV6XNQART/Picture12.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320889420-4624Q2LN2PL3UHDBXTFV/Picture13.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320927909-33WI5X2TT3C78LGKZ7H3/Picture14.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320958273-O3WQJ5HD0DP6DPJ4C1B0/Picture15.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592320995894-MDLNVAES5E0J6EP72FM1/Picture16.png",
            "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1592321031777-VT95XCLA6PPMT4VX44MB/Picture17.png",
            "https://www.zerodayinitiative.com/images/logo-footer.svg"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "The ZDI Research Team"
        ],
        "publish_date": "2020-06-16T00:00:00",
        "summary": "",
        "meta_description": "Last week, Microsoft released a patch to correct  CVE-2020-1181  – a remote code execution bug in the supported versions of Microsoft SharePoint Server. This bug was reported to the ZDI program by an anonymous researcher and as is also known as  ZDI-20-694 . This blog takes a deeper look at the root",
        "meta_lang": "en",
        "meta_favicon": "https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1487670157237-HOXHMI54TA0SZP21OY7C/favicon.ico",
        "meta_site_name": "Zero Day Initiative",
        "canonical_link": "https://www.thezdi.com/blog/2020/6/16/cve-2020-1181-sharepoint-remote-code-execution-through-web-parts",
        "text": "Last week, Microsoft released a patch to correct CVE-2020-1181 – a remote code execution bug in the supported versions of Microsoft SharePoint Server. This bug was reported to the ZDI program by an anonymous researcher and as is also known as ZDI-20-694. This blog takes a deeper look at the root cause of this vulnerability.\n\nBefore this patch being made available, SharePoint Server allowed an authenticated user to execute arbitrary .NET code on the server in the context and permissions of the service account of the SharePoint Web Application. For an attack to succeed, the attacker should have Add and Customize Pages permissions on the SharePoint site. However, the default configuration of SharePoint allows authenticated users to create sites. When they do, the user will be the owner of this site and will have all the necessary permissions.\n\nHigh-Level Description of The Vulnerability\n\nMicrosoft SharePoint Server allows users to create web pages, but to prevent abuse, it places strict limits on what components can appear on those pages. The SharePoint server treats its “own” pages and user-defined pages in different ways. SharePoint’s “own” pages are stored on the file system and are excluded from all restrictions. User pages are stored in a database and are subject to restrictions. Some of these restrictions include the inability to use code blocks or include files from the file system. They typically can use only allowed web controls from a predefined list.\n\nIf a user creates a new page via upload, it will be restricted as usual. However, if the new page is instead created by going through the SharePoint web editor, it will be considered as “ghosted” and will be treated as a trusted source. This makes sense, because the SharePoint web editor places restrictions on what components can be added to a page, so the page can be run safely in unrestricted mode.\n\nConclusion\n\nIn their patch documentation, Microsoft gave this vulnerability an Exploit Index (XI) rating of 2, which means they felt exploitation of this bug is unlikely. However, as demonstrated in our proof of concept section, the exploitation of this bug is quite straightforward for any authenticated user. Because of this, we recommend treating as an XI of 1, which indicates exploitation is likely. According to Microsoft, they addressed this bug by “correcting how Microsoft SharePoint Server handles processing of created content.” That does seem like a reasonable path to take in this instance. SharePoint continues to be an attractive target for researchers and attackers alike, and several SharePoint-related disclosures are currently in our Upcoming queue. Stay tuned to this blog for details about those bugs once they are disclosed.\n\nUntil then, follow the team for the latest in exploit techniques and security patches."
    }
}