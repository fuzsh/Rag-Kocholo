{
    "id": "wrong_mix_random_award_00146_1",
    "rank": 25,
    "data": {
        "url": "https://pan.dev/panos/docs/tutorials/redundant-internet/",
        "read_more_link": "",
        "language": "en",
        "title": "Develop with Palo Alto Networks",
        "top_image": "https://pan.dev/img/PANW_Parent_Glyph_Red.svg",
        "meta_img": "https://pan.dev/img/PANW_Parent_Glyph_Red.svg",
        "images": [
            "https://pan.dev/img/pan_dev_black.svg",
            "https://pan.dev/img/pan_dev_white.svg",
            "https://pan.dev/img/PANW_Parent_Logo_White.svg",
            "https://pan.dev/img/PANW_Parent_Logo_White.svg"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            "PAN-OS",
            "SD-WAN"
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "An example configuration which uses the PAN-OS SD-WAN feature to perform load sharing and automatic Internet failover when there is service disruption on a connection is provided.",
        "meta_lang": "en",
        "meta_favicon": "/img/PANW_Parent_Glyph_Red.svg",
        "meta_site_name": "",
        "canonical_link": "https://pan.dev/panos/docs/tutorials/redundant-internet/",
        "text": "Using PAN-OS SD-WAN for Redundant Internet\n\nAuthor: Kevin Steves - Palo Alto Networks\n\nSoftware-Defined Wide Area Network (SD-WAN) is a technology that is included in PAN-OS. One use case which is not explicitly covered in the SD-WAN Administratorâ€™s Guide is configuring SD-WAN on an Internet firewall with redundant Internet connections (e.g., dual ISPs).\n\nAn example configuration which uses the PAN-OS SD-WAN feature to perform load sharing and automatic Internet failover when there is service disruption on a connection is provided.\n\nIn the example configuration there are two Internet connections:\n\nCenturyLink DSL, 40 Mbps\n\nComcast Cable (Xfinity), 200 Mbps\n\nTwo PA-460s running PAN-OS 10.2 are deployed in an Active/Passive high availability (HA) cluster (HA is optional). The example configuration does not use Panorama, and can be deployed using the firewall Web Interface or the CLI. The set CLI configuration statements for the SD-WAN configuration are provided, in addition to the configuration paths in the firewall Web Interface.\n\nThe SD-WAN topology is a single branch using Direct Internet Access (DIA) only with no hub.\n\nNote: The example configuration has been previously deployed on a single PA-220 running PAN-OS 10.1.\n\nNote: When Panorama is used to configure SD-WAN, the SD-WAN plugin must be installed on the Panorama management server; the plugin is not used on PAN-OS firewalls.\n\nA license is required to enable the SD-WAN feature:\n\nCreate an object tag for each of the Internet links:\n\nWeb Interface: Objects->Tags\n\nCreate a SD-WAN interface profile for each Internet link. The tags created in Step 1 are used in the profiles (link-tag) and will be used to reference the profiles in other SD-WAN objects. The example uses the same profile name as the tag:\n\nThis configuration does not create VPN tunnels--it is a single branch with no hub. The path monitoring mode, probe frequency, probe idle time and fallback hold time settings apply only to VPN tunnels. Probing is performed from the physical Ethernet interfaces to the next hop gateway using ICMP echo request at a fixed frequency of 1 ping per second.\n\nWeb Interface: Network->SD-WAN Interface Profile\n\nConfigure a physical layer 3 Ethernet interface for each Internet link:\n\nAssign interface to a zone and virtual router\n\nSet an IPv4 address\n\nStatic: set next hop gateway\n\nDHCP client: disable Automatically create default route pointing to default gateway provided by server\n\nEnable SD-WAN\n\nSet SD-WAN interface profile\n\nIn the example configuration, ethernet1/1 uses a static IP address and sets the next hop gateway (sdwan-gateway) and ethernet1/2 uses DHCP client with options create-default-route no.\n\nWeb Interface: Network->Interfaces->Ethernet->Config\n\nWeb Interface: Network->Interfaces->Ethernet->IPv4\n\nWeb Interface: Network->Interfaces->Ethernet->Advanced\n\nCreate a virtual SD-WAN interface with an interface group containing the two Internet interfaces, and place them in the same zone and virtual router; the virtual interface is sdwan.1:\n\nWeb Interface: Network->Interfaces->SD-WAN\n\nCreate a default route to the sdwan.1 interface. Additionally, host routes to devices connected to the interfaces in the SD-WAN interface group may need to be created so they can be reached through a specific interface. In the example configuration there is a router and a cable modem that need to be reached for management:\n\nWeb Interface: Network->Virtual Routers\n\nNote: An error correction profile is not used in the configuration because Forward Error Correction (FEC) and Packet Duplication (PD) requires the receiver to have knowledge of FEC or PD.\n\nThere are a number of predefined path quality profiles, many with similar jitter, latency and packet loss values. A custom profile is not created and the predefined general-web path quality profile will be used.\n\nWeb Interface: Objects->SD-WAN Link Management->Path Quality Profile\n\nThe SaaS quality profile is a key component of the configuration--it is used to define path quality for physical links and the preferred path for outgoing connections.\n\nThe SaaS quality profile has 3 monitoring mode options:\n\nAdaptive - passive monitoring using session packet send and receive statistics\n\nStatic IP Address - ping IP addresses\n\nHTTP/HTTP2 - probe a URL\n\nThe adaptive monitoring mode works very well for the redundant Internet use case, and it requires no additional configuration:\n\nWeb Interface: Objects->SD-WAN Link Management->SaaS Quality Profile\n\nThe traffic distribution profile has 3 options:\n\nBest Available Path\n\nTop Down Priority\n\nWeighted Session Distribution\n\nThe two links have disparate bandwidth (40Mbps and 200Mbps) however load sharing is still desired and possible. The adaptive SaaS monitoring mode is used combined with best available path:\n\nWeb Interface: Objects->SD-WAN Link Management->Traffic Distribution Profile\n\nCreate a single outbound SD-WAN policy rule which references the link management profiles created and the predefined general-web path quality profile:\n\nWeb Interface: Policies->SD-WAN\n\nCreate a NAT rule for each of the Internet interfaces:\n\nThe enternet1/1 interface is assigned a static private IP address. The connected gateway is a DSL router that is performing source NAT with its modem public IP address and NAT at the firewall is not required, however it is used to avoid adding static routes to internal networks on the router.\n\nSource NAT is required on the ethernet1/2 interface because it has a DHCP assigned public IP address.\n\nWeb Interface: Policies->NAT\n\nDo not enable HA link or path monitoring on the SD-WAN interfaces; the SD-WAN configuration will handle link and path failures while avoiding the need for an HA failover.\n\nThere are a number of useful SD-WAN CLI commands under the show sdwan command tree that are useful for monitoring and troubleshooting:\n\nThe show sdwan rule CLI command displays the SD-WAN rules, including:\n\nTraffic distribution method\n\nTag and interface\n\nLatency, sensitivity (M is medium), jitter, packet loss from path quality profile\n\nThe ping monitoring in this case is for the fixed 1 ping per second probe performed to the next hop gateway of each Ethernet interface. Additional statistics for each interface can be displayed using the conn-idx option:\n\nThe show sdwan event CLI command displays event logs, including which interface is used for new sessions. The example configuration uses Best Available Path in the SD-WAN policy Traffic Distribution Profile, and can be used to confirm both interfaces are being used for path selection.\n\nThe sdwand.log contains various SD-WAN log events, including monitor UP and DOWN state changes.\n\nThe connection number is the idx from show sdwan path-monitor stats, and the if_idx is the if-id. It's unclear what may cause the very short duration state changes--the last two are each 200 milliseconds. These use a SaaS adaptive path monitoring profile.\n\nAdd value all to show all counters (including zero).\n\nAdd delta yes to show the difference between the last command.\n\nTwo SD-WAN debug flow targets are available:"
    }
}