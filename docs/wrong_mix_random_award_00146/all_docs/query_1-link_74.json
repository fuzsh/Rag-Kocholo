{
    "id": "wrong_mix_random_award_00146_1",
    "rank": 74,
    "data": {
        "url": "https://cwiki.apache.org/confluence/display/CLOUDSTACK/Palo%2BAlto%2BFirewall%2BIntegration",
        "read_more_link": "",
        "language": "en",
        "title": "Palo Alto Firewall Integration",
        "top_image": "https://cwiki.apache.org/confluence/s/p9b4rx/8804/1naq7q0/1/_/favicon.ico",
        "meta_img": "https://cwiki.apache.org/confluence/s/p9b4rx/8804/1naq7q0/1/_/favicon.ico",
        "images": [
            "https://cwiki.apache.org/confluence/download/attachments/29687934/CLOUDSTACK?version=1&modificationDate=1342270988000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/29687935/CLOUDSTACK2.png",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/Palo_Alto_Design_2.png?version=2&modificationDate=1366307819000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/pa_interfaces.png?version=1&modificationDate=1366988977000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/pub_prv_interfaces_pre.png?version=2&modificationDate=1368988046000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/sp.png?version=1&modificationDate=1366989009000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/add_pa.png?version=1&modificationDate=1366988937000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/enable_pa.png?version=1&modificationDate=1366988963000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/palo_alto_offering.png?version=2&modificationDate=1366303573000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/enable_pa_so.png?version=1&modificationDate=1366988955000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/add_pa_network.png?version=1&modificationDate=1366988921000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/create_instance.png?version=1&modificationDate=1366988946000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/running_instance.png?version=2&modificationDate=1368988346000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/ip_allocation.png?version=3&modificationDate=1368996359000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/src_nat_rule.png?version=2&modificationDate=1368996364000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/firewall_egress_cs.png?version=1&modificationDate=1368996875000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/firewall_egress_pa.png?version=1&modificationDate=1368996879000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/firewall_ingress_cs.png?version=1&modificationDate=1368996882000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/firewall_ingress_pa.png?version=1&modificationDate=1368996887000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/view_ip_addresses.png?version=1&modificationDate=1371042195000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/acquire_new_ip.png?version=1&modificationDate=1371042245000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/pf_ip.png?version=1&modificationDate=1371042292000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/configure_pf.png?version=1&modificationDate=1371042330000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/add_pf.png?version=1&modificationDate=1371042346000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/add_vm_to_pf.png?version=1&modificationDate=1371042366000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/pf_rule.png?version=1&modificationDate=1371042395000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/pa_pf_rule.png?version=1&modificationDate=1371042442000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/view_ip_addresses.png?version=1&modificationDate=1371042195000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/acquire_new_ip.png?version=1&modificationDate=1371042245000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/stc_nat_ip.png?version=1&modificationDate=1371042500000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/enable_stc_nat.png?version=1&modificationDate=1371042524000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/stc_nat_vm.png?version=1&modificationDate=1371042760000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/stc_nat_rule.png?version=1&modificationDate=1371042673000&api=v2",
            "https://cwiki.apache.org/confluence/download/attachments/30753712/pa_stc_nat_rule.png?version=1&modificationDate=1371042709000&api=v2"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "Will Stevens"
        ],
        "publish_date": null,
        "summary": "",
        "meta_description": "",
        "meta_lang": "en",
        "meta_favicon": "/confluence/s/p9b4rx/8804/1naq7q0/1/_/favicon.ico",
        "meta_site_name": "",
        "canonical_link": "https://cwiki.apache.org/confluence/display/CLOUDSTACK/Palo+Alto+Firewall+Integration",
        "text": "Bug Reference\n\nCLOUDSTACK-1275\n\nBranch\n\nThe code has been merged into ACS master, so we will be working from that now...\n\ngithub.com/cloudops/cs_palo_alto\n\n=> 'palo_alto' branch is a work in progress and is the current status of the integration\n\n=> 'master' branch is a point in time of the cloudstack master branch which the 'palo_alto' branch is working from (i pull in changes periodically)\n\nInstall instructions below...\n\nCurrent state of the integration:\n\nWORKING!!!\n\nList/Add/Delete Palo Alto service provider\n\nList/Add/Delete Palo Alto network service offering\n\nList/Add/Delete Palo Alto network with above service offering\n\nAdd instance to the new network (creates the public IP and private gateway/cidr on the PA as well as the source nat rule)\n\nList/Add/Delete Ingress Firewall rule\n\nList/Add/Delete Egress Firewall rule\n\nList/Add/Delete Port Forwarding rule\n\nList/Add/Delete Static Nat rule\n\nBasic Unit Tests\n\nIN PROGRESS!!!\n\nAdd Usage tracking\n\nIntroduction\n\nThe goal of this project is to enable basic integration of Palo Alto’s firewall products into the Apache CloudStack 4.x platform.\n\nBy leveraging CloudStack extension points, this project will allow configuring a Palo Alto firewall as a service provider to override services typically offered by CloudStack’s virtual routers, such as Firewall, NAT & Port forwarding.\n\nProper orchestration will be developed so that calling the CloudStack APIs for these services will be transparently routed to the corresponding services on the Palo Alto firewall.\n\nPurpose\n\nThis document is intended to keep the community abreast with the functionality being added with the integration of Palo Alto firewalls as a service provider.\n\nReferences\n\nPalo Alto API docs are included at the end of this document.\n\nFeature Specifications\n\nIn-Scope\n\nSupport of CloudStack advanced network topology.\n\nSupport of multiple Palo Alto firewall.\n\nSupport of parallel deployment with hardware load-balancer (e.g.: Netscaler).\n\nConfiguration of connectivity with Palo Alto firewall through CloudStack UI and persistence of this information.\n\nAllow selection of Palo Alto firewall when defining CloudStack network service offering for:\n\nFirewall (Ingress & Egress)\n\nSource NAT\n\nStatic NAT\n\nPort forwarding\n\nSupport of virtual Palo Alto firewall.\n\nCommunication layer with Palo Alto APIs.\n\nMapping of CloudStack APIs to corresponding Palo Alto APIs.\n\nProper display of Palo Alto connectivity status in CloudStack UI.\n\nSupport of virtual Palo Alto firewall.\n\nFunctional/Integration testing on PA-3020 platform (version 5.0.0)\n\nFull documentation of the solution (architecture, design, APIs)\n\nOut-of-scope\n\nSupport of inline deployment with hardware load-balancer (e.g.: Netscaler).\n\nFirewalling between VLANs within an advanced network.\n\nFirewalling between VM instances.\n\nExposing any Palo Alto features having no equivalent UI/API in CloudStack.\n\nArchitecture and Design description\n\nHere is a basic diagram showing some of the technical detail for the Palo Alto (PA) firewall will handle the CloudStack (CS) networks:\n\nAE1 is an Aggregated Interface (or Ethernet interface) which links out to the Public Internet from the PA. If you are using multiple public IP ranges in CS, you will need this to be trunked.\n\nAE1 will have one subinterface per public IP range in CS which will be named according to: untagged = ae1.9999 | public vlan tags of x and y = ae1.x and ae1.y\n\nEach subinterface on AE1 will include a non-/32 IP which will need to be preconfigured and will define the subnet to route that public range's traffic upstream to the next hop\n\nAE2 is an Aggregated Interface (or Ethernet interface) which connects the PA device over a trunked connection to CS and the Hypervisor (eg: Xen)\n\nEach CS network will have a dedicated L3 subinterface on the PA through the AE2 aggregate interface (eg: AE2.3301, AE2.3302 and AE2.3303)\n\nEach subinterface on AE2 (eg: AE2.3301) will act as the default gateway for its corresponding CS network\n\nEach CS network will have SourceNAT rules between an IP on the public subinterface on AE1 and its corresponding AE2 subinterface (eg: AE2.3301)\n\nEach CS network will have a unique and CS valid VLAN ID (color coordinated in diagram)\n\nEach CS network will have a non-overlapping CIDR (subnet) and the default gateway subinterface on the PA will be the first ip in this range\n\nThe public interface AE1 will be in the Untrusted Zone\n\nThe private interface AE2 will be in the Trusted Zone\n\nCS will manage Firewall rules between the untrusted zone and the trusted zone through cidrs (subnets)\n\nCS will manage StaticNAT rules between a Public IP on the public subinterface and with the IP of a VM in CS\n\nCS will manage Port Forwarding rules between a Public CIDR and the IP of a specific VM on specified ports\n\nThere will be one Virtual Router on PA which will handle all of the routing\n\nEach CS network will have an associated VR in CS which will handle services not yet handled by the PA (eg: DNS, DHCP, ...)\n\nInstall Instructions\n\nCompile the code with the 'nonoss' flag.\n\nPre-configuration Requirements\n\nFor each public IP range configured in CS, you will need to create a subinterface in AE1 with an IP which is outside the range configured in CS but within the CIDR which includes the whole range. The IP can be any IP that is not in the public IP range, but is included in the public CIDR.\n\nThe subinterface on AE1 needs to be named using the public VLAN tag configured in CS. Untagged will be named using 9999, aka - AE1.9999. If you are using an untagged interface, you need to allow 'untagged subinterface' in the advanced tab of the parent interface. Palo Alto does not support both untagged and tagged interfaces on the same interface, so keep that in mind when defining your public ranges in CloudStack.\n\nYou need one Static Route created on the PA Virtual Router which will route destination 0.0.0.0/0 to the gateway of the next hop.\n\nExamples (more in UI flow below):\n\n1 IP Range in CS:\n\nGateway:172.30.0.1, Netmask:255.255.255.0, IP Range:172.30.0.100-172.30.0.199, VLAN:untagged\n\n=> You would configure an IP on AE1.9999 with something like: 172.30.0.254/24\n\n2 IP Ranges in CS:\n\nGateway:172.30.0.1, Netmask:255.255.255.0, IP Range:172.30.0.100-172.30.0.199, VLAN:3030\n\nGateway:172.30.1.1, Netmask:255.255.255.0, IP Range:172.30.1.100-172.30.1.199, VLAN:3031\n\n=> You would configure an IP on AE1.3030 with something like: 172.30.0.2/24\n\n=> You would configure an IP on AE1.3031 with something like: 172.30.1.2/24\n\nUI flow\n\nPre-configure the Palo Alto firewall\n\nInitial setup of the Palo Alto interfaces (in this case Aggregate Ethernet)\n\nInitial Public and Private interface config on Palo Alto (does not have to be Aggregate Ethernet)\n\nInitial configuration of CloudStack\n\nConfigure service providers\n\nAdd Palo Alto as a service provider\n\nEnable the Palo Alto service provider\n\nAdd a new Palo Alto network service offering\n\nEnable Palo Alto network service offering\n\nSetup and use a Palo Alto network\n\nAdd a new network using the Palo Alto network service offering\n\nLaunch a VM on the newly created network\n\nThe network details for the newly created VM\n\nResults on the Palo Alto: Sub-interfaces have been created for the Public IP and the Private Gateway\n\nA Source NAT rule has been created to link the sub-interfaces\n\nEgress Firewall Rules\n\nCloudStack config\n\nResulting Security Policy on the Palo Alto\n\nIngress Firewall Rules\n\nCloudStack config (for a specific IP)\n\nResulting Security Policy on the Palo Alto\n\nPort Forwarding Rules (Destination NAT)\n\nView IP addresses for your network.\n\nAcquire an IP\n\nConfigure a Port Forwarding rule for this new IP\n\nResulting Port Forwarding rule on the Palo Alto\n\nStatic NAT Rules\n\nView IP addresses for your network\n\nAcquire an IP\n\nEnable Static NAT\n\nAssociate the Static NAT rule with a VM\n\nResulting Static NAT rule on the Palo Alto\n\nWeb Services APIs\n\nCloudStack API commands\n\nIP Clearance\n\nI do not intend to use any code outside of CloudStack. I will be using the Palo Alto APIs which is documented in:\n\nXML-API-5-1.0-RevA.pdf\n\nXML_API_Training.pdf\n\nUnit Tests\n\nHere is the result of the tests without additional detail: palo_alto_tests_without_logging.txt\n\nHere is the result of the tests with additional detail: palo_alto_tests_with_logging.txt\n\nThere is a flag in the unit tests that can be used to turn the detail on and off.\n\nBecause this plugin requires communication with a 3rd party API, the detailed view of the tests will show a play-by-play of the API commands being run and their results.\n\nPresentations"
    }
}