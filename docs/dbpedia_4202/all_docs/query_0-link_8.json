{
    "id": "dbpedia_4202_0",
    "rank": 8,
    "data": {
        "url": "https://arxiv.org/html/2401.00003v2",
        "read_more_link": "",
        "language": "en",
        "title": "Generative Inverse Design of Metamaterials with Functional Responses by Interpretable Learning",
        "top_image": "",
        "meta_img": "",
        "images": [
            "https://arxiv.org/html/x1.png",
            "https://arxiv.org/html/x2.png",
            "https://arxiv.org/html/x3.png",
            "https://arxiv.org/html/x4.png",
            "https://arxiv.org/html/x5.png",
            "https://arxiv.org/html/x6.png",
            "https://arxiv.org/html/x7.png",
            "https://arxiv.org/html/x8.png",
            "https://arxiv.org/html/x9.png",
            "https://arxiv.org/html/x10.png",
            "https://arxiv.org/html/x11.png",
            "https://arxiv.org/html/x12.png",
            "https://arxiv.org/html/x13.png",
            "https://arxiv.org/html/x14.png",
            "https://arxiv.org/html/x15.png",
            "https://arxiv.org/html/x16.png",
            "https://arxiv.org/html/x17.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "",
        "meta_lang": "en",
        "meta_favicon": "",
        "meta_site_name": "",
        "canonical_link": null,
        "text": "Wei (Wayne) Chen\n\nJ. Mike Walker ’66 Department of Mechanical Engineering\n\nTexas A&M University\n\nCollege Station, TX 77843\n\nw.chen@tamu.edu\n\n&Rachel Sun\n\nDepartment of Mechanical Engineering\n\nMassachusetts Institute of Technology\n\nCambridge, MA 02139\n\nrmsun@mit.edu\n\n&Doksoo Lee\n\nDepartment of Mechanical Engineering\n\nNorthwestern University\n\nEvanston, IL 60208\n\ndslee@northwestern.edu\n\n&Carlos M. Portela\n\nDepartment of Mechanical Engineering\n\nMassachusetts Institute of Technology\n\nCambridge, MA 02139\n\ncportela@mit.edu\n\n&Wei Chen\n\nDepartment of Mechanical Engineering\n\nNorthwestern University\n\nEvanston, IL 60208\n\nweichen@northwestern.edu\n\nAbstract\n\nMetamaterials with functional responses, such as wave-based responses or deformation-induced property variation under external stimuli, can exhibit varying properties or functionalities under different conditions. Herein, we aim at rapid inverse design of these metamaterials to meet target qualitative functional behaviors. This inverse problem is challenging due to its intractability and the existence of non-unique solutions. Past works mainly focus on deep-learning-based methods that are data-demanding, require time-consuming training and hyperparameter tuning, and are non-interpretable. To overcome these limitations, we propose the Random-forest-based Interpretable Generative Inverse Design (RIGID), an iteration-free, single-shot inverse design method to achieve the fast generation of metamaterial designs with on-demand functional behaviors. Unlike most existing methods, by exploiting the interpretability of the random forest, we eliminate the need to train an inverse model mapping responses to designs. Based on the likelihood of target satisfaction derived from the trained forward model, one can sample design solutions using Markov chain Monte Carlo methods. The RIGID method therefore functions as a generative model that captures the conditional distribution of satisfying solutions given a design target. We demonstrate the effectiveness and efficiency of RIGID on both acoustic and optical metamaterial design problems where only small datasets (less than 250 training samples) are available. Synthetic design problems are created to further illustrate and validate the mechanism of likelihood estimation in RIGID. This work offers a new perspective on solving on-demand inverse design problems, showcasing the potential for incorporating interpretable machine learning into generative design and eliminating its large data requirement.\n\n1 Introduction\n\nMetamaterials with functional responses are engineered materials that exhibit varying properties or behaviors under different conditions. One example is metamaterials whose electromagnetic, acoustic, or elastic wave propagation behaviors change with wavelengths or frequencies [1]. Another example is metamaterials that exhibit changing properties or functionalities due to deformation in response to external stimuli like temperature [2] and magnetic fields [3]. Tailoring functional responses of these metamaterials is of interest to applications such as sound and vibration control, analog computing, medical imaging, sensing, communication, and soft robotics. In many use cases, rather than precisely controlling the complete functional responses, we only care about qualitative behaviors under certain conditions. For example, acoustic metamaterials were usually designed to have bandgaps at specified frequencies to achieve functionalities like wave-guiding [4, 5], focusing [6, 7], and vibration mitigation [8, 9, 10]. However, it is unnecessary and computationally expensive to design for the whole dispersion relation [11, 12, 13, 14, 15]. Similarly, we may design optical metamaterials to qualitatively manipulate optical properties (e.g., high or low absorption/reflection/transmission) under certain wavelengths, without requiring the entire spectral response to match an exact target [16, 17].\n\nIdentifying metamaterial designs from a given target forms an inverse design problem. Unlike many forward problems where one can obtain solutions (e.g., spectral responses or material properties under external stimuli) by modeling the physics or conducting experiments, inverse design problems are usually intractable. Traditionally, these problems are solved by iterative optimization (i.e., minimizing the difference between the actual quantity of interest and the target) [11, 12, 18, 14, 19]. This, however, requires repeatedly updating the design solution and solving forward problems. When the design target changes, one needs to rerun the entire optimization process. Thus, inverse design by iterative optimization becomes impractical if solving the forward problem (by simulations or experiments) is time-consuming or if the design target needs to change frequently. For example, in the case of acoustic metamaterial design, one may want to obtain a material waveguide containing spatially-varying unit cells with different bandgap ranges at different locations in a tessellation. To accelerate the optimization approach, prior works replaced simulations or experiments with machine learning models [20, 21]. However, the efficiency and quality of final solutions are highly dependent on both the machine learning model and the optimization algorithm. On the other hand, a single run of optimization usually only returns one final solution, although multiple designs might satisfy a given target (i.e., the non-uniqueness of solutions). For example, multiple acoustic metamaterial designs may have bandgaps within the same target frequency range. This non-uniqueness nature of inverse design problems was also shown for optical metasurfaces [22, 23, 24, 19], especially when we only care about qualitative target responses. Optimization approaches cannot explore diverse alternative solutions efficiently.\n\nIn this work, we aim to achieve iteration-free, single-shot inverse design for metamaterials — given a qualitative target response, we want to generate multiple satisfying design solutions rapidly, without the need for iteratively evaluating designs (i.e., running simulations or conducting experiments); and after one-time initial training, no additional training or design evaluation is required to generate designs for different targets. This allows fast and comprehensive exploration of the feasible design space under different target responses.\n\nPrior research attempted to realize iteration-free, single-shot inverse design using machine learning. There are three mainstream methods. The most straightforward approach is to learn a direct inverse mapping from the response to design variables. Neural networks are the most commonly used machine learning model for this purpose, due to their high flexibility in approximating arbitrary nonlinear input-output relationships [25, 13]. Despite the simplicity of the direct inverse mapping, its underlying assumption of the response-design mapping being one-to-one does not hold in many cases due to the non-uniqueness of solutions, as mentioned earlier. Such non-uniqueness will cause conflicting training instances where the same input (response) is associated with distinct outputs (designs), which will destabilize the convergence during neural network training [22, 26]. To avoid this issue, past work proposed the Tandem Neural Network (T-NN) that cascades an inverse-design network with a pretrained forward-modeling network to avoid using designs as labels when training the inverse-design network and hence solved the training convergence issue [22, 27, 28, 29, 30, 31, 32]. Nonetheless, the original T-NNs still learn a one-to-one response-design mapping and cannot account for the non-uniqueness of design solutions. To fundamentally solve this problem, one needs to learn a one-to-many mapping. For example, Bastek et al. [30] integrated stochastic sampling into the inverse-design network to allow the generation of multiple feasible solutions. Ha et al. [33] used multiple T-NNs to predict multiple design solutions given a target response. Wang et al. [34] adapted the T-NN to mimic the structure of a variational autoencoder that is capable of learning the conditional distributions of designs given target responses. A large body of recent works achieved the goal of learning one-to-many mapping by using conditional generative models, typically conditional generative adversarial networks (cGANs) [35, 36, 37, 38, 24], conditional variational autoencoders (cVAEs) [23, 39, 40], and conditional diffusion models [41, 42, 43]. These models can generate multiple designs given a target response by learning the distribution of designs conditioned on the response. We include more detailed explanations of these three mainstream methods in SI Appendix, Sec. A and Fig. S1.\n\nWe refer interested readers to Ref. [26, 44, 45, 46, 47, 48, 49] for comprehensive reviews of existing metamaterial design methods. To the best of our knowledge, almost all the existing iteration-free, single-shot metamaterial inverse design methods are based on deep learning, which has many common issues such as high data demand, exhaustive hyperparameter tuning, slow training, and low interpretability, especially compared to traditional machine learning models like decision trees and random forests. On the other hand, Elzouka et al. [50] proposed to use the decision tree as a more interpretable model to solve both the forward prediction and inverse design problem. After training a decision tree for forward prediction, one can identify explicit design rules (i.e., feasible regions in the design space) by tracing from target leaf nodes to the root node. This approach also captures the one-to-many mapping nature of inverse design problems since it gives feasible design variable ranges rather than a single solution. However, there remain some limitations. Firstly, for solutions identified by the design rules, the method does not differentiate their likelihood of target satisfaction. Yet in reality, solutions always have different likelihoods due to the uncertainty of model estimation. Secondly, the method has to train two models: a random forest was trained first to ensure model accuracy and robustness, and then a large decision tree was trained to emulate the performance of the random forest and provide design rules. This is due to the challenge of deriving explicit design rules from an ensemble model like the random forest. Finally, the method was demonstrated on a problem with more than 104superscript10410^{4}10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT training data, while the effectiveness on smaller datasets (i.e., data with orders of magnitude smaller sample sizes) was not studied.\n\nThis work aims to address the aforementioned problems by proposing a method called Random-forest-based Interpretable Generative Inverse Design (RIGID). Figure 1 shows an overview of this method. Specifically, we first train a forward prediction random forest. Then given a design target, we can probe the trained random forest to infer the likelihood of any design satisfying the target. To generate new designs tailored to the target, we can sample from the design space according to the likelihood. Compared to the most widely studied neural-network-based methods, RIGID has a much lower cost in training and hyperparameter tuning, and works more robustly on small-size datasets (as random forests are less prone to overfitting). Similar to deep generative models, it can generate a desired number of solutions, allowing one to explore alternative solutions that might have desired properties or functionalities beyond the ones considered as the target. The explicit likelihood estimation also offers an interpretable characterization of a design’s target satisfaction probability and allows an exploitation-exploration trade-off when selecting generated designs. We validate the RIGID method on two metamaterial design examples — an acoustic metamaterial design example, where the target is to generate metamaterials with specific bandgaps, and an optical metasurface design example, where the target is to generate metasurfaces with high absorbance at specified wavelengths.\n\nOur contributions are three-fold. First, we propose an iteration-free, single-shot inverse design method that is fast, generative, interpretable, and small-data-compatible. Secondly, we demonstrate the effectiveness of the proposed method on acoustic and optical metamaterial design examples, and propose both qualitative and quantitative ways of assessing our method. Finally, we create two synthetic test cases for fast examination and validation of model performance. These test cases can be used for future benchmarking studies of related methods.\n\n2 Methods\n\nThe functional response of metamaterials can be modeled as y=f⁢(𝐱,s)𝑦𝑓𝐱𝑠y=f(\\mathbf{x},s)italic_y = italic_f ( bold_x , italic_s ), where 𝐱𝐱\\mathbf{x}bold_x denotes metamaterial design variables (e.g., materials and geometry parameters), s𝑠sitalic_s is an auxiliary variable representing the independent variable (or the “x𝑥xitalic_x-axis”) of the response (e.g., the frequency/wavelength or the external stimuli such as temperature), and y𝑦yitalic_y indicates the value of the response associated with our design target. In this paper, we assume y∈{0,1}𝑦01y\\in\\{0,1\\}italic_y ∈ { 0 , 1 } since we only focus on qualitative behaviors at specified frequencies (e.g., for an acoustic metamaterial or an optical metamaterial design, whether a bandgap exists or whether the energy absorbance is higher than a threshold within a range of frequencies). We leave the more challenging problem of tailoring quantitative behaviors as future work.\n\nOur goal is to solve the inverse problem — find a set of design solutions that satisfy f⁢(𝐱,s)=1𝑓𝐱𝑠1f(\\mathbf{x},s)=1italic_f ( bold_x , italic_s ) = 1 when s𝑠sitalic_s is inside a target domain ΩΩ\\Omegaroman_Ω, i.e., {𝐱∗|f⁢(𝐱∗,s)=1,∀s∈Ω}conditional-setsuperscript𝐱formulae-sequence𝑓superscript𝐱𝑠1for-all𝑠Ω\\{\\mathbf{x}^{*}|f(\\mathbf{x}^{*},s)=1,\\forall s\\in\\Omega\\}{ bold_x start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT | italic_f ( bold_x start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , italic_s ) = 1 , ∀ italic_s ∈ roman_Ω }. Here f⁢(𝐱,s)=1𝑓𝐱𝑠1f(\\mathbf{x},s)=1italic_f ( bold_x , italic_s ) = 1 could mean, for instance, the existence of bandgaps for acoustic metamaterials or high absorption for optical metamaterials. The domain ΩΩ\\Omegaroman_Ω can be any frequency or wavelength interval(s). Note that this design target only requires the satisfaction of behaviors within the specified domain ΩΩ\\Omegaroman_Ω, while behaviors outside this domain are out of concern in this study, although it is straightforward to adopt our method to this problem setting.\n\nWe use a random forest to approximate the function f𝑓fitalic_f. A random forest is an ensemble learning method that combines the predictions of multiple decision trees to improve accuracy and reduce overfitting [51]. The trained random forest serves as a forward prediction model that predicts the outcome y𝑦yitalic_y given design variables 𝐱𝐱\\mathbf{x}bold_x and the auxiliary variable s𝑠sitalic_s. Compared to the widely used neural networks, the random forest as a forward prediction model (1) offers significantly faster training, (2) has fewer hyperparameters to tune, (3) is less susceptible to overfitting on small data, and (4) has higher interpretability (i.e., the decision-making of each tree in the random forest is transparent). More importantly, this interpretability also allows us to realize inverse design without training a separate inverse model.\n\nFigure 2 shows how, by probing the trained random forest, one can estimate a likelihood distribution for target satisfaction of solutions over the entire design space and sample (generate) new designs based on this likelihood distribution. Since we target qualitative (binary) behaviors at specified s𝑠sitalic_s (e.g., a bandgap in 3-4 MHz frequency or high absorption at a wavelength of 400-500 nm), we first identify the leaf nodes (on each decision tree in the random forest) that are relevant to the s𝑠sitalic_s in the target (Fig. 2, Step 1). We do this by tracing down each tree, checking only the nodes that use s𝑠sitalic_s as the splitting feature, and pruning the branches that are irrelevant to the s𝑠sitalic_s in the target. For example, as shown in Fig. 2, there are two tree nodes using s𝑠sitalic_s as the splitting feature, with splitting criteria at s≤5𝑠5s\\leq 5italic_s ≤ 5 and s≤7𝑠7s\\leq 7italic_s ≤ 7. Given the target frequency range of 3≤s≤43𝑠43\\leq s\\leq 43 ≤ italic_s ≤ 4, we can remove the right branches of both nodes as these branches are only relevant to s>5𝑠5s>5italic_s > 5 and s>7𝑠7s>7italic_s > 7, respectively, which conflicts with the target range of 3≤s≤43𝑠43\\leq s\\leq 43 ≤ italic_s ≤ 4. After pruning these branches, we end up with a set of leaves relevant to the target (highlighted in Fig. 2, Step 1). When we have a combined target (e.g., bandgaps in both 3-4 MHz and 6-7 MHz, as shown in Fig. 2), we need to get the intersection of all the sets of relevant leaves and use that as the final set of relevant leaves (highlighted in Fig. 2, Step 2). Note that a combined target includes cases where there are multiple nonadjacent target ranges (e.g., 3-4 MHz and 6-7 MHz) or when a target range is split by a tree node (e.g., a target range of 4-6 MHz can be split by the node “s≤5𝑠5s\\leq 5italic_s ≤ 5”, thus we need to consider it as the combination of two target ranges — 4-5 MHz and 5-6 MHz). A more detailed discussion of this step is in SI Appendix, Sec. B.\n\nThe next step is to trace up the tree from the N𝑁Nitalic_N relevant leaves, obtained by Step 2, to the root node (Fig. 2, Step 3). This will result in N𝑁Nitalic_N decision paths, along which are nodes indicating splitting criteria for design variables 𝐱𝐱\\mathbf{x}bold_x. Thus, each decision path represents a set of design variable ranges, or in other words, a region in the design space. We assign each region a score equal to the predicted probability at each corresponding leaf. This probability is learned from the training data and equals the proportion of positive data in a leaf. It indicates the tree’s belief in the probability of a design 𝐱𝐱\\mathbf{x}bold_x satisfying the target 𝒯={f⁢(𝐱∗,s)=1|∀s∈Ω}𝒯conditional-set𝑓superscript𝐱𝑠1for-all𝑠Ω\\mathcal{T}=\\{f(\\mathbf{x}^{*},s)=1|\\forall s\\in\\Omega\\}caligraphic_T = { italic_f ( bold_x start_POSTSUPERSCRIPT ∗ end_POSTSUPERSCRIPT , italic_s ) = 1 | ∀ italic_s ∈ roman_Ω } (Ω=[3,4]∪[6,7]Ω3467\\Omega=[3,4]\\cup[6,7]roman_Ω = [ 3 , 4 ] ∪ [ 6 , 7 ] in this example) if the design falls in the design space region corresponding to the leaf. Therefore, with a single decision tree i𝑖iitalic_i, we already have the map of likelihood ℒm⁢(𝐱|𝒯)=ℙm⁢(𝒯|𝐱)subscriptℒ𝑚conditional𝐱𝒯subscriptℙ𝑚conditional𝒯𝐱\\mathcal{L}_{m}(\\mathbf{x}|\\mathcal{T})=\\mathbb{P}_{m}(\\mathcal{T}|\\mathbf{x})caligraphic_L start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ( bold_x | caligraphic_T ) = blackboard_P start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ( caligraphic_T | bold_x ) for target satisfaction: each of the N𝑁Nitalic_N regions has a uniformly distributed likelihood equal to the predicted probability at the corresponding leaf, and the rest of the design space has a likelihood of 0 (Fig. 2, Step 3).\n\nSince a single decision tree usually lacks accuracy, robustness, and a way to quantify estimation uncertainty, we still want to take advantage of the random forest as an ensemble model for inverse design. We use Steps 1-3 to derive the likelihood distribution for each of the M𝑀Mitalic_M trees in the random forest, and simply use the average of these M𝑀Mitalic_M likelihood distributions as the final likelihood for target satisfaction, ℒ⁢(𝐱|𝒯)=∑mMℒm⁢(𝐱|𝒯)/Mℒconditional𝐱𝒯superscriptsubscript𝑚𝑀subscriptℒ𝑚conditional𝐱𝒯𝑀\\mathcal{L}(\\mathbf{x}|\\mathcal{T})=\\sum_{m}^{M}\\mathcal{L}_{m}(\\mathbf{x}|% \\mathcal{T})/Mcaligraphic_L ( bold_x | caligraphic_T ) = ∑ start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT start_POSTSUPERSCRIPT italic_M end_POSTSUPERSCRIPT caligraphic_L start_POSTSUBSCRIPT italic_m end_POSTSUBSCRIPT ( bold_x | caligraphic_T ) / italic_M, which is a more complex and smooth function (Fig. 2, Step 4). If more trees believe a design 𝐱𝐱\\mathbf{x}bold_x has a higher likelihood of satisfying the target, then the design will have a higher likelihood ℒ⁢(𝐱|𝒯)ℒconditional𝐱𝒯\\mathcal{L}(\\mathbf{x}|\\mathcal{T})caligraphic_L ( bold_x | caligraphic_T ). Finally, to generate new designs, we can sample from ℒ⁢(𝐱|𝒯)ℒconditional𝐱𝒯\\mathcal{L}(\\mathbf{x}|\\mathcal{T})caligraphic_L ( bold_x | caligraphic_T ) using Markov chain Monte Carlo (MCMC) methods such as Metropolis-Hastings [52] (Fig. 2, Step 5).\n\nCompared to prior works, RIGID provides the following unique benefits:\n\n1.\n\nIt is effective on small data problems as the random forest is less susceptible to overfitting.\n\n2.\n\nThe training is fast (in seconds of wall time) and does not require computationally-demanding hyperparameter tuning. Once the training is done, no further training or iterative optimization is required to generate designs for different targets.\n\n3.\n\nThe method estimates the explicit likelihood of target satisfaction for every possible solution in the design space. Given a design target of specific functional behavior, we can generate an unlimited number of solutions based on the likelihood, allowing us to explore alternative solutions that might have desired properties or functionalities beyond the ones considered as the target.\n\n4.\n\nThe method offers a high level of transparency as one can easily probe the trained model to understand its reasoning behind any decision-making (i.e., why a design has a high/low likelihood).\n\n5.\n\nWhen generating design solutions, one can use a single parameter — the sampling threshold — to easily tune the trade-off between exploitation (i.e., generated designs have higher chances of satisfying the target) and exploration (i.e., generated designs cover a broader area of the design space), as we will demonstrate in Results.\n\n3 Results\n\nWe demonstrate our RIGID method on an acoustic metamaterial design problem, an optical metasurface design problem, and two synthetic design problems. Based on a recent review article by Lee et al. [26] and other related works (e.g., [30]), existing iteration-free, single-shot inverse design methods were demonstrated on training data size ranging from 103superscript10310^{3}10 start_POSTSUPERSCRIPT 3 end_POSTSUPERSCRIPT to 106superscript10610^{6}10 start_POSTSUPERSCRIPT 6 end_POSTSUPERSCRIPT in scale. Here we show that our method can work with much smaller-scale datasets (less than 250 training samples).\n\nFor all the test problems, we used the same random forest hyperparameter settings and did not perform hyperparameter tuning. Specifically, each random forest contains 1,000 trees with a minimum of 2 samples required to split an internal node and a minimum of 1 sample required to be at a leaf node. Gini impurity [53] was used as the splitting criterion at tree nodes. The train-test split ratio was 4:1. Since the positive/negative training data can be highly imbalanced (e.g., the frequency ranges with bandgaps are much narrower than those without), we used the Synthetic Minority Over-sampling TEchnique (SMOTE) [54] to over-sample the positive class. For all the case studies, the random forest training took less than 10 seconds on an Intel Core i5-9300H CPU 2.4GHz and 8GB memory.\n\nAfter training, we generate new designs by sampling from the resulting likelihood distribution using Metropolis-Hastings. In practice, Metropolis-Hastings can generate identical samples, which provides no benefits for design purposes. Thus in this work, we reject the designs identical to previous ones during sampling.\n\n3.1 Applying RIGID to Design Acoustic Metamaterials with Target Bandgaps\n\nHere we consider acoustic metamaterials that can control elastic wave propagation at ultrasound (MHz) frequencies. Varying the microscale geometries of acoustic metamaterials changes the dynamic properties of a material, such as bandgaps [10] (i.e., forbidden frequency ranges of a material) and wave propagation direction [4]. These materials promise applications in waveguides [4, 5], lenses [6, 7], and vibration mitigation [9]. Designing acoustic metamaterials with target bandgaps is challenging, as many three-dimensional architectures do not naturally have full bandgaps. We present the braced cubic design framework (Fig. 3A-B) as a method to tune the size and location of bandgaps (Fig. 3C). In particular, spherical micro-inertia are added to the center and corner of a braced cubic unit cell with strut radius rstrutsubscript𝑟strutr_{\\text{strut}}italic_r start_POSTSUBSCRIPT strut end_POSTSUBSCRIPT. Micro-inertia placed at the center of the brace has radius rcentersubscript𝑟centerr_{\\text{center}}italic_r start_POSTSUBSCRIPT center end_POSTSUBSCRIPT while micro-inertia placed at the corner of the cubic unit cell has radius rcornersubscript𝑟cornerr_{\\text{corner}}italic_r start_POSTSUBSCRIPT corner end_POSTSUBSCRIPT.\n\nWe randomly created 284 sets of geometric parameters 𝐱=(rstrut,rcenter,rcorner)𝐱subscript𝑟strutsubscript𝑟centersubscript𝑟corner\\mathbf{x}=(r_{\\text{strut}},r_{\\text{center}},r_{\\text{corner}})bold_x = ( italic_r start_POSTSUBSCRIPT strut end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT center end_POSTSUBSCRIPT , italic_r start_POSTSUBSCRIPT corner end_POSTSUBSCRIPT ) with 4 ≤rstrut≤absentsubscript𝑟strutabsent\\leq r_{\\text{strut}}\\leq≤ italic_r start_POSTSUBSCRIPT strut end_POSTSUBSCRIPT ≤ 6.41, 0 ≤rcenter≤absentsubscript𝑟centerabsent\\leq r_{\\text{center}}\\leq≤ italic_r start_POSTSUBSCRIPT center end_POSTSUBSCRIPT ≤ 20, and 0 ≤rcorner≤absentsubscript𝑟cornerabsent\\leq r_{\\text{corner}}\\leq≤ italic_r start_POSTSUBSCRIPT corner end_POSTSUBSCRIPT ≤ 20 (unit: µm). The unit cell size was set at a=60𝑎60a=60italic_a = 60 µm. For each of these designs, we performed Bloch-wave analysis to compute its acoustic dispersion relation. Bandgap location and width were extracted for each design based on its dispersion relation.\n\nOut of the 284 sets of design variables and bandgap data, we used 227 samples as training data. We first discretized the entire frequency range into 100 intervals, and trained a random forest to predict bandgap existence y∈{0,1}𝑦01y\\in\\{0,1\\}italic_y ∈ { 0 , 1 } at a specific interval s𝑠sitalic_s for a given design 𝐱𝐱\\mathbf{x}bold_x. The trained model has a test F1 score of 0.82. The resulting confusion matrix on test data is shown in SI Appendix, Tab. S1.\n\nTo test the inverse design capability of RIGID, we randomly created 10 targets, each containing 1-2 frequency ranges in which bandgap(s) should exist. We generated 30 designs for each target by sampling from the resulting likelihood distribution over the design space . Bandgaps were identified from dispersion relations computed using Bloch-wave analysis. Figure 3D shows the kernel density estimation (KDE) for the likelihood of the 300 generated designs, conditioned on their target satisfaction. We use 𝒟𝒟\\mathcal{D}caligraphic_D and 𝒟feassubscript𝒟feas\\mathcal{D}_{\\text{feas}}caligraphic_D start_POSTSUBSCRIPT feas end_POSTSUBSCRIPT to represent the complete set of generated designs and the set of generated designs that actually satisfy the target, respectively. Then 𝒟\\𝒟feas\\𝒟subscript𝒟feas\\mathcal{D}\\backslash\\mathcal{D}_{\\text{feas}}caligraphic_D \\ caligraphic_D start_POSTSUBSCRIPT feas end_POSTSUBSCRIPT denotes the set of generated designs that cannot fulfill the target in reality.\n\nIn an ideal scenario, all solutions in 𝒟𝒟\\mathcal{D}caligraphic_D would satisfy the target, which means 𝒟=𝒟feas𝒟subscript𝒟feas\\mathcal{D}=\\mathcal{D}_{\\text{feas}}caligraphic_D = caligraphic_D start_POSTSUBSCRIPT feas end_POSTSUBSCRIPT, and their density profiles should coincide. However, this ideal scenario is impossible in reality due to both limited model accuracy and uncertainty. As RIGID generates designs by sampling the entire design space based on the likelihood values, it is expected for non-satisfactory designs to be generated as long as the likelihood values for these designs are non-zeros. Therefore, the fact that a design is generated does not mean that the model is certain about the design satisfying the target. We have to look at the estimated likelihood to know how likely the target will be satisfied and make decisions from there. RIGID thus incorporated the model’s confidence into the inverse design process.\n\nFor a reasonable model, most designs in 𝒟\\𝒟feas\\𝒟subscript𝒟feas\\mathcal{D}\\backslash\\mathcal{D}_{\\text{feas}}caligraphic_D \\ caligraphic_D start_POSTSUBSCRIPT feas end_POSTSUBSCRIPT should have low estimated likelihood values. Consequently, the density of 𝒟feassubscript𝒟feas\\mathcal{D}_{\\text{feas}}caligraphic_D start_POSTSUBSCRIPT feas end_POSTSUBSCRIPT’s likelihood is a result of shifting some of 𝒟𝒟\\mathcal{D}caligraphic_D’s density from left (low likelihood) to right (high likelihood). This expectation aligns with the observation in Fig. 3D.\n\nWhen sampling new designs or selecting solutions from generated designs, we can put a sampling threshold τ∈(0,1)𝜏01\\tau\\in(0,1)italic_τ ∈ ( 0 , 1 ) on the likelihood values to filter out “less promising” solutions. To further examine model behavior and quantify how τ𝜏\\tauitalic_τ affects the inverse design outcome, we define the following metrics:\n\nSelection Rate=|𝒟ϕ≥τ||𝒟|,Satisfaction Rate=|𝒟ϕ≥τ∩𝒟feas||𝒟ϕ≥τ|,Average Score=1|𝒟ϕ≥τ|⁢∑i=1|𝒟ϕ≥τ|qi,formulae-sequenceSelection Ratesubscript𝒟italic-ϕ𝜏𝒟formulae-sequenceSatisfaction Ratesubscript𝒟italic-ϕ𝜏subscript𝒟feassubscript𝒟italic-ϕ𝜏Average Score1subscript𝒟italic-ϕ𝜏superscriptsubscript𝑖1subscript𝒟italic-ϕ𝜏subscript𝑞𝑖\\begin{split}\\text{Selection Rate}&=\\frac{|\\mathcal{D}_{\\phi\\geq\\tau}|}{|% \\mathcal{D}|},\\\\ \\text{Satisfaction Rate}&=\\frac{|\\mathcal{D}_{\\phi\\geq\\tau}\\cap\\mathcal{D}_{% \\text{feas}}|}{|\\mathcal{D}_{\\phi\\geq\\tau}|},\\\\ \\text{Average Score}&=\\frac{1}{|\\mathcal{D}_{\\phi\\geq\\tau}|}\\sum_{i=1}^{|% \\mathcal{D}_{\\phi\\geq\\tau}|}q_{i},\\\\ \\end{split}start_ROW start_CELL Selection Rate end_CELL start_CELL = divide start_ARG | caligraphic_D start_POSTSUBSCRIPT italic_ϕ ≥ italic_τ end_POSTSUBSCRIPT | end_ARG start_ARG | caligraphic_D | end_ARG , end_CELL end_ROW start_ROW start_CELL Satisfaction Rate end_CELL start_CELL = divide start_ARG | caligraphic_D start_POSTSUBSCRIPT italic_ϕ ≥ italic_τ end_POSTSUBSCRIPT ∩ caligraphic_D start_POSTSUBSCRIPT feas end_POSTSUBSCRIPT | end_ARG start_ARG | caligraphic_D start_POSTSUBSCRIPT italic_ϕ ≥ italic_τ end_POSTSUBSCRIPT | end_ARG , end_CELL end_ROW start_ROW start_CELL Average Score end_CELL start_CELL = divide start_ARG 1 end_ARG start_ARG | caligraphic_D start_POSTSUBSCRIPT italic_ϕ ≥ italic_τ end_POSTSUBSCRIPT | end_ARG ∑ start_POSTSUBSCRIPT italic_i = 1 end_POSTSUBSCRIPT start_POSTSUPERSCRIPT | caligraphic_D start_POSTSUBSCRIPT italic_ϕ ≥ italic_τ end_POSTSUBSCRIPT | end_POSTSUPERSCRIPT italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT , end_CELL end_ROW (1)\n\nwhere 𝒟ϕ≥τsubscript𝒟italic-ϕ𝜏\\mathcal{D}_{\\phi\\geq\\tau}caligraphic_D start_POSTSUBSCRIPT italic_ϕ ≥ italic_τ end_POSTSUBSCRIPT is the set of generated designs with the likelihood of at least τ𝜏\\tauitalic_τ (i.e., the selected designs) and qisubscript𝑞𝑖q_{i}italic_q start_POSTSUBSCRIPT italic_i end_POSTSUBSCRIPT denotes the percentage overlap between the target and the actual behavior of selected designs. The satisfaction rate evaluates how many selected designs satisfy the target based on a binary criterion (i.e., whether or not a design satisfies the complete target), whereas the average score provides a soft measure where partial satisfaction is also counted. The average score is lower-bounded by the satisfaction rate.\n\nAs shown in Fig. 3E, the selection rate decreases when τ𝜏\\tauitalic_τ increases since more solutions are filtered out. On the other hand, both the satisfaction rate and the average score increase with τ𝜏\\tauitalic_τ, which indicates a high correlation between the estimated likelihood of a solution and its probability of actually achieving the target. As τ𝜏\\tauitalic_τ reaches 0.6, the satisfaction rate and the average score reach 1, indicating that all generated designs satisfy their targets. When sampling or selecting new solutions, we can use the sample threshold τ𝜏\\tauitalic_τ to tune the trade-off between exploitation and exploration — a low τ𝜏\\tauitalic_τ favors exploration as sampled solutions will cover a larger area of the design space, while a high τ𝜏\\tauitalic_τ favors exploitation as sampled solutions will have a higher chance of satisfying the target.\n\nFigure 3F visualizes the geometries and dispersion relations of designs generated based on a randomly created bandgap target. Only the top five designs with the highest likelihood values are shown. In this example, our method generates geometrically different designs that have a high probability of achieving target bandgaps, each yielding a slightly different dispersion relation. This is promising in design applications requiring other material properties, such as dynamic wave velocity or quasi-static stiffness, in which the user can select from a menu of designs with the same target bandgap but other varying properties. Generated designs based on the other nine bandgap targets can be found in SI Appendix, Figs. S2-S6.\n\n3.2 Applying RIGID to Design Optical Metasurfaces with Target High-Absorbance Wavelengths\n\nOptical metasurfaces are artificially engineered systems that can support exotic light propagation building on subwavelength inclusions [55, 56, 57, 58, 59, 60]. Among a diverse array of devices, metamaterial absorbers [61, 62, 63, 64, 65, 66, 67] have been intensely studied for medical imaging, sensing, and wireless communications.\n\nIn this case study, we consider four types of cross-sections (c∈{1,2,3,4}𝑐1234c\\in\\{1,2,3,4\\}italic_c ∈ { 1 , 2 , 3 , 4 }) chosen from the literature (Fig. 4B). It is assumed that a 3D geometric instance is composed of a stack of three layers of prismatic unit cells, each of which is vertically extruded and stacked (Fig. 4A). The geometries constructed in this way can be regarded as an instantiation of multilayered metasurfaces [68, 69, 70, 71, 72], which offer richer design freedom than the single-layer counterpart. The thickness of each layer (hl,l=1,2,3formulae-sequencesubscriptℎ𝑙𝑙123h_{l},l=1,2,3italic_h start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_l = 1 , 2 , 3) is allowed to continuously vary between 50 and 150 nm. Herein we do not consider parametric variations of a given type of unit cell cross-section; yet those can be trivially incorporated in the proposed design framework if necessary.\n\nWe also design the material of each layer (ml,l=1,2,3formulae-sequencesubscript𝑚𝑙𝑙123m_{l},l=1,2,3italic_m start_POSTSUBSCRIPT italic_l end_POSTSUBSCRIPT , italic_l = 1 , 2 , 3). Three dielectric materials of interest, each of which is assigned to a different color in Fig. 4A, are Ti (red), Si (blue), and Ge (yellow). The challenge associated with this design problem is its mixed-variable design space containing three continuous variables (i.e., layer thicknesses) and four categorical variables (i.e., material choices at each layer and the geometry type), which may lead to potentially complicated underlying design-response relations (e.g., those across different geometry or material types). In general, a dielectric material is characterized through a complex refractive index n~∈ℂ~𝑛ℂ\\tilde{n}\\in\\mathbb{C}over~ start_ARG italic_n end_ARG ∈ blackboard_C defined as n~=n+j⁢k~𝑛𝑛𝑗𝑘\\tilde{n}=n+jkover~ start_ARG italic_n end_ARG = italic_n + italic_j italic_k, where j=−1𝑗1j=\\sqrt{-1}italic_j = square-root start_ARG - 1 end_ARG is the imaginary unit, n∈ℝ𝑛ℝn\\in\\mathbb{R}italic_n ∈ blackboard_R involves the speed at which the light propagates through the material, and k∈ℝ𝑘ℝk\\in\\mathbb{R}italic_k ∈ blackboard_R is the extinction coefficient that dictates the energy loss due to the material. Within the frequency regime of interest, those exhibit nonlinear dispersion; both the real and imaginary terms in general are a non-analytic function of excitation wavelength s𝑠sitalic_s, i.e., n⁢(s)𝑛𝑠n(s)italic_n ( italic_s ) and k⁢(s)𝑘𝑠k(s)italic_k ( italic_s ). In addition, the impact of the same material choice on the spectral response A⁢(s)𝐴𝑠A(s)italic_A ( italic_s ) varies depending on the layer location at which the material is placed.\n\nBased on the above configuration, we randomly sampled 258 sets of design variables 𝐱=(c,h1,h2,h3,m1,m2,m3)𝐱𝑐subscriptℎ1subscriptℎ2subscriptℎ3subscript𝑚1subscript𝑚2subscript𝑚3\\mathbf{x}=(c,h_{1},h_{2},h_{3},m_{1},m_{2},m_{3})bold_x = ( italic_c , italic_h start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_h start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT , italic_m start_POSTSUBSCRIPT 1 end_POSTSUBSCRIPT , italic_m start_POSTSUBSCRIPT 2 end_POSTSUBSCRIPT , italic_m start_POSTSUBSCRIPT 3 end_POSTSUBSCRIPT ) and computed their corresponding absorbance spectra using wave analysis. We set t=0.9𝑡0.9t=0.9italic_t = 0.9 as the absorbance threshold, so that “high” absorbance means the absorbance A⁢(s)𝐴𝑠A(s)italic_A ( italic_s ) is no less than 0.9. We trained a random forest on 206 training data (i.e., 80% of the 258 designs and corresponding absorbance spectra) to predict whether “high” absorbance is presented (i.e., the binary indicator y=1𝑦1y=1italic_y = 1) at a wavelength s𝑠sitalic_s for a given design 𝐱𝐱\\mathbf{x}bold_x. The trained random forest has a test F1 score of 0.83. The confusion matrix on test data is shown in SI Appendix, Tab. S2.\n\nNote that this problem involves inverse design with both continuous and categorical variables, which common optimization and generative modeling-based inverse design cannot handle well without special treatment [73, 74, 75]. On the other hand, our random forest-based method can naturally address such mixed-variable problems without any issues.\n\nSimilar to the acoustic metamaterial design problem, we use 10 randomly created targets to evaluate the inverse design performance of RIGID, except that here a target is represented as the wavelength range(s) within which absorbance should be at least 0.9. We generated 100 designs for each target by sampling from the estimated likelihood distribution. Among the 1,000 generated solutions, we successfully conducted wave analysis for 911 designs and obtained their absorbance spectra. Figure 4D shows the KDE for the likelihood of these 911 designs, conditioned on their target satisfaction. The densities share similar behavior as in the acoustic problem (Fig. 3D) —unsatisfied/infeasible designs 𝒟\\𝒟feas\\𝒟subscript𝒟feas\\mathcal{D}\\backslash\\mathcal{D}_{\\text{feas}}caligraphic_D \\ caligraphic_D start_POSTSUBSCRIPT feas end_POSTSUBSCRIPT are concentrated at low likelihood regions, which causes the likelihood density of satisfied/feasible designs 𝒟feassubscript𝒟feas\\mathcal{D}_{\\text{feas}}caligraphic_D start_POSTSUBSCRIPT feas end_POSTSUBSCRIPT to be a result of shifting some of 𝒟𝒟\\mathcal{D}caligraphic_D’s density from left (low likelihood) to right (high likelihood). The sampling threshold and metrics relation shown in Fig. 4E also follow the same trend as in the acoustic problem (Fig. 3E), which again demonstrates a strong positive correlation between the estimated likelihood and the probability of generated designs actually achieving their targets.\n\nFigure 4F shows generated optical metasurface designs with the top five likelihood estimations for a randomly created target. While the materials, cross-section geometries, and layer thicknesses of generated designs can be different, all the designs satisfy the target (Fig. 4F, right panel). To further enhance the diversity of final solutions, we can use sampling strategies such as the one proposed in Ref. [76, 77] to identify a subset (of generated solutions) that simultaneously exhibits high likelihood and high diversity. Generated designs based on the other nine targets can be found in SI Appendix, Figs. S7-S9.\n\n3.3 Synthetic Design Problems for Rapid Validation and Visualization\n\nWhile the above metamaterial design problems represent practical use cases, the validation study is time-consuming due to the expensive computation of metamaterials’ responses such as dispersion relations and absorbance spectra. To allow fast validation of the proposed method and easier inspection of the estimated likelihood in the design space, we create two synthetic case studies. Both problems have 2-dimensional “design spaces” that allow easy visualization.\n\nSqExp Problem\n\nTo construct the first synthetic problem, we used a squared exponential function with tunable parameters a𝑎aitalic_a and b𝑏bitalic_b to mimic the quantitative functional response of metamaterials. The qualitative response (e.g., “high” or “low” energy absorption at a wavelength) is defined as:\n\nI⁢(a,b;s)={0,if z=exp⁡(−(s−a0.3⁢b+0.1)2)<t1,otherwise,𝐼𝑎𝑏𝑠cases0if z=exp⁡(−(s−a0.3⁢b+0.1)2)<t1otherwiseI(a,b;s)=\\begin{cases}0,&\\text{if $z=\\exp\\left(-{\\left(\\frac{s-a}{0.3b+0.1}% \\right)^{2}}\\right)<t$}\\\\ 1,&\\text{otherwise}\\end{cases},italic_I ( italic_a , italic_b ; italic_s ) = { start_ROW start_CELL 0 , end_CELL start_CELL if italic_z = roman_exp ( - ( divide start_ARG italic_s - italic_a end_ARG start_ARG 0.3 italic_b + 0.1 end_ARG ) start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT ) < italic_t end_CELL end_ROW start_ROW start_CELL 1 , end_CELL start_CELL otherwise end_CELL end_ROW , (2)\n\nwhere z𝑧zitalic_z represents quantitative response and t𝑡titalic_t is a threshold that converts z𝑧zitalic_z into a qualitative response I⁢(a,b;s)𝐼𝑎𝑏𝑠I(a,b;s)italic_I ( italic_a , italic_b ; italic_s ). Specifically, I⁢(a,b;s)=1𝐼𝑎𝑏𝑠1I(a,b;s)=1italic_I ( italic_a , italic_b ; italic_s ) = 1 can mean the existence of a bandgap or high absorbance at a frequency s𝑠sitalic_s. Then {s|I⁢(a,b;s)=1}conditional-set𝑠𝐼𝑎𝑏𝑠1\\{s|I(a,b;s)=1\\}{ italic_s | italic_I ( italic_a , italic_b ; italic_s ) = 1 } represents a range of s𝑠sitalic_s that mimics our interested material behavior, such as the frequency range of the bandgap or the wavelength range of high absorbance. We call this the positive range. By varying a𝑎aitalic_a and b𝑏bitalic_b, we can produce different synthetic responses and positive ranges. Therefore, we can use a𝑎aitalic_a and b𝑏bitalic_b as synthetic design variables. There is a clear relation between these design variables and the positive range that Eq. 2 creates — a𝑎aitalic_a and b𝑏bitalic_b control the center location and the width of the positive range, respectively.\n\nIn this design problem, we sampled 100 sets of a𝑎aitalic_a and b𝑏bitalic_b uniformly at random. We set t𝑡titalic_t as 0.9. Based on Eq. 2, we obtained the corresponding responses (Fig. 5A). These sets of a𝑎aitalic_a, b𝑏bitalic_b, and responses constitute a dataset for training and testing our model.\n\nSupSin Problem\n\nAnother synthetic design problem was constructed by replacing the squared exponential function in the SqExp problem with a superposed sine function. Given synthetic design variables a𝑎aitalic_a and b𝑏bitalic_b, we can produce qualitative responses using the following equation:\n\nI⁢(a,b;s)={0,if z=sin⁡(2⁢π⁢(s+a))+sin⁡(3⁢π⁢(s+b))<t1,otherwise.𝐼𝑎𝑏𝑠cases0if z=sin⁡(2⁢π⁢(s+a))+sin⁡(3⁢π⁢(s+b))<t1otherwiseI(a,b;s)=\\begin{cases}0,&\\text{if $z=\\sin\\left(2\\pi(s+a)\\right)+\\sin\\left(3\\pi% (s+b)\\right)<t$}\\\\ 1,&\\text{otherwise}\\end{cases}.italic_I ( italic_a , italic_b ; italic_s ) = { start_ROW start_CELL 0 , end_CELL start_CELL if italic_z = roman_sin ( 2 italic_π ( italic_s + italic_a ) ) + roman_sin ( 3 italic_π ( italic_s + italic_b ) ) < italic_t end_CELL end_ROW start_ROW start_CELL 1 , end_CELL start_CELL otherwise end_CELL end_ROW . (3)\n\nSame as in the SqExp problem, we set t=0.9𝑡0.9t=0.9italic_t = 0.9 and created a dataset with 100 sets of synthetic design variables and corresponding ranges derived from synthetic responses (Fig. 5B). Unlike the squared exponential function, the superposed sine function can be multimodal, which means it can result in multiple synthetic ranges to mimic, for example, multiple bandgaps. The bandgap locations are controlled by a𝑎aitalic_a and b𝑏bitalic_b.\n\nFor each synthetic example, we split the data into 80 training data and 20 test data, and trained a random forest, with the same hyperparameter settings as the other problems, to predict the binary indicators I⁢(a,b;s)𝐼𝑎𝑏𝑠I(a,b;s)italic_I ( italic_a , italic_b ; italic_s ). The F1 scores are 0.85 and 0.86 for the SqExp and the SupSin problems, respectively. The resulting confusion matrices are shown in SI Appendix, Tables S3-S4. We evaluated the inverse design performance with the trained models.\n\nDue to the fast evaluation of Equations 2 and 3, we can exhaust all the possible solutions in the design space to obtain the ground-truth feasible region(s) for a target. Figure 6A shows the estimated likelihood values and the ground-truth feasible regions under randomly created targets. In general, high-likelihood regions match actual feasible regions well, which further demonstrates the effectiveness of RIGID. We can also observe that feasible regions in the SqExp and the SupSin problems follow distinct patterns. In the SqExp problem, a𝑎aitalic_a and b𝑏bitalic_b control the center location and the width of the positive range, respectively. Therefore, the position of the feasible region along the a𝑎aitalic_a-axis moves with the location of the target range, while the feasible region gradually shrinks as b𝑏bitalic_b decreases since the decrease of b𝑏bitalic_b (i.e., positive range width) causes the choice of a𝑎aitalic_a (i.e., positive range center location) to be more restricted to fit the target range. In the SupSin problem, there might be multiple positive ranges appearing at the peaks of the superposed sine function in Eq. 3. Design variables a𝑎aitalic_a and b𝑏bitalic_b control positive range locations by translating each sine function. Due to the sine function’s periodicity, we can obtain multiple feasible regions along both a𝑎aitalic_a- and b𝑏bitalic_b-axes. Figure 6A shows that the likelihood estimation by RIGID successfully captured the above-mentioned patterns of feasible regions.\n\nFigure 6B demonstrates how the estimated likelihood varies when increasing the number of trees in a random forest. With a single decision tree, the estimated likelihood function is almost a binary function and highly inaccurate. The likelihood in the SqExp case is even zero everywhere, which makes it impossible to sample designs based on the likelihood. As the number of trees increases, the likelihood function becomes smoother and eventually converges.\n\nBesides these qualitative visual inspections, we also calculated the metrics proposed in Eq. 1, as shown in Fig. 6C. For each of the two synthetic problems, these metrics were computed on 500 designs generated by giving five random target ranges. Again, the satisfaction rate and the average score increase with the sampling threshold, indicating a strong correlation between the sampling threshold and the probability of generated designs actually achieving their targets. In both problems, all the selected designs satisfy their targets (i.e., the satisfaction rates and average scores reach 1) when the sampling threshold reaches 0.8.\n\n4 Summary and Outlook\n\nWe proposed RIGID, an iteration-free, single-shot inverse design method that generates metamaterials to satisfy qualitative behaviors of functional responses. Such qualitative behaviors are important design targets in many applications such as tailoring bandgaps of acoustic metamaterials for wave-guiding, focusing, and vibration mitigation, or tailoring the absorption level of optical metasurfaces at certain wavelengths for medical sensing, imaging, and communication applications. Unlike most existing machine learning-based inverse design methods that require training an inverse model to map targets to designs, the RIGID method takes advantage of the random forest’s interpretability and derives the likelihood of target satisfaction by probing the trained forward model. Incorporated with MCMC, one can sample a desired number of new designs based on the estimated likelihood. Therefore, RIGID functions as a generative model that can capture the conditional distribution of satisfying designs given a target, or in other words, the one-to-many mapping from the target to satisfying designs. Using both real-world and synthetic design problems, we demonstrated that RIGID is efficient and effective on datasets with training sample sizes smaller than 250. We used both qualitative and quantitative approaches to validate the proposed method. The quantitative results revealed a strong correlation between the estimated likelihood of a solution and its probability of actually achieving the target, which demonstrated the effectiveness of the likelihood estimation. Due to the fast evaluation of output responses and the transparency of ground-truth solutions, the proposed synthetic problems can be used for future benchmarking studies of metamaterial design problems.\n\nRIGID offers two levels of interpretability. Firstly, RIGID is more transparent than deep learning models. The transparency of the random forest as a forward model helps us understand how the predictions are made. The inverse design process based on likelihood estimation and sampling is also transparent. The transparency of both forward and inverse processes offers insights into the decision-making process and diagnostic capabilities. Secondly, owing to the interpretability of the forward prediction model, we can derive the likelihood, which the inverse design relies on, by probing into each decision path of trees in the random forest. The likelihood is an interpretable metric to help us understand the probability of a generated design satisfying the given target and thus aid the decision-making process when selecting final solutions. The results (Figures 3D, 3E, 4D, 4E, and 6C) have demonstrated a high correlation between the likelihood and actual probability of target satisfaction. The likelihood also serves as an indicator of the need for adjusting the design space. When the likelihood is low across the entire design space, the model believes the target is almost impossible to achieve, which may indicate a need for expanding the design space (i.e., extending design space bounds or adding new design freedom) to allow wider coverage of the response space and easier discovery of satisfying solutions. Please see more discussion in SI Appendix, Sec. D. Another benefit of having the explicit likelihood as an interpretable metric is that we can adjust the likelihood threshold to trade-off exploration and exploitation — higher (lower) threshold means more focus on exploitation (exploration). Both levels of interpretability were absent from most prior works of iteration-free, single-shot inverse design methods for metamaterials.\n\nRIGID is particularly useful when data collection is expensive, as in many cases where high-fidelity simulation or experimental data are needed. Although hardware-accelerated simulation and surrogate solvers have advanced in recent years to make simulation faster without sacrificing too much accuracy, the trade-off between time/computational resources and accuracy will always pose a problem. For example, hardware acceleration for high-fidelity simulation relies on high-end GPUs/CPUs and other high-performance computing infrastructure, which might not be accessible under limited budgets. With surrogate solvers, the need for computational resources reduces, but so will the accuracy. If the surrogate solver is data-driven, we will still have the problem of collecting high-fidelity data in the first place. Thus, we believe that the issue of data deficiency will always exist, especially when high-fidelity data is desired but time and computational resources are constrained. With most of the prior inverse design works based on deep learning with a high demand for data and computational resources, it is useful to create a method that works under scenarios at the other end of the data/computational resource requirement spectrum. Additionally, our proposed method is not only useful with high-fidelity simulation/numerical data, but also with experimental data. When it is difficult to build an accurate numerical model, the only way to acquire high-fidelity data is through experiments. In this case, data deficiency will become a pressing challenge for deep learning-based methods.\n\nThis work focuses on the scenario of small data, low-dimensional problems. As the problem dimension increases, the requirement for dataset size will quickly increase due to the curse of dimensionality. While there is a large collection of deep learning methods to address high-dimensional and large dataset problems, the setting of small data and low dimensionality seems to be under-studied by prior works, despite this setting’s practicality under constrained budgets. RIGID can fill this gap.\n\nThe MCMC in RIGID can sample new designs in the entire design space based on the estimated likelihood, which is not limited to local optimality and has the potential to discover multiple very different satisfying solutions (if any) in one shot. This is clearly demonstrated in the SupSin example where there are multiple disconnected feasible regions in the design space and the likelihood estimated by RIGID successfully coincides with these feasible regions (Fig. 6A). The ability to generate multiple satisfying solutions allows us to consider other figures of merit, such as manufacturability and cost, in addition to the main objective of satisfying the target response. We can also control the likelihood threshold to adjust the diversity of generated designs.\n\nThe use of a random forest in RIGID allows easy consideration of discrete design variables. For example, our optical metasurface design problem has the geometry type and the material choice for each layer as categorical design variables. In contrast, these discrete variables will pose challenges for other inverse design methods based on some machine learning models (e.g., conditional generative models) or gradient-based optimization. On the other hand, the simplicity of the tree-based model does not hurt its capability of solving complex problems, as a decision tree can represent arbitrarily complex decision boundaries.\n\nWhile we address qualitative design targets in this study, a similar idea has the potential to generalize to quantitative targets. Such problems can be, for example, generating optical metasurface designs with specific optical spectra [78, 23], generating functional materials with target nonlinear constitutive relations [41, 79], or generating programmable metamaterials with prescribed functional responses [80, 81]. It is also straightforward to adjust the target to achieve multifunctionality (e.g., negative/positive Poisson’s ratio under low/high compression rate [82]).\n\nAlthough this study only demonstrates the RIGID method on parametric design (i.e., designs are represented by geometric and/or material parameters), the method also applies to shape or topological design problems where the shape or topology of designs can vary without being restricted to a limited number of geometric parameters [78, 35, 23, 37, 83]. In those cases, as valid designs only lie on a lower-dimensional manifold of the design space, the likelihood of target satisfaction will be zero almost everywhere in the original design space. Thus before applying RIGID, we need to obtain a latent representation that compactly captures the manifold of valid designs [84, 85], and use the latent representation as design variables for inverse design.\n\n5 Experimental Section\n\nComputation of Acoustic Dispersion Relations\n\nWe performed Bloch-wave analysis in COMSOL Multiphysics to compute the dispersion relations of acoustic metamaterials. Poisson’s ratio of 0.49, Young’s modulus of 2.7 GPa, and density of 1170 kg/m3 were set as material properties with ∼1.5×104similar-toabsent1.5superscript104\\sim 1.5\\times 10^{4}∼ 1.5 × 10 start_POSTSUPERSCRIPT 4 end_POSTSUPERSCRIPT mesh elements per unit cell. We used Floquet-Bloch periodic boundary conditions to obtain the first 60 eigenfrequencies along all symmetry domains of the cubic irreducible Brillouin zone (Fig. 3B) for all lattices, thus generating a dispersion relation.\n\nComputation of Optical Absorbance Spectra\n\nWe computed the absorbance spectra for optical metasurfaces using wave analysis inspired by Zhang et al. [72]. The RF Module of COMSOL Multiphysics® [86] was used to evaluate the spectral response of concern, which is the energy absorbance A⁢(s)𝐴𝑠A(s)italic_A ( italic_s ) in the visible regime (380-700 nm). An absorbance spectrum is computed with respect to 33 wavelength components sksubscript𝑠𝑘s_{k}italic_s start_POSTSUBSCRIPT italic_k end_POSTSUBSCRIPT that are uniformly discretized over the specified range. An incident plane wave is assumed to be given from the port, located at the top face of the analysis domain. We set the periodicity of the analysis domain as 400 nm. The periodic boundary condition on electromagnetic fields is imposed on the lateral faces of the analysis domain. A substrate made of SiO2 is placed right below a given unit cell instance (the black layers in Fig. 4A-B). With full electric fields computed through the wave analysis, the energy absorbance at a single wavelength s𝑠sitalic_s is quantified as A⁢(s)=1−|S11⁢(s)|2𝐴𝑠1superscriptsubscript𝑆11𝑠2A(s)=1-|S_{11}(s)|^{2}italic_A ( italic_s ) = 1 - | italic_S start_POSTSUBSCRIPT 11 end_POSTSUBSCRIPT ( italic_s ) | start_POSTSUPERSCRIPT 2 end_POSTSUPERSCRIPT, where Si⁢jsubscript𝑆𝑖𝑗S_{ij}italic_S start_POSTSUBSCRIPT italic_i italic_j end_POSTSUBSCRIPT is the component of the S𝑆Sitalic_S-parameter matrix that specifies energy transfer between ports. We use the data presented in Ref. [87] to set the material dispersion of the dielectric.\n\nKeywords\n\nmetamaterials, inverse design, generative design, random forest, interpretable machine learning, functional response\n\nReferences\n\n[1] Shan Jiang, Xuejun Liu, Jianpeng Liu, Dong Ye, Yongqing Duan, Kan Li, Zhouping Yin, and YongAn Huang. Flexible metamaterial electronics. Advanced Materials, 34(52):2200070, 2022.\n\n[2] J William Boley, Wim M Van Rees, Charles Lissandrello, Mark N Horenstein, Ryan L Truby, Arda Kotikian, Jennifer A Lewis, and L Mahadevan. Shape-shifting structured lattices via multimaterial 4d printing. Proceedings of the National Academy of Sciences, 116(42):20856–20862, 2019.\n\n[3] Chunping Ma, Yilong Chang, Shuai Wu, and Ruike Renee Zhao. Deep learning-accelerated designs of tunable magneto-mechanical metamaterials. ACS Applied Materials & Interfaces, 14(29):33892–33902, 2022.\n\n[4] Filippo Casadei, Tommaso Delpero, Andrea Bergamini, Paolo Ermanni, and Massimo Ruzzene. Piezoelectric resonator arrays for tunable acoustic waveguides and metamaterials. Journal of Applied Physics, 112(6):064902, 09 2012.\n\n[5] Guang-Sheng Liu, Yang Zhou, Ming-Hao Liu, Ying Yuan, Xin-Ye Zou, and Jian-Chun Cheng. Acoustic waveguide with virtual soft boundary based on metamaterials. Scientific Reports, 10(1):981, 2020.\n\n[6] Gunho Kim, Carlos M Portela, Paolo Celli, Antonio Palermo, and Chiara Daraio. Poroelastic microlattices for underwater wave focusing. Extreme Mechanics Letters, 49:101499, 2021.\n\n[7] Yangbo Xie, Yangyang Fu, Zhetao Jia, Junfei Li, Chen Shen, Yadong Xu, Huanyang Chen, and Steven A Cummer. Acoustic imaging with metamaterial luneburg lenses. Scientific reports, 8(1):16188, 2018.\n\n[8] Kathryn H Matlack, Anton Bauhofer, Sebastian Krödel, Antonio Palermo, and Chiara Daraio. Composite 3d-printed metastructures for low-frequency and broadband vibration absorption. Proceedings of the National Academy of Sciences, 113(30):8386–8390, 2016.\n\n[9] Sebastian Krödel, Nicolas Thomé, and Chiara Daraio. Wide band-gap seismic metastructures. Extreme Mechanics Letters, 4:111–117, 2015.\n\n[10] Alireza Bayat and Stavros Gaitanaros. Wave directionality in three-dimensional periodic lattices. Journal of Applied Mechanics, 85(1):011004, 2018.\n\n[11] Henrik Ronellenfitsch, Norbert Stoop, Josephine Yu, Aden Forrow, and Jörn Dunkel. Inverse design of discrete mechanical metamaterials. Physical Review Materials, 3(9):095201, 2019.\n\n[12] Heedong Goh and Loukas F Kallivokas. Inverse band gap design of elastic metamaterials for p and sv wave control. Computer Methods in Applied Mechanics and Engineering, 370:113263, 2020.\n\n[13] Xiang Li, Shaowu Ning, Zhanli Liu, Ziming Yan, Chengcheng Luo, and Zhuo Zhuang. Designing phononic crystal with anticipated band gap through a deep learning based data-driven method. Computer Methods in Applied Mechanics and Engineering, 361:112737, 2020.\n\n[14] Xiaopeng Zhang, Jian Xing, Pai Liu, Yangjun Luo, and Zhan Kang. Realization of full and directional band gap design by non-gradient topology optimization in acoustic metamaterials. Extreme Mechanics Letters, 42:101126, 2021.\n\n[15] Zhi Chen, Alexander Ogren, Chiara Daraio, L Catherine Brinson, and Cynthia Rudin. How to see hidden patterns in metamaterials with interpretable machine learning. Extreme Mechanics Letters, 57:101895, 2022.\n\n[16] Robin Vismara, Nils Odebo Länk, Ruggero Verre, Mikael Käll, Olindo Isabella, and Miro Zeman. Solar harvesting based on perfect absorbing all-dielectric nanoresonators on a mirror. Optics Express, 27(16):A967–A980, 2019.\n\n[17] Yongzhi Cheng, Fu Chen, and Hui Luo. Plasmonic chiral metasurface absorber based on bilayer fourfold twisted semicircle nanostructure at optical frequency. Nanoscale Research Letters, 16:1–9, 2021.\n\n[18] Zhaocheng Liu, Dayu Zhu, Kyu-Tae Lee, Andrew S Kim, Lakshmi Raju, and Wenshan Cai. Compounding meta-atoms into metamolecules with hybrid artificial intelligence techniques. Advanced Materials, 32(6):1904790, 2020.\n\n[19] Doksoo Lee, Lu Zhang, Yue Yu, and Wei Chen. Deep neural operator enabled concurrent multitask design for multifunctional metamaterials under heterogeneous fields. Advanced Optical Materials, n/a(n/a):2303087, 2024.\n\n[20] Sandeep Inampudi and Hossein Mosallaei. Neural network based design of metagratings. Applied Physics Letters, 112(24), 2018.\n\n[21] Maksym V Zhelyeznyakov, Steve Brunton, and Arka Majumdar. Deep learning to accelerate scatterer-to-field mapping for inverse design of dielectric metasurfaces. ACS Photonics, 8(2):481–488, 2021.\n\n[22] Dianjing Liu, Yixuan Tan, Erfan Khoram, and Zongfu Yu. Training deep neural networks for the inverse design of nanophotonic structures. Acs Photonics, 5(4):1365–1369, 2018.\n\n[23] Wei Ma, Feng Cheng, Yihao Xu, Qinlong Wen, and Yongmin Liu. Probabilistic representation and inverse design of metamaterials based on a deep generative model with semi-supervised learning strategy. Advanced Materials, 31(35):1901111, 2019.\n\n[24] Sensong An, Bowen Zheng, Hong Tang, Mikhail Y. Shalaginov, Li Zhou, Hang Li, Myungkoo Kang, Kathleen A. Richardson, Tian Gu, Juejun Hu, Clayton Fowler, and Hualiang Zhang. Multifunctional Metasurface Design with a Generative Adversarial Network. Advanced Optical Materials, 9(5):1–10, 2021.\n\n[25] Itzik Malkiel, Michael Mrejen, Achiya Nagler, Uri Arieli, Lior Wolf, and Haim Suchowski. Plasmonic nanostructure design and characterization via Deep Learning. Light: Science and Applications, 7(1), 2018.\n\n[26] Doksoo Lee, Wei Chen, Liwei Wang, Yu-Chin Chan, and Wei Chen. Data-driven design for metamaterials and multiscale systems: A review. Advanced Materials, 36(8):2305254, 2024.\n\n[27] Sensong An, Clayton Fowler, Bowen Zheng, Mikhail Y Shalaginov, Hong Tang, Hang Li, Li Zhou, Jun Ding, Anuradha Murthy Agarwal, Clara Rivero-Baleine, et al. A deep learning approach for objective-driven all-dielectric metasurface design. ACS Photonics, 6(12):3196–3207, 2019.\n\n[28] Siddhant Kumar, Stephanie Tan, Li Zheng, and Dennis M Kochmann. Inverse-designed spinodoid metamaterials. npj Computational Materials, 6(1):1–10, 2020.\n\n[29] Christopher Yeung, Ju Ming Tsai, Brian King, Benjamin Pham, David Ho, Julia Liang, Mark W. Knight, and Aaswath P. Raman. Multiplexed supercell metasurface design and optimization with tandem residual networks. Nanophotonics, 10(3):1133–1143, 1 2021.\n\n[30] Jan-Hendrik Bastek, Siddhant Kumar, Bastian Telgen, Raphaël N Glaesener, and Dennis M Kochmann. Inverting the structure–property map of truss metamaterials by deep learning. Proceedings of the National Academy of Sciences, 119(1):e2111505119, 2022.\n\n[31] Chen Xie, Haonan Li, Chenyang Cui, Haodong Lei, Yingjie Sun, Chi Zhang, Yaqiang Zhang, Hongxing Dong, and Long Zhang. Deep learning assisted inverse design of metamaterial microwave absorber. Applied Physics Letters, 123(18), 2023.\n\n[32] K Mahesh, S Kumar Ranjith, and RS Mini. A deep autoencoder based approach for the inverse design of an acoustic-absorber. Engineering with Computers, 40(1):279–300, 2024.\n\n[33] Chan Soo Ha, Desheng Yao, Zhenpeng Xu, Chenang Liu, Han Liu, Daniel Elkins, Matthew Kile, Vikram Deshpande, Zhenyu Kong, Mathieu Bauchy, et al. Rapid inverse design of metamaterials based on prescribed mechanical behavior through machine learning. Nature Communications, 14(1):5765, 2023.\n\n[34] Ze-Wei Wang, An Chen, Zi-Xiang Xu, Jing Yang, Bin Liang, and Jian-Chun Cheng. On-demand inverse design of acoustic metamaterials using probabilistic generation network. Science China Physics, Mechanics & Astronomy, 66(2):224311, 2023.\n\n[35] Jiaqi Jiang, David Sell, Stephan Hoyer, Jason Hickey, Jianji Yang, and Jonathan A Fan. Free-form diffractive metagrating design based on generative adversarial networks. ACS nano, 13(8):8872–8878, 2019.\n\n[36] Sunae So and Junsuk Rho. Designing nanophotonic structures using conditional deep convolutional generative adversarial networks. Nanophotonics, 8(7):1255–1261, 2019.\n\n[37] Fufang Wen, Jiaqi Jiang, and Jonathan A Fan. Robust freeform metasurface design based on progressively growing generative networks. ACS Photonics, 7(8):2098–2104, 2020.\n\n[38] Caglar Gurbuz, Felix Kronowetter, Christoph Dietz, Martin Eser, Jonas Schmid, and Steffen Marburg. Generative adversarial networks for the design of acoustic metamaterials. The Journal of the Acoustical Society of America, 149(2):1162–1174, 2021.\n\n[39] Wei Ma, Yihao Xu, Bo Xiong, Lin Deng, Ru-Wen Peng, Mu Wang, and Yongmin Liu. Pushing the limits of functionality-multiplexing capability in metasurface design based on statistical machine learning. Advanced Materials, 34(16):2110022, 2022.\n\n[40] Zhi-Dan Lei, Yi-Duo Xu, Cheng Lei, Yan Zhao, and Du Wang. Dynamic multifunctional metasurfaces: an inverse design deep learning approach. Photonics Research, 12(1):123–133, 2024.\n\n[41] Andrew J Lew and Markus J Buehler. Single-shot forward and inverse hierarchical architected materials design for nonlinear mechanical properties using an attention-diffusion model. Materials Today, 64:10–20, 2023.\n\n[42] Zezhou Zhang, Chuanchuan Yang, Yifeng Qin, Hao Feng, Jiqiang Feng, and Hongbin Li. Diffusion probabilistic model based accurate and high-degree-of-freedom metasurface inverse design. Nanophotonics, 12(20):3871–3881, 2023.\n\n[43] Jan-Hendrik Bastek and Dennis M Kochmann. Inverse design of nonlinear mechanical metamaterials via video denoising diffusion models. Nature Machine Intelligence, 5(12):1466–1475, 2023.\n\n[44] Sunae So, Jungho Mun, Junghyun Park, and Junsuk Rho. Revisiting the design strategies for metasurfaces: fundamental physics, optimization, and beyond. Advanced Materials, 35(43):2206399, 2023.\n\n[45] Xiaoyang Zheng, Xubo Zhang, Ta-Te Chen, and Ikumu Watanabe. Deep learning in mechanical metamaterials: from prediction and generation to inverse design. Advanced Materials, 35(45):2302530, 2023.\n\n[46] Yabin Jin, Liangshu He, Zhihui Wen, Bohayra Mortazavi, Hongwei Guo, Daniel Torrent, Bahram Djafari-Rouhani, Timon Rabczuk, Xiaoying Zhuang, and Yan Li. Intelligent on-demand design of phononic metamaterials. Nanophotonics, 11(3):439–460, 2022.\n\n[47] Wei Ma, Zhaocheng Liu, Zhaxylyk A Kudyshev, Alexandra Boltasseva, Wenshan Cai, and Yongmin Liu. Deep learning for the design of photonic structures. Nature Photonics, 15(2):77–90, 2021.\n\n[48] Jiaqi Jiang, Mingkun Chen, and Jonathan A Fan. Deep neural networks for the evaluation and design of photonic devices. Nature Reviews Materials, 6(8):679–700, 2021.\n\n[49] Yihao Xu, Bo Xiong, Wei Ma, and Yongmin Liu. Software-defined nanophotonic devices and systems empowered by machine learning. Progress in Quantum Electronics, page 100469, 2023.\n\n[50] Mahmoud Elzouka, Charles Yang, Adrian Albert, Ravi S Prasher, and Sean D Lubner. Interpretable forward and inverse design of particle spectral emissivity using common machine-learning models. Cell Reports Physical Science, 1(12), 2020.\n\n[51] Leo Breiman. Random forests. Machine learning, 45:5–32, 2001.\n\n[52] WK Hastings. Monte carlo sampling methods using markov chains and their applications. Biometrika, pages 97–109, 1970.\n\n[53] Leo Breiman, Jerome Friedman, Charles J Stone, and R A Olshen. Classification and Regression Trees. Chapman and Hall/CRC, 1984.\n\n[54] Nitesh V Chawla, Kevin W Bowyer, Lawrence O Hall, and W Philip Kegelmeyer. Smote: synthetic minority over-sampling technique. Journal of artificial intelligence research, 16:321–357, 2002.\n\n[55] John Brian Pendry. Negative refraction makes a perfect lens. Physical review letters, 85(18):3966, 2000.\n\n[56] Nanfang Yu, Patrice Genevet, Mikhail A Kats, Francesco Aieta, Jean-Philippe Tetienne, Federico Capasso, and Zeno Gaburro. Light propagation with phase discontinuities: generalized laws of reflection and refraction. science, 334(6054):333–337, 2011.\n\n[57] Alexander V Kildishev, Alexandra Boltasseva, and Vladimir M Shalaev. Planar photonics with metasurfaces. Science, 339(6125):1232009, 2013.\n\n[58] Tie Jun Cui, Mei Qing Qi, Xiang Wan, Jie Zhao, and Qiang Cheng. Coding metamaterials, digital metamaterials and programmable metamaterials. Light: science & applications, 3(10):e218–e218, 2014.\n\n[59] Syed S Bukhari, J Yiannis Vardaxoglou, and William Whittow. A metasurfaces review: Definitions and applications. Applied Sciences, 9(13):2727, 2019.\n\n[60] Jie Hu, Sankhyabrata Bandyopadhyay, Yu-hui Liu, and Li-yang Shao. A review on metasurface: from principle to smart metadevices. Frontiers in Physics, 8:586087, 2021.\n\n[61] N Iê Landy, S Sajuyigbe, Jack J Mock, David R Smith, and Willie J Padilla. Perfect metamaterial absorber. Physical review letters, 100(20):207402, 2008.\n\n[62] Xianliang Liu, Tatiana Starr, Anthony F Starr, and Willie J Padilla. Infrared spatial and frequency selective metamaterial with near-unity absorbance. Physical review letters, 104(20):207403, 2010.\n\n[63] Jiaming Hao, Jing Wang, Xianliang Liu, Willie J Padilla, Lei Zhou, and Min Qiu. High performance optical absorber based on a plasmonic metamaterial. Applied Physics Letters, 96(25), 2010.\n\n[64] Claire M Watts, Xianliang Liu, and Willie J Padilla. Metamaterial electromagnetic wave absorbers. Advanced materials, 24(23):OP98–OP120, 2012.\n\n[65] Yanxia Cui, Yingran He, Yi Jin, Fei Ding, Liu Yang, Yuqian Ye, Shoumin Zhong, Yinyue Lin, and Sailing He. Plasmonic and metamaterial structures as electromagnetic absorbers. Laser & Photonics Reviews, 8(4):495–520, 2014.\n\n[66] Xinyu Liu, Kebin Fan, Ilya V Shadrivov, and Willie J Padilla. Experimental realization of a terahertz all-dielectric metasurface absorber. Optics express, 25(1):191–201, 2017.\n\n[67] Gun-Yeal Lee, Gwanho Yoon, Seung-Yeol Lee, Hansik Yun, Jaebum Cho, Kyookeun Lee, Hwi Kim, Junsuk Rho, and Byoungho Lee. Complete amplitude and phase control of light using broadband holographic metasurfaces. Nanoscale, 10(9):4237–4245, 2018.\n\n[68] You Zhou, Ivan I Kravchenko, Hao Wang, J Ryan Nolen, Gong Gu, and Jason Valentine. Multilayer noninteracting dielectric metasurfaces for multiwavelength metaoptics. Nano letters, 18(12):7529–7537, 2018.\n\n[69] You Li, Qunsheng Cao, and Yi Wang. A wideband multifunctional multilayer switchable linear polarization metasurface. IEEE Antennas and Wireless Propagation Letters, 17(7):1314–1318, 2018.\n\n[70] Giuseppe Marino, Davide Rocco, Carlo Gigli, Grégoire Beaudoin, Konstantinos Pantzas, Stéphan Suffit, Pascal Filloux, Isabelle Sagnes, Giuseppe Leo, and Costantino De Angelis. Harmonic generation with multi-layer dielectric metasurfaces. Nanophotonics, 10(7):1837–1843, 2021.\n\n[71] Stephanie C Malek, Adam C Overvig, Andrea Alù, and Nanfang Yu. Multifunctional resonant wavefront-shaping meta-optics based on multilayer and multi-perturbation nonlocal metasurfaces. Light: Science & Applications, 11(1):246, 2022.\n\n[72] Yuanjian Zhang, Yingting Yi, Wenxin Li, Shiri Liang, Jing Ma, Shubo Cheng, Wenxing Yang, and Yougen Yi. High absorptivity and ultra-wideband solar absorber based on ti-al2o3 cross elliptical disk arrays. Coatings, 13(3):531, 2023.\n\n[73] Yichi Zhang, Daniel W Apley, and Wei Chen. Bayesian optimization for materials design with mixed quantitative and qualitative variables. Scientific reports, 10(1):4924, 2020.\n\n[74] Chao Ma, Sebastian Tschiatschek, Richard Turner, José Miguel Hernández-Lobato, and Cheng Zhang. Vaem: a deep generative model for heterogeneous mixed type data. Advances in Neural Information Processing Systems, 33:11237–11247, 2020.\n\n[75] Lei Xu and Kalyan Veeramachaneni. Synthesizing tabular data using generative adversarial networks. arXiv preprint arXiv:1811.11264, 2018.\n\n[76] Yu-Chin Chan, Faez Ahmed, Liwei Wang, and Wei Chen. Metaset: Exploring shape and property spaces for data-driven metamaterials design. Journal of Mechanical Design, 143(3):031707, 2021.\n\n[77] Doksoo Lee, Yu-Chin Chan, Wei Chen, Liwei Wang, Anton van Beek, and Wei Chen. T-metaset: Task-aware acquisition of metamaterial datasets through diversity-based active learning. Journal of Mechanical Design, 145(3):031704, 2023.\n\n[78] Zhaocheng Liu, Dayu Zhu, Sean P Rodrigues, Kyu-Tae Lee, and Wenshan Cai. Generative model for the inverse design of metasurfaces. Nano letters, 18(10):6570–6576, 2018.\n\n[79] Nikolaos N Vlassis and WaiChing Sun. Denoising diffusion algorithm for inverse design of microstructures with fine-tuned nonlinear material properties. Computer Methods in Applied Mechanics and Engineering, 413:116126, 2023.\n\n[80] Weichen Li, Fengwen Wang, Ole Sigmund, and Xiaojia Shelly Zhang. Digital synthesis of free-form multimaterial structures for realization of arbitrary programmed mechanical responses. Proceedings of the National Academy of Sciences, 119(10):e2120563119, 2022.\n\n[81] Xin Lin, Fei Pan, Yong Ma, Yuling Wei, Kang Yang, Zihong Wu, Juan Guan, Bin Ding, Bin Liu, Jinwu Xiang, et al. Mechanical fourier transform for programmable metamaterials. Proceedings of the National Academy of Sciences, 120(37):e2305380120, 2023.\n\n[82] Aleksi Bossart, David MJ Dykstra, Jop Van der Laan, and Corentin Coulais. Oligomodal metamaterials with multifunctional mechanics. Proceedings of the National Academy of Sciences, 118(21):e2018610118, 2021.\n\n[83] Sensong An, Bowen Zheng, Hong Tang, Mikhail Y Shalaginov, Li Zhou, Hang Li, Myungkoo Kang, Kathleen A Richardson, Tian Gu, Juejun Hu, et al. Multifunctional metasurface design with a generative adversarial network. Advanced Optical Materials, 9(5):2001433, 2021.\n\n[84] Liwei Wang, Yu-Chin Chan, Faez Ahmed, Zhao Liu, Ping Zhu, and Wei Chen. Deep generative modeling for mechanistic-based learning and design of metamaterial systems. Computer Methods in Applied Mechanics and Engineering, 372:113377, 2020.\n\n[85] Wei Chen, Doksoo Lee, Oluwaseyi Balogun, and Wei Chen. Gan-duf: Hierarchical deep generative models for design under free-form geometric uncertainty. Journal of Mechanical Design, 145(1):011703, 2023.\n\n[86] COMSOL AB. Comsol multiphysics (version 5.6). https://www.comsol.com, 2020. Stockholm, Sweden.\n\n[87] David E Aspnes and AA Studna. Dielectric functions and optical parameters of si, ge, gap, gaas, gasb, inp, inas, and insb from 1.5 to 6.0 ev. Physical review B, 27(2):985, 1983.\n\nAppendix S1 Existing Works on Deep Learning-Based Iteration-Free, Single-Shot Inverse Design\n\nThe three mainstream deep learning methods for iteration-free, single-shot metamaterial inverse design are direct inverse mapping, Tandem Neural Network (T-NN), and conditional generative models. Most prior works fall into one of the three categories or at the intersection of two categories. Here we give more details of each method. The direct inverse mapping approach (Fig. S1A) simply learns a one-to-one mapping from responses to designs. It fails to account for non-unique solutions of the inverse problem, which leads to conflicting labels (i.e., designs) for the same input (i.e., response) and hence causes training convergence issues.\n\nThe T-NN (Fig. S1B) was designed to solve this non-uniqueness issue. Its training is split into two steps: (1) pretraining the forward-modeling network to approximate the design-response mapping and (2) training the cascaded network by freezing the weights of the pretrained forward-modeling network. There is no loss function that forces designs at the intermediate layer to match data (which contains conflicting instances), hence the training convergence issue is avoided. However, the original T-NNs still learn a one-to-one response-design mapping and cannot generate multiple satisfying solutions. Variants of T-NN that learn one-to-many mappings are mentioned in the main text.\n\nThe conditional generative models (Fig. S1C) are the most common approach to learning a one-to-many mapping from responses to designs. Different generative models have distinct ways of learning conditional distributions. In general, this is realized by training neural networks to transform responses and random noise (or latent variables) into designs, so that the trained network can generate a non-deterministic design solution from a given target response and randomly sampled noise, which is equivalent to sampling from a conditional distribution.\n\nAppendix S2 Explanation of Step 2 in RIGID\n\nThe purpose of Step 2 is to obtain the intersection of relevant design space regions for all the ranges of s𝑠sitalic_s in a target. We are approximating this goal by simply obtaining the intersection of relevant leaves. However, some non-intersecting leaves may still have intersecting design space regions. When assigning the probability to the intersecting region of two non-intersecting leaves A𝐴Aitalic_A and B𝐵Bitalic_B, we need to consider the predicted probabilities at both leaves (PAsubscript𝑃𝐴P_{A}italic_P start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT and PBsubscript𝑃𝐵P_{B}italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT). Specifically, the assigned probability at this intersecting region should be PA⁢PBsubscript𝑃𝐴subscript𝑃𝐵P_{A}P_{B}italic_P start_POSTSUBSCRIPT italic_A end_POSTSUBSCRIPT italic_P start_POSTSUBSCRIPT italic_B end_POSTSUBSCRIPT, which can be small. Therefore, we adopt the simplification of only considering the intersection of relevant leaves and ignoring the intersecting regions associated with non-intersecting leaves. The results also demonstrate that this is a reasonable approximation.\n\nAppendix S3 Test Performance of Forward Prediction\n\nTest data for all the design problems are designs 𝐱𝐱\\mathbf{x}bold_x (that the random forests have never seen during training) and their corresponding qualitative behaviors y∈{0,1}𝑦01y\\in\\{0,1\\}italic_y ∈ { 0 , 1 } based on functional responses.\n\nIn the acoustic metamaterial design problem, we have 57 test designs, yielding 5,700 test points as the entire frequency range of dispersion relations is discretized into 100 intervals for each design. In the optical metasurface design problem, we have 52 test designs, with each functional response discretized into 33 points, which yields 1,716 test points in total. In each of the synthetic design problems, we have 20 synthetic test designs, with each synthetic response discretized into 100 points. This results in 2,000 test data points in total. Confusion matrices showing test performances are in Tables S1-S4.\n\nAppendix S4 Generated Designs and Corresponding Responses\n\nIn each of the acoustic and optical metamaterial design problems, we randomly created 10 design targets (i.e., frequency ranges within which bandgaps exist or wavelength ranges within which absorption is high). Given each design target, we generate multiple design solutions but only visualize five solutions having the highest likelihood values. The main text shows the five solutions for the first design target in each problem. Figures S2-S9 show the top solutions (ranked by likelihood) for the other design targets.\n\nWhile these limited examples cannot reveal the same degree of generalizable insights as the satisfaction rate and the average score do, they still offer an intuitive glimpse into the method’s performance and functionality. Most of these generated designs satisfy their corresponding targets. Some distinct designs can achieve the same target, demonstrating the capability of RIGID in solving the non-uniqueness issue of inverse design. For some targets, even the maximum likelihood of generated designs is extremely small (e.g., Target \\@slowromancapiv@ shown in the first row in Fig. S4), indicating small likelihood values across the entire design space. This can be owing to the difficulty of achieving the target under the limit of the design space. For example, all the top five generated designs for Target \\@slowromancapiv@ have a likelihood of 0.001. This means that the model believes satisfying the target is almost impossible, which may be due to the wide span of the combination of two target bandgaps. This difficulty may result from the limitation of the current design space. A larger design space can lead to a wider coverage of the response space and hence more likely to contain satisfactory solutions. Based on the estimated likelihood, we can decide whether expanding the design space (i.e., extending design space bounds or adding new design freedom) is necessary to discover satisfying solutions.\n\nAppendix S5 Investigation of Geometry Types in Generated Optical Metasurface Designs\n\nAlthough the generated metasurface designs with top likelihood values in the main text and Figs. S7-S9 do not contain the rectangular ring (c=1𝑐1c=1italic_c = 1) and the H-shaped (c=4𝑐4c=4italic_c = 4) types, both types were generated in our inverse design processes. Based on the histogram of 1,000 generated designs from all four geometry types (Fig. S10A), there is a relatively lower percentage of designs from the rectangular ring and the H-shaped types (the 1st and 4th types). The kernel density estimation (KDE) plot (Fig. S10B) shows that these two types have fewer high-likelihood designs compared to the other two types (the 2nd and 3rd types). This explains why they are absent from the examples of generated designs with top likelihood values shown in the main text and Figs. S7-S9. Regardless of the relatively lower likelihood values, there are satisfying designs from the rectangular ring and the H-shaped types. Some examples are shown in Fig. S11.\n\nThe low estimated likelihood can be caused by the model’s lack of belief regarding the possibility of the design meeting the target, and this belief stemmed from learning from the training dataset. Upon further investigation into our optical metasurface dataset, we found that the percentages of the high absorbance region (absorbance not less than the 0.9 threshold) within the considered wavelength range for the rectangular ring and the H-shaped geometry types are 29.5% and 18.8%, respectively, while the percentages for the other two types are above 80%. This may explain the model’s low confidence in believing the rectangular ring and the H-shaped geometry types satisfying the target, which further led to the low likelihood."
    }
}