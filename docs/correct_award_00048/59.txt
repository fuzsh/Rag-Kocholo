Herbert Hauptman, 94, who won the Nobel Prize in chemistry in 1985 for his work uncovering the structure of molecules, has died. He had worked into his 90s at the research institute in Buffalo that now bears his name. He recently had a stroke, a colleague said Monday.

Mr. Hauptman received the Nobel Prize nearly 40 years after setting out to solve a problem other scientists had given up on: how to determine molecular structures using X-ray crystallography. He used mathematical equations to interpret the patterns formed by X-rays scattered from crystals.

"All I had to hear was here was a problem that no one could solve. Not even that, but was even impossible to solve on principle," Mr. Hauptman said in a 2008 television documentary on his life. "Once I heard that, there was no letting go."

Born in New York City, Mr. Hauptman began his research at the Naval Research Laboratory in Washington but left for Buffalo during the Vietnam War after feeling pressured to develop anti-missile and other war-related technology, which he was morally opposed to after serving in the Navy during World War II.

In Buffalo, Mr. Hauptman continued his research at the Medical Foundation, which eventually became the Hauptman-Woodward Medical Research Institute in recognition of Mr. Hauptman's contributions, along with the Woodward family, which supported the work.