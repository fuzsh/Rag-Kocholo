{
    "id": "dbpedia_121_1",
    "rank": 20,
    "data": {
        "url": "https://www.wallstreetprep.com/knowledge/financial-modeling/",
        "read_more_link": "",
        "language": "en",
        "title": "Financial Modeling Guide",
        "top_image": "https://media.wallstreetprep.com/uploads/2017/01/26002826/What-is-Financial-Modeling.jpg",
        "meta_img": "https://media.wallstreetprep.com/uploads/2017/01/26002826/What-is-Financial-Modeling.jpg",
        "images": [
            "https://media.wallstreetprep.com/wspimage/wsp-logo-full.svg",
            "https://media.wallstreetprep.com/wspimage/wsp-logo-reverse.svg",
            "https://media.wallstreetprep.com/wspimage/Twitter.svg",
            "https://media.wallstreetprep.com/wspimage/LinkedIn.svg",
            "https://media.wallstreetprep.com/wspimage/Facebook.svg",
            "https://media.wallstreetprep.com/wspimage/Google.svg",
            "https://media.wallstreetprep.com/wspimage/wsp-meta-icon-link.svg",
            "https://media.wallstreetprep.com/uploads/2017/01/26002826/What-is-Financial-Modeling-960x540.jpg",
            "https://media.wallstreetprep.com/wspimage/wsp-logo-circle.svg",
            "https://media.wallstreetprep.com/uploads/2017/01/25234921/Financial-Model-Example.jpg",
            "https://media.wallstreetprep.com/uploads/2022/10/04164130/YouTube_FreeModelingCourseMatan.jpg",
            "https://media.wallstreetprep.com/wspimage/wsp-spinner.gif",
            "https://media.wallstreetprep.com/uploads/2017/01/18204754/fig-granularity.jpg",
            "https://www.wallstreetprepdev.com/learn-financial-modeling/wp-content/uploads/2017/01/fig-comments-1.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/16154805/fig-sign-convention1.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14091014/fig-partial-inputs.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14094831/fig-formula-consistency.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14094920/fig-roll-forward.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14090556/fig-revolver-if-1.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14090635/fig-revolver-min-1.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14090706/fig-revolver-if-2.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14090744/fig-revolver-min-2.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14090942/fig-reduce-date.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14094956/fig-balance-sheet.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14095027/fig-same-input.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14095111/fig-source-link.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14095206/fig-multiple-references.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14095244/fig-hide-rows.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14124156/fig-no-spacer.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14124243/fig-elevator-jumps.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14124331/fig-circularity-1.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14124356/fig-circularity-2.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14124612/fig-circularity-options.jpg",
            "https://media.wallstreetprep.com/uploads/2017/01/29173612/circuit-error.gif",
            "https://media.wallstreetprep.com/uploads/2017/01/29173613/circuitbreaker.gif",
            "https://media.wallstreetprep.com/uploads/2017/01/29173611/iferror.gif",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14124827/fig-error-checks.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14124904/fig-plugs.jpg",
            "https://s3.amazonaws.com/wspimage/learn-financial-modeling/wp-content/uploads/2017/01/14124941/fig-worksheet-designs.jpg",
            "https://media.wallstreetprep.com/wspimage/salesbanner_laptop_premium_cert_900.png",
            "https://media.wallstreetprep.com/uploads/2020/10/16110050/wsp-tile-ad-premium2.jpg",
            "https://media.wallstreetprep.com/wspimage/lifting.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [
            "Wall Street Prep"
        ],
        "publish_date": "2017-01-18T16:17:58+00:00",
        "summary": "",
        "meta_description": "Financial Modeling is a tool to understand and perform analysis on an underlying business to guide decision-making, usually built in Excel.",
        "meta_lang": "en",
        "meta_favicon": "https://www.wallstreetprep.com/learn-financial-modeling/wp-content/themes/wallstreetprep/favicon.ico",
        "meta_site_name": "Wall Street Prep",
        "canonical_link": "https://www.wallstreetprep.com/knowledge/financial-modeling/",
        "text": "What is Financial Modeling Used For?\n\nFinancial modeling is a tool to analyze a particular company’s historical performance and relevant market data on comparable companies operating in the same (or adjacent) industry to project its financial performance.\n\nBy forecasting the operating and financial performance of a company (or project), financial models are practical for various use-cases and guide decision-making, such as in the context of performing a valuation or capital budgeting analysis.\n\nThe following list contains the top ten most common types of financial models:\n\n3-Statement Model (Income Statement, Cash Flow Statement, Balance Sheet)\n\nDiscounted Cash Flow Analysis (DCF Model)\n\nComparable Company Analysis (Trading Comps Model)\n\nPrecedent Transactions Analysis (Transaction Comps Model)\n\nMerger Model (M&A Accretion/Dilution)\n\nLeveraged Buyout (LBO) Model\n\nInitial Public Offering (IPO) Model\n\nSum-of-the-Parts Model (SOTP Valuation)\n\nCapital Budgeting Model (Capital Investment Model)\n\nLender Model (Credit Risk Analysis)\n\nWhat are the Financial Modeling Best Practices?\n\nFinancial modeling best practices refer to industry-standard modeling conventions and tips to adhere to when building models in Excel.\n\nFollowing these general guidelines and industry best practices ensures that the financial models built on the job are intuitive, error-proof, and structurally sound.\n\nLike many computer programmers, people who build financial models can get opinionated about the “right way” to do it.\n\nIn fact, there is surprisingly little consistency across Wall Street around the structure of financial models.\n\nOne reason is that financial models can vary widely in purpose, which, along with the context of the analysis, determines the required level of granularity and structure of the model.\n\nFor example, if your task was to build a discounted cash flow (DCF) model to be used in a preliminary pitch book as a valuation for one of 5 potential acquisition targets, it would likely be a waste of time to build a highly complex and feature-rich model.\n\nThe time required to build a super complex DCF model isn’t justified, given the purpose of the financial model (and the context of the analysis).\n\nOn the other hand, a leveraged finance model used to make thousands of loan approval decisions for various loan types under various scenarios requires a lot of complexity.\n\nWhat are the Different Types of Financial Models?\n\nThe most common types of financial models include the following:\n\nType of Financial Model Description 3-Statement Model\n\nThe 3-statement model projects the operating and financial performance of a particular company using historical data, relevant industry data, and management guidance, among others.\n\nThe forecasted financial statements include the income statement, balance sheet (and supporting B/S schedules), and cash flow statement.\n\nDiscounted Cash Flow (DCF) Model\n\nThe DCF model is a method to estimate the intrinsic value of a company by projecting the free cash flow (FCF) generation of a company and discounting the FCFs to the present date using an appropriate discount rate.\n\nIn a two-stage, unlevered DCF analysis, the sum of the stage 1 cash flows (i.e. explicit forecast period) and the terminal value (TV) is the implied enterprise value (TEV) of the company.\n\nMerger Model (Accretion/Dilution Analysis)\n\nA merger model, or accretion/dilution analysis, is a model built to analyze the pro forma impact on the earnings per share (EPS) of an acquirer post-M&A.\n\nIn short, the purpose of a merger model is to determine whether a merger or acquisition is accretive or dilutive to EPS.\n\nIf the pro forma EPS of the combined entity exceeds the pre-transaction EPS, the deal is “accretive” – in contrast, the transaction is deemed “dilutive” if the pro forma EPS is less than the pre-transaction EPS.\n\nLeveraged Buyout (LBO) Model\n\nAn LBO model is used by private equity firms that engage in leveraged buyouts (LBOs), which are acquisitions of companies where a substantial percentage of the purchase price is funded by debt.\n\nThe LBO model determines the “floor valuation” of a potential investment, i.e. the maximum purchase price at which the PE firm can offer to acquire the target yet still meet its minimum return hurdle.\n\nThe output of an LBO analysis offers insights regarding the implied internal rate of return (IRR) and multiple on invested capital (MOIC)\n\nComparable Company Analysis (Trading Comps)\n\nThe trading comps model is a form of relative valuation, where the value of the target company is estimated by analyzing the valuation multiples of comparable companies (i.e. industry peers), which are most often competitors.\n\nThe process of conducting a trading comps analysis requires gathering the current valuation multiples of comparable companies and applying the mean or median to the target company’s metric.\n\nPrecedent Transactions Model (Transaction Comps)\n\nThe transaction comps model, similar to the trading comps model, is categorized as a method of relative valuation.\n\nBut rather than pricing a company based on the current trading multiples of comparable companies, the method estimates the value of a company based on the purchase prices paid by investors in recent M&A transactions.\n\nRestructuring Model\n\nThe core restructuring model values a distressed company in a two-fold process (Chapter 11 Reorganization vs. Liquidation Valuation Method).\n\nThe restructuring model estimates the value of a company on a “going concern” basis (post-reorganization) and then compares the valuation to the implied value of the liquidated assets belonging to the company.\n\nThe 13-week cash flow model (or TWCF) is a model prepared under cash-based accounting instead of accrual accounting to measure the near-term performance of a distressed company to quantify its short-term liquidity needs.\n\nCapital Investment Model\n\nA capital investment model is used as part of a capital budgeting analysis, where metrics such as the net present value (NPV), internal rate of return (IRR), and payback period are computed to decide whether to proceed with a project or not.\n\nCapital investment models are most often used internally by corporations to determine if a project is worth pursuing from an economic perspective and to guide their long-term strategic plans to achieve growth and scale.\n\nLender Credit Model\n\nCredit models are used by lenders to perform credit risk analysis on a specific borrower and request for debt capital.\n\nThe credit model will estimate the debt capacity of the borrower, gauge the risk of default, and determine the appropriate amount of debt to offer (i.e. debt sizing) based on the borrower’s risk profile.\n\nThe implied credit risk derived from the credit model is used not only to size the debt financing but also to set the terms appropriately, namely the interest rate, based on the risk undertaken by the lender.\n\nIn particular, the core 3-statement financial model is designed to better grasp the operating drivers of a given company and its business model.\n\nCreating a robust projection model requires analyzing a company’s historical performance and the relevant industry trends (and developments) to create a defensible 3-statement forecast, which underpins most valuation models (e.g. DCF analysis), strategic planning, and capital budgeting analyses.\n\nFinancial Modeling Example – Apple 3-Statement Model (Source: WSP Financial Modeling Course)\n\nFinancial Modeling Course – Excel Template\n\nBefore we delve into the financial modeling best practices and conventions – are you interested in learning how to build a basic 3-statement model in Excel?\n\nIf so, fill out the form below to access our free introductory financial modeling course, including the Excel template that goes along with the tutorial.\n\nBuild a 3-Statement Financial Model | Free Course\n\nFirst Name *\n\nEmail *\n\nEmail provided\n\nThanks!\n\nSubmitting...\n\nWhat are the Examples of Financial Modeling?\n\nUnderstanding the purpose of the model is key to determining its optimal structure. There are two primary determinants of a model’s ideal structure:\n\nGranularity\n\nFlexibility\n\nLet’s consider the following 5 common types of financial models built in corporate finance.\n\nFinancial Model Purpose Granularity Flexibility One Page DCF Model\n\nUsed in a buy-side pitch book to provide a valuation range for one of several potential acquisition targets.\n\nLow.\n\nBall-park valuation range is sufficient – the entire analysis can fit on one worksheet < 300 rows\n\nLow. Not reusable without structural modifications.\n\nWill be used in a specific pitch and circulated between just 1-3 deal team members.\n\nFully Integrated DCF Model\n\nUsed to value target company in a fairness opinion presented to the acquiring company board of directors\n\nMedium\n\nLow. Not reusable without structural modifications.\n\nWill be tailored for use in the fairness opinion and circulated between deal time members.\n\nComps Model\n\nUsed as the standard model by the entire industrials team at a bulge bracket bank\n\nMedium\n\nHigh. Reusable without structural modifications.\n\nA template to be used for a variety of pitches and deals by many analysts and associates, possibly other stakeholders.\n\nWill be used by people with varying levels of Excel skills.\n\nRestructuring Model (RX)\n\nBuilt specifically for a multinational corporation to stress test the impact of selling 1 or more businesses as part of a restructuring advisory engagement\n\nHigh\n\nMedium. Some re-usability but not quite a template.\n\nWill be used by both the deal team and counterparts at the client firm.\n\nLeveraged Finance Model (LevFin)\n\nUsed in the loan approval process to analyze loan performance under various operating scenarios and credit events\n\nHigh\n\nHigh. Reusable without structural modifications.\n\nA template to be used group-wide.\n\nHow to Structure a Financial Model\n\nComponent 1. Granularity in Financial Modeling\n\nOne critical determinant of a financial model’s structure is the concept of granularity.\n\nGranularity refers to how detailed a model needs to be. For example, imagine you are tasked with performing an LBO analysis for Disney.\n\nIf the purpose is to provide a back-of-the-envelope floor valuation range to be used in a preliminary pitch book, it might be appropriate to perform a “high-level” LBO analysis, using consolidated data and making very simple assumptions for financing.\n\nIf your model is a key decision-making tool for financing requirements in a potential recapitalization of Disney, a far higher degree of accuracy is crucial. The differences in these two examples might involve things like:\n\nForecasting revenue and cost of goods segment by segment, and using price-per-unit and #-units-sold drivers instead of aggregate forecasts\n\nForecasting financials across different business units, as opposed to looking only at consolidated financials\n\nAnalyzing assets and liabilities in more detail (i.e. leases, pensions, PP&E, etc.)\n\nBreaking out financing into various tranches with more realistic pricing\n\nLooking at quarterly or monthly results instead of annual results\n\nPractically speaking, the more granular a model, the longer and more difficult it will be to understand. In addition, the likelihood of errors increases exponentially by having more data.\n\nConcerning the importance of abiding by a consistent structure of a financial model — from the layout of the worksheets to the layout of individual sections, formulas, rows, and columns — the matter is particularly critical for in-depth, granular models.\n\nIn addition, integrating formal error and “integrity” checks can mitigate the risk of modeling errors.\n\nComponent 2. Flexibility in Financial Modeling\n\nThe other main determinant for how to structure a financial model is its required flexibility. A model’s flexibility stems from how often it will be used, by how many users, and for how many different uses. A model designed for a specific transaction or for a particular company requires far less flexibility than one designed for heavy reuse (often called a template).\n\nAs you can imagine, a template must be far more flexible than a company-specific or “transaction-specific model”. For example, say you are tasked with building a merger model.\n\nIf the purpose of the model is to analyze the potential acquisition of Disney by Apple, you would build in far less functionality than if its purpose was to build a merger model that could handle any two companies.\n\nSpecifically, a merger model template might require the following items that are not required in the deal-specific model:\n\nAdjustments to the Acquirer’s Currency\n\nDynamic Calendarization (Set Target’s Financials to Acquirer’s Fiscal Year)\n\nInsertion of Placeholders (Income Statement, Balance Sheet, and Cash Flow Statement)\n\nNet operating loss analysis (neither Disney or Apple have NOLs)\n\nThe placeholders are for the line items that do not appear on Disney or Apple financials\n\nPut together, granularity and flexibility largely determine the structural requirements in financial modeling.\n\nStructural requirements for models with low granularity and a limited user base are quite low.\n\nThere is a trade-off to building a highly structured model per usual, which boils down to time.\n\nIn short, simply don’t if you don’t need to build in bells and whistles\n\nBut as you add granularity and flexibility into the model, structure and error-proofing become increasingly critical.\n\nThe table below shows the granularity and flexibility levels of common investment banking models.\n\nHigh Flexibility Low Flexibility High Granularity\n\nLeveraged finance credit model\n\nMerger model template “one size fits all”\n\nIntegrated LBO model\n\nIntegrated DCF model\n\nIntegrated Merger Model\n\nIntegrated operating model\n\nLow Granularity\n\nTrading comps template\n\nTransaction comps template\n\n“Back of the envelope” accretion/dilution model\n\nDCF “one-pager”\n\nLBO “one-pager”\n\nSimple operating model\n\nWhat is the Purpose of Financial Modeling?\n\nBefore building a financial model, the first step must be to understand the purpose of the analysis and end-goal.\n\nA financial model is a tool designed to aid decision-making, irrespective of its granularity and flexibility.\n\nTherefore, a proper financial model must have a presented output and conclusion, which should be intuitive and easy to understand.\n\nFor instance, if an investment banking analyst submits a valuation model to their direct supervisor, or an associate, the process of auditing the model should be relatively easy, assuming the model was built properly and abides by the standard modeling best practices and industry conventions.\n\nOtherwise, the associate is likely to be frustrated because auditing the model is time-consuming and the “flow” of the model is difficult to comprehend.\n\nWhile constructing a financial model, constantly remind yourself that another person will soon review your work.\n\nSince virtually all financial models will help decision-making within various assumptions and forecasts, an effective model will allow users to easily modify and sensitize various scenarios and present information in various ways.\n\nHow to Format a Financial Model\n\nThus far, we’ve established a simple framework for structuring models, so it is now time to discuss specific features of model architecture, error proofing, flexibility, and presentation, where we’ll lay out the key elements of an effectively structured model.\n\nIn particular, these best practices and industry conventions will go a long way to improving the transparency of the model.\n\nAs a financial model becomes more complex – due to higher granularity and flexibility – the model naturally becomes less transparent.\n\nThe financial modeling best practices and practical tips described in the next sections will help fix this, starting with the following guidelines around formatting financial models.\n\nGuidelines for Color Coding in Financial Modeling\n\nJust about everyone agrees that color-coding cells based on whether the cell contains a hard-coded number or a formula are critical. Without color coding, it is extremely difficult to visually distinguish between cells that should be modified and cells that should not (i.e. formulas).\n\nA properly built financial model will further distinguish between formulas that link to other worksheets and workbooks, as well as cells that link to financial data services, like Capital IQ and FactSet.\n\nWhile different investment banks have different house styles, blue is typically used to color inputs, and black is used for formulas (or calculations).\n\nThe table below shows our recommended color coding scheme.\n\nCell Type Excel Formula Color Scheme Hard-Coded Numbers (Inputs) =1234 Blue Formulas (Calculations) =A1*A2 Black Links to Other Worksheets =Sheet2!A1 Green Links to Other Files =[Book2]Sheet1!$A$1 Red Links to Data Providers (e.g. CIQ, FactSet) =CIQ(IQ_TOTAL_REV) Dark Red\n\nWhile everyone agrees that color coding is important, keeping up with it can be a pain in native Excel. It’s not easy to format cells based on whether they are inputs or formulas, but it can be done. One option is to use Excel’s “Go To Special”.\n\nAlternatively, color coding is dramatically simplified with a third-party Excel add-in like Capital IQ or Factset.\n\nThese tools allow you to “auto-color” an entire worksheet in one click.\n\nHow to Make Financial Models Easier to Audit\n\nInserting comments (Shortcut “Shift F2”) in cells is critical for footnoting sources and adding clarity to data in a model.\n\nFor example, a cell with an assumption of revenue growth from an equity research report should include a comment regarding the research report.\n\nSo how much commenting do you need?\n\nAlways err on the side of over-commenting.\n\nNo managing director (MD) at an investment bank will complain that a financial model contains too many comments.\n\nConversely, a financial model with inputs and calculations, where the rationale is not straightforward to understand, is prone to criticism.\n\nAdditionally, if you’re on a conference call and someone asks how you came up with the number in cell AC1238, and you are not sure, you’ll regret not commenting.\n\nWhat are the Sign Convention Rules in Financial Modeling?\n\nThe decision on whether to use positive or negative sign conventions must be made before the model is built.\n\nModels in practice are all over the place on this one. The modeler should choose from and clearly identify one of the following 3 approaches:\n\nConvention 1. Income = Positive; Expenses = Negative\n\nAdvantage: logical, consistent, makes subtotal calculations less error-prone\n\nDisadvantage: Doesn’t align with conventions used by public filings, % margin calculations appear negative\n\nConvention 2. Expenses Positive; Non-Operating Income Negative.\n\nAdvantage: Consistent with public filings, % margin calculations appear positive\n\nDisadvantages: Negative non-operating income is confusing, subtotal calculations are error-prone, proper labeling is critical\n\nConvention 3. Expenses Positive (Except Non-Operating Expenses)\n\nAdvantage: Avoids negative non-operating income presentation; margins evaluate to positive\n\nDisadvantage: Presentation not internally consistent. Proper labeling is critical.\n\nOur recommendation is Convention 1. The reduced likelihood of error from easier subtotaling alone makes this our clear choice. In addition, one of the most common mistakes in modeling is forgetting to switch the sign from positive to negative, or vice versa when linking data across financial statements. Convention 1, by virtue of being the most visibly transparent approach, makes it easier to track sign-related mistakes.\n\nHow to Maintain Consistency in Financial Modeling\n\nHard-coded numbers (constants) should never be embedded into a cell reference.\n\nThe danger here is that you’ll likely forget there is an assumption inside a formula. Inputs must be separated from calculations.\n\nMost investment banking models, like the 3-statement model, rely on historical data to drive forecasts.\n\nFinancial data should be presented from left to right. The right of the historical columns are the forecast columns. Hence, the left section font color is blue, while the projection section on the right is black.\n\nWhile building a financial model in Excel, remember the rule: “One Row, One Calculation”.\n\nThe formulas in the forecast columns should be consistent across the row.\n\nHow to Ensure Simplicity in Financial Models (“BASE”)\n\nIn financial modeling, roll-forward schedules (“BASE” or “Cork-Screw”) refer to a forecasting approach that connects the current period forecast to the prior period.\n\nThis approach is useful in adding transparency to how schedules are constructed. Maintaining strict adherence to the roll-forward approach improves a user’s ability to audit the model and reduces the likelihood of linking errors.\n\nThere is a temptation when working in Excel to create complicated formulas.\n\nWhile it may feel good to craft a super complex formula, the obvious disadvantage is that no one – including the author after being away from the model for a bit – will understand it.\n\nBecause transparency should drive structure, complicated formulas should be avoided at all cost. A complicated formula can often be broken down into multiple cells and simplified. Remember, Microsoft doesn’t charge you extra for using more cells! So take advantage of that. Below are some common traps to avoid:\n\nSimplify IF statements and avoid nested IFs\n\nConsider using flags\n\nFor instance, “IF” statements in financial models – while intuitive and well understood by most Excel users – can become long and difficult to audit.\n\nThere are several excellent alternatives to IF that top-notch modelers frequently use. They include using Boolean logic along with various reference functions, including MAX, MIN, AND, OR, VLOOKUP, HLOOKUP, and OFFSET.\n\nBelow is a real-world example of how an IF statement can be simplified. Cell F298 uses any surplus cash generated during the year to pay down the revolver, up until the revolver is fully paid down.\n\nHowever, if deficits are generated during the year, we want the revolver to grow. While an IF statement accomplishes this, a MIN function does it more elegantly:\n\nExample 1. Revolver Formula Using IF Statement\n\nExample 2. Revolver Formula Using Excel MIN Function\n\nThe revolver formula using MIN as an alternative to IF also holds up better when additional complexity is required. Imagine there’s a limit on the annual revolver draw of $50,000. Look at how we have to modify both formulas to accommodate this:\n\nExample 3. Revolver Formula Using IF Statement (Modified)\n\nExample 4. Revolver Formula Using Excel MIN and MAX Function\n\nWhile both formulas are challenging to audit, the formula using IF statements is more difficult to audit and is more vulnerable to getting completely out of hand with additional modifications. It uses nested (or embedded) IF statements, with which our feeble human brains have a hard time once there are more than one or two.\n\nFortunately, Excel has made this a bit easier in 2016 with the introduction of the IFS function, but our preference for relying on more elegant functions remains.\n\nFlags refer to a modeling technique most useful for modeling transitions across phases of a company, project or transaction over time, without violating the “one row/one calculation” consistency rule.\n\nImagine you’re building a model for a company contemplating bankruptcy. Each phase of the restructuring process has its own distinct borrowing and operating characteristics.\n\nIn our example below, the company’s revolver “freezes” once it goes into bankruptcy, and a new type of borrowing (“DIP”) acts as the new revolver until the company emerges from bankruptcy.\n\nAdditionally, a new “Exit” facility replaces the DIP. We insert 3 “flags” in rows 8-10 to output “TRUE/FALSE” based on the phase we’re in. This enables us to build very simple, consistent formulas for each revolver, without having to embed IF statements into each calculation.\n\nIn cell F16, the formula is =F13*F8. Whenever you apply an operator (like multiplication) on a TRUE, the TRUE is treated like a “1” while a FALSE is treated like a “0.” This means the pre-bankruptcy revolver is the de facto revolver when the pre-bankruptcy flag evaluates to TRUE and becomes 0 once the flag evaluates to FALSE (starting in column I in our example below).\n\nThe main benefit is that with the use of just an extra 3 rows, we’ve avoided having to insert any sort of conditional tests within the calculations. The same applies to the formulas in rows 20 and 204 — the flags have prevented a lot of extra code.\n\nHow to Name Cells and Ranges\n\nAnother way many modelers reduce formula complexity is by using names and named ranges.\n\nThat said, we strongly caution against using names and named ranges.\n\nWhy? As you’re probably beginning to sense, there is always some sort of trade-off with Excel. In the case of names, the trade-off is that when you name a cell, you no longer know exactly where it is without going to the name manager.\n\nIn addition, unless you are proactively deleting names (you aren’t), Excel will retain these names even when you delete the named cell. The result is that a file you’re using today to build a DCF contains dozens of phantom names from previous versions of the model, leading to warning messages and confusion.\n\nWhat are Common Mistakes in Financial Modeling?\n\nDo Not Calculate on the Balance Sheet – Link from Supporting Schedules Instead\n\nIn investment banking, your financial models frequently involve financial statements. Ideally, your calculations are done in schedules separate from the output you’re working towards.\n\nFor example, you shouldn’t perform any direct calculations on the model’s balance sheet.\n\nInstead, balance sheet forecasts should be determined in separate schedules and linked to the balance sheet, as illustrated below.\n\nThis consistency enhances transparency in the model, making it easier to audit.\n\nNever Re-Enter the Same Input in Different Cells\n\nFor example, if you’ve inputted a company name in the first worksheet of the model, reference that worksheet name — don’t re-type it into the other worksheets.\n\nThe same goes for years and dates entered into a column header or discount rate assumptions used in various places in the model.\n\nA more subtle example of this is hard coding subtotals or EPS when you can calculate it. In other words, calculate whenever possible.\n\nAlways Link Directly to a Source Cell – Easier to Audit “Daisy Chained” Data\n\nThe one major exception is when “straight-lining” base period assumptions.\n\nFor this, go ahead and daisy chain. The reason is that straight-lining base period assumptions are an implicit assumption, that can change, making it possible for certain years in the forecast to ultimately end up with different assumptions than other years.\n\nAvoid Formulas Containing References to Multiple Worksheets\n\nCompare the two images below – it is far more difficult to audit the formula in the first image because you’ll need to bounce around to different worksheets to view the precedent cells.\n\nTherefore, bring the data from other worksheets into the active worksheet where the calculation is made whenever possible.\n\nLink Assumptions into Standalone Cells in the Calculation and Output Sheets\n\nIf you’re working with larger models and have assumptions that need to be referenced from a separate worksheet, consider linking assumptions directly into the worksheet where you’re using them, and color code them as a distinct worksheet reference link.\n\nIn other words, don’t have an input reference embedded into a calculation (i.e. =D13*input!C7).\n\nInstead, use a clean reference =input!C7 and a separate cell for the calculation. While this creates a redundant cell reference, it preserves the visual auditability of the model tab and reduces the likelihood of error.\n\nAvoid Linking External Files\n\nExcel allows you to link to other Excel files, but others might not have access to the linked-to files, or these files may get inadvertently moved.\n\nTherefore, avoid linking to other files whenever possible.\n\nIf linking to other files is necessary, be vigilant about color-coding all cell references to other files.\n\nOne Sheet vs. Multiple Sheet Financial Model: Which is Better?\n\nIn short, a financial model presented on a single long sheet is preferable over many short sheets.\n\nA long worksheet means a lot of scrolling and less visual compartmentalizing of sections.\n\nOn the other hand, multiple worksheets significantly increase the likelihood of linking errors.\n\nThere’s no hard and fast rule about this, but the general bias should be toward a longer sheet over multiple, shorter worksheets.\n\nThe dangers of mis-linking across worksheets are quite real and hard to mitigate, while the issues of cumbersome scrolling and lack of compartmentalization associated with long worksheets can be drastically mitigated with Excel’s split screen functionality, clear headers, and links from a cover sheet or table of contents.\n\nWhy Group Rows Instead of Hiding Them?\n\nAs a general financial modeling best practice, do not hide rows. Instead, group the rows (and do it sparingly).\n\nA model often has rows with data and calculations that you do not want to show when the model is printed or when you paste the data into a presentation. In this situation, it’s often tempting to hide rows and columns for a “cleaner” presentation of results.\n\nThe danger is that when the model is passed around, it is very easy to miss (and potentially paste over) the hidden data.\n\nHow to Structure a Financial Model\n\nIn short, group the inputs (i.e. the assumptions) that drive the financial model together in one section.\n\nNearly every financial modeling expert recommends a standard that isolates all of the model’s hard-coded assumptions (things like revenue growth, WACC, operating margin, interest rates, etc…) in one clearly defined section of a model — typically on a dedicated tab called “Inputs”.\n\nThese should never be commingled with the model’s calculations (i.e. balance sheet schedules, financial statements) or outputs (i.e. credit and financial ratios, charts and summary tables).\n\nIn other words, think of a model comprised of three clearly identified and physically separated components:\n\nAssumptions → Calculations → Output\n\nThe advantages of using one sheet are as follows.\n\nConsistent, reliable architecture: Once a model is built, the user has only one place to go to change any assumptions. This creates a consistent distinction between areas in the model that the user works in vs. areas the computer works in.\n\nError mitigation: Storing all assumptions in one place makes it far less likely that you’ll forget to remove old assumptions from a prior analysis and inadvertently bring them into a new analysis.\n\nYet despite these advantages, this practice has never been widely adopted in investment banking.\n\nOne reason is simply poor practice. Some models would benefit from an input/calculation/output separation but are often built with no forethought given to structure. Imagine building a house without any pre-planning.\n\nSure, you’ll avoid the pain of all that planning, but you’ll encounter unforeseen problems and end up redoing work or adding complexity by working around what’s already been done. This problem is rampant in investment banking models.\n\nAnother reason is that many investment banking models are simply not granular enough to merit the additional audit trail and legwork.\n\nThe analyses bankers perform are often broader than in-depth, at least initially.\n\nFor example, a pitch book might present a valuation using 4 different valuation models, but none of them will be overly granular.\n\nCommon investment banking analyses like accretion dilution models, LBO models, operating models, and DCF models usually don’t delve into detail beyond the limits of public filings and basic forecasting. In this case, moving back and forth from input to calculation to output tabs is unnecessarily cumbersome.\n\nAs long as you’re diligent about color coding, placing assumptions on the same sheet and right below calculations is preferable in smaller models, because your assumptions are visually right next to the output, making it easy to see what’s driving what.\n\nThe other consideration is the number of users of a model. The advantages of the “inputs together” approach grow with the number of intended users of a model. When you have many users, your model will inevitably be used by people with a wide range of modeling proficiency.\n\nIn this case, a consistent and reliable structure that prevents users from getting into the guts of the model will reduce error. In addition, it will also reduce the time a user spends in the model.\n\nA user can simply locate the area for inputs, fill them in, and the model (in theory) will work.\n\nThat said, despite attempts by IB teams to standardize models, many investment banking models are essentially “one-offs” that get materially modified for each new use.\n\nApart from comps models, which are becoming templates, most models are used primarily by their original authors (usually an analyst and associates) who understand the model well.\n\nThe bottom line on keeping inputs all together: Unfortunately, there’s no established benchmark for when it makes sense to separate assumptions. The ideal approach depends on the scope and goal of the model.\n\nFor a simple 1-page discounted cash flow analysis not intended for frequent reuse, it is preferable to embed inputs throughout the page.\n\nHowever, for a large fully integrated LBO model with many debt tranches to be used as a group-wide template, the benefits of keeping all inputs together will outweigh the costs.\n\nNo Spacer Columns Between Data\n\nElevator Jumps\n\nIn long worksheets, dedicating the leftmost column to placing an “x” or another character at the start of schedules will make it easy to quickly navigate from section to section.\n\nAnnual vs. Quarterly Model: How to Adjust for Periodicity\n\nMost investment banking models are either quarterly or annual. For example, a U.S. equity research earnings model will always be a quarterly model because one of its key purposes is to forecast upcoming earnings, which are reported by firms quarterly.\n\nSimilarly, a restructuring model is usually a quarterly model (or even a monthly or weekly model) because a key purpose of this model is to understand the cash flow impact of operational and financing changes over the next 1-2 years.\n\nOn the other hand, a DCF valuation is a long-term analysis, with at least 4-5 years of explicit forecasts required. In this case, an annual model is appropriate.\n\nThere are also models for which both quarterly and annual periods are useful. For example, a merger model usually needs a quarterly period, because a key goal is to understand the impact of the acquisition on the acquirer’s financial statements over the next 2 years.\n\nHowever, attaching a DCF valuation to the combined merged companies may also be desirable. In this case, a possible solution is to roll up the quarters into an annual model and extend those annual forecasts further out.\n\nWhen determining a model’s periodicity, remember the following:\n\nThe model must be set up with the smallest unit of time desired, with longer periods aggregated (“rolled up”) from those shorter periods. If you’re building an integrated financial statement model in which you want quarterly and annual data, forecast the quarterly data first.\n\nKeep the quarterly and annual data in separate worksheets. It is easier to audit what’s going on when periods aren’t commingled. Additionally, commingling quarterly and annual data in one worksheet will either A) force you to violate the one row/one formula consistency best practice, or B) you will have to jump through some crazy hoops to maintain the consistency.\n\nHow to Handle Circular References in Financial Modeling\n\nCircularity refers to a cell referring to itself (directly or indirectly). Usually, this is an unintentional mistake. In the simple example below, the user accidentally included the sum total (D5) in the sum formula. Notice how Excel becomes confused:\n\nBut sometimes a circularity is intentional.\n\nFor example, if a model calculates a company’s interest expense based on a cell that calculates the company’s revolving debt balance, but that revolving debt balance is itself determined by (among other things) the company’s expenses (including interest expense), then we have a circularity.\n\nThe logic of such a calculation is sound: A company’s borrowing needs should take into account the interest expense. As such, many investment banking models contain intentional circularities like these.\n\nSince unintentional circularity is a mistake to avoid, the usage of intentional circularity in financial models is controversial.\n\nThe problem with intentional circularity is that a special setting must be selected within ‘Excel Options’ to prevent Excel from misbehaving when a circularity exists:\n\nEven with these settings selected, Excel can become unstable when handling circularity and often leads to a model “blowing up” (i.e. the model short-circuits and populates the spreadsheet with errors), requiring manual intervention to zero out the cells containing the source of circularity:\n\nWhile the underlying logic for wanting to incorporate a circularity into a model may be valid, circularity problems can lead to minutes, if not hours, of wasted auditing time trying to locate the source(s) of circularity to zero them out.\n\nThere are several things modelers can do to better cope with circularity, most notably the creation of a simple circuit breaker, which creates a central place in the model that “resets” any cell containing a circularity, or wrapping an error-trap formula (IFERROR Excel Function) around the formula that is the source of the circularity.\n\nIFERROR Error-Trap\n\nWhen building an intentional circularity, you MUST build a circuit breaker and identify all the circularities in your model.\n\nIn our simple example, we placed a circuit breaker in D17 and altered the formula in D8 so the circularity is zeroed out when the user switches the breaker to “ON”.\n\nApproach 1. Adding a Circuit Breaker Toggle\n\nAn alternative approach is to simply wrap an IFERROR function around the source of the circularity.\n\nWhen the model short circuits, the IFERROR function evaluates to the FALSE condition and populates the model with 0s automatically.\n\nThe primary downside to this approach is that it makes finding unintentional circularities harder. That’s because you can never explicitly turn the breaker on or off – the IFERROR does it automatically.\n\nThat said, as long as all circs are handled with an IFERROR function, the model will never blow up.\n\nApproach 2. Add an Error Trap Using the IFERROR Function\n\nBottom Line: To Circ or Not to Circ?\n\nDespite the circuit breaker and error trap solutions, many believe it is preferable to simply outlaw all circularity from financial models.\n\nFor example, the way to avoid intentional circularities in the example above is to calculate interest expense using the beginning debt balance.\n\nFor quarterly and monthly models with minor debt fluctuations, this is desirable, but for an annual model with a large forecasted change in debt, the “fix” can lead to a materially different result.\n\nTherefore, we do not believe in a blanket “ban.” Instead, we provide the following simple guidelines:\n\nCircularities in Excel are only “OK” if all the following conditions are met.\n\nIntentional Circularity → At the risk of stating the obvious, you must understand exactly why, where, and how the circularity exists. The example above is the most common source of circularity in financial models.\n\nYou have “enable iterative calculation” selected in your Excel settings → This tells Excel the circularity is intentional, and ensures Excel doesn’t throw up an error and populates the entire model with random zeros everywhere.\n\nYou have a circuit breaker or error trap formula → A circuit breaker or error trap formula ensures that if the file gets unstable and #DIV/0!s starts populating the model, there is an easy and clear way to fix it.\n\nThe model will not be shared with Excel novices → Circularities, even with a circuit breaker, can create confusion for Excel users unfamiliar with it. If the model you are building will be shared with clients (or a managing director) who like to get into the model but are generally unfamiliar with Excel, avoid the circularity and save yourself the headache.\n\nDon’t Use Macros (or Limit Usage)\n\nKeep the use of Excel macros to an absolute bare minimum.\n\nVery few people know how macros work, and some users cannot open files that use macros.\n\nEvery additional macro is a step closer to making your model a “black box.”\n\nIn investment banking, this is never a good thing. The only macros regularly tolerated in banking models are print macros.\n\nHow to Error-Proof a Financial Model\n\nStandardize the Format in Financial Modeling\n\nUnlike software specifically designed to perform a particular set of tasks (i.e. real estate investment software, bookkeeping software), Excel is a blank canvas, which makes it easy to perform extremely complicated analyses and quickly develop invaluable tools to help in financial decision-making.\n\nThe downside here is that Excel analyses are only as good as the model builder (i.e. “Garbage in = garbage”). Model errors are rampant and have serious consequences.\n\nLet’s break up the most common modeling errors:\n\nPoor Assumptions: If your assumptions are faulty, the model’s output will be incorrect regardless of how well it is structured.\n\nPoor Structure: Even if your model’s assumptions are great, mistakes in calculations and structure will lead to incorrect conclusions.\n\nThe key to mitigating #1 is to present results with clearly defined ranges of assumptions (scenarios and sensitivities) and make the assumptions clearly defined and transparent.\n\nStandardizing financial models into the Inputs → Calculation → Output format helps others quickly identify and challenge your assumptions, which were addressed in detail in the “Presentation” section above.\n\nThe far more pernicious modeling error is #2 because it’s much more difficult to find. As you might imagine, the problem grows exponentially as the model’s granularity increases. Hence, building error checks into your financial model is a critical part of model building.\n\nBuilt-In Error Checks\n\nThe most common error check in a financial model is the balance check – a simple formula to confirm the accounting equation is true (and the balance sheet is in fact “balanced”)\n\nAssets = Liabilities + Shareholders’ Equity\n\nIf the balance sheet does not “balance,” a past error or mistake was made that must be promptly identified and fixed, such as a cell reference that links to the wrong cell or an incorrect sign convention.\n\nAnyone who has built an integrated financial statement model knows it is quite easy to make a simple mistake that prevents the model from balancing.\n\nThe balance check clearly identifies to the user that a mistake has been made and further investigation is required.\n\nHowever, there are many other areas of models that are prone to error and thus could merit error checks.\n\nWhile every model will need its own checks, some of the more common ones include:\n\nEnsuring sources of funds = uses of funds\n\nEnsuring quarterly results add up to annual results\n\nTotal forecast depreciation expense does not exceed PP&E\n\nDebt pay-down does not exceed the outstanding principal\n\nFavor Direct Calculations over “Plugs”\n\nIn the next section, we’ll illustrate two common methods that users often use to set up sources & uses of funds tables in financial models.\n\nIn both approaches, the user accidentally references intangible assets.\n\nApproach 1 → In approach 1, the incorrect data is linked to D37. The model notices that sources do not equal uses and throws an error message in D41.\n\nApproach 2 → The second (and equally common) approach structurally sets D52 equal to D47 and uses D49 as a plug to ensure that sources and uses are always equal. Which approach do you think is preferable? If you guessed the first approach, you are correct.\n\nThe problem with the second (“plug”) approach is that because of the mis-linking in D50, the model incorrectly calculates the amount of secured loans required for the transaction, and no error is identified.\n\nWhenever a direct calculation is possible, use it, along with an error check (i.e. “do sources equal uses?”) instead of building plugs.\n\nAggregate Error Checks into One Area\n\nPlace error checks close to where the relevant calculation is taking place, but aggregate all error checks into a central easy-to-see “error dashboard” that clearly shows any errors in the model.\n\nError Trapping to Reduce Mistakes\n\nModels that require a lot of flexibility (templates) often contain areas that a user may not need now, but will need down the road. This includes extra line items, extra functionality, etc.\n\nThis creates room for error because Excel is dealing with blank values. Formulas like IFERROR (and ISERROR), ISNUMBER, ISTEXT, and ISBLANK are all useful functions for trapping errors, especially in templates.\n\nIndustry Guidelines on Presentability and Design\n\nCover Page and Table of Contents (TOC)\n\nWhen a model is designed for use by more than just the model builder, include a cover page. The cover page should include:\n\nCompany and/or project name\n\nDescription of the model\n\nModeler and team contact information\n\nInclude a table of contents when the model is sufficiently large to merit it (a good rule of thumb is more than 5 worksheets).\n\nWorksheet Design\n\nLabel worksheets by the nature of the analysis (i.e. DCF, LBO, FinStatements, etc…). Tabs should flow logically from left to right. When following the inputs→calculations→output approach, color the worksheet tabs based on this division:\n\nQuick Tips\n\nInclude the company name on the top left of every sheet\n\nInclude the sheet purpose, scenario selected (when relevant), scale, and currency prominently below the company name on each sheet\n\nPage setup for printing: When a sheet is too long to fit on one page, the top rows containing company name, purpose of the page, currency, and scale should be displayed on top of each page (select “rows to repeat at top” (Page Layout>Page Setup>Sheet)\n\nInclude file path, page number, and date in the footer\n\nHow to Integrate Scenario and Sensitivity Analysis\n\nThe purpose of building a financial model is to provide actionable insights that were otherwise not readily visible.\n\nFinancial models shed light on various critical business decisions:\n\nHow does an acquisition change the financial statements of an acquirer (accretion/dilution)?\n\nWhat is a company’s intrinsic value?\n\nHow much should an investor contribute to a project, given specified return requirements and risk tolerances?\n\nVirtually all investment banking models rely on forecasting and assumptions to arrive at the outputs presented to clients.\n\nBecause assumptions are by definition uncertain, presenting the financial model’s output in ranges and based on various scenarios and sensitivities is critical."
    }
}