{
    "id": "dbpedia_4377_3",
    "rank": 50,
    "data": {
        "url": "https://www.nature.com/articles/s43247-024-01496-3",
        "read_more_link": "",
        "language": "en",
        "title": "Climate change-resilient snowpack estimation in the Western United States",
        "top_image": "https://media.springernature.com/m685/springer-static/image/art%3A10.1038%2Fs43247-024-01496-3/MediaObjects/43247_2024_1496_Fig1_HTML.png",
        "meta_img": "https://media.springernature.com/m685/springer-static/image/art%3A10.1038%2Fs43247-024-01496-3/MediaObjects/43247_2024_1496_Fig1_HTML.png",
        "images": [
            "https://pubads.g.doubleclick.net/gampad/ad?iu=/285/commsenv.nature.com/article&sz=728x90&c=-330339425&t=pos%3Dtop%26type%3Darticle%26artid%3Ds43247-024-01496-3%26doi%3D10.1038/s43247-024-01496-3%26subjmeta%3D106,125,242,2786,2805,694,704,706%26kwrd%3DCryospheric+science,Hydrology,Projection+and+prediction,Water+resources",
            "https://media.springernature.com/full/nature-cms/uploads/product/commsenv/header-0cc262da52be1456137714e0f094052a.svg",
            "https://media.springernature.com/w215h120/springer-static/image/art%3A10.1038%2Fs41558-020-0754-8/MediaObjects/41558_2020_754_Fig1_HTML.png",
            "https://media.springernature.com/w215h120/springer-static/image/art%3A10.1038%2Fs41597-022-01768-7/MediaObjects/41597_2022_1768_Fig1_HTML.png",
            "https://media.springernature.com/w215h120/springer-static/image/art%3A10.1038%2Fs41467-019-12566-y/MediaObjects/41467_2019_12566_Fig1_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs43247-024-01496-3/MediaObjects/43247_2024_1496_Fig1_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs43247-024-01496-3/MediaObjects/43247_2024_1496_Fig2_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs43247-024-01496-3/MediaObjects/43247_2024_1496_Fig3_HTML.png",
            "https://media.springernature.com/lw685/springer-static/image/art%3A10.1038%2Fs43247-024-01496-3/MediaObjects/43247_2024_1496_Fig4_HTML.png",
            "https://pubads.g.doubleclick.net/gampad/ad?iu=/285/commsenv.nature.com/article&sz=300x250&c=852762182&t=pos%3Dright%26type%3Darticle%26artid%3Ds43247-024-01496-3%26doi%3D10.1038/s43247-024-01496-3%26subjmeta%3D106,125,242,2786,2805,694,704,706%26kwrd%3DCryospheric+science,Hydrology,Projection+and+prediction,Water+resources",
            "https://www.nature.com/static/images/logos/sn-logo-white-ea63208b81.svg",
            "https://www.nature.com/static/images/logos/nature-briefing-anthropocene-logo-98e871be64.svg",
            "https://verify.nature.com/verify/nature.png",
            "https://www.nature.com/y5evuc49/article/s43247-024-01496-3"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": "2024-06-18T00:00:00",
        "summary": "",
        "meta_description": "In the 21st century, warmer temperatures and changing atmospheric circulation will likely produce unprecedented changes in Western United States snowfall1–3, with impacts on the timing, amount, and spatial patterns of snowpack4–7. The ~900 snow pillow stations are indispensable to water resource management by measuring snow-water equivalent (SWE)8,9 in strategic but fixed locations10,11. However, this network may not be impacted by climate change in the same way as the surrounding area12 and thus fail to accurately represent unmeasured locations; climate change thereby threatens our ability to measure the effects of climate change on snow. In this work, we show that maintaining the current peak SWE estimation skill is nonetheless possible. We find that explicitly including spatial correlations—either from gridded observations or learned by the model—improves skill at predicting distributed snowpack from sparse observations by 184%. Existing artificial intelligence methods can be useful tools to harness the many available sources of snowpack information to estimate snowpack in a nonstationary climate. Statistical models that bring together in situ measurements and open-source satellite reanalysis are necessary to maintain the current level of snow water equivalent estimation skill under future warming and circulation changes in the Western USA.",
        "meta_lang": "en",
        "meta_favicon": "/static/images/favicons/nature/apple-touch-icon-f39cb19454.png",
        "meta_site_name": "Nature",
        "canonical_link": "https://www.nature.com/articles/s43247-024-01496-3",
        "text": "Snow and snow pillow sensitivity to climate change\n\nThe ability of the snow pillow networks to represent unobserved snowpack will be increasingly impacted by changing snow, precipitation, and temperature. Figure 2 shows how those impacts are expected to manifest.\n\nFigure 2a indicates the expected year at which the 918 snow pillow stations in the WUS (excluding Alaska) will exhibit substantial degradation in peak SWE sensitivity. The metric of degradation is when the peak SWE at that station is <10% of its 1980–2015 average for more than 5 of the previous 10 years, which is based on an existing percentile-based low-to-no-snow definition2 but better-suited to locations with low interannual variability within the baseline period. Figure 2b shows that the lower elevations (below 2000 masl) will become increasingly snow-free by mid-century, while the higher elevations will become snow-free later in the century. Figure 2c–h shows the rising snowline elevation at several basins across the West in three decades: 1980–90, 2050–60, and 2090–2100.\n\nFinally, Fig. 2h–l highlights the long-term decline in snow pattern repeatability (shown in black and quantified with average R2 between current-year normalized SWE and the previous 20 years of the same, see the “Methods” section for details) from 2000 to 2100, punctuated by years with far less pattern repeatability than the historical average. Across the ensemble of simulations, future years are predicted to contain different within-basin snow patterns relative to the recent past; in other words, the interannual variability in spatial SWE patterns is predicted to increase. Furthermore, Fig. 2h–l shows that the high level of peak SWE interannual pattern repeatability33 found in the historical record34,35 is expected to decline, but at different rates in each region.\n\nClimate-resilient peak snow estimation\n\nWe conduct experiments to determine the forcing data and model structures that will maintain SWE estimation skills in future climates. These experiments entail establishing a range of input data sets and statistical models for distributed SWE estimation and applying them to the WUS-D3. We evaluate the relative impact of snow pillow observations, ancillary datasets, and comprehensive snow survey observations (e.g., ref. 36) on peak SWE estimation skills as used as inputs to linear regression, random forest, and U-Net convolutional neural network models.\n\nWe simulate three levels of forcing data from observations that can be used to estimate peak SWE across a basin: (1) snow pillow peak SWE observations alone, (2) snow pillow peak SWE observations augmented with gridded meteorology and (3), (1) and (2) along with intensive, gridded observational estimates of SWE (such as with remotely-sensed, high-resolution lidar data36). These inputs are simulated in historical and future years by extracting the relevant fields from the WUS-D3 dataset corresponding to those observational levels, creating observational drivers, and adding synthetic error to those drivers (see the “Methods” section).\n\nWe estimate pixel-wise peak SWE with three data modeling procedures in order of increasing complexity: (1) linear regression, (2) random forests37, and (3) U-Nets38. Traditionally, operational SWE and runoff forecasting in snow-dominated watersheds has relied on the first of these procedures: empirical development of linear relationships between snow measured at local (i.e., in the same watershed) snow pillow stations and distributed SWE39. We, therefore, use linear regression to replicate the assumptions of status quo approaches. The implementation of random forests then allows for explicit non-linear relationships between input data and distributed peak SWE. Lastly, U-Nets preserve spatial correlations within the outputs in addition to capturing nonlinearity.\n\nIn reality, we expect neither observational information nor data models to be static as snow volumes and patterns change. Therefore, we trained all models on the previous 20 years of data (see the “Methods” section) to reflect current water management and drought definition practices9,40. Figures 3 and 4 show the coefficient of determination (R2) between the WUS-D3 peak SWE value and the modeled estimate of that value for each experimental configuration (i.e., forcing data and model choice).\n\nFigure 3 shows that more observational information and/or higher data model complexity yields higher R2 values. Consequently, the inclusion of more observations (e.g., gridded meteorology and intensive monitoring) and higher complexity models (e.g., random forest or U-Net) enables more accurate estimates of the spatial patterns of peak SWE throughout the 21st century. This figure also shows that while it will be challenging to estimate peak SWE in some catchments with low and/or intermittent snow cover (e.g., the Lower Colorado River Basin and Nevada), estimates of peak SWE can greatly benefit from additional observations and higher-complexity data models. These additional observations and complex models are able to inject information about new spatial relationships between measured and non-measured locations and the response of old spatial relationships to a new climate.\n\nFigure 4 further explores the importance of observations and model complexity for peak SWE prediction across the WUS, highlighting that all predictions decrease in skill into the future as year-to-year variability in snow increases. However, the skill of the U-Net is far greater than the skill of linear regression when forced with snow pillow SWE alone or with gridded meteorology (Fig. 4b–d). The accordion plots in Fig. 4a show high skill in predictions that use a U-Net or at least gridded meteorology. The U-Net and gridded meteorology both explicitly include two-dimensional spatial patterns, while the snow pillow locations, random forest, and linear regression do not. With gridded meteorology, the added value from higher complexity models is smaller than with linear regression but still present. Intensive observations make complex modeling unnecessary or even counterproductive. Figure 4b–d shows time sequences of R2 for each data-model combination, indicating that the U-Net consistently achieves higher skill. Even in future water years, the U-Net model retains R2 generally above 0.75.\n\nFigure 4e–g shows performance increases from implementing U-Nets in place of linear regression. The lower performance in the historical year (yellow) compared to the end-of-century year (blue) is consistent across forcing data categories, but the decline is lower for U-Nets (y-axis) than for linear regression (x-axis). The salient features of the random forest and U-Net are their ability to model nonlinear relationships and that the U-Net explicitly encodes spatial correlations while linear regression and random-forest models are point-specific. These findings suggest that encoding spatial correlations will become increasingly important for peak SWE estimation. While historical performance has less inter-model and inter-basin variance, the snow pillow and gridded cases show consistent improvements from U-Net implementation. Because each model is trained on the previous 20 years of data, the decline in performance toward the end of the century in all data and model cases indicates that snow distributions are changing faster than the spatial models can adapt.\n\nDownscaled regional climate simulations\n\nIn this work, we use WUS-D325, a nine-member ensemble of CMIP6 GCMs, dynamically downscaled with WRf27. Each raw GCM was accessed at its native resolution, and its temperature, humidity, horizontal winds, and geopotential fields were bias-corrected50. Supplementary Table 1 lists each GCM name and variant used in this ensemble. These bias-corrected fields were then used to drive WRF simulations on a 45-km outer domain grid. One-way nesting was then used to downscale the 45-km results to a 9-km grid length inner domain over the Western United States The SWE field is obtained from directly coupling Noah-MP to WRF following methods in refs. 25,29. For this work, we use 9-km data, as the domain of that product covers the entire WUS land region. While this grid cell size can obscure orographic influences on snowpack, the snow product in the historical simulations of WRF with the bias correction described above showed skill in being able to reproduce observed diagnostic fields29, including exhibiting skill in largely reproducing the SWE values found in historical regional snow reanalyses15, as shown in Fig. 1. The skill of WUS-D3 SWE is further demonstrated in the snow pillow site-specific climatology shown in Supplementary Fig. 1. We justify this bias correction because the biases in the corrected fields are endemic to CMIP6 GCMs and arise from unrealistic circulation biases in the northeastern Pacific Ocean. These errors, relative to the European Centre for Medium-Range Weather Forecasting Reanalysis product—version 5 (ERA5)51, are carried forward in future projections and must be corrected to capture realistic WUS hydroclimate.\n\nWe create a historical downscaled dataset covering 1980–2014 by downscaling the historical experiment of the suite of CMIP6 models analyzed26 and we create a dataset that extends from 2015 to 2100 with CMIP6 models that are forced with the Shared Socioeconomic Pathway (SSP) 3-7.0 emissions scenario28. Here, the SSP3-7.0 simulations provide one scenario through which to explore the nature of future change in snowpack-related observations.\n\nFor this work, we use the ‘snow’ (snow water equivalent in mm), ‘prec’ (total precipitation in mm d−1), and ‘t2’ (2-m air temperature in K) outputs of WUS-D3. The peak SWE value at a given pixel is simply the annual maximum at that pixel, which approximately represents the total snow water storage accumulated in a particular pixel. April 1 has been a historically useful proxy for peak SWE and has been used in water supply forecasting, but we use peak SWE here because the regional and temporal drift between true peak SWE and April 1 is increasing and will continue to increase52.\n\nThe precipitation field was used by summing the precipitation of any phase that occurred at that pixel for that water year prior to the peak SWE at that pixel. Similarly, positive degree-day (PDD) values at a given pixel were used as a driver. We calculated this term by summing the positive-only difference between the 2-m air temperature at that pixel and 0 °C for the same time period. The calendaring convention for this analysis is based on the WUS water year that begins on October 1 and is named for the calendar year of the following year (e.g., the water year 1981 is from October 1, 1980 to September 30, 1981 inclusive).\n\nCurrently available snow data products\n\nThe data combinations evaluated in this work were constructed to reflect actual snow-related data products. We accessed daily SNOTEL records from the Natural Resources Conservation Service (NRCS) SNOTEL data repository8 and other snow pillows from CCSS. For comparisons between these data and the downscaled historical simulations, we truncated the snow pillow record to the time period that overlapped between the two datasets: 1980-2014. We accessed the WUS-SR17 SWE data post-assimilation records from the National Snow and Ice Data Center (NSIDC) and selected pixel-wise maximum SWE for each water year in the time domain 1985–2014 for comparison with modeled products in Fig. 1. We also used SNOTEL and WUS-SR data to evaluate the ability of the 9-km downscaled data to represent the performance of the SNOTEL network. Other work has conducted similar comparisons with positive outcomes, including for statistically downscaled, coarser-grid products (e.g., ref. 12). Supplementary Fig. 1 shows daily SWE climatologies for each of the 9-km downscaled, bias-corrected WUS-D3 simulations at pixels containing at least one SNOTEL station from 1985 to 2014, compared to the same time frame with the SNOTEL record and the same pixels in WUS-SR.\n\nPeak SWE in many watersheds of the WUS is constrained by multiple snow pillow stations, weather analyses, and satellite data15,17,53. The most comprehensive observations of catchment-scale SWE currently are sub-orbital: aerial lidar measurements such as the Airborne Snow Observatories36 (ASO), or stereo-photogrammetric reconstructions of snow height at the end of winter54 yield spatially-resolved, cloud-contamination-free SWE products because those measurements are a powerful constraint on SWE. The uncertainty in peak SWE from these measurements is driven by uncertainty in snow density55, the difficulty of measuring snow under canopies56, and off-peak observation timing. Therefore, in situ datasets, particularly from snow pillows, form the backbone of peak SWE estimation in most regions, as reflected in the snow pillow data case; sub-orbital observations are modeled in the intensive data case.\n\nSpatially and temporally resolved gridded precipitation fields, derived from a wide range of observational datasets including ground-based gauges and radars, satellite-based radars and radiometers, and numerical weather simulation57, represent another key dataset with predictive information on peak SWE in the mountains, as reflected by the gridded data case. Surface energy budgets strongly influence SWE, and measures of temperature, such as degree-days, provide practical information on snowpack processes that would negatively influence peak SWE, including snowmelt58. There are also numerous satellite datasets that are relevant to, but only loosely constrain peak SWE in high-altitude complex terrain. For example, the areal fraction of snow is readily measured from multi-spectral radiometry on satellite-based platforms such as the MODerate resolution Imaging Spectroradiometer (MODIS) and Visible Infrared Imaging Radiometer Suite (VIIRS), but those products do not observe snow depth and density.\n\nSpatial pattern repeatability\n\nThe snow pattern repeatability34 is defined as the average R2 between the nondimensionalized peak SWE field S; where \\(S=\\frac{s-{\\mu }}{{\\sigma }}\\) and s is the SWE value in a given grid box, μ is the mean for that time, and σ is the standard deviation of that time step35; and each of the 20 previous years of the same. The 20-year moving window gives each analysis year that we analyze a wide range of interannual variability in SWE while not being directly impacted by a nonstationary climate. The metric S has been applied to higher-resolution snow data in ref. 34 to demonstrate a high degree of pattern repeatability between years. This method of calculating pattern repeatability treats pixels as independent points without a 2-D structure because points in a basin are flattened for correlation analysis.\n\nPerfect data experiments\n\nThe findings presented here, including those in Figs. 3 and 4, are derived from perfect data experiments (sometimes referred to as observing system simulation experiments)59. In this framework, a number of different data models attempt to predict the underlying peak SWE value produced by one of the WUS-D3 simulations at a given time at a given location using predictors based on the atmospheric and surface state from that same WUS-D3 simulation. These data models range in algorithmic complexity and are only given incomplete information about the peak SWE of the WUS-D3 simulation that they are trying to predict. Consequently, synthetic, but realistic errors are added to the gridded precipitation, temperature, fSCA, and SWE predictors. Additionally, a range of different variables (see the section “Data groups for peak SWE prediction”) and algorithms (see the section “Models for peak SWE prediction”) were used to predict peak SWE. Finally, the construction of the perfect data models was designed to ensure that the data models only used a subset of the predictor variables in each WUS-D3 simulation that reasonably corresponds to the data that will be available to make a prediction for peak SWE (e.g., the prediction of any data model at a given time would not be aware of future predictor or predictand values). These observing system simulations are idealized but reveal the challenges, opportunities, and relationships between predictors and a predictand associated with using different observations and data processing algorithms and are used to assess the climate resiliency of peak SWE estimation approaches.\n\nSynthetic gridded data\n\nThere are several synthetic, gridded data fields that are included in these perfect data experiments, including the following. The data field for the fractional snow-covered area (fSCA) is estimated from the distributed SWE field reported in WUS-D3 in order to correspond to what an optical spectroradiometric satellite observes (e.g., Landsat or MODIS Normalized Difference Snow Index60,61). By imaging the same location approximately daily, the satellite instrument datasets skillfully measure snow fraction in and around peak SWE in spite of cloud contamination. For a given day, if a pixel has SWE > 40 mm, then it is assigned an fSCA value of 1, otherwise 062. To account for cloud contamination, the fSCA values are corrupted by randomly masking out 1/3 of the days between the start of the water year (October 1) and the date of peak SWE. For days that are considered cloudy, the value of fSCA is determined by considering the most recent non-cloudy day. The daily fSCA values are then averaged for the entire snow season to yield a synthetic data field of fSCA corresponding to peak SWE.\n\nThe PDD and cumulative precipitation fields are constructed from modeled values of those same quantities, with error and bias added as calculated between the WUS-D3 historical outputs and products from Parameter-elevation Regressions on Independent Slopes Model (PRISM)63 followed by a spatial gradient smoothing step (see Supplementary Fig. 2).\n\nLastly, the distributed April 1 SWE in the intensive data modeling case was constructed to simulate a potential SWE observation either by a future SWE satellite or a modeled product from a sub-orbital aerial system (e.g., ASO). Due to operational constraints that limit the windows when aerial data are collected, the exact timing of sub-orbital observations relative to the peak SWE timing is not guaranteed and cannot be retroactively adjusted to align with the true date of peak SWE. To account for this variance, we randomly assigned a date of synthetic sub-orbital observation by sampling from a normal distribution centered on April 1 of the water year and a standard deviation of seven days.\n\nThe synthetic future gridded temperature and precipitation datasets were developed using a statistical mapping process between the WUS-D3 outputs and historical PRISM data for the same HUC6 basin. For the 1980–2020 time period, we aggregated PRISM data for precipitation and temperature over the WUS domain and re-gridded the 4-km product to the 9-km WUS-D3 grid. For the cumulative precipitation and PDD fields, we then created a pixel-wise bias and error comparison between the PRISM data and the simulated data. We then produce synthetic gridded fields for the analysis presented in Figs. 3 and 4 by adding the same bias and error statistics we diagnosed in the historical WUS-D3 simulations to the 2015-2100 WUS-D3 simulation. The synthetic error is produced by randomly sampling from a distribution that exhibits the same bias and error statistics as the WUS-D3 historical output relative to PRISM. Because each pixel’s future error was randomly sampled independently from all other pixels, we then applied a spatial smoothing algorithm64, as implemented in Python’s skimage module65. This smoothing algorithm captures the spatial correlation structure of WUS-D3 errors relative to PRISM. Supplementary Fig. 2a and c show the synthetic PRISM data for temperature and PDD, respectively, before the spatial smoothing. Supplementary Fig. 2b and d show the same quantities after spatial smoothing. The smoothing algorithm does not change the overall distribution of the absolute quantities across the region, but rather creates a more realistic synthetic PRISM dataset with spatial distributions that represent what an actual PRISM dataset may look like in a future year. Due to the spatial domain of the PRISM data set, we truncated basins that cross the US–Canada border to only include pixels within the US, as it was impossible to estimate the bias and error needed to generate synthetic PRISM PDD and cumulative temperature fields in Canada.\n\nData groups for peak SWE prediction\n\nThese synthetic observational datasets were then used to train a series of different distributed SWE prediction data models. We established several dataset scenarios whereby different combinations of observational datasets are used as predictors of peak SWE, noting that these synthetic variables could very plausibly be used as predictors of peak SWE because they are all currently operationally available. The five predictors dataset groups are as follows:\n\n1.\n\nPeak SWE at the pixel containing a snow pillow site, latitude, longitude\n\n2.\n\nData in (1) with added elevation, slope, and aspect\n\n3.\n\nData in (2) with added synthetic fractional snow-covered area (fSCA) at each pixel\n\n4.\n\nData in (3) with added synthetic PRISM cumulative precipitation, cumulative snowfall, PDD, and mean seasonal temperature\n\n5.\n\nData in (4) with added synthetic sub-orbital lidar-based SWE at April 1 ± 10 days\n\nThese dataset groups were further grouped into three categories. Groups 1 and 2 (“snow pillow”) represent a version of current practices in which topography and snow pillow data are the main drivers of distributed SWE estimation. Groups 3 and 4 (“gridded”) represent the addition of relevant, approximately real-time remote sensing (3) and/or reanalysis (4) data but which only loosely constrain SWE estimates. These datasets, while not generally currently used in most basins to support SWE estimation, are realistically available for the entire WUS without any local expenditures or targeted measurement campaigns. Furthermore, a recent study66 showed that these datasets (scenarios 3 and 4) are drivers that tightly constrain the physical processes governing snow accumulation and melt in the Upper Colorado River Basin. We accumulated these variables from October 1 (i.e., the start of the water year) through April 1 (of the same water year). Lastly, dataset group 5 (“intensive”) represents a heavily observed basin with significant targeted measurements. These measurements tend to be in highly researched basins with funding available to pay for extensive campaigns67. For example, the Tuolumne River Basin in California and the East River Watershed in Colorado had near-April 1 ASO measurements in 2023 and thus have highly constrained SWE estimates47.\n\nModels for peak SWE prediction\n\nWe established the following space of data models to explore the impact of increasing model complexity for predicting spatially distributed SWE:\n\n1.\n\nLinear regression\n\n2.\n\nRandom forest\n\n3.\n\nU-Net\n\nLinear regression methods represent the simplest data model and seek to predict snowpack as a linear function of a set of input variables that are connected to and predictive of the processes that control peak SWE in a given area. Random Forest methods37 add a layer of complexity to model predictions by enabling a non-linear mapping between input(s) and peak SWE. They consist of an ensemble of regression trees, which seek to minimize the model loss by recursively partitioning the input into smaller subspaces. Each regression tree picks a random subset of data points and a random subset of input features for training. The final model output is obtained by taking an average (or ensemble) prediction of all the regression trees. We implemented random forests using Python’s scikit-learn module68 and used the hyperparameter values recommended by the developers of this method (https://CRAN.R-project.org/package=randomForest). We used 500 trees, considered p/3 features when looking for the best node split (where p is the number of input features), and specified a node size of 5. Random forests have been shown to work well with these hyperparameter values for predicting snowpack66.\n\nFinally, we also considered U-Nets38, which adds another layer of complexity to model predictions by imposing spatial constraints on the non-linear mapping between snowpack and input. Spatial constraints imply that pixels that are close to each other will be more correlated than pixels that are further away from each other. U-Nets achieve this by virtue of being fully convolutional neural networks. They also use an encoder-decoder architecture to ensure that only the most relevant information is considered while learning a functional mapping. U-Nets also implement skip connections between the encoding and decoding paths to ensure that there is no information loss during the encoding-decoding process. This results in the model learning a precise mapping between its inputs and its outputs. We implemented U-Nets using the tensorflow module in python69. We used an architecture similar to the original architecture with modifications as shown in Supplementary Fig. 4. Since the input for a given year was a single 2-d image (with multiple channels corresponding to the number of input features), we used a bounding box around each HUC6 basin. The encoder (left side) consisted of a repeated application of two 3 × 3 convolutions (each padded with zeros and followed by a rectified linear unit) and a 2 × 2 max pooling operation to contract the input. Each downsampling step involved doubling the number of feature channels. We did three contractive iterations, which meant the bounding box for each basin needed to be expanded such that its dimensions were a multiple of 8. Additional contractions were not considered due to computational expense. The decoder (right side) consisted of a 3 × 3 transposed convolution that upsampled the inputs by a factor of 2 and halved the number of feature channels. This was concatenated (via a skip connection) with the corresponding hidden layer from the encoder path and then subjected to two 3 × 3 convolutions (as described for the encoder path). The above steps were repeated until the original height and width of the input were recovered. Following this approach, the output was obtained by subjecting the decoder output to a 1 × 1 convolution. The first encoder layer consisted of 64 channels, which resulted in a U-Net model with ~8.6 million parameters. We then clipped the output to the actual basin boundaries.\n\nOther machine learning models have been successfully implemented for distributed SWE prediction70,71; the choice of U-Nets for this work is motivated by the portability and 2-D nature of U-Nets, in addition to their relatively straightforward implementation. All the models were trained on the Perlmutter supercomputer CPU provided by the National Energy Research Scientific Computing Center (NERSC). For the entire study area, the linear regression models took about 20 min to train on a single core. The random forests models took 90 min to train using 128 cores. The U-Net models took 12 h to train using 2048 cores."
    }
}