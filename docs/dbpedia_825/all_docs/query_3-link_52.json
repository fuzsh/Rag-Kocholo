{
    "id": "dbpedia_825_3",
    "rank": 52,
    "data": {
        "url": "https://support.microsoft.com/en-us/topic/kb5025885-how-to-manage-the-windows-boot-manager-revocations-for-secure-boot-changes-associated-with-cve-2023-24932-41a975df-beb2-40c1-99a3-b3ff139f832d",
        "read_more_link": "",
        "language": "en",
        "title": "KB5025885: How to manage the Windows Boot Manager revocations for Secure Boot changes associated with CVE",
        "top_image": "https://support.microsoft.com/favicon-32x32.png",
        "meta_img": "https://support.microsoft.com/favicon-32x32.png",
        "images": [
            "https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE1Mu3b?ver=5c31",
            "https://support.content.office.net/en-us/media/46b20be7-4d36-4305-9b03-5556c3dd7e18.png",
            "https://support.microsoft.com/images/Facebook-GrayScale.png",
            "https://support.microsoft.com/images/Linkedin-GrayScale.png",
            "https://support.microsoft.com/images/Mail-GrayScale.png",
            "https://support.content.office.net/en-us/media/f4e85874-2a1a-438d-9c3c-17b069c454c0.png",
            "https://support.content.office.net/en-us/media/a9241eee-a729-4513-97b4-5b87c381c21b.png",
            "https://support.content.office.net/en-us/media/9e557d93-f803-44df-a274-1282d542cf63.png",
            "https://support.content.office.net/en-us/media/fbf6e41b-ddbe-43db-a616-7a8e48d43d18.png",
            "https://support.content.office.net/en-us/media/9255871d-06a6-4de5-9236-5fd7af100c5c.png",
            "https://support.content.office.net/en-us/media/ccb7c2a6-17dd-4cc3-88b7-8da966e59f59.png",
            "https://support.content.office.net/en-us/media/bcd2fdf1-530a-482f-b96d-5f2f2a49ac66.png",
            "https://support.content.office.net/en-us/media/f4e85874-2a1a-438d-9c3c-17b069c454c0.png"
        ],
        "movies": [],
        "keywords": [],
        "meta_keywords": [
            ""
        ],
        "tags": null,
        "authors": [],
        "publish_date": null,
        "summary": "",
        "meta_description": "",
        "meta_lang": "en",
        "meta_favicon": "/apple-touch-icon.png",
        "meta_site_name": "",
        "canonical_link": "https://support.microsoft.com/en-us/topic/kb5025885-how-to-manage-the-windows-boot-manager-revocations-for-secure-boot-changes-associated-with-cve-2023-24932-41a975df-beb2-40c1-99a3-b3ff139f832d",
        "text": "Summary\n\nThis article describes the protection against the publicly disclosed Secure Boot security feature bypass that uses the BlackLotus UEFI bootkit tracked by CVE-2023-24932, how to enable the mitigations, and guidance on bootable media. A bootkit is a malicious program that is designed to load as early as possible in a devices boot sequence to control the operating system start.\n\nSecure Boot is recommended by Microsoft to make a safe and trusted path from the Unified Extensible Firmware Interface (UEFI) through the Windows kernel Trusted Boot sequence. Secure Boot helps prevent bootkit malware in the boot sequence. Disabling Secure Boot puts a device at risk of being infected by bootkit malware. Fixing the Secure Boot bypass described in CVE-2023-24932 requires revoking boot managers. This could cause issues for some device boot configurations.\n\nMitigations against the Secure Boot bypass detailed in CVE-2023-24932 are included in the Windows security updates that were released on or after July 9, 2024. However, these mitigations are not enabled by default. With these updates, we recommend that you begin evaluating these changes within your environment. The complete schedule is described in the Timing of updates section.\n\nBefore you enable these mitigations, you should thoroughly review the details in this article and determine whether you have to enable the mitigations or wait for a future update from Microsoft. If you choose to enable the mitigations, you must verify your devices are updated and ready, and understand the risks described in this article.\n\nTake Action\n\nScope of Impact\n\nAll Windows devices with Secure Boot protections enabled are affected by the BlackLotus bootkit. Mitigations are available for supported versions of Windows. For the full list, please see CVE-2023-24932.\n\nUnderstanding the risks\n\nMalware Risk: For the BlackLotus UEFI bootkit exploit described in this article to be possible, an attacker must gain administrative privileges on a device or gain physical access to the device. This can be done by accessing the device physically or remotely, such as by using a hypervisor to access VMs/cloud. An attacker will commonly use this vulnerability to continue controlling a device that they can already access and possibly manipulate. Mitigations in this article are preventive and not corrective. If your device is already compromised, contact your security provider for help.\n\nRecovery Media: If you encounter an issue with the device after applying the mitigations and the device becomes unbootable, you might be unable to start or recover your device from existing media. Recovery or install media will need to be updated so that it will work with a device that has the mitigations applied.\n\nFirmware Issues: When Windows applies the mitigations described in this article, it must rely on the UEFI firmware of the device to update the Secure Boot values (the updates are applied to the Database Key (DB) and the Forbidden Signature Key (DBX)). In some cases, we have experience with devices that fail the updates. We are working with device manufacturers to test these key updates in as many devices as possible.\n\nNOTE Please first test these mitigations on a single device per device class in your environment to detect possible firmware issues. Do not deploy broadly before confirming all the device classes in your environment have been evaluated.\n\nBitLocker Recovery: Some devices may go into BitLocker recovery. Be sure to retain a copy of your BitLocker recovery key before enabling the mitigations.\n\nKnown Issues\n\nFirmware Issues: Not all device firmware will successfully update the Secure Boot DB or DBX. In the cases that we are aware of, we have reported the issue to the device manufacturer. See KB5016061: Secure Boot DB and DBX variable update events for details on logged events. Please contact the device manufacturer for firmware updates. If the device is not in support, Microsoft recommends upgrading the device.\n\nKnown firmware issues:\n\nNOTE The following known issues have no impact on, and will not prevent the installation of the July 9, 2024 updates. In most cases, the mitigations will not apply where known issues exist. See details called out in each known issue.\n\nHP: HP identified an issue with mitigation installation on HP Z4G4 Workstation PCs and will release an updated Z4G4 UEFI firmware (BIOS) in the coming weeks. To ensure successful installation of the mitigation, it will be blocked on Desktop Workstations until the update is available. Customers should always update to the latest system BIOS before applying the mitigation.\n\nHP devices with Sure Start Security: These devices need the latest firmware updates from HP to install the mitigations. The mitigations are blocked until the firmware is updated. Install the latest firmware update from HPs support page — Official HP Drivers and Software Download | HP Support.\n\nArm64-based devices: The mitigations are blocked due to known UEFI firmware issues with Qualcomm-based devices. Microsoft is working with Qualcomm to address this issue. Qualcomm will provide the fix to device manufacturers. Contact your device manufacturer to determine if a fix for this issue is available. Microsoft will add detection to allow the mitigations to be applied on devices when the fixed firmware is detected. If your Arm64-based device does not have Qualcomm firmware, configure the following registry key to enable the mitigations.\n\nRegistry Subkey\n\nHKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\SecureBoot\n\nKey Value name\n\nSkipDeviceCheck\n\nData Type\n\nREG_DWORD\n\nData\n\n1\n\nApple: Mac computers that have the Apple T2 Security Chip support Secure Boot. However, updating UEFI security related variables is available only as part of macOS updates. Boot Camp users are expected to see an event log entry of Event ID 1795 in Windows related to these variables. For more information about this log entry, see KB5016061: Secure Boot DB and DBX variable update events.\n\nVMware: On VMware-based virtualization environments, a VM using an x86-based processor with Secure Boot enabled, will fail to boot after applying the mitigations. Microsoft is coordinating with VMware to address this issue.\n\nTPM 2.0-based systems: These systems that run Windows Server 2012 and Windows Server 2012 R2 cannot deploy the mitigations released in the July 9, 2024 security update because of known compatibility issues with TPM measurements. The July 9, 2024 security updates will block mitigations #2 (boot manager) and #3 (DBX update) on affected systems.\n\nMicrosoft is aware of the issue and an update will be released in the future to unblock TPM 2.0-based systems.\n\nTo check your TPM version, right-click Start, click Run, and then type tpm.msc. On the bottom-right of the center pane under TPM Manufacturer Information, you should see a value for Specification Version.\n\nSymantec Endpoint Encryption: Secure Boot mitigations cannot be applied to systems who have installed Symantec Endpoint Encryption. Microsoft and Symantec are aware of the issue and will be addressed in future update.\n\nGuidelines for this release\n\nFor this release, follow these two steps.\n\nStep 1: Install the Windows security update\n\nInstall the Windows monthly security update released on or after July 9, 2024, on supported Windows devices. These updates include mitigations for CVE-2023-24932 but are not enabled by default. All Windows devices should complete this step whether or not you plan to deploy the mitigations.\n\nStep 2: Evaluate the changes\n\nWe encourage you to do the following:\n\nUnderstand the first two mitigations that allow updating the Secure Boot DB and updating the boot manager.\n\nReview the updated schedule.\n\nBegin testing the first two mitigations against representative devices from your environment.\n\nBegin planning for the deployment.\n\nStep 3: Enforce the changes\n\nWe encourage you to understand the risks called out in the Understanding the Risks section.\n\nUnderstand the impact to recovery and other bootable media.\n\nBegin testing the third mitigation that untrusts the signing certificate used for all previous Windows boot managers.\n\nUpdating Windows install media\n\nNOTE When creating a bootable USB thumb drive, be sure to format the drive by using the FAT32 filesystem.\n\nYou can use the Create Recovery Drive application by following these steps. This media can be used to reinstall a device in case there is a major issue such as a hardware failure, you will be able to use the recovery drive to reinstall Windows.\n\nGo to a device where the July 9, 2024 updates and the first mitigation step (updating the Secure Boot DB) have been applied.\n\nFrom the Start menu, search for “Create a Recovery Drive” control panel applet and follow the instructions to create a recovery drive.\n\nWith the newly created flash drive mounted (for example, as drive “D:”), run the following commands as an administrator. Type each of the following commands, and then press Enter:\n\nCOPY D:\\EFI\\MICROSOFT\\BOOT\\BCD D:\\EFI\\MICROSOFT\\BOOT\\BCD.BAK\n\nbcdboot c:\\windows /f UEFI /s D: /bootex\n\nCOPY D:\\EFI\\MICROSOFT\\BOOT\\BCD.BAK D:\\EFI\\MICROSOFT\\BOOT\\BCD\n\nIf you manage installable media in your environment by using the Update Windows installation media with Dynamic Update guidance, follow these steps. These additional steps will create a bootable flash drive that uses boot files signed by the “Windows UEFI CA 2023” signing certificate.\n\nGo to a device where the July 9, 2024, updates and the first mitigation step (updating the Secure Boot DB) has been applied.\n\nFollow the steps in the link below to create media with the July 9, 2024, updates. Update Windows installation media with Dynamic Update\n\nPlace the contents of the media on a USB thumb drive and mount the thumb drive as a drive letter. For example, mount the thumb drive as “D:”.\n\nRun the following commands from a command window as an administrator. Type each of the following commands, and then press Enter.\n\nCOPY D:\\EFI\\MICROSOFT\\BOOT\\BCD D:\\EFI\\MICROSOFT\\BOOT\\BCD.BAK\n\nbcdboot c:\\windows /f UEFI /s D: /bootex\n\nCOPY D:\\EFI\\MICROSOFT\\BOOT\\BCD.BAK D:\\EFI\\MICROSOFT\\BOOT\\BCD\n\nIf a device has the Secure Boot settings reset to the defaults after applying the mitigations, the device will not boot. To resolve this issue, a repair application is included with the July 9, 2024 updates that can be used to reapply the “Windows UEFI CA 2023” certificate to the DB (mitigation #1).\n\nNOTE Do not use this repair application on a device or system that is described in the Known Issues section.\n\nGo to a device where the July 9, 2024 updates have been applied.\n\nIn a command window, copy the recovery app to the flash drive using the following commands (assuming the flash drive is the “D:” drive). Type each command separately and then press Enter:\n\nmd D:\\EFI\\BOOT\n\ncopy C:\\windows\\boot\\efi\\securebootrecovery.efi\n\nD:\\EFI\\BOOT\\bootx64.efi\n\nOn the device that has the Secure Boot settings reset to the defaults, insert the flash drive, restart the device and boot from the flash drive."
    }
}